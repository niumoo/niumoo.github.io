<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>é›ªæ¼«å£«å…µ</title>
  
  <subtitle>ä¸‰å°ºå¾®å‘½ï¼Œä¸€ä»‹ä¹¦ç”Ÿ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.codingme.net/"/>
  <updated>2019-08-07T14:53:57.272Z</updated>
  <id>https://www.codingme.net/</id>
  
  <author>
    <name>é›ªæ¼«å£«å…µ</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåå››ï¼‰è¿…é€Ÿå¯ç”¨ HTTPS åŠ å¯†ä½ çš„ç½‘ç«™</title>
    <link href="https://www.codingme.net/2019/08/springboot/springboot-14-https/"/>
    <id>https://www.codingme.net/2019/08/springboot/springboot-14-https/</id>
    <published>2019-08-06T16:10:22.000Z</published>
    <updated>2019-08-07T14:53:57.272Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-è·å–-HTTPS-è¯ä¹¦"><a href="#1-è·å–-HTTPS-è¯ä¹¦" class="headerlink" title="1. è·å– HTTPS è¯ä¹¦"></a>1. è·å– HTTPS è¯ä¹¦</h2><p>æ­£å¸¸æƒ…å†µä¸‹ HTTPS è¯ä¹¦éœ€è¦ä»è¯ä¹¦æˆæƒä¸­å¿ƒè·å¾—ï¼Œè¿™æ ·è·å¾—çš„è¯ä¹¦æ‰å…·æœ‰å…¬ä¿¡åŠ›ï¼Œä¹Ÿä¼šè¢«å„ç§æµè§ˆå™¨å®¢æˆ·ç«¯æ‰€è®¤å¯ã€‚å¸¸è§çš„è¯ä¹¦å“ç‰Œå¦‚ Symantecï¼ŒGeoTrustmï¼ŒTrustAsiaï¼ŒSymantec ç­‰ã€‚ä¸è¿‡åœ¨ Springboot çš„ HTTPS å®éªŒä¸­å°±æ²¡æœ‰å¿…è¦å»ç”³è¯·äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Java è‡ªå¸¦çš„ <strong>keytool</strong> ç”Ÿæˆ HTTPS è¯ä¹¦ã€‚</p><a id="more"></a><p>æŸ¥çœ‹ keytool å·¥<a href="http://support.typora.io/Images/" target="_blank" rel="noopener">äº†è§£æ›´å¤šâ€¦</a>å…·ä½¿ç”¨è¯´æ˜ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;keytool</span><br><span class="line">å¯†é’¥å’Œè¯ä¹¦ç®¡ç†å·¥å…·</span><br><span class="line">å‘½ä»¤:</span><br><span class="line"> -certreq            ç”Ÿæˆè¯ä¹¦è¯·æ±‚</span><br><span class="line"> -changealias        æ›´æ”¹æ¡ç›®çš„åˆ«å</span><br><span class="line"> -delete             åˆ é™¤æ¡ç›®</span><br><span class="line"> -exportcert         å¯¼å‡ºè¯ä¹¦</span><br><span class="line"> -genkeypair         ç”Ÿæˆå¯†é’¥å¯¹</span><br><span class="line"> -genseckey          ç”Ÿæˆå¯†é’¥</span><br><span class="line"> -gencert            æ ¹æ®è¯ä¹¦è¯·æ±‚ç”Ÿæˆè¯ä¹¦</span><br><span class="line"> -importcert         å¯¼å…¥è¯ä¹¦æˆ–è¯ä¹¦é“¾</span><br><span class="line"> -importpass         å¯¼å…¥å£ä»¤</span><br><span class="line"> -importkeystore     ä»å…¶ä»–å¯†é’¥åº“å¯¼å…¥ä¸€ä¸ªæˆ–æ‰€æœ‰æ¡ç›®</span><br><span class="line"> -keypasswd          æ›´æ”¹æ¡ç›®çš„å¯†é’¥å£ä»¤</span><br><span class="line"> -list               åˆ—å‡ºå¯†é’¥åº“ä¸­çš„æ¡ç›®</span><br><span class="line"> -printcert          æ‰“å°è¯ä¹¦å†…å®¹</span><br><span class="line"> -printcertreq       æ‰“å°è¯ä¹¦è¯·æ±‚çš„å†…å®¹</span><br><span class="line"> -printcrl           æ‰“å° CRL æ–‡ä»¶çš„å†…å®¹</span><br><span class="line"> -storepasswd        æ›´æ”¹å¯†é’¥åº“çš„å­˜å‚¨å£ä»¤</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ "keytool -command_name -help" è·å– command_name çš„ç”¨æ³•</span><br><span class="line"></span><br><span class="line">D:\&gt;keytool -genkeypair --help</span><br><span class="line">keytool -genkeypair [OPTION]...</span><br><span class="line">ç”Ÿæˆå¯†é’¥å¯¹</span><br><span class="line">é€‰é¡¹:</span><br><span class="line"> -alias &lt;alias&gt;                  è¦å¤„ç†çš„æ¡ç›®çš„åˆ«å</span><br><span class="line"> -keyalg &lt;keyalg&gt;                å¯†é’¥ç®—æ³•åç§°</span><br><span class="line"> -keysize &lt;keysize&gt;              å¯†é’¥ä½å¤§å°</span><br><span class="line"> -sigalg &lt;sigalg&gt;                ç­¾åç®—æ³•åç§°</span><br><span class="line"> -destalias &lt;destalias&gt;          ç›®æ ‡åˆ«å</span><br><span class="line"> -dname &lt;dname&gt;                  å”¯ä¸€åˆ¤åˆ«å</span><br><span class="line"> -startdate &lt;startdate&gt;          è¯ä¹¦æœ‰æ•ˆæœŸå¼€å§‹æ—¥æœŸ/æ—¶é—´</span><br><span class="line"> -ext &lt;value&gt;                    X.509 æ‰©å±•</span><br><span class="line"> -validity &lt;valDays&gt;             æœ‰æ•ˆå¤©æ•°</span><br><span class="line"> -keypass &lt;arg&gt;                  å¯†é’¥å£ä»¤</span><br><span class="line"> -keystore &lt;keystore&gt;            å¯†é’¥åº“åç§°</span><br><span class="line"> -storepass &lt;arg&gt;                å¯†é’¥åº“å£ä»¤</span><br><span class="line"> -storetype &lt;storetype&gt;          å¯†é’¥åº“ç±»å‹</span><br><span class="line"> -providername &lt;providername&gt;    æä¾›æ–¹åç§°</span><br><span class="line"> -providerclass &lt;providerclass&gt;  æä¾›æ–¹ç±»å</span><br><span class="line"> -providerarg &lt;arg&gt;              æä¾›æ–¹å‚æ•°</span><br><span class="line"> -providerpath &lt;pathlist&gt;        æä¾›æ–¹ç±»è·¯å¾„</span><br><span class="line"> -v                              è¯¦ç»†è¾“å‡º</span><br><span class="line"> -protected                      é€šè¿‡å—ä¿æŠ¤çš„æœºåˆ¶çš„å£ä»¤</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„ keytool ï¼Œæˆ‘ä»¬ç”Ÿæˆè‡ªå·±çš„è‡ªç­¾åè¯ä¹¦ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;keytool -genkeypair -alias tomcat_https -keypass 123456 -keyalg RSA -keysize 1024 -validity 365 -keystore d:/tomcat_https.keystore -storepass 123456</span><br><span class="line">æ‚¨çš„åå­—ä¸å§“æ°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  darcy</span><br><span class="line">æ‚¨çš„ç»„ç»‡å•ä½åç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  codingme</span><br><span class="line">æ‚¨çš„ç»„ç»‡åç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  codingme</span><br><span class="line">æ‚¨æ‰€åœ¨çš„åŸå¸‚æˆ–åŒºåŸŸåç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  ShangHai</span><br><span class="line">æ‚¨æ‰€åœ¨çš„çœ/å¸‚/è‡ªæ²»åŒºåç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  ShangHai</span><br><span class="line">è¯¥å•ä½çš„åŒå­—æ¯å›½å®¶/åœ°åŒºä»£ç æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  ZN</span><br><span class="line">CN=darcy, OU=codingme, O=codingme, L=ShangHai, ST=ShangHai, C=ZNæ˜¯å¦æ­£ç¡®?</span><br><span class="line">  [å¦]:  y</span><br><span class="line">D:\&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å·²ç»åœ¨æˆ‘ä»¬æŒ‡å®šçš„ä½ç½®ä¸‹ç”Ÿæˆäº†è¯ä¹¦æ–‡ä»¶ï¼Œå¦‚æœéœ€è¦æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ keytool çš„ list å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å¯†é’¥åº“ç±»å‹æ˜¯ JKSï¼Œåœ¨åé¢çš„é…ç½®é‡Œä¼šç”¨åˆ°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;keytool -list -keystore tomcat_https.keystore</span><br><span class="line">è¾“å…¥å¯†é’¥åº“å£ä»¤:</span><br><span class="line"></span><br><span class="line">å¯†é’¥åº“ç±»å‹: JKS</span><br><span class="line">å¯†é’¥åº“æä¾›æ–¹: SUN</span><br><span class="line"></span><br><span class="line">æ‚¨çš„å¯†é’¥åº“åŒ…å« 1 ä¸ªæ¡ç›®</span><br><span class="line"></span><br><span class="line">tomcat_https, 2019-4-21, PrivateKeyEntry,</span><br><span class="line">è¯ä¹¦æŒ‡çº¹ (SHA1): 1E:5F:15:9C:45:BD:D3:2A:7E:7F:1F:83:56:B8:74:E0:8B:CA:FD:F6</span><br><span class="line"></span><br><span class="line">D:\&gt;</span><br></pre></td></tr></table></figure><p>è‡ªå·±ç”Ÿæˆçš„ HTTPS è¯ä¹¦åªèƒ½ç”¨æ¥è‡ªå·±æµ‹è¯•ï¼ŒçœŸæ­£ç”¨äºç½‘ç»œä¸Šæ—¶ï¼Œæµè§ˆå™¨ä¼šæ˜¾ç¤ºè¯ä¹¦æ— æ³•ä¿¡æ¯ã€‚å› æ­¤å¦‚æœæƒ³è¦å¾—åˆ°ä¸€ä¸ªçœŸå®æœ‰æ•ˆçš„è¯ä¹¦ï¼Œè¯·çœ‹æ–‡ç« æœ«å°¾ã€‚</p><h2 id="2-é…ç½®-HTTPS-è¯ä¹¦"><a href="#2-é…ç½®-HTTPS-è¯ä¹¦" class="headerlink" title="2. é…ç½® HTTPS è¯ä¹¦"></a>2. é…ç½® HTTPS è¯ä¹¦</h2><p>åˆ›å»ºä¸€ä¸ª Springboot é¡¹ç›®è¿™é‡Œä¸æï¼Œæ‹·è´ä¸Šä¸€æ­¥éª¤ä¸­ç”Ÿæˆçš„ tomcat_https.keystore è¯ä¹¦æ–‡ä»¶åˆ°<strong>src/main/resource</strong> æ–‡ä»¶å¤¹ä¸‹ï¼Œå…ˆçœ‹ä¸‹æ€»ä½“çš„é¡¹ç›®ç»“æ„ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/3f4682d8b6eaa6ac7bf29eae9f9d5109.png" alt="é¡¹ç›®ç»“æ„å¦‚ä¸‹"></p><p>ç„¶ååœ¨ application.yml æ–‡ä»¶ä¸­é…ç½® HTTPS ç›¸å…³ä¿¡æ¯ã€‚ç›´æ¥é…ç½®äº†ç«¯å£å·ä¸º <strong>443</strong>ï¼Œ443æ˜¯ HTTPS çš„é»˜è®¤ç«¯å£ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ HTTPS å°±è¡Œè®¿é—®çš„æ—¶å€™å°±ä¸éœ€è¦å†™é¢å¤–çš„ç«¯å£å·äº†ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½® HTTPS ç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">443</span></span><br><span class="line"><span class="attr">  http-port:</span> <span class="number">80</span> <span class="comment"># ä¸ºäº†åé¢çš„é…ç½®ä½¿ç”¨ï¼Œæš‚æ—¶æ— ç”¨</span></span><br><span class="line"><span class="attr">  ssl:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    key-store:</span> <span class="attr">classpath:tomcat_https.keystore</span> <span class="comment"># è¯ä¹¦æ–‡ä»¶</span></span><br><span class="line"><span class="attr">    key-password:</span> <span class="number">123456</span>  <span class="comment"># å¯†ç </span></span><br><span class="line"><span class="attr">    key-store-type:</span> <span class="string">JKS</span> <span class="comment"># å¯†é’¥åº“ç±»å‹</span></span><br><span class="line"><span class="attr">    key-alias:</span> <span class="string">tomcat_https</span></span><br></pre></td></tr></table></figure><p>è¿™æ—¶ï¼Œå·²ç»å¯ä»¥é€šè¿‡ HTTPS è¿›è¡Œé¡µé¢è®¿é—®äº†ã€‚</p><h2 id="3-æµ‹è¯•-HTTPS-è¯ä¹¦"><a href="#3-æµ‹è¯•-HTTPS-è¯ä¹¦" class="headerlink" title="3. æµ‹è¯• HTTPS è¯ä¹¦"></a>3. æµ‹è¯• HTTPS è¯ä¹¦</h2><p>ç›´æ¥ç¼–å†™ä¸€ä¸ª æ¥å£ç”¨äºæµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Https æ¥å£æ§åˆ¶ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/4/20 22:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpsController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello HTTPS"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ä¹‹åå¯ä»¥é€šè¿‡ <a href="https://localhost/hello" target="_blank" rel="noopener">https://localhost/hello</a> è¿›è¡Œè®¿é—®äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/29a658a7761aa462cb80e1e34e5b0017.png" alt="HTTPS è®¿é—®æµ‹è¯•"></p><p>å½“ç„¶ï¼Œç”±äºæ˜¯è‡ªå·±ç”Ÿæˆçš„è¯ä¹¦ï¼Œä¼šæç¤ºä¸å®‰å…¨ï¼Œç»§ç»­è®¿é—®å³å¯ï¼Œå¦‚æœæ˜¯æ­£å¸¸ç”³è¯·æˆ–è€…è´­ä¹°çš„è¯ä¹¦å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜çš„ã€‚</p><h2 id="4-HTTP-è·³è½¬-HTTPS"><a href="#4-HTTP-è·³è½¬-HTTPS" class="headerlink" title="4. HTTP è·³è½¬ HTTPS"></a>4. HTTP è·³è½¬ HTTPS</h2><p>åœ¨ä¸Šé¢çš„æµ‹è¯•é‡Œï¼ŒHTTPS å·²ç»å¯ä»¥è®¿é—®äº†ï¼Œä½†æ˜¯ HTTP å´ä¸èƒ½è®¿é—®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹åœ¨å¯ç”¨äº† HTTPS ä¹‹åï¼Œéƒ½ä¼šå¸Œæœ› HTTP çš„è¯·æ±‚ä¼šè‡ªåŠ¨è·³è½¬åˆ° HTTPSï¼Œè¿™ä¸ªåœ¨ Springboot é‡Œè‡ªç„¶ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚æˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªé…ç½®ç±»æŠŠ HTTP è¯·æ±‚ç›´æ¥è½¬å‘åˆ° HTTPS å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * HTTP å¼ºåˆ¶è·³è½¬ HTTPS</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/4/21 17:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Http2Https</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;server.port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sslPort;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;server.http-port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> httpPort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TomcatServletWebServerFactory <span class="title">servletContainerFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TomcatServletWebServerFactory tomcat = <span class="keyword">new</span> TomcatServletWebServerFactory() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postProcessContext</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">                SecurityConstraint securityConstraint = <span class="keyword">new</span> SecurityConstraint();</span><br><span class="line">                securityConstraint.setUserConstraint(<span class="string">"CONFIDENTIAL"</span>);</span><br><span class="line">                SecurityCollection collection = <span class="keyword">new</span> SecurityCollection();</span><br><span class="line">                collection.addPattern(<span class="string">"/*"</span>);</span><br><span class="line">                securityConstraint.addCollection(collection);</span><br><span class="line">                context.addConstraint(securityConstraint);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        Connector connector = <span class="keyword">new</span> Connector(<span class="string">"org.apache.coyote.http11.Http11NioProtocol"</span>);</span><br><span class="line">        connector.setScheme(<span class="string">"http"</span>);</span><br><span class="line">        connector.setPort(httpPort);</span><br><span class="line">        connector.setRedirectPort(sslPort);</span><br><span class="line">        tomcat.addAdditionalTomcatConnectors(connector);</span><br><span class="line">        <span class="keyword">return</span> tomcat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨ä¹‹åï¼Œä½¿ç”¨ <a href="http://localhost/hello" target="_blank" rel="noopener">http://localhost/hello</a> è®¿é—®ä¼šè‡ªåŠ¨è·³è½¬åˆ° <a href="https://localhost/hello" target="_blank" rel="noopener">https://localhost/hello</a>.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>å¦‚æœéœ€è¦ç”³è¯·å…è´¹è¯ä¹¦ï¼Œå¯ä»¥åœ¨è…¾è®¯äº‘ä¸Šå…è´¹ç”³è¯·ï¼Œè¯·å‚è€ƒï¼š</p><ul><li><a href="https://cloud.tencent.com/document/product/400/6813#.E8.8E.B7.E5.8F.96.E8.AF.81.E4.B9.A6" target="_blank" rel="noopener">å…è´¹ç‰ˆ DV SSL è¯ä¹¦ç”³è¯·</a>ã€‚</li></ul><p>å¦‚æœæƒ³è¦è‡ªå·±å®‰è£…è¯ä¹¦ï¼Œè¯·å‚è€ƒï¼š</p><ul><li><a href="https://cloud.tencent.com/document/product/400/35243" target="_blank" rel="noopener">Apache æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li><li><a href="https://cloud.tencent.com/document/product/400/35244" target="_blank" rel="noopener">Nginx æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li><li><a href="https://cloud.tencent.com/document/product/400/35224" target="_blank" rel="noopener">Tomcat æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li><li><a href="https://cloud.tencent.com/document/product/400/35225" target="_blank" rel="noopener">Windows IIS æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li></ul><p>ğŸŸ æ–‡ç« ç›¸å…³ä»£ç å·²ç»ä¸Šä¼  Github <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-https" target="_blank" rel="noopener">Spring Boot https</a>ï¼Œ æ¬¢è¿â­Starï¸ï¼Œæ¬¢è¿ Fork !</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-è·å–-HTTPS-è¯ä¹¦&quot;&gt;&lt;a href=&quot;#1-è·å–-HTTPS-è¯ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;1. è·å– HTTPS è¯ä¹¦&quot;&gt;&lt;/a&gt;1. è·å– HTTPS è¯ä¹¦&lt;/h2&gt;&lt;p&gt;æ­£å¸¸æƒ…å†µä¸‹ HTTPS è¯ä¹¦éœ€è¦ä»è¯ä¹¦æˆæƒä¸­å¿ƒè·å¾—ï¼Œè¿™æ ·è·å¾—çš„è¯ä¹¦æ‰å…·æœ‰å…¬ä¿¡åŠ›ï¼Œä¹Ÿä¼šè¢«å„ç§æµè§ˆå™¨å®¢æˆ·ç«¯æ‰€è®¤å¯ã€‚å¸¸è§çš„è¯ä¹¦å“ç‰Œå¦‚ Symantecï¼ŒGeoTrustmï¼ŒTrustAsiaï¼ŒSymantec ç­‰ã€‚ä¸è¿‡åœ¨ Springboot çš„ HTTPS å®éªŒä¸­å°±æ²¡æœ‰å¿…è¦å»ç”³è¯·äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Java è‡ªå¸¦çš„ &lt;strong&gt;keytool&lt;/strong&gt; ç”Ÿæˆ HTTPS è¯ä¹¦ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Https" scheme="https://www.codingme.net/tags/Https/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåä¸‰ï¼‰ä½¿ç”¨é‚®ä»¶æœåŠ¡</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-13-email/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-13-email/</id>
    <published>2019-03-11T16:20:22.000Z</published>
    <updated>2019-05-20T16:29:37.608Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/00a2b4768bf601da67118c0acb347876.jpg" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰">æˆ‘ä»¬è¿™ä¸ªæ—¶ä»£ï¼Œé‚®ä»¶æœåŠ¡ä¸ç®¡æ˜¯å¯¹äºå·¥ä½œä¸Šçš„äº¤æµï¼Œè¿˜æ˜¯å¹³æ—¶çš„å„ç§é‚®ä»¶é€šçŸ¥ï¼Œéƒ½æ˜¯ä¸€ä¸ªååˆ†é‡è¦çš„å­˜åœ¨ã€‚Java ä»å¾ˆæ—©æ—¶å€™å°±å¯ä»¥é€šè¿‡ Java mail æ”¯æŒé‚®ä»¶æœåŠ¡ã€‚Spring æ›´æ˜¯å¯¹ Java mail è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼ŒæŠ½è±¡å‡ºäº† <code>JavaMailSender</code>. åæ¥éšç€ Springboot çš„å‡ºç°ï¼Œç†æ‰€å½“ç„¶çš„å‡ºç°äº† <code>spring-boot-starter-mail</code>. ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ¯æ¬¡çš„å°è£…éƒ½è®©ä½¿ç”¨å˜å¾—è¶Šæ¥è¶Šç®€å•ã€‚<br><a id="more"></a></p><h2 id="Springboot-mail-ä¾èµ–"><a href="#Springboot-mail-ä¾èµ–" class="headerlink" title="Springboot mail ä¾èµ–"></a>Springboot mail ä¾èµ–</h2><p>åˆ›å»º Springboot é¡¹ç›®ä¸æï¼Œå…ˆçœ‹ä¸€ä¸‹æ€»ä½“ç›®å½•ç»“æ„ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/87989c22d455e3d428811562649c840d.jpg" alt="é¡¹ç›®ç»“æ„"></p><p>ç›´æ¥å¼•å…¥ Springboot é‚®ä»¶æœåŠ¡æ‰€éœ€çš„ä¾èµ–ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- é‚®ä»¶æœåŠ¡ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- Thymeleaf æ¨¡ç‰ˆï¼Œç”¨äºå‘é€æ¨¡ç‰ˆé‚®ä»¶ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="Springboot-mail-é…ç½®"><a href="#Springboot-mail-é…ç½®" class="headerlink" title="Springboot mail é…ç½®"></a>Springboot mail é…ç½®</h2><p>ä½¿ç”¨é‚®ä»¶æœåŠ¡éœ€è¦é…ç½®è‡ªå·±å¯ä»¥ä½¿ç”¨çš„é‚®ç®±ä¿¡æ¯ï¼Œä¸€èˆ¬éœ€è¦é…ç½®å‘é€åè®® SMTPã€é‚®ç®±å¸å·ï¼ˆæœ¬æ¬¡ä»¥126é‚®ç®±ä¸ºä¾‹ï¼‰ã€é‚®ç®±å¯†ç ä»¥åŠç¼–ç æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring.mail.host=smtp.126.com</span><br><span class="line">spring.mail.port=25</span><br><span class="line"># ä½ çš„é‚®ç®±åœ°å€</span><br><span class="line">spring.mail.username=niumoo@126.com </span><br><span class="line"># ä½ çš„æˆæƒç ï¼ˆ126 å’Œ 163 ä»¥åŠ qq é‚®ç®± éƒ½éœ€è¦æˆæƒç ç™»å½•ï¼Œæ²¡æœ‰æˆæƒç çš„ç›´æ¥ç™»å½•ç½‘é¡µç‰ˆé‚®ç®±è®¾ç½®é‡Œè®¾ç½®ï¼‰</span><br><span class="line">spring.mail.password=password</span><br><span class="line">spring.mail.default-encoding=UTF-8</span><br></pre></td></tr></table></figure></p><h2 id="Springboot-mail-æ–‡æœ¬é‚®ä»¶"><a href="#Springboot-mail-æ–‡æœ¬é‚®ä»¶" class="headerlink" title="Springboot mail æ–‡æœ¬é‚®ä»¶"></a>Springboot mail æ–‡æœ¬é‚®ä»¶</h2><p>æ–‡æœ¬é‚®ä»¶æ˜¯æœ€ç®€å•ä¹Ÿæ˜¯æœ€åŸºç¡€çš„ä¸€ç§é‚®ä»¶ï¼Œä½¿ç”¨ Spring å°è£…çš„ <code>JavaMailSender</code> ç›´æ¥å‘é€å°±å¯ä»¥äº†ã€‚</p><p>åˆ›å»º <code>MailService</code> ç±»ï¼Œæ³¨å…¥ <code>JavaMailSender</code> ç”¨äºå‘é€é‚®ä»¶ï¼Œä½¿ç”¨ <code>@Value(&quot;${spring.mail.username}&quot;)</code> ç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ç”¨äºè®¾ç½®é‚®ä»¶å‘é€çš„æ¥é‚®ç®±ã€‚ä½¿ç”¨ <code>@Service</code> æ³¨è§£æŠŠ <code>MailService</code> æ³¨å…¥åˆ° Spring å®¹å™¨ï¼Œä½¿ç”¨ <code>Lombok</code> çš„ <code>@Slf4j</code> å¼•å…¥æ—¥å¿—ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * é‚®ä»¶æœåŠ¡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/3/10 21:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.mail.username&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String from;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSender mailSender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€ç®€å•æ–‡æœ¬é‚®ä»¶</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendSimpleTextMail</span><span class="params">(String to, String subject, String content)</span> </span>&#123;</span><br><span class="line">        SimpleMailMessage message = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">        message.setTo(to);</span><br><span class="line">        message.setSubject(subject);</span><br><span class="line">        message.setText(content);</span><br><span class="line">        message.setFrom(from);</span><br><span class="line">        mailSender.send(message);</span><br><span class="line">        log.info(<span class="string">"ã€æ–‡æœ¬é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åˆ›å»º Springboot çš„å•å…ƒæµ‹è¯•ç±»æµ‹è¯•æ–‡æœ¬é‚®ä»¶ï¼Œå®éªŒä¸­çš„æ”¶ä¿¡äººä¸ºäº†æ–¹ä¾¿ï¼Œéƒ½è®¾ç½®æˆäº†è‡ªå·±çš„é‚®ç®±ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MailService mailService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendSimpleTextMailTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">        String subject = <span class="string">"Springboot å‘é€ç®€å•æ–‡æœ¬é‚®ä»¶"</span>;</span><br><span class="line">        String content = <span class="string">"&lt;p&gt;ç¬¬ä¸€å° Springboot ç®€å•æ–‡æœ¬é‚®ä»¶&lt;/p&gt;"</span>;</span><br><span class="line">        mailService.sendSimpleTextMail(to, subject, content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•æ–‡æœ¬é‚®ä»¶çš„å‘é€ã€‚</p><p>PSï¼šå¦‚æœè¿è¡ŒæŠ¥å‡ºå¼‚å¸¸ <code>AuthenticationFailedException: 535 Error</code>. ä¸€èˆ¬éƒ½æ˜¯ç”¨æˆ·åå’Œå¯†ç æœ‰è¯¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Caused by: javax.mail.AuthenticationFailedException: 535 Error: authentication failed</span><br><span class="line"></span><br><span class="line">at com.sun.mail.smtp.SMTPTransport$Authenticator.authenticate(SMTPTransport.java:965)</span><br><span class="line">at com.sun.mail.smtp.SMTPTransport.authenticate(SMTPTransport.java:876)</span><br><span class="line">at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:780)</span><br><span class="line">at javax.mail.Service.connect(Service.java:366)</span><br><span class="line">at org.springframework.mail.javamail.JavaMailSenderImpl.connectTransport(JavaMailSenderImpl.java:517)</span><br><span class="line">at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:436)</span><br><span class="line">... 34 more</span><br></pre></td></tr></table></figure></p><p>æ­£å¸¸è¿è¡Œè¾“å‡ºæˆåŠŸå‘é€çš„æ—¥å¿—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2019-03-11 23:35:14.743  INFO 13608 --- [           main] n.codingme.boot.service.MailServiceTest  : Started MailServiceTest in 3.964 seconds (JVM running for 5.749)</span><br><span class="line">2019-03-11 23:35:24.718  INFO 13608 --- [           main] net.codingme.boot.service.MailService    : ã€æ–‡æœ¬é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=niumoo@126.com</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹é‚®ç®±ä¸­çš„æ”¶ä¿¡ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/e391dbce4b614779ae9a024908ef0275.jpg" alt="æ–‡æœ¬é‚®ä»¶"></p><p>æ–‡æœ¬é‚®ä»¶æ­£å¸¸æ”¶åˆ°ï¼ŒåŒæ—¶å¯è§æ–‡æœ¬é‚®ä»¶ä¸­çš„ HTML æ ‡ç­¾ä¹Ÿä¸ä¼šè¢«è§£æã€‚</p><h2 id="Springboot-mail-HTML-é‚®ä»¶"><a href="#Springboot-mail-HTML-é‚®ä»¶" class="headerlink" title="Springboot mail HTML é‚®ä»¶"></a>Springboot mail HTML é‚®ä»¶</h2><p>åœ¨ä¸Šé¢çš„ <code>MailService</code> ç±»é‡Œæ–°åŠ ä¸€ä¸ªæ–¹æ³• <code>sendHtmlMail</code>ï¼Œç”¨äºæµ‹è¯• HTML é‚®ä»¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€ HTML é‚®ä»¶</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> MessagingException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendHtmlMail</span><span class="params">(String to, String subject, String content)</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    MimeMessage message = mailSender.createMimeMessage();</span><br><span class="line">    MimeMessageHelper messageHelper = <span class="keyword">new</span> MimeMessageHelper(message, <span class="keyword">true</span>);</span><br><span class="line">    messageHelper.setFrom(from);</span><br><span class="line">    messageHelper.setTo(to);</span><br><span class="line">    messageHelper.setSubject(subject);</span><br><span class="line">    <span class="comment">// true ä¸º HTML é‚®ä»¶</span></span><br><span class="line">    messageHelper.setText(content, <span class="keyword">true</span>);</span><br><span class="line">    mailSender.send(message);</span><br><span class="line">    log.info(<span class="string">"ã€HTML é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨æµ‹è¯•æ–¹æ³•ä¸­å¢åŠ  HTML é‚®ä»¶æµ‹è¯•æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendHtmlMailTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ HTML é‚®ä»¶"</span>;</span><br><span class="line">    String content = <span class="string">"&lt;h2&gt;Hi~&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€å° Springboot HTML é‚®ä»¶&lt;/p&gt;"</span>;</span><br><span class="line">    mailService.sendHtmlMail(to, subject, content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/147b7f68d12e0080b408a581414fb92a.jpg" alt="HTML é‚®ä»¶"></p><p>HTML é‚®ä»¶æ­£å¸¸æ”¶åˆ°ï¼ŒHTML æ ‡ç­¾ä¹Ÿè¢«è§£ææˆå¯¹åº”çš„æ ·å¼ã€‚</p><h2 id="Springboot-mail-é™„ä»¶é‚®ä»¶"><a href="#Springboot-mail-é™„ä»¶é‚®ä»¶" class="headerlink" title="Springboot mail é™„ä»¶é‚®ä»¶"></a>Springboot mail é™„ä»¶é‚®ä»¶</h2><p>åœ¨ä¸Šé¢çš„ <code>MailService</code> ç±»é‡Œæ–°åŠ ä¸€ä¸ªæ–¹æ³• <code>sendAttachmentMail</code>ï¼Œç”¨äºæµ‹è¯• é™„ä»¶é‚®ä»¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileArr</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendAttachmentMail</span><span class="params">(String to, String subject, String content, String... fileArr)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line">    MimeMessageHelper messageHelper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line">    messageHelper.setFrom(from);</span><br><span class="line">    messageHelper.setTo(to);</span><br><span class="line">    messageHelper.setSubject(subject);</span><br><span class="line">    messageHelper.setText(content, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ é™„ä»¶</span></span><br><span class="line">    <span class="keyword">for</span> (String filePath : fileArr) &#123;</span><br><span class="line">        FileSystemResource fileResource = <span class="keyword">new</span> FileSystemResource(<span class="keyword">new</span> File(filePath));</span><br><span class="line">        <span class="keyword">if</span> (fileResource.exists()) &#123;</span><br><span class="line">            String filename = fileResource.getFilename();</span><br><span class="line">            messageHelper.addAttachment(filename, fileResource);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mailSender.send(mimeMessage);</span><br><span class="line">    log.info(<span class="string">"ã€é™„ä»¶é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨æµ‹è¯•æ–¹æ³•ä¸­å¢åŠ é™„ä»¶é‚®ä»¶æµ‹è¯•æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendAttachmentTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ HTML é™„ä»¶é‚®ä»¶"</span>;</span><br><span class="line">    String content = <span class="string">"&lt;h2&gt;Hi~&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€å° Springboot HTML é™„ä»¶é‚®ä»¶&lt;/p&gt;"</span>;</span><br><span class="line">    String filePath = <span class="string">"pom.xml"</span>;</span><br><span class="line">    mailService.sendAttachmentMail(to, subject, content, filePath, filePath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/0ab42e65ae35c7970d7954bf5a985a79.jpg" alt="é™„ä»¶é‚®ä»¶"></p><p>å¸¦é™„ä»¶çš„é‚®ä»¶æ­£å¸¸æ”¶åˆ°ï¼Œå¤šä¸ªé™„ä»¶çš„å®ç°æ–¹å¼åŒç†ã€‚</p><h2 id="Springboot-mail-å›¾ç‰‡é‚®ä»¶"><a href="#Springboot-mail-å›¾ç‰‡é‚®ä»¶" class="headerlink" title="Springboot mail å›¾ç‰‡é‚®ä»¶"></a>Springboot mail å›¾ç‰‡é‚®ä»¶</h2><p>å›¾ç‰‡é‚®ä»¶å’Œå…¶ä»–çš„é‚®ä»¶æ–¹å¼ç•¥æœ‰ä¸åŒï¼Œå›¾ç‰‡é‚®ä»¶éœ€è¦å…ˆåœ¨å†…å®¹ä¸­å®šä¹‰å¥½å›¾ç‰‡çš„ä½ç½®å¹¶å‡ºç»™ä¸€ä¸ªè®°å½• ID ï¼Œç„¶ååœ¨æŠŠå›¾ç‰‡åŠ åˆ°é‚®ä»¶ä¸­çš„å¯¹äºçš„ ID ä½ç½®ã€‚</p><p>åœ¨ä¸Šé¢çš„ <code>MailService</code> ç±»é‡Œæ–°åŠ ä¸€ä¸ªæ–¹æ³• <code>sendImgMail</code>ï¼Œç”¨äºæµ‹è¯• é™„ä»¶é‚®ä»¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * å‘é€å¸¦å›¾ç‰‡çš„é‚®ä»¶</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> imgMap</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendImgMail</span><span class="params">(String to, String subject, String content, Map&lt;String, String&gt; imgMap)</span></span></span><br><span class="line"><span class="function">     <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">     MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line">     MimeMessageHelper messageHelper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line">     messageHelper.setFrom(from);</span><br><span class="line">     messageHelper.setTo(to);</span><br><span class="line">     messageHelper.setSubject(subject);</span><br><span class="line">     messageHelper.setText(content, <span class="keyword">true</span>);</span><br><span class="line">     <span class="comment">// æ·»åŠ å›¾ç‰‡</span></span><br><span class="line">     <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : imgMap.entrySet()) &#123;</span><br><span class="line">         FileSystemResource fileResource = <span class="keyword">new</span> FileSystemResource(<span class="keyword">new</span> File(entry.getValue()));</span><br><span class="line">         <span class="keyword">if</span> (fileResource.exists()) &#123;</span><br><span class="line">             String filename = fileResource.getFilename();</span><br><span class="line">             messageHelper.addInline(entry.getKey(), fileResource);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     mailSender.send(mimeMessage);</span><br><span class="line">     log.info(<span class="string">"ã€å›¾ç‰‡é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨æµ‹è¯•æ–¹æ³•ä¸­å¢åŠ å›¾ç‰‡é‚®ä»¶æµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•æ–¹æ³•ä¸­ä½¿ç”¨çš„ apple.png æ˜¯é¡¹ç›®é‡Œçš„ä¸€ä¸ªå›¾ç‰‡ã€‚å¯ä»¥çœ‹ä¸Šé¢çš„é¡¹ç›®ç»“æ„ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendImgTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ HTML å›¾ç‰‡é‚®ä»¶"</span>;</span><br><span class="line">    String content =</span><br><span class="line">        <span class="string">"&lt;h2&gt;Hi~&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€å° Springboot HTML å›¾ç‰‡é‚®ä»¶&lt;/p&gt;&lt;br/&gt;&lt;img src=\"cid:img01\" /&gt;&lt;img src=\"cid:img02\" /&gt;"</span>;</span><br><span class="line">    String imgPath = <span class="string">"apple.png"</span>;</span><br><span class="line">    Map&lt;String, String&gt; imgMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    imgMap.put(<span class="string">"img01"</span>, imgPath);</span><br><span class="line">    imgMap.put(<span class="string">"img02"</span>, imgPath);</span><br><span class="line">    mailService.sendImgMail(to, subject, content, imgMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/a676fadf6b40195c7de746adff0700bc.jpg" alt="å›¾ç‰‡é‚®ä»¶"></p><p>ä¸¤ä¸ªå›¾ç‰‡æ­£å¸¸æ˜¾ç¤ºåœ¨é‚®ä»¶é‡Œã€‚</p><h2 id="Springboot-mail-æ¨¡ç‰ˆé‚®ä»¶"><a href="#Springboot-mail-æ¨¡ç‰ˆé‚®ä»¶" class="headerlink" title="Springboot mail æ¨¡ç‰ˆé‚®ä»¶"></a>Springboot mail æ¨¡ç‰ˆé‚®ä»¶</h2><p>æ¨¡ç‰ˆé‚®ä»¶çš„ç”¨å¤„å¾ˆå¹¿æ³›ï¼Œåƒç»å¸¸æ”¶åˆ°çš„æ³¨å†ŒæˆåŠŸé‚®ä»¶æˆ–è€…æ˜¯æ“ä½œé€šçŸ¥é‚®ä»¶ç­‰éƒ½æ˜¯æ¨¡ç‰ˆé‚®ä»¶ï¼Œæ¨¡ç‰ˆé‚®ä»¶å¾€å¾€åªéœ€è¦æ›´æ”¹å…¶ä¸­çš„å‡ ä¸ªå˜é‡ã€‚Springboot ä¸­çš„æ¨¡ç‰ˆé‚®ä»¶é¦–é€‰éœ€è¦é€‰æ‹©ä¸€æ¬¾æ¨¡ç‰ˆå¼•æ“ï¼Œåœ¨å¼•å…¥ä¾èµ–çš„æ—¶å€™å·²ç»å¢åŠ äº†æ¨¡ç‰ˆå¼•æ“ <code>Thymeleaf</code>.</p><p>æ¨¡ç‰ˆé‚®ä»¶é¦–å…ˆéœ€è¦ä¸€ä¸ªé‚®ä»¶æ¨¡ç‰ˆï¼Œæˆ‘ä»¬åœ¨ <code>Templates</code> ä¸‹æ–°å»ºä¸€ä¸ª <code>HTML</code> æ–‡ä»¶ <code>RegisterSuccess.html</code>. å…¶ä¸­çš„ username æ˜¯ç»™æˆ‘ä»¬è‡ªå®šä¹‰çš„ã€‚<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ³¨å†ŒæˆåŠŸé€šçŸ¥<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>[[$&#123;username&#125;]]ï¼Œæ‚¨å¥½!</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    æ–°çš„å…¬é’¥å·²æ·»åŠ åˆ°ä½ çš„è´¦æˆ·:<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    æ ‡é¢˜: HP-WIN10 <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    å¦‚æœå…¬é’¥æ— æ³•ä½¿ç”¨ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œé‡æ–°æ·»åŠ ï¼š SSH Keys</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>åœ¨é‚®ä»¶æœåŠ¡ <code>MailService</code> ä¸­æ³¨å…¥æ¨¡ç‰ˆå¼•æ“,ç„¶åç¼–å†™é‚®ä»¶æ¨¡ç‰ˆå‘é€ä»£ç ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€æ¨¡ç‰ˆé‚®ä»¶</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> paramMap</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> template</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> MessagingException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendTemplateMail</span><span class="params">(String to, String subject, Map&lt;String, Object&gt; paramMap, String template)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    Context context = <span class="keyword">new</span> Context();</span><br><span class="line">    <span class="comment">// è®¾ç½®å˜é‡çš„å€¼</span></span><br><span class="line">    context.setVariables(paramMap);</span><br><span class="line">    String emailContent = templateEngine.process(template, context);</span><br><span class="line">    sendHtmlMail(to, subject, emailContent);</span><br><span class="line">    log.info(<span class="string">"ã€æ¨¡ç‰ˆé‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼paramsMap=&#123;&#125;ï¼Œtemplate=&#123;&#125;"</span>, paramMap, template);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨å•å…ƒå•å…ƒæµ‹è¯•ä¸­å¢åŠ æ¨¡ç‰ˆé‚®ä»¶æµ‹è¯•æ–¹æ³•ï¼Œç„¶åå‘é€é‚®ä»¶æµ‹è¯•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendTemplateMailTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ æ¨¡ç‰ˆé‚®ä»¶"</span>;</span><br><span class="line">    Map&lt;String, Object&gt; paramMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">    paramMap.put(<span class="string">"username"</span>, <span class="string">"Darcy"</span>);</span><br><span class="line">    mailService.sendTemplateMail(to, subject, paramMap, <span class="string">"RegisterSuccess"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/8244d50efe797cfa3ceb14aab7b7b461.jpg" alt="æ¨¡ç‰ˆé‚®ä»¶"></p><p>å¯ä»¥å‘ç°æ¨¡ç‰ˆé‚®ä»¶å·²ç»æ­£å¸¸å‘é€äº†ã€‚</p><h2 id="Springboot-mail-è¡¥å……"><a href="#Springboot-mail-è¡¥å……" class="headerlink" title="Springboot mail è¡¥å……"></a>Springboot mail è¡¥å……</h2><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ˜¯ Springboot é‚®ä»¶æœåŠ¡çš„åŸºæœ¬ç”¨æ³•ï¼Œä»£ç ä¹Ÿæœ‰å¾ˆå¤šé‡å¤ï¼Œå’Œå®é™…çš„ä½¿ç”¨æƒ…å†µç›¸æ¯”è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œæ¯”å¦‚ç¼ºå°‘<code>å¼‚å¸¸å¤„ç†æœºåˆ¶</code>ï¼Œåœ¨å‘é€å¤±è´¥æ—¶çš„<code>é‡è¯•æœºåˆ¶</code>ä¹Ÿæ²¡æœ‰ï¼Œå®é™…æƒ…å†µä¸­é‚®ä»¶æœåŠ¡å¾€å¾€å¯¹å®æ—¶æ€§ä¸é«˜ï¼Œå¤šè¯´æƒ…å†µä¸‹ä¼šç”¨äº<code>å¼‚æ­¥è¯·æ±‚</code>ã€‚</p><p>æ–‡ç« ç›¸å…³ä»£ç å·²ç»ä¸Šä¼  Github <a href="https://github.com/niumoo/springboot/tree/master/springboot-mail" target="_blank" rel="noopener">Spring Boot ç›¸å…³æ•´åˆ - é‚®ä»¶æœåŠ¡</a>ã€‚</p><p>&lt;å®Œ&gt;<br>æœ¬æ–‡åŸå‘äºä¸ªäººåšå®¢ï¼š<a href="https://www.codingme.net">https://www.codingme.net</a> è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/00a2b4768bf601da67118c0acb347876.jpg&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;æˆ‘ä»¬è¿™ä¸ªæ—¶ä»£ï¼Œé‚®ä»¶æœåŠ¡ä¸ç®¡æ˜¯å¯¹äºå·¥ä½œä¸Šçš„äº¤æµï¼Œè¿˜æ˜¯å¹³æ—¶çš„å„ç§é‚®ä»¶é€šçŸ¥ï¼Œéƒ½æ˜¯ä¸€ä¸ªååˆ†é‡è¦çš„å­˜åœ¨ã€‚Java ä»å¾ˆæ—©æ—¶å€™å°±å¯ä»¥é€šè¿‡ Java mail æ”¯æŒé‚®ä»¶æœåŠ¡ã€‚Spring æ›´æ˜¯å¯¹ Java mail è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼ŒæŠ½è±¡å‡ºäº† &lt;code&gt;JavaMailSender&lt;/code&gt;. åæ¥éšç€ Springboot çš„å‡ºç°ï¼Œç†æ‰€å½“ç„¶çš„å‡ºç°äº† &lt;code&gt;spring-boot-starter-mail&lt;/code&gt;. ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ¯æ¬¡çš„å°è£…éƒ½è®©ä½¿ç”¨å˜å¾—è¶Šæ¥è¶Šç®€å•ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="é‚®ä»¶" scheme="https://www.codingme.net/tags/%E9%82%AE%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåäºŒï¼‰ä½¿ç”¨ Mybatis é›†æˆ pagehelper åˆ†é¡µæ’ä»¶å’Œ mapper æ’ä»¶</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-12-data-mybatis-page/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-12-data-mybatis-page/</id>
    <published>2019-03-07T16:40:22.000Z</published>
    <updated>2019-05-20T16:26:48.646Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/64cccddf32b7e3f4069ca2459057496e.png" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ Springboot ç³»åˆ—æ–‡ç« ç¬¬åä¸€ç¯‡é‡Œï¼ˆ<a href="https://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483756&amp;idx=1&amp;sn=902dba8ed665131453bc26de246ccaa1&amp;chksm=e984e808def3611edf0949a9db71ea6dc29432b25fb27015d78bc8117a50a3bedd79194de5ea&amp;token=93558379&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ä½¿ç”¨ Mybatisï¼ˆè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼‰ è®¿é—®æ•°æ®åº“</a>ï¼‰ï¼Œå®éªŒäº† Springboot ç»“åˆ Mybatis ä»¥åŠ Mybatis-generator ç”Ÿæˆæ’ä»¶çš„å¼€å‘è¿‡ç¨‹ï¼Œå…¶å®å¯¹äº Mybatis æ¥è®²è¿˜æœ‰å¾ˆå¤šä¼˜ç§€æ–¹ä¾¿å¥½ç”¨çš„æ’ä»¶ï¼Œæ¯”å¦‚è¿™æ¬¡è¦æ¼”ç¤ºçš„ é€šç”¨ Mapper ç”Ÿæˆæ’ä»¶å’Œåˆ†é¡µæ’ä»¶ã€‚<br><a id="more"></a></p><h2 id="æ•°æ®åº“å‡†å¤‡"><a href="#æ•°æ®åº“å‡†å¤‡" class="headerlink" title="æ•°æ®åº“å‡†å¤‡"></a>æ•°æ®åº“å‡†å¤‡</h2><p> æ—¢ç„¶æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œå…ˆå‡†å¤‡ä¸€ä¸ªç”¨äºå®éªŒæ“ä½œçš„æ•°æ®è¡¨ï¼Œè¿™æ¬¡è¿˜æ˜¯ä½¿ç”¨ä¸Šä¸€ä¸ªå®éªŒä½¿ç”¨çš„ mysql æ•°æ®åº“ä¸­çš„ springboot.book æ•°æ®è¡¨ã€‚</p><p>æœªåˆ›å»ºçš„å¯ä»¥åœ¨ mysql æ•°æ®åº“çš„ springboot åº“ä¸­åˆ›å»ºè¡¨ book ç”¨äºæ¼”ç¤ºã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`author`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä½œè€…'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±åç§°'</span>,</span><br><span class="line">  <span class="string">`price`</span> <span class="built_in">float</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä»·æ ¼'</span>,</span><br><span class="line">  <span class="string">`create_time`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">  <span class="string">`description`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±æè¿°'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">15</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></p><p>å¢åŠ æµ‹è¯•æ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (2, &apos;é‡‘åº¸&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–&apos;, 12, &apos;2018-09-01 10:10:12&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (3, &apos;ç½—è´¯ä¸­&apos;, &apos;ä¸‰å›½æ¼”ä¹‰&apos;, 22, &apos;2018-09-01 10:10:16&apos;, &apos;æ˜¯ä½œå®¶ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å†å²å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (4, &apos;å´æ‰¿æ©&apos;, &apos;è¥¿æ¸¸è®°&apos;, 17, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶å´æ‰¿æ©åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (5, &apos;é‡‘åº¸1535767819284&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819284&apos;, 43, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819284&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (6, &apos;é‡‘åº¸1535767819679&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819679&apos;, 24, &apos;2018-09-01 10:10:20&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819679&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (7, &apos;ç½—è´¯ä¸­1535769035138&apos;, &apos;ä¸‰å›½æ¼”ä¹‰1535769035138&apos;, 20, &apos;2018-09-01 10:30:35&apos;, &apos;æ˜¯ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨å°è¯´1535769035138&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (9, &apos;é‡‘åº¸1535783613226&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783613226&apos;, 30, &apos;2018-09-01 14:33:33&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783613226&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (10, &apos;é‡‘åº¸1535783618455&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783618455&apos;, 30, &apos;2018-09-01 14:33:38&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783618455&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (11, &apos;é‡‘åº¸1535783620634&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783620634&apos;, 30, &apos;2018-09-01 14:33:41&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783620634&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (12, &apos;é‡‘åº¸1535783672457&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783672457&apos;, 30, &apos;2018-09-01 14:34:32&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783672457&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (13, &apos;é‡‘åº¸1535783673664&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783673664&apos;, 30, &apos;2018-09-01 14:34:34&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783673664&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (14, &apos;é‡‘åº¸1535783939262&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783939262&apos;, 30, &apos;2018-09-01 14:38:59&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783939262&apos;);</span><br></pre></td></tr></table></figure></p><h2 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h2><p>åˆ›å»º Springboot é¡¹ç›®ä¸æï¼Œå¼•å…¥ maven ä¾èµ–ï¼Œä¸»è¦æ˜¯ mybastis æ ¸å¿ƒä¾èµ–ä»¥åŠ mybatis mapper è‡ªåŠ¨ç”Ÿæˆæ’ä»¶ã€åˆ†é¡µæ’ä»¶ã€é€šç”¨ Mapper æ’ä»¶ã€‚ä¾èµ–ä¸­çš„ druid æ•°æ®æºéƒ¨åˆ†ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!--æ·»åŠ æ•°æ®åº“é“¾æ¥ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Druid æ•°æ®æº --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis mapperè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis é€šç”¨ Mapper --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç®€å•è¯´æ˜ä¸€ä¸‹å‡ ä¸ªä¸å¸¸è§ä¾èµ–çš„ä½œç”¨ã€‚</p><ol><li>mybatis-generator-core ç”¨äºè‡ªåŠ¨ç”Ÿæˆ modelã€mapper æ¥å£ã€mapper xmlã€‚</li><li>pagehelper-spring-boot-starter ç”¨äºåˆ†é¡µ</li><li>mapper ç”¨äºå¢å¼ºå¢åˆ æ”¹æŸ¥åŠŸèƒ½ï¼Œé›†æˆäº†å¾ˆå¤šå¸¸ç”¨æ“ä½œã€‚</li></ol><h2 id="å¢åŠ é…ç½®"><a href="#å¢åŠ é…ç½®" class="headerlink" title="å¢åŠ é…ç½®"></a>å¢åŠ é…ç½®</h2><p>å…³äº Druid æ•°æ®æºçš„é…ç½®ä¸å†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚é…ç½®ä¸­ä¸»è¦é…ç½®äº†é¡¹ç›®ç¼–ç ã€æ•°æ®æºä¿¡æ¯ã€durid æ•°æ®æºå’Œ mybatis çš„ mapper ä½ç½®ä»¥åŠ mybatis æ˜ å°„åˆ«åçš„åŒ…è·¯å¾„ã€‚è¿˜æœ‰ pagehelper åˆ†é¡µæ’ä»¶éƒ¨åˆ†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">############################################################</span><br><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line"># ç¼–ç </span><br><span class="line">server.tomcat.uri-encoding=utf-8</span><br><span class="line">spring.http.encoding.force=true</span><br><span class="line">spring.http.encoding.charset=UTF-8</span><br><span class="line">spring.http.encoding.enabled=true</span><br><span class="line">############################################################</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line"># ä½¿ç”¨ druid æ•°æ®æº</span><br><span class="line">spring.datasource.type:com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.initialSize:5</span><br><span class="line">spring.datasource.minIdle:5</span><br><span class="line">spring.datasource.maxActive:20</span><br><span class="line">spring.datasource.maxWait:60000</span><br><span class="line">spring.datasource.timeBetweenEvictionRunsMillis:60000</span><br><span class="line">spring.datasource.minEvictableIdleTimeMillis:300000</span><br><span class="line">spring.datasource.validationQuery:SELECT 1 FROM DUAL</span><br><span class="line">spring.datasource.testWhileIdle:true</span><br><span class="line">spring.datasource.testOnBorrow:false</span><br><span class="line">spring.datasource.testOnReturn:false</span><br><span class="line">spring.datasource.poolPreparedStatements:true</span><br><span class="line">spring.datasource.filters:stat</span><br><span class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize:20</span><br><span class="line">spring.datasource.useGlobalDataSourceStat:true</span><br><span class="line">spring.datasource.connectionProperties:druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br><span class="line">############################################################</span><br><span class="line"># mybatis</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*.xml</span><br><span class="line">mybatis.type-aliases-package=net.codingme.boot.domain</span><br><span class="line">############## mybatis pageé…ç½®#######################</span><br><span class="line"># restart ç±»åŠ è½½åŠ è½½ include è¿›å»çš„ jar åŒ…ã€‚</span><br><span class="line">restart.include.mapper=/mapper-[\\w-\\.]+jar</span><br><span class="line">restart.include.pagehelper=/pagehelper-[\\w-\\.]+jar</span><br><span class="line"># mappers å¤šä¸ªæ¥å£æ—¶é€—å·éš”å¼€</span><br><span class="line">mapper.mappers=net.codingme.boot.util.MybatisMapper</span><br><span class="line">mapper.not-empty=false</span><br><span class="line">mapper.identity=MYSQL</span><br><span class="line"># pagehelper</span><br><span class="line">pagehelper.helperDialect=mysql</span><br><span class="line">pagehelper.reasonable=true</span><br><span class="line">pagehelper.supportMethodsArguments=true</span><br><span class="line">pagehelper.params=count=countSql</span><br><span class="line"># è¾“å‡º mybatis SQL æ—¥å¿—</span><br><span class="line">logging.level.net.codingme.boot.domain.mapper=debug</span><br></pre></td></tr></table></figure><p>ä¸€äº›è¯´æ˜ã€‚</p><ol><li><code>mapper.mappers=net.codingme.boot.util.MybatisMapper</code> ç”¨äºåŒ…å«ä¸€ä¸ªè‡ªå·±ç¼–å†™çš„ mapperã€‚</li><li><code>restart.include</code> çƒ­éƒ¨ç½²</li><li><code>logging.level.net.codingme.boot.domain.mapper=debug</code> è¾“å‡º Mybatis SQL è¿™é‡Œè¦æŒ‡å®šè‡ªå·± mapper æ‰€åœ¨çš„åŒ…è·¯å¾„</li></ol><h2 id="é€šç”¨-Mapper"><a href="#é€šç”¨-Mapper" class="headerlink" title="é€šç”¨ Mapper"></a>é€šç”¨ Mapper</h2><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä¹Ÿæ¼”ç¤ºäº†è‡ªåŠ¨ç”Ÿæˆï¼Œé‚£æ˜¯é€šç”¨çš„ä¸€ç§ç”Ÿæˆæ–¹å¼ï¼Œè¿™æ¬¡æˆ‘ä»¬å¼•å…¥é€šç”¨ Mapper å†è¿›è¡Œç”Ÿæˆï¼Œè¿™æ ·ç”Ÿæˆçš„ä»£ç æ›´åŠ ç®€æ´ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå…ˆçœ‹ä¸€ä¸‹é¡¹ç›®æœ€ç»ˆç»“æ„ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/58fef28ddbcf12f769f2424db21d7fa3.png" alt="é¡¹ç›®æ¥å£"></p><h3 id="è‡ªåŠ¨ç”Ÿæˆé…ç½®"><a href="#è‡ªåŠ¨ç”Ÿæˆé…ç½®" class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆé…ç½®"></a>è‡ªåŠ¨ç”Ÿæˆé…ç½®</h3><p>è‡ªåŠ¨ç”Ÿæˆé€šç”¨æ¥å£åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¼–å†™ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œæ³¨é‡Šå·²ç»æ·»åŠ äº†ï¼Œç›´æ¥çœ‹ä»£ç ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"MysqlContext"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javaFileEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ˜¯å¦ä½¿ç”¨é€šç”¨ Mapper æä¾›çš„æ³¨é‡Šå·¥å…·ï¼Œé»˜è®¤ true ä½¿ç”¨ï¼Œè¿™æ ·åœ¨ç”Ÿæˆä»£ç æ—¶ä¼šåŒ…å«å­—æ®µçš„æ³¨é‡Šï¼ˆç›®å‰åªæœ‰ mysql å’Œ oracle æ”¯æŒï¼‰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useMapperCommentGenerator"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">"tk.mybatis.mapper.generator.MapperPlugin"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®åç”Ÿæˆçš„ Mapper æ¥å£éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªæ¥å£--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappers"</span> <span class="attr">value</span>=<span class="string">"tk.mybatis.mapper.common.MySqlMapper"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">"tk.mybatis.mapper.generator.MapperPlugin"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®åç”Ÿæˆçš„ Mapper æ¥å£éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªæ¥å£ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappers"</span> <span class="attr">value</span>=<span class="string">"tk.mybatis.mapper.common.Mapper"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œé»˜è®¤ false --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"caseSensitive"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;amp;serverTimezone=GMT%2B8&amp;amp;nullCatalogMeansCurrent=true"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"123"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„pojoæ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„mapperæ‰€åœ¨ç›®å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®mapperå¯¹åº”çš„javaæ˜ å°„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- è¦ç”Ÿæˆé‚£äº›è¡¨(æ›´æ”¹tableNameå’ŒdomainObjectNameå°±å¯ä»¥) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"book"</span> <span class="attr">domainObjectName</span>=<span class="string">"Book"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä¸ä¸Šæ¬¡ä¸åŒçš„æ˜¯è¿™æ¬¡å¢åŠ äº†ä¸¤ä¸ª <code>plugin</code>ï¼Œåé¢ç”Ÿæˆçš„ Mapper æ¥å£éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™äº›ç±»ã€‚</p><h3 id="è‡ªåŠ¨ç”Ÿæˆä»£ç "><a href="#è‡ªåŠ¨ç”Ÿæˆä»£ç " class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆä»£ç "></a>è‡ªåŠ¨ç”Ÿæˆä»£ç </h3><p>å†™å¥½é…ç½®æ–‡ä»¶ä¹‹åï¼Œè¿˜éœ€è¦å†™ä¸€ä¸ªç”Ÿæˆç¨‹åºï¼Œç”¨äºåŠ è½½é…ç½®æ–‡ä»¶ï¼Œè¿è¡Œå°±å¯ä»¥ç”Ÿæˆç›¸å…³çš„å®ä½“ç±»ã€Mapper æ¥å£ã€Mapper xml .<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Mybatis generatorçš„é€†å‘ç”Ÿæˆå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">// æŒ‡å®šä½ æƒ³å·¥ç¨‹é…ç½®æ–‡ä»¶</span></span><br><span class="line">        File configFile = <span class="keyword">new</span> File(<span class="string">"generatorConfig.xml"</span>);</span><br><span class="line">        System.out.println(configFile.getAbsolutePath());</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (String warning : warnings) &#123;</span><br><span class="line">            System.out.println(warning);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        MybatisGenerator mybatisGenerator = <span class="keyword">new</span> MybatisGenerator();</span><br><span class="line">        mybatisGenerator.generator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="è‡ªåŠ¨ç”Ÿæˆç»“æœ"><a href="#è‡ªåŠ¨ç”Ÿæˆç»“æœ" class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆç»“æœ"></a>è‡ªåŠ¨ç”Ÿæˆç»“æœ</h3><p>è¿è¡Œå®Œæ¯•ä¸Šé¢ç¨‹åºä¹‹åï¼Œè‡ªåŠ¨ç”Ÿæˆäº† Book.java.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Table</span>(name = <span class="string">"book"</span>)</span><br><span class="line"><span class="meta">@ToString</span> <span class="comment">// æ‰‹åŠ¨æ·»åŠ çš„ tostring æ³¨è§£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹¦ç±ä½œè€…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹¦ç±åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹¦ç±ä»·æ ¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Float price;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥ä¸‹é¢çš„è‡ªåŠ¨ç”Ÿæˆä»£ç </span></span><br></pre></td></tr></table></figure></p><h3 id="é€šç”¨-Mapper-1"><a href="#é€šç”¨-Mapper-1" class="headerlink" title="é€šç”¨ Mapper"></a>é€šç”¨ Mapper</h3><p>ä¸Šé¢çš„ç¨‹åºä¹Ÿè‡ªåŠ¨ç”Ÿæˆäº† BookMapper æ¥å£ï¼Œä¸”ç»§æ‰¿äº†é…ç½®çš„ MySqlMapper å’Œ Mapper æ¥å£ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Book;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.Mapper;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.MySqlMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookMapper</span> <span class="keyword">extends</span> <span class="title">MySqlMapper</span>&lt;<span class="title">Book</span>&gt;, <span class="title">Mapper</span>&lt;<span class="title">Book</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸¤ä¸ªæ¥å£é‡Œå®ç°äº†å¾ˆå¤šå¸¸ç”¨æ“ä½œã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/51f20a7f33ad27d9495046c236dec145.png" alt="é€šç”¨ Mapper é‡Œçš„æ–¹æ³•"></p><p>ç”Ÿæˆå®Œæˆä¹‹åè¦åœ¨ Springboot å¯åŠ¨å™¨ä¸Šæ·»åŠ  MapperScan æ³¨è§£æŒ‡å®šè¦æ‰«æçš„ mapper ä½ç½®ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@tk</span>.mybatis.spring.annotation.MapperScan(basePackages = <span class="string">"net.codingme.boot.domain.mapper"</span>)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•"></a>å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•</h2><p>ç¼–å†™ BookMapperTest å•å…ƒæµ‹è¯•ç”¨äºæµ‹è¯• BookMapper çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.domain.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Book;</span><br><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookMapper bookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = <span class="keyword">new</span> Book();</span><br><span class="line">        book.setId(<span class="number">2</span>);</span><br><span class="line">        Book selectOne = bookMapper.selectOne(book);</span><br><span class="line">        Assert.assertNotNull(selectOne);</span><br><span class="line">        System.out.println(selectOne);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = bookMapper.selectByPrimaryKey(<span class="number">2</span>);</span><br><span class="line">        Assert.assertNotNull(book);</span><br><span class="line">        System.out.println(book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæµ‹è¯•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPageInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper.startPage(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥è¯¢å‡ºæ•°é‡ï¼š"</span> + bookList.size());</span><br><span class="line">        PageInfo&lt;Book&gt; pageInfo = PageInfo.of(bookList);</span><br><span class="line">        System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + pageInfo.getTotal());</span><br><span class="line">        System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + pageInfo.getPages());</span><br><span class="line">        System.out.println(<span class="string">"é¡µå¤§å°ï¼š"</span> + pageInfo.getPageSize());</span><br><span class="line">        System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + pageInfo.getPageNum());</span><br><span class="line">        System.out.println(<span class="string">"å½“å‰é‡ï¼š"</span> + pageInfo.getSize());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæµ‹è¯•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper.startPage(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥è¯¢å‡ºæ•°é‡ï¼š"</span> + bookList.size());</span><br><span class="line">        System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + ((Page)bookList).getTotal());</span><br><span class="line">        System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + ((Page)bookList).getPages());</span><br><span class="line">        System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + ((Page)bookList).getPageNum());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°åˆ†é¡µçš„å®ç°ä¸»è¦æ˜¯ PageHelper çš„è®¾ç½®ï¼Œåœ¨è®¾ç½® PageHelper ä¹‹åçš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¼šè¿›è¡Œåˆ†é¡µã€‚åƒä¸Šé¢çš„ä¾‹å­ä¼šæŸ¥è¯¢ç¬¬äºŒé¡µï¼Œæ¯é¡µä¸‰æ¡è¿™æ ·ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.startPage(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br></pre></td></tr></table></figure></p><p>å…¶å®ä½¿ç”¨äº†åˆ†é¡µæ’ä»¶ä¹‹åè¿”å›çš„æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ª Page ç±»ï¼Œæ€»æ•°ç­‰åˆ†é¡µä¿¡æ¯éƒ½å·²ç»è¿”å›ï¼Œå¦‚æœè¦å–å‡ºæ¥ä½¿ç”¨å°±éœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹ç„¶åå–å‡ºï¼Œä¸Šé¢ä¹Ÿæ˜¯æ¼”ç¤ºäº†ä¸¤ç§æ–¹å¼ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼ 1</span></span><br><span class="line">PageInfo&lt;Book&gt; pageInfo = PageInfo.of(bookList);</span><br><span class="line">System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + pageInfo.getTotal());</span><br><span class="line">System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + pageInfo.getPages());</span><br><span class="line">System.out.println(<span class="string">"é¡µå¤§å°ï¼š"</span> + pageInfo.getPageSize());</span><br><span class="line">System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + pageInfo.getPageNum());</span><br><span class="line">System.out.println(<span class="string">"å½“å‰é‡ï¼š"</span> + pageInfo.getSize());</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼ 2</span></span><br><span class="line">System.out.println(<span class="string">"æŸ¥è¯¢å‡ºæ•°é‡ï¼š"</span> + bookList.size());</span><br><span class="line">System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + ((Page)bookList).getTotal());</span><br><span class="line">System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + ((Page)bookList).getPages());</span><br><span class="line">System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + ((Page)bookList).getPageNum());</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œ BookMapperTest ç±»æµ‹è¯•æ‰€æœ‰çš„å•å…ƒæµ‹è¯•ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/0dd65eb033d1b3e872cd2ed41f201dca.png" alt="å•å…ƒæµ‹è¯•ç»“æœ"></p><p>å‘ç°å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ŒæŸ¥çœ‹ä¸€ä¸ªåˆ†é¡µæŸ¥è¯¢ï¼ˆtestSelectPageInfoï¼‰è¾“å‡ºæƒ…å†µã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2019-03-08 16:07:52.226 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectAll_COUNT     : ==&gt;  Preparing: SELECT count(0) FROM book </span><br><span class="line">2019-03-08 16:07:52.227 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectAll_COUNT     : ==&gt; Parameters: </span><br><span class="line">2019-03-08 16:07:52.229 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectAll_COUNT     : &lt;==      Total: 1</span><br><span class="line">2019-03-08 16:07:52.231 DEBUG 26764 --- [           main] n.c.b.d.mapper.BookMapper.selectAll      : ==&gt;  Preparing: SELECT id,author,name,price,create_time,description FROM book LIMIT ?, ? </span><br><span class="line">2019-03-08 16:07:52.233 DEBUG 26764 --- [           main] n.c.b.d.mapper.BookMapper.selectAll      : ==&gt; Parameters: 3(Integer), 3(Integer)</span><br><span class="line">2019-03-08 16:07:52.236 DEBUG 26764 --- [           main] n.c.b.d.mapper.BookMapper.selectAll      : &lt;==      Total: 3</span><br><span class="line">æŸ¥è¯¢å‡ºæ•°é‡ï¼š3</span><br><span class="line">æ€»æ•°é‡ï¼š12</span><br><span class="line">æ€»é¡µæ•°ï¼š4</span><br><span class="line">é¡µå¤§å°ï¼š3</span><br><span class="line">ç¬¬å‡ é¡µï¼š2</span><br><span class="line">å½“å‰é‡ï¼š3</span><br></pre></td></tr></table></figure></p><p>å†æŸ¥çœ‹ä¸€ä¸ªæ™®é€šæŸ¥è¯¢ï¼ˆtestSelectByPrimaryKeyï¼‰è¾“å‡ºæƒ…å†µã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2019-03-08 16:07:52.241 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectByPrimaryKey  : ==&gt;  Preparing: SELECT id,author,name,price,create_time,description FROM book WHERE id = ? </span><br><span class="line">2019-03-08 16:07:52.242 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectByPrimaryKey  : ==&gt; Parameters: 2(Integer)</span><br><span class="line">2019-03-08 16:07:52.244 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectByPrimaryKey  : &lt;==      Total: 1</span><br><span class="line">Book(id=2, author=é‡‘åº¸, name=ç¬‘å‚²æ±Ÿæ¹–, price=12.0, createTime=Sat Sep 01 10:10:12 GMT+08:00 2018, description=æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´)</span><br></pre></td></tr></table></figure></p><p>æ–‡ä¸­ä»£ç å·²ç»ä¸Šä¼ åˆ° Github <a href="https://github.com/niumoo/springboot" target="_blank" rel="noopener">Spring Boot è¿æ¥æ•°æ®åº“ - Mybatis æ’ä»¶</a></p><p>æƒ³è¦äº†è§£è¿™å‡ ä¸ªæ’ä»¶çš„å…¶ä»–ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><ol><li><a href="https://pagehelper.github.io/docs/howtouse/" target="_blank" rel="noopener">å¦‚ä½•ä½¿ç”¨åˆ†é¡µæ’ä»¶</a></li><li><a href="https://github.com/abel533/Mapper/wiki/1.3-spring-boot" target="_blank" rel="noopener">Mapperæ’ä»¶</a></li><li><a href="http://www.mybatis.org/generator/" target="_blank" rel="noopener"> MyBatis Generator</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/64cccddf32b7e3f4069ca2459057496e.png&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨ Springboot ç³»åˆ—æ–‡ç« ç¬¬åä¸€ç¯‡é‡Œï¼ˆ&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;amp;mid=2247483756&amp;amp;idx=1&amp;amp;sn=902dba8ed665131453bc26de246ccaa1&amp;amp;chksm=e984e808def3611edf0949a9db71ea6dc29432b25fb27015d78bc8117a50a3bedd79194de5ea&amp;amp;token=93558379&amp;amp;lang=zh_CN#rd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä½¿ç”¨ Mybatisï¼ˆè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼‰ è®¿é—®æ•°æ®åº“&lt;/a&gt;ï¼‰ï¼Œå®éªŒäº† Springboot ç»“åˆ Mybatis ä»¥åŠ Mybatis-generator ç”Ÿæˆæ’ä»¶çš„å¼€å‘è¿‡ç¨‹ï¼Œå…¶å®å¯¹äº Mybatis æ¥è®²è¿˜æœ‰å¾ˆå¤šä¼˜ç§€æ–¹ä¾¿å¥½ç”¨çš„æ’ä»¶ï¼Œæ¯”å¦‚è¿™æ¬¡è¦æ¼”ç¤ºçš„ é€šç”¨ Mapper ç”Ÿæˆæ’ä»¶å’Œåˆ†é¡µæ’ä»¶ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="æ’ä»¶" scheme="https://www.codingme.net/tags/%E6%8F%92%E4%BB%B6/"/>
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Mybatis" scheme="https://www.codingme.net/tags/Mybatis/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåä¸€ï¼‰ä½¿ç”¨ Mybatisï¼ˆè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼‰ è®¿é—®æ•°æ®åº“</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-11-data-mybatis/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-11-data-mybatis/</id>
    <published>2019-03-06T17:40:01.000Z</published>
    <updated>2019-05-20T16:26:48.640Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/60327e81c9b1f06ed84cb177feded21b.jpg" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰"></p><h2 id="1-Springboot-mybatis-ä»‹ç»"><a href="#1-Springboot-mybatis-ä»‹ç»" class="headerlink" title="1. Springboot mybatis ä»‹ç»"></a>1. Springboot mybatis ä»‹ç»</h2><p>MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°è·å–ç»“æœé›†çš„è¿‡ç¨‹ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ <code>XML</code> æˆ–<code>æ³¨è§£</code>æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚<br><a id="more"></a><br>å…³äº Mybatis çš„åŸºç¡€çŸ¥è¯†å¯ä»¥æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ï¼Œååˆ†çš„è¯¦ç»†ã€‚<a href="http://www.mybatis.org/mybatis-3/zh/getting-started.html" target="_blank" rel="noopener">mybatis å®˜æ–¹æ–‡æ¡£</a>.</p><h2 id="2-Springboot-mybatis-ä¾èµ–"><a href="#2-Springboot-mybatis-ä¾èµ–" class="headerlink" title="2. Springboot mybatis ä¾èµ–"></a>2. Springboot mybatis ä¾èµ–</h2><p>æœ¬ç³»åˆ— Springboot æ–‡ç« ä¸»è¦æ˜¯ Springboot çš„å­¦ä¹ ä¸åˆ†æï¼Œä¹Ÿå› æ­¤åªä¼šè¯•éªŒ Mybatis åœ¨ Springboot ä¸­çš„ä¸€äº›ç”¨æ³•ï¼Œå…³äº Mybatis çš„åŸºç¡€çŸ¥è¯†ï¼Œè¿˜æ˜¯éœ€è¦è‡ªè¡Œå­¦ä¹ çš„ã€‚<br>åˆ›å»º Springboot é¡¹ç›®ä¸æï¼Œå¼•å…¥ maven ä¾èµ–ï¼Œä¸»è¦æ˜¯ mybastis æ ¸å¿ƒä¾èµ–ä»¥åŠä¸€ä¸ª mybatis mapper è‡ªåŠ¨ç”Ÿæˆæ’ä»¶ã€‚ä¾èµ–ä¸­çš„ druid æ•°æ®æºéƒ¨åˆ†ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Druid æ•°æ®æº --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- mybatis mapperè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!--æ·»åŠ æ•°æ®åº“é“¾æ¥ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="3-Springboot-mybatis-é…ç½®"><a href="#3-Springboot-mybatis-é…ç½®" class="headerlink" title="3. Springboot mybatis é…ç½®"></a>3. Springboot mybatis é…ç½®</h2><p>å…³äº Druid æ•°æ®æºçš„é…ç½®ä¸å†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚é…ç½®ä¸­ä¸»è¦é…ç½®äº†é¡¹ç›®ç¼–ç ã€æ•°æ®æºä¿¡æ¯ã€durid æ•°æ®æºå’Œ mybatis çš„ mapper ä½ç½®ä»¥åŠ mybatis æ˜ å°„åˆ«åçš„åŒ…è·¯å¾„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">############################################################</span><br><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line"></span><br><span class="line"># ç¼–ç </span><br><span class="line">server.tomcat.uri-encoding=utf-8</span><br><span class="line">spring.http.encoding.force=true</span><br><span class="line">spring.http.encoding.charset=UTF-8</span><br><span class="line">spring.http.encoding.enabled=true</span><br><span class="line">############################################################</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span><br><span class="line">spring.datasource.driver-class-name= com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ druid æ•°æ®æº</span><br><span class="line">spring.datasource.type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.initialSize: 5</span><br><span class="line">spring.datasource.minIdle: 5</span><br><span class="line">spring.datasource.maxActive: 20</span><br><span class="line">spring.datasource.maxWait: 60000</span><br><span class="line">spring.datasource.timeBetweenEvictionRunsMillis: 60000</span><br><span class="line">spring.datasource.minEvictableIdleTimeMillis: 300000</span><br><span class="line">spring.datasource.validationQuery: SELECT 1 FROM DUAL</span><br><span class="line">spring.datasource.testWhileIdle: true</span><br><span class="line">spring.datasource.testOnBorrow: false</span><br><span class="line">spring.datasource.testOnReturn: false</span><br><span class="line">spring.datasource.poolPreparedStatements: true</span><br><span class="line">spring.datasource.filters: stat</span><br><span class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize: 20</span><br><span class="line">spring.datasource.useGlobalDataSourceStat: true</span><br><span class="line">spring.datasource.connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br><span class="line"></span><br><span class="line"># mybatis</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*.xml</span><br><span class="line">mybatis.type-aliases-package=net.codingme.boot.domain</span><br></pre></td></tr></table></figure></p><h2 id="4-Springboot-mybatis-ç¼–ç "><a href="#4-Springboot-mybatis-ç¼–ç " class="headerlink" title="4. Springboot mybatis ç¼–ç "></a>4. Springboot mybatis ç¼–ç </h2><p>mybatis æ˜¯åŠ ORM æ¡†æ¶ï¼Œå®ƒé€šè¿‡ XML æè¿°ç¬¦æˆ–è€…æ³¨è§£æŠŠ POJO å¯¹è±¡ä¸ SQL ä¿¡æ¯å…³è”èµ·æ¥ï¼Œä¹Ÿå› ä¸ºæ˜¯å’Œ SQL å…³è”èµ·æ¥ï¼Œä½¿ç”¨ mybatis å¯ä»¥å……åˆ†çš„åˆ©ç”¨æ•°æ®çš„å„ç§åŠŸèƒ½ä»¥åŠå¼ºå¤§çš„ SQL è¯­å¥ã€‚ä¹Ÿå¯ä»¥å‘å‘ç°ä½¿ç”¨ mybatis è‡³å°‘åº”è¯¥å»ºç«‹ POJO å¯¹è±¡å’Œ SQL å…³è”ä¿¡æ¯ä»¥åŠç¼–å†™ç›¸å…³æ“ä½œä»£ç ã€‚</p><h3 id="4-1-æ•°æ®åº“å‡†å¤‡"><a href="#4-1-æ•°æ®åº“å‡†å¤‡" class="headerlink" title="4.1. æ•°æ®åº“å‡†å¤‡"></a>4.1. æ•°æ®åº“å‡†å¤‡</h3><p>æ—¢ç„¶æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œå…ˆå‡†å¤‡ä¸€ä¸ªç”¨äºå®éªŒæ“ä½œçš„æ•°æ®è¡¨ã€‚ä¸Šä¸€ä¸ªæ­¥éª¤ä¸­æœ‰é…ç½®æ•°æ®åº“ä¿¡æ¯ä¸º springbootã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot</span><br></pre></td></tr></table></figure></p><p>å› æ­¤åœ¨ mysql æ•°æ®åº“çš„ springboot åº“ä¸­åˆ›å»ºè¡¨ book ç”¨äºæ¼”ç¤ºã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`author`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä½œè€…'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±åç§°'</span>,</span><br><span class="line">  <span class="string">`price`</span> <span class="built_in">float</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä»·æ ¼'</span>,</span><br><span class="line">  <span class="string">`create_time`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">  <span class="string">`description`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±æè¿°'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">15</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></p><p>å¢åŠ æµ‹è¯•æ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (2, &apos;é‡‘åº¸&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–&apos;, 12, &apos;2018-09-01 10:10:12&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (3, &apos;ç½—è´¯ä¸­&apos;, &apos;ä¸‰å›½æ¼”ä¹‰&apos;, 22, &apos;2018-09-01 10:10:16&apos;, &apos;æ˜¯ä½œå®¶ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å†å²å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (4, &apos;å´æ‰¿æ©&apos;, &apos;è¥¿æ¸¸è®°&apos;, 17, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶å´æ‰¿æ©åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (5, &apos;é‡‘åº¸1535767819284&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819284&apos;, 43, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819284&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (6, &apos;é‡‘åº¸1535767819679&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819679&apos;, 24, &apos;2018-09-01 10:10:20&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819679&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (7, &apos;ç½—è´¯ä¸­1535769035138&apos;, &apos;ä¸‰å›½æ¼”ä¹‰1535769035138&apos;, 20, &apos;2018-09-01 10:30:35&apos;, &apos;æ˜¯ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨å°è¯´1535769035138&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (8, &apos;é‡‘åº¸1535783611785&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783611785&apos;, 30, &apos;2018-09-01 14:33:32&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783611785&apos;);</span><br></pre></td></tr></table></figure></p><h3 id="4-2-è‡ªåŠ¨ç”Ÿæˆæ’ä»¶"><a href="#4-2-è‡ªåŠ¨ç”Ÿæˆæ’ä»¶" class="headerlink" title="4.2. è‡ªåŠ¨ç”Ÿæˆæ’ä»¶"></a>4.2. è‡ªåŠ¨ç”Ÿæˆæ’ä»¶</h3><p>ä¼ ç»Ÿçš„ mybatisã€€å¼€å‘è¿‡ç¨‹éœ€è¦ä¾ç…§æ•°æ®è¡¨æ–°å»ºå¤§é‡çš„ã€€POJO ç±»ï¼Œç„¶ååœ¨ç¼–å†™å“åº”çš„å¢åˆ æ”¹æŸ¥æ¥å£ï¼Œç»§è€Œç¼–å†™å¢åˆ æ”¹æŸ¥å¯¹åº”çš„ XML æ–‡ä»¶ã€‚è¿‡ç¨‹æ— è¶£ä¸”æœ‰é‡å¤åŠ³åŠ¨ï¼Œå› æ­¤äº§ç”Ÿäº†ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆå·¥å…·ï¼Œå¯ä»¥é€šè¿‡ JDBC è¿æ¥åˆ°æ•°æ®åº“ï¼Œè‡ªåŠ¨çš„åˆ›å»º POJOã€æ“ä½œæ¥å£ã€XML æ–‡ä»¶ã€‚</p><p>åœ¨å¼•å…¥ä¾èµ–çš„æ—¶å€™å·²ç»å¼•å…¥äº†è‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼Œä¹Ÿå°±æ˜¯ <code>mybatis-generator-core</code>ã€‚</p><p>æ¥ç€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºè‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œä¸»è¦é…ç½®æ•°æ®åº“ä¿¡æ¯å’Œè¦ç”Ÿæˆçš„è¡¨å·²ç»ç”Ÿæˆçš„ä»£ç å­˜æ”¾ä½ç½®ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/9de1c6553d3afc7f006f791fdf088b04.png" alt="é¡¹ç›®ç»“æ„"></p><p>åœ¨ä¹‹å‰ä½œè€…ä¹Ÿä»‹ç»è¿‡ï¼Œå¯ä»¥å‚è€ƒåšå®¢æ–‡ç« <a href="https://www.codingme.net/2017/11/develop/tool-mybatis-generator/">ä½¿ç”¨MyBatis Generatorè‡ªåŠ¨ç”ŸæˆModelã€Daoã€Mapperç›¸å…³ä»£ç </a>ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"MysqlContext"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;amp;serverTimezone=GMT%2B8&amp;amp;nullCatalogMeansCurrent=true"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"123"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„pojoæ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„mapperæ‰€åœ¨ç›®å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®mapperå¯¹åº”çš„javaæ˜ å°„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- è¦ç”Ÿæˆé‚£äº›è¡¨(æ›´æ”¹tableNameå’ŒdomainObjectNameå°±å¯ä»¥) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"book"</span> <span class="attr">domainObjectName</span>=<span class="string">"Book"</span> <span class="attr">enableCountByExample</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">enableUpdateByExample</span>=<span class="string">"true"</span> <span class="attr">enableUpdateByPrimaryKey</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">selectByExampleQueryId</span>=<span class="string">"true"</span> <span class="attr">enableDeleteByPrimaryKey</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">enableSelectByPrimaryKey</span>=<span class="string">"true"</span> <span class="attr">enableSelectByExample</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        &gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å†™å¥½é…ç½®æ–‡ä»¶ä¹‹åï¼Œè¿˜éœ€è¦å†™ä¸€ä¸ªå¯åŠ¨ç¨‹åºï¼Œç”¨äºåŠ è½½é…ç½®æ–‡ä»¶ï¼Œè¿è¡Œå°±å¯ä»¥ç”Ÿæˆç›¸å…³é…ç½®ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Mybatis generatorçš„é€†å‘ç”Ÿæˆå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">// æŒ‡å®šä½ æƒ³å·¥ç¨‹é…ç½®æ–‡ä»¶</span></span><br><span class="line">        File configFile = <span class="keyword">new</span> File(<span class="string">"generatorConfig.xml"</span>);</span><br><span class="line">        System.out.println(configFile.getAbsolutePath());</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        MybatisGenerator mybatisGenerator = <span class="keyword">new</span> MybatisGenerator();</span><br><span class="line">        mybatisGenerator.generator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç”Ÿæˆçš„æ–‡ä»¶å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/de3a01eaf435ed5ab223603a04c9eb71.png" alt="é¡¹ç›®ç»“æ„"></p><p>æŸ¥çœ‹ç”Ÿæˆçš„æ¥å£ä»¥åŠ XML æ˜ å°„æ–‡ä»¶å¯ä»¥å‘ç°å·²ç»è‡ªåŠ¨ç”Ÿæˆäº†å¸¸ç”¨çš„å‡ ä¸ªæ–¹æ³•ã€‚</p><ol><li>deleteByPrimaryKey</li><li>insert</li><li>updateByPrimaryKey</li><li>selectByPrimaryKey</li><li>selectAll</li></ol><p>ç”Ÿæˆå®Œæˆä¹‹åè¦åœ¨ Springboot å¯åŠ¨å™¨ä¸Šæ·»åŠ  MapperScan æ³¨è§£æŒ‡å®šè¦æ‰«æçš„ mapper ä½ç½®ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"net.codingme.boot.domain.mapper"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="4-3-æ³¨è§£é…ç½®æ–¹å¼"><a href="#4-3-æ³¨è§£é…ç½®æ–¹å¼" class="headerlink" title="4.3. æ³¨è§£é…ç½®æ–¹å¼"></a>4.3. æ³¨è§£é…ç½®æ–¹å¼</h3><p>Mybatis åŒæ ·æ”¯æŒæ³¨è§£çš„æ–¹å¼é…ç½®æ˜ å°„å…³ç³»ï¼Œä½¿ç”¨æ³¨è§£å¯ä»¥æ›¿ä»£ XML çš„é…ç½®ï¼Œå†™ä¸€ä¸ªç®€å•çš„æ³¨è§£ä¾‹å­ã€‚åœ¨åˆšæ‰ç”Ÿæˆçš„ BookMapper.java ä¸­å¢åŠ ä¸€ä¸ªæ ¹æ®ä½œè€…åç§°æŸ¥è¯¢çš„æ–¹æ³•ï¼Œå¹¶æ˜ å°„å­—æ®µå¯¹åº”çš„å±æ€§ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ  @Repository æ³¨è§£ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ @Autowired å¼•å…¥çš„æ—¶å€™ä¸ä¼šæŠ¥æ¨ªçº¿</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookMapper</span> </span>&#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨è§£æ–¹å¼é…ç½®æ˜ å°„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> author</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Results</span> å­—æ®µå’Œå±æ€§æ˜ å°„å…³ç³»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Select</span> æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Results</span>(&#123;</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"id"</span>, column = <span class="string">"ids"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"name"</span>, column = <span class="string">"name"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"author"</span>, column = <span class="string">"authors"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"createTime"</span>, column = <span class="string">"create_time"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select id as ids, author as authors, name, price, create_time, description from book where author = #&#123;author&#125;"</span>)</span><br><span class="line">    <span class="function">List&lt;Book&gt; <span class="title">selectByAuthor</span><span class="params">(@Param(<span class="string">"author"</span>)</span> String author)</span>;</span><br><span class="line">    <span class="comment">// çœç•¥ä¸‹é¢è‡ªåŠ¨ç”Ÿæˆä»£ç </span></span><br></pre></td></tr></table></figure></p><h2 id="5-Springboot-mybatis-æµ‹è¯•"><a href="#5-Springboot-mybatis-æµ‹è¯•" class="headerlink" title="5. Springboot mybatis æµ‹è¯•"></a>5. Springboot mybatis æµ‹è¯•</h2><p>æ­£å¸¸æƒ…å†µä¸‹ä¼šåœ¨é¡¹ç›®ä¸­çš„ä¸šåŠ¡å±‚ service åŒ…ä¸‹åˆ›å»ºæ¥å£å’Œç±»ç„¶åé€šè¿‡æ³¨è§£å¼•å…¥ä½¿ç”¨ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> BookMapper bookMapper;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬åªæ˜¯å®éªŒï¼Œæ²¡æœ‰è¿™æ ·å†™ä¸€å¥—çš„å¿…è¦ï¼Œåªè¦èƒ½ç¡®ä¿ BookMapper å¯ä»¥æ­£å¸¸æ³¨å…¥ä½¿ç”¨å°±å¥½äº†ã€‚å› æ­¤åˆ›å»ºæµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/730d20139c46c077d4064261ec9290a5.png" alt="åˆ›å»ºæµ‹è¯•ç±»"></p><p>åœ¨ç”Ÿæˆçš„ï¼ˆä¹Ÿå¯ä»¥å®Œå…¨æ‰‹å†™æµ‹è¯•æ–¹æ³•ï¼‰æµ‹è¯•ç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•è¿›è¡Œæµ‹è¯•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookMapper bookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        bookList.forEach((book) -&gt; System.out.println(book));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByAuthro</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectByAuthor(<span class="string">"é‡‘åº¸"</span>);</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        bookList.forEach((book) -&gt; System.out.println(book));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = bookMapper.selectByPrimaryKey(<span class="number">2</span>);</span><br><span class="line">        Assert.assertNotNull(book);</span><br><span class="line">        System.out.println(book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> primaryKey = bookMapper.deleteByPrimaryKey(<span class="number">8</span>);</span><br><span class="line">        Assert.assertNotEquals(<span class="number">0</span>, primaryKey);</span><br><span class="line">        System.out.println(primaryKey);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸ºäº†è§‚å¯ŸæŸ¥è¯¢æ¥å£ book çš„ä¿¡æ¯è¾“å‡ºï¼Œé‡å†™ Book ç±»çš„ toString æ–¹æ³•ï¼Œç„¶åè¿è¡Œå•å…ƒæµ‹è¯•ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/0a059a1c7f49265a61cda7bbd07f1d2d.png" alt="å•å…ƒæµ‹è¯•ç»“æœ"></p><p>å¯ä»¥å‘ç°æµ‹è¯•å…¨éƒ¨é€šè¿‡ã€‚ç»“æœæ­£å¸¸ã€‚<br>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° Github <a href="https://github.com/niumoo/springboot/tree/master/springboot-data-mybatis" target="_blank" rel="noopener">Spring Boot è¿æ¥æ•°æ®åº“ - Mybatis</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/60327e81c9b1f06ed84cb177feded21b.jpg&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-Springboot-mybatis-ä»‹ç»&quot;&gt;&lt;a href=&quot;#1-Springboot-mybatis-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1. Springboot mybatis ä»‹ç»&quot;&gt;&lt;/a&gt;1. Springboot mybatis ä»‹ç»&lt;/h2&gt;&lt;p&gt;MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°è·å–ç»“æœé›†çš„è¿‡ç¨‹ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ &lt;code&gt;XML&lt;/code&gt; æˆ–&lt;code&gt;æ³¨è§£&lt;/code&gt;æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="æ’ä»¶" scheme="https://www.codingme.net/tags/%E6%8F%92%E4%BB%B6/"/>
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Mybatis" scheme="https://www.codingme.net/tags/Mybatis/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåï¼‰ä½¿ç”¨ Spring data jpa è®¿é—®æ•°æ®åº“</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-10-data-jpa/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-10-data-jpa/</id>
    <published>2019-02-28T17:40:01.000Z</published>
    <updated>2019-05-20T16:26:48.636Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/7bea43f15edb0db3ac708c346acd35c4.jpg" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Springboot data jpa å’Œ Spring jdbc åŒå±äº Springå¼€æºç»„ç»‡ï¼Œåœ¨ Spring jdbc ä¹‹ååˆå¼€å‘äº†æŒä¹…å±‚æ¡†æ¶ï¼Œå¾ˆæ˜æ˜¾ Spring data jpa ç›¸å¯¹äº Spring jdbc æ›´åŠ çš„ä¾¿æ·å¼ºå¤§ï¼Œä¸ç„¶ä¹Ÿå°±æ²¡æœ‰å¼€å‘çš„å¿…è¦äº†ã€‚æ ¹æ®ä¸‹é¢çš„æ–‡ç« å¼€å§‹ä½“éªŒä¸‹ Spring data jpa é­…åŠ›ã€‚<br><a id="more"></a></p><h2 id="1-Spring-data-jpa-ä»‹ç»"><a href="#1-Spring-data-jpa-ä»‹ç»" class="headerlink" title="1. Spring data jpa ä»‹ç»"></a>1. Spring data jpa ä»‹ç»</h2><p>Spring data jpa æ˜¯ Spring data ç³»åˆ—çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨å®ƒå¯ä»¥è½»æ¾çš„å®ç°å¯¹æ•°æ®è®¿é—®å±‚çš„å¢å¼ºæ”¯æŒï¼Œåœ¨ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼Œå®ç°åº”ç”¨ç¨‹åºçš„æ•°æ®è®¿é—®å±‚ä¸€ç›´å¾ˆéº»çƒ¦ï¼Œéœ€è¦ç¼–å†™å¤§é‡çš„æ ·æ¿å¼çš„ä»£ç æ¥æ‰§è¡Œç®€å•æŸ¥è¯¢æˆ–è€…åˆ†é¡µæ“ä½œã€‚Spring data jpa çš„ç›®æ ‡æ˜¯å°½é‡çš„å‡å°‘å®é™…ç¼–ç æ¥æ”¹å–„æ•°æ®è®¿é—®å±‚çš„æ“ä½œã€‚</p><h2 id="2-Spring-data-jpa-ä¾èµ–"><a href="#2-Spring-data-jpa-ä¾èµ–" class="headerlink" title="2. Spring data jpa ä¾èµ–"></a>2. Spring data jpa ä¾èµ–</h2><p>è¿™æ¬¡çš„å®éªŒåŸºäºç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡å®éªŒä»£ç ï¼Œä»£ç ä¸­çš„æ•°æ®æºç›¸å…³çš„é…ç½®ä¹Ÿå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ï¼Œè¿™é‡Œåªæ¼”ç¤º Spring data jpa éƒ¨åˆ†ã€‚</p><p>åˆ›å»ºSpring boot é¡¹ç›®ï¼Œå¼•å…¥éœ€è¦çš„ä¾èµ–ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ•°æ®åº“è®¿é—® JPA--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ·»åŠ æ•°æ®åº“é“¾æ¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é˜¿é‡Œ druid æ•°æ®æºï¼ŒSpring boot ä¸­ä½¿ç”¨Druidè¦ç”¨è¿™ä¸ª  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="3-Spring-data-jpa-é…ç½®"><a href="#3-Spring-data-jpa-é…ç½®" class="headerlink" title="3. Spring data jpa é…ç½®"></a>3. Spring data jpa é…ç½®</h2><p>å…³äº Druid æ•°æ®æºçš„é…ç½®ä¸å†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">############################################################</span><br><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line">############################################################</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span><br><span class="line">spring.datasource.driver-class-name= com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line"># ä½¿ç”¨ druid æ•°æ®æº</span><br><span class="line">spring.datasource.type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.initialSize: 5</span><br><span class="line">spring.datasource.minIdle: 5</span><br><span class="line">spring.datasource.maxActive: 20</span><br><span class="line">spring.datasource.maxWait: 60000</span><br><span class="line">spring.datasource.timeBetweenEvictionRunsMillis: 60000</span><br><span class="line">spring.datasource.minEvictableIdleTimeMillis: 300000</span><br><span class="line">spring.datasource.validationQuery: SELECT 1 FROM DUAL</span><br><span class="line">spring.datasource.testWhileIdle: true</span><br><span class="line">spring.datasource.testOnBorrow: false</span><br><span class="line">spring.datasource.testOnReturn: false</span><br><span class="line">spring.datasource.poolPreparedStatements: true</span><br><span class="line">spring.datasource.filters: stat</span><br><span class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize: 20</span><br><span class="line">spring.datasource.useGlobalDataSourceStat: true</span><br><span class="line">spring.datasource.connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br><span class="line"># SpringBoot JPA</span><br><span class="line">spring.jpa.show-sql=true</span><br><span class="line"># create æ¯æ¬¡éƒ½é‡æ–°åˆ›å»ºè¡¨ï¼Œupdateï¼Œè¡¨è‹¥å­˜åœ¨åˆ™ä¸é‡å»º</span><br><span class="line">spring.jpa.hibernate.ddl-auto=update</span><br><span class="line">spring.jpa.database-platform=org.hibernate.dialect.MySQL55Dialect</span><br></pre></td></tr></table></figure></p><p><code>spring.jpa.show-sql=true</code> æ‰“å° SQL è¯­å¥ã€‚<br><code>spring.jpa.hibernate.ddl-auto=update</code> æ ¹æ® Enity è‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨ï¼ŒUpdate è¡¨ç¤ºå¦‚æœè¡¨å­˜åœ¨åˆ™ä¸é‡æ–°åˆ›å»ºã€‚</p><h2 id="4-Spring-data-jpa-ç¼–ç "><a href="#4-Spring-data-jpa-ç¼–ç " class="headerlink" title="4. Spring data jpa ç¼–ç "></a>4. Spring data jpa ç¼–ç </h2><p>Springboot Data JPA æ˜¯ ORM çš„å®Œæ•´å®ç°ï¼Œå®ä½“ç±»å’Œæ•°æ®è¡¨å…³ç³»ä¸€ä¸€å¯¹åº”ï¼Œå› æ­¤å®ä½“ç±»ä¹Ÿå°±æ˜¯æ•°æ®è¡¨ç»“æ„ã€‚<code>spring.jpa.hibernate.ddl-auto=update</code> ä¼šåœ¨ JPA è¿è¡Œæ—¶è‡ªåŠ¨åœ¨æ•°æ®è¡¨ä¸­åˆ›å»ºè¢« <code>@Entity</code> æ³¨è§£çš„å®ä½“æ•°æ®è¡¨ã€‚å¦‚æœè¡¨å·²ç»å­˜åœ¨ï¼Œåˆ™ä¸ä¼šåˆ›å»ºã€‚</p><h3 id="4-1-æ•°æ®å®ä½“ç±»"><a href="#4-1-æ•°æ®å®ä½“ç±»" class="headerlink" title="4.1. æ•°æ®å®ä½“ç±»"></a>4.1. æ•°æ®å®ä½“ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Entity</span> JPAå®ä½“</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Data</span> GET SET TOSTRING</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@NoArgsConstructor</span> æ— å‚æ„é€ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@AllArgsConstructor</span> å…¨å‚æ„é€ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/19 17:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ID</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Id</span> ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@GeneratedValue</span> è‡ªå¢ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"username"</span>, length = <span class="number">32</span>, nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"password"</span>, length = <span class="number">32</span>, nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"å¯†ç ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"age"</span>, length = <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæ—¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(pattern = <span class="string">"yyyy-MM-dd hh:mm:ss"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠ€èƒ½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String skills;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-JPA-æ“ä½œæ¥å£"><a href="#4-2-JPA-æ“ä½œæ¥å£" class="headerlink" title="4.2. JPA æ“ä½œæ¥å£"></a>4.2. JPA æ“ä½œæ¥å£</h3><p>JPA æ“ä½œæ¥å£åªéœ€è¦ç»§æ‰¿ JpaRepository å°±å¯ä»¥äº†ï¼ŒJpaRepository é‡Œå°è£…äº†å¸¸ç”¨çš„å¢åˆ æ”¹æŸ¥åˆ†é¡µç­‰æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰æŸ¥è¯¢æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•åçš„æ–¹å¼å¢åŠ ã€‚ä¸‹é¢å¢åŠ äº†ä¸€ä¸ªæ ¹æ® username å’Œ password æŸ¥è¯¢ User ä¿¡æ¯çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.domain.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/1114:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸€ä¸ªè‡ªå®šä¹‰æ–¹æ³•ï¼Œæ ¹æ® username å’Œ password æŸ¥è¯¢ User ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">findByUsernameAndPassword</span><span class="params">(String username, String password)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼ŒJpa çš„åŠŸèƒ½å·²ç»å¯ä»¥æµ‹è¯•ä½¿ç”¨äº†ï¼Œå…³äº Service å±‚å’Œ Controller å°±ä¸åœ¨è¿™é‡Œè´´äº†ï¼Œç›´æ¥ç¼–å†™ Springboot å•å…ƒæµ‹è¯•è¿›è¡Œ Jpa æµ‹è¯•ã€‚</p><h2 id="5-Spring-data-jpa-æµ‹è¯•"><a href="#5-Spring-data-jpa-æµ‹è¯•" class="headerlink" title="5. Spring data jpa æµ‹è¯•"></a>5. Spring data jpa æµ‹è¯•</h2><p>ä½¿ç”¨ Springboot çš„å•å…ƒæµ‹è¯•æ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„æµ‹è¯• Springboot é¡¹ç›®ï¼Œå¯¹ Springboot å•å…ƒæµ‹è¯•ä¸äº†è§£çš„å¯ä»¥ç›´æ¥å‚ç…§<a href="https://docs.spring.io/spring-boot/docs/2.1.x/reference/htmlsingle/#boot-features-testing-spring-applications" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>çš„è¯´æ˜ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ã€‚<br>ä¸‹é¢ç¼–å†™å››ä¸ªæµ‹è¯•æ–¹æ³•åˆ†åˆ«æµ‹è¯•æ ¹æ® Id æŸ¥è¯¢ã€åˆ†é¡µæŸ¥è¯¢ã€æ›´æ–°æ•°æ®ã€æ ¹æ® username å’Œ password æŸ¥è¯¢å››ä¸ªåŠŸèƒ½ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.domain.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•å…ƒæµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRepositoryTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * idæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByIdUserTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Optional&lt;User&gt; userOptional = userRepository.findById(<span class="number">1</span>);</span><br><span class="line">        User user = userOptional.orElseGet(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        Assert.assertNotNull(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByPageTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageRequest pageRequest = PageRequest.of(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">        Page&lt;User&gt; userPage = userRepository.findAll(pageRequest);</span><br><span class="line">        List&lt;User&gt; userList = userPage.getContent();</span><br><span class="line">        userList.forEach((user) -&gt; System.out.println(user));</span><br><span class="line">        Assert.assertNotNull(userList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUserTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Optional&lt;User&gt; userOptional = userRepository.findById(<span class="number">1</span>);</span><br><span class="line">        User user = userOptional.orElseThrow(() -&gt; <span class="keyword">new</span> RuntimeException(<span class="string">"ç”¨æˆ·ä¿¡æ¯æ²¡æœ‰å–åˆ°"</span>));</span><br><span class="line">        System.out.println(user.getAge());</span><br><span class="line">        ;</span><br><span class="line">        user.setAge(user.getAge() + <span class="number">1</span>);</span><br><span class="line">        User updateResult = userRepository.save(user);</span><br><span class="line">        Assert.assertNotNull(updateResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® Username å’Œ Password æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByUsernameAndPasswordTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = userRepository.findByUsernameAndPassword(<span class="string">"Darcy"</span>, <span class="string">"123"</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        Assert.assertNotNull(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é¦–å…ˆçœ‹åˆ°å››ä¸ªæ–¹æ³•å…¨éƒ¨è¿è¡Œé€šè¿‡ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/77d538a467dd500356c519b67f41b7a6.png" alt="å•å…ƒæµ‹è¯•ç»“æœ"><br>åˆ†é¡µæŸ¥è¯¢æŸ¥å‡ºæ•°æ®åº“ä¸­çš„ä¸¤æ¡æ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_, user0_.age as age2_0_, user0_.birthday as birthday3_0_, user0_.password as password4_0_, user0_.skills as skills5_0_, user0_.username as username6_0_ from user user0_ limit ?</span><br><span class="line">Hibernate: select count(user0_.id) as col_0_0_ from user user0_</span><br><span class="line">User(id=1, username=Darcy, password=123, age=18, birthday=2019-01-12 21:02:30.0, skills=Go)</span><br><span class="line">User(id=3, username=Chris, password=456, age=23, birthday=2019-01-01 00:11:22.0, skills=Java)</span><br></pre></td></tr></table></figure></p><p>æ ¹æ® Id æŸ¥è¯¢ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_0_, user0_.age as age2_0_0_, user0_.birthday as birthday3_0_0_, user0_.password as password4_0_0_, user0_.skills as skills5_0_0_, user0_.username as username6_0_0_ from user user0_ where user0_.id=?</span><br><span class="line">User(id=1, username=Darcy, password=123, age=18, birthday=2019-01-12 21:02:30.0, skills=Go)</span><br></pre></td></tr></table></figure></p><p>æ›´æ–°æ“ä½œä¹Ÿæ˜¯æ­£å¸¸è¾“å‡º SQL ï¼Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_0_, user0_.age as age2_0_0_, user0_.birthday as birthday3_0_0_, user0_.password as password4_0_0_, user0_.skills as skills5_0_0_, user0_.username as username6_0_0_ from user user0_ where user0_.id=?</span><br><span class="line">18</span><br><span class="line">Hibernate: select user0_.id as id1_0_0_, user0_.age as age2_0_0_, user0_.birthday as birthday3_0_0_, user0_.password as password4_0_0_, user0_.skills as skills5_0_0_, user0_.username as username6_0_0_ from user user0_ where user0_.id=?</span><br><span class="line">Hibernate: update user set age=?, birthday=?, password=?, skills=?, username=? where id=?</span><br></pre></td></tr></table></figure></p><p>æœ€åä¸€ä¸ªæ˜¯è‡ªå®šä¹‰æŸ¥è¯¢æ“ä½œï¼Œä¸Šé¢ä¸‰ä¸ªæ–¹æ³•çš„è¾“å‡ºä¸­ï¼ŒDarcy ç”¨æˆ·å¯¹åº”çš„å¹´é¾„æ˜¯ 18ï¼Œåœ¨ç»è¿‡æ›´æ–°åŠ 1 ä¹‹ååº”è¯¥å˜ä¸º19ï¼Œä¸‹é¢æ˜¯è‡ªå®šä¹‰æŸ¥è¯¢çš„ç»“æœã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_, user0_.age as age2_0_, user0_.birthday as birthday3_0_, user0_.password as password4_0_, user0_.skills as skills5_0_, user0_.username as username6_0_ from user user0_ where user0_.username=? and user0_.password=?</span><br><span class="line">User(id=1, username=Darcy, password=123, age=19, birthday=2019-01-12 21:02:30.0, skills=Go)</span><br></pre></td></tr></table></figure></p><p>å¯è§æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚<br>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/niumoo/springboot/tree/master/springboot-data-jpa" target="_blank" rel="noopener">GitHub</a>ã€‚<br>æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨äº†ä¸€äº› JDK8 çš„ç‰¹æ€§ï¼Œå¦‚ <code>Optional</code> ç±»çš„ä½¿ç”¨ï¼Œä»¥åä¼šå•ç‹¬å†™ä¸€éƒ¨åˆ†å…³äº JDK æ–°ç‰¹æ€§çš„æ–‡ç« ï¼Œæ¬¢è¿æ‰«ç å…³æ³¨å…¬ä¼—å·ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/7bea43f15edb0db3ac708c346acd35c4.jpg&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;Springboot data jpa å’Œ Spring jdbc åŒå±äº Springå¼€æºç»„ç»‡ï¼Œåœ¨ Spring jdbc ä¹‹ååˆå¼€å‘äº†æŒä¹…å±‚æ¡†æ¶ï¼Œå¾ˆæ˜æ˜¾ Spring data jpa ç›¸å¯¹äº Spring jdbc æ›´åŠ çš„ä¾¿æ·å¼ºå¤§ï¼Œä¸ç„¶ä¹Ÿå°±æ²¡æœ‰å¼€å‘çš„å¿…è¦äº†ã€‚æ ¹æ®ä¸‹é¢çš„æ–‡ç« å¼€å§‹ä½“éªŒä¸‹ Spring data jpa é­…åŠ›ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Jpa" scheme="https://www.codingme.net/tags/Jpa/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆä¹ï¼‰ä½¿ç”¨ Spring JDBC å’Œ Druid æ•°æ®æºç›‘æ§</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-09-data-jdbc/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-09-data-jdbc/</id>
    <published>2019-02-27T15:40:01.000Z</published>
    <updated>2019-05-20T16:26:48.632Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/129bdbc0a9f53e0fd3b748978ccd5fe6.png" alt="ç›‘æ§"></p><p>ä½œä¸ºä¸€å Java å¼€å‘è€…ï¼Œç›¸ä¿¡å¯¹ JDBCï¼ˆJava Data Base Connectivityï¼‰æ˜¯ä¸ä¼šé™Œç”Ÿçš„ï¼ŒJDBCä½œä¸º Java åŸºç¡€å†…å®¹ï¼Œå®ƒæä¾›äº†ä¸€ç§åŸºå‡†ï¼Œæ®æ­¤å¯ä»¥æ„å»ºæ›´é«˜çº§çš„å·¥å…·å’Œæ¥å£ï¼Œä½¿æ•°æ®åº“å¼€å‘äººå‘˜èƒ½å¤Ÿç¼–å†™æ•°æ®åº“åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ¼”ç¤ºä¸‹ Springboot ä¸­å¦‚ä½•ä½¿ç”¨ JDBC æ“ä½œï¼Œå¹¶é…ç½®ä½¿ç”¨ Druid è¿æ¥æ± ï¼Œä½“éªŒ Druid å¯¹æ•°æ®åº“æ“ä½œå¼ºå¤§çš„ç›‘æ§å’Œæ‰©å±•åŠŸèƒ½ã€‚Alibaba-Durid å®˜æ–¹æ‰‹å†Œ<a href="https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" target="_blank" rel="noopener">ç‚¹è¿™é‡Œ</a>ã€‚<br><a id="more"></a></p><h2 id="1-æ•°æ®åº“å‡†å¤‡"><a href="#1-æ•°æ®åº“å‡†å¤‡" class="headerlink" title="1. æ•°æ®åº“å‡†å¤‡"></a>1. æ•°æ®åº“å‡†å¤‡</h2><p>ä½¿ç”¨mysqlæ•°æ®åº“åˆ›å»ºæ•°æ®åº“ springbootï¼Œå¹¶åœ¨åº“ä¸­æ–°å»ºæ•°æ®è¡¨ user å¹¶æ–°å¢ä¸¤æ¡ä¿¡æ¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`birthday`</span> datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`skills`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`username`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">4</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"># æ–°å¢æ•°æ®</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`springboot`</span>.<span class="string">`user`</span>(<span class="string">`id`</span>, <span class="string">`age`</span>, <span class="string">`birthday`</span>, <span class="string">`password`</span>, <span class="string">`skills`</span>, <span class="string">`username`</span>) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">17</span>, <span class="string">'2019-01-12 21:02:30'</span>, <span class="string">'123'</span>, <span class="string">'Go'</span>, <span class="string">'Darcy'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`springboot`</span>.<span class="string">`user`</span>(<span class="string">`id`</span>, <span class="string">`age`</span>, <span class="string">`birthday`</span>, <span class="string">`password`</span>, <span class="string">`skills`</span>, <span class="string">`username`</span>) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">23</span>, <span class="string">'2019-01-01 00:11:22'</span>, <span class="string">'456'</span>, <span class="string">'Java'</span>, <span class="string">'Chris'</span>);</span><br></pre></td></tr></table></figure></p><h2 id="2-æ·»åŠ ä¾èµ–"><a href="#2-æ·»åŠ ä¾èµ–" class="headerlink" title="2. æ·»åŠ ä¾èµ–"></a>2. æ·»åŠ ä¾èµ–</h2><p>æ–°å»ºä¸€ä¸ª Springbooté¡¹ç›®ï¼Œè¿™é‡Œä¸è¯´ã€‚æ·»åŠ ä¾èµ–å¦‚ä¸‹ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- spring jdbc æ“ä½œæ¨¡ç‰ˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- springboot webå¼€å‘ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mysql æ•°æ®åº“è¿æ¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥druidæ•°æ®æº --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="3-é…ç½®æ•°æ®æºä¿¡æ¯"><a href="#3-é…ç½®æ•°æ®æºä¿¡æ¯" class="headerlink" title="3. é…ç½®æ•°æ®æºä¿¡æ¯"></a>3. é…ç½®æ•°æ®æºä¿¡æ¯</h2><p>å¸¸è§„çš„ JDBC é…ç½®ä¸éœ€è¦é…ç½®è¿™ä¹ˆå¤šå†…å®¹ï¼Œè¿™é‡Œå› ä¸ºä½¿ç”¨äº† Druid è¿æ¥æ± ï¼Œæ‰€ä»¥é…ç½®äº† Druid éƒ¨åˆ†ã€‚å¯¹è‡ªåŠ¨é…ç½®ä¸ç†è§£çš„å¯ä»¥æŸ¥çœ‹ç³»åˆ—æ–‡ç« <a href="https://www.codingme.net/2019/01/springboot/springboot02-config/#4-%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BD%BF%E7%94%A8">Springboot ç³»åˆ—ï¼ˆäºŒï¼‰Spring Boot é…ç½®æ–‡ä»¶</a>ã€‚<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    initialSize:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">    minIdle:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">    maxActive:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">    maxWait:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">    timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">    minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line"><span class="attr">    validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line"><span class="attr">    testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    testOnReturn:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment">#   é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œå»æ‰åç›‘æ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡ï¼Œ'wall'ç”¨äºé˜²ç«å¢™</span></span><br><span class="line"><span class="attr">    filters:</span> <span class="string">stat</span></span><br><span class="line"><span class="attr">    maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">    useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br></pre></td></tr></table></figure></p><p>é…ç½®å®Œæ¯•ä¹‹åï¼Œé…ç½®ä¿¡æ¯è¿˜ä¸èƒ½ç»‘å®šåˆ° Druidæ•°æ®æºä¸­ï¼Œè¿˜éœ€è¦æ–°å»ºä¸€ä¸ªé…ç½®ç±»ç»‘å®šæ•°æ®æºå’Œé…ç½®ä¿¡æ¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Druid æ•°æ®æºé…ç½®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/14 22:20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®ç»‘å®š</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">druid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åˆ°è¿™é‡Œï¼Œæ•°æ®æºå·²ç»é…ç½®å®Œæ¯•ï¼Œç¼–å†™æµ‹è¯•æ–¹æ³•æµ‹è¯• druid è¿æ¥æ± æ˜¯å¦ç”Ÿæ•ˆã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootDataJdbcApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•JDBCæ•°æ®æº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        Connection connection = dataSource.getConnection();</span><br><span class="line">        System.out.println(connection);</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œçœ‹åˆ° contextLoads è¾“å‡ºä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">Loading class `com.mysql.jdbc.Driver&apos;. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver&apos;. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span><br><span class="line">2019-02-27 14:14:56.144  INFO 12860 --- [           main] com.alibaba.druid.pool.DruidDataSource   : &#123;dataSource-1&#125; inited</span><br><span class="line">com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@3e104d4b</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºæ—¥å¿—ä¸­çš„ com.alibaba.druid è¯´æ˜ Druid å·²ç»ç”Ÿæ•ˆã€‚</p><h2 id="4-ä½¿ç”¨-Spring-JDBC"><a href="#4-ä½¿ç”¨-Spring-JDBC" class="headerlink" title="4. ä½¿ç”¨ Spring-JDBC"></a>4. ä½¿ç”¨ Spring-JDBC</h2><p>ä¼ ç»Ÿçš„ JDBC ä½¿ç”¨ä¸­ï¼Œéœ€è¦ç¼–å†™å¤§é‡ä»£ç ï¼Œä»æ„é€  PreparedStatement åˆ°æŸ¥è¯¢ä¸èƒœå…¶çƒ¦ã€‚é¢å¯¹è¿™æ ·çš„å¼€å‘ç—›ç‚¹ï¼ŒSpring å°è£…äº† Spring-jdbc. è®©æˆ‘ä»¬ä½¿ç”¨ JdbcTemplate å³å¯è½»æ¾çš„æ“ä½œæ•°æ®åº“ã€‚Spring-jdbc çš„è¯¦ç»†ä½¿ç”¨ä¸æ˜¯è¿™ç¯‡æ–‡ç« é‡ç‚¹ï¼Œåªç®€å•æ¼”ç¤ºä¸‹æ˜¯å¦ç”Ÿæ•ˆã€‚<br>ç¼–å†™æ§åˆ¶å™¨ï¼ŒæŸ¥è¯¢ä¸€ä¸ª user ä¿¡æ¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">map</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; list = jdbcTemplate.queryForList(<span class="string">"select * FROM user"</span>);</span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯åŠ¨spring é¡¹ç›®ï¼Œè¯·æ±‚ /query æ¥å£å¾—åˆ°æ­£å¸¸å“åº”ã€‚<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"age"</span>: <span class="number">17</span>,</span><br><span class="line"><span class="attr">"birthday"</span>: <span class="string">"2019-01-12T13:02:30.000+0000"</span>,</span><br><span class="line"><span class="attr">"password"</span>: <span class="string">"123"</span>,</span><br><span class="line"><span class="attr">"skills"</span>: <span class="string">"Go"</span>,</span><br><span class="line"><span class="attr">"username"</span>: <span class="string">"Darcy"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯è§ Spring-JDBC å·²ç»ä»æ•°æ®åº“ä¸­å–å‡ºäº†æ•°æ®ä¿¡æ¯ã€‚</p><h2 id="5-ä½¿ç”¨-Druid-ç›‘æ§"><a href="#5-ä½¿ç”¨-Druid-ç›‘æ§" class="headerlink" title="5. ä½¿ç”¨ Druid ç›‘æ§"></a>5. ä½¿ç”¨ Druid ç›‘æ§</h2><p>å¦‚æœä½¿ç”¨ Druid è¿æ¥æ± å´ä¸ä½¿ç”¨ç›‘æ§åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±æœ‰ç‚¹æš´æ®„å¤©ç‰©äº†ã€‚ä¸‹é¢å¼€å§‹é…ç½® Druid çš„ SQL ç›‘æ§åŠŸèƒ½ã€‚åœ¨ä¸Šé¢å†™çš„ DruidConfig é…ç½®ç±»ä¸­å¢åŠ é…ç½® Druid çš„ Servlet å’Œ Filter.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Druidçš„servlet</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">statViewServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      ServletRegistrationBean bean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet());</span><br><span class="line">      Map&lt;String, String&gt; initParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">      initParams.put(<span class="string">"loginUsername"</span>, <span class="string">"admin"</span>);</span><br><span class="line">      initParams.put(<span class="string">"loginPassword"</span>, <span class="string">"123"</span>);</span><br><span class="line">      initParams.put(<span class="string">"allow"</span>,<span class="string">"127.0.0.1"</span>);</span><br><span class="line">      bean.setInitParameters(initParams);</span><br><span class="line">      bean.setUrlMappings(Arrays.asList(<span class="string">"/druid/*"</span>));</span><br><span class="line">      <span class="keyword">return</span> bean;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">webStatFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      FilterRegistrationBean&lt;WebStatFilter&gt; bean = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;(<span class="keyword">new</span> WebStatFilter());</span><br><span class="line">      HashMap&lt;String, String&gt; initParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">      initParams.put(<span class="string">"exclusions"</span>, <span class="string">"/css,/druid/*"</span>);</span><br><span class="line">      bean.setInitParameters(initParams);</span><br><span class="line">      bean.setUrlPatterns(Arrays.asList(<span class="string">"/*"</span>));</span><br><span class="line">      <span class="keyword">return</span> bean;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢é…ç½®äº† Druid ç›‘æ§è®¿é—®è·¯å¾„ä¸º <code>/druid</code>ã€ç™»å½•ç”¨æˆ·æ˜¯ <code>admin</code>ã€ç™»å½•å¯†ç æ˜¯<code>123</code>ã€å…è®¸è®¿é—®çš„IPæ˜¯<code>127.0.0.1</code> æœ¬æœºã€ä¸éœ€è¦ç›‘æ§çš„è¯·æ±‚æ˜¯ <code>/css</code> å’Œ <code>/druid</code> å¼€å¤´çš„è¯·æ±‚ã€‚</p><p>é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®æµ‹è¯• <code>/query</code>ï¼Œç„¶åè®¿é—® <code>/durid</code> ç™»å½•é¡µã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/d6f42164708fcd4c8e5009386bb9837e.png" alt="Druid ç™»å½•é¡µ"></p><p>ç™»å½•åå¯ä»¥çœ‹åˆ° SQL ç›‘æ§ä¿¡æ¯å’Œ URL ç›‘æ§ç­‰ä¿¡æ¯ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/64a71b68b6afb74e22a2eb274e8956c3.png" alt="SQL ç›‘æ§"><br>URL ç›‘æ§ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/7b96df5bbd8698295696a3805ad82e26.png" alt="URL ç›‘æ§"></p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-data-jdbc" target="_blank" rel="noopener">Spring Boot jdbc</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/129bdbc0a9f53e0fd3b748978ccd5fe6.png&quot; alt=&quot;ç›‘æ§&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€å Java å¼€å‘è€…ï¼Œç›¸ä¿¡å¯¹ JDBCï¼ˆJava Data Base Connectivityï¼‰æ˜¯ä¸ä¼šé™Œç”Ÿçš„ï¼ŒJDBCä½œä¸º Java åŸºç¡€å†…å®¹ï¼Œå®ƒæä¾›äº†ä¸€ç§åŸºå‡†ï¼Œæ®æ­¤å¯ä»¥æ„å»ºæ›´é«˜çº§çš„å·¥å…·å’Œæ¥å£ï¼Œä½¿æ•°æ®åº“å¼€å‘äººå‘˜èƒ½å¤Ÿç¼–å†™æ•°æ®åº“åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ¼”ç¤ºä¸‹ Springboot ä¸­å¦‚ä½•ä½¿ç”¨ JDBC æ“ä½œï¼Œå¹¶é…ç½®ä½¿ç”¨ Druid è¿æ¥æ± ï¼Œä½“éªŒ Druid å¯¹æ•°æ®åº“æ“ä½œå¼ºå¤§çš„ç›‘æ§å’Œæ‰©å±•åŠŸèƒ½ã€‚Alibaba-Durid å®˜æ–¹æ‰‹å†Œ&lt;a href=&quot;https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç‚¹è¿™é‡Œ&lt;/a&gt;ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆå…«ï¼‰åŠ¨æ€Bannerä¸å›¾ç‰‡è½¬å­—ç¬¦å›¾æ¡ˆçš„æ‰‹åŠ¨å®ç°</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-08-banner/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-08-banner/</id>
    <published>2019-02-25T15:40:01.000Z</published>
    <updated>2019-05-20T16:26:48.627Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ <strong>v2.1.1.RELEASE</strong> è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/33e6877404fed0daf8c894cec6a4d37c.png" alt="Springboot å¯åŠ¨ banner"></p><p>ä½¿ç”¨è¿‡ Springboot çš„å¯¹ä¸Šé¢è¿™ä¸ªå›¾æ¡ˆè‚¯å®šä¸ä¼šé™Œç”Ÿï¼ŒSpringboot å¯åŠ¨çš„åŒæ—¶ä¼šæ‰“å°ä¸Šé¢çš„å›¾æ¡ˆï¼Œå¹¶å¸¦æœ‰ç‰ˆæœ¬å·ã€‚æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥æ‰¾åˆ°å…³äº banner çš„æè¿°</p><blockquote><p>The banner that is printed on start up can be changed by adding a banner.txt file to your classpath or by setting the spring.banner.location property to the location of such a file. If the file has an encoding other than UTF-8, you can set spring.banner.charset. In addition to a text file, you can also add a banner.gif, banner.jpg, or banner.png image file to your classpath or set the spring.banner.image.location property. Images are converted into an ASCII art representation and printed above any text banner.</p></blockquote><a id="more"></a><p>å°±ä¸ç¿»è¯‘äº†ï¼Œç›´æ¥æœ‰é“ç¿»è¯‘è´´è¿‡æ¥çœ‹ä¸ªå¤§æ¦‚æ„æ€ã€‚</p><blockquote><p>å¯ä»¥é€šè¿‡å‘ç±»è·¯å¾„ä¸­æ·»åŠ ä¸€ä¸ªbanner.txtæ–‡ä»¶æˆ–è®¾ç½®spring.banneræ¥æ›´æ”¹åœ¨start upä¸Šæ‰“å°çš„bannerã€‚å±æ€§æŒ‡å‘æ­¤ç±»æ–‡ä»¶çš„ä½ç½®ã€‚å¦‚æœæ–‡ä»¶çš„ç¼–ç ä¸æ˜¯UTF-8ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®spring.banner.charsetã€‚é™¤äº†æ–‡æœ¬æ–‡ä»¶ï¼Œè¿˜å¯ä»¥æ·»åŠ æ¨ªå¹…ã€‚å°†gifã€banner.jpgæˆ–banner.pngå›¾åƒæ–‡ä»¶ä¿å­˜åˆ°ç±»è·¯å¾„æˆ–è®¾ç½®spring.banner.imageã€‚ä½ç½®å±æ€§ã€‚å›¾åƒè¢«è½¬æ¢æˆASCIIè‰ºæœ¯å½¢å¼ï¼Œå¹¶æ‰“å°åœ¨ä»»ä½•æ–‡æœ¬æ¨ªå¹…ä¸Šé¢ã€‚</p></blockquote><h1 id="1-è‡ªå®šä¹‰-banner"><a href="#1-è‡ªå®šä¹‰-banner" class="headerlink" title="1. è‡ªå®šä¹‰ banner"></a>1. è‡ªå®šä¹‰ banner</h1><p>æ ¹æ®å®˜æ–¹çš„æè¿°ï¼Œå¯ä»¥åœ¨ç±»è·¯å¾„ä¸­è‡ªå®šä¹‰ banner å›¾æ¡ˆï¼Œæˆ‘ä»¬è¿›è¡Œå°è¯•åœ¨æ”¾ resouce ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ banner.txt å¹¶å†™å…¥å†…å®¹ï¼ˆ<a href="http://patorjk.com/software/taag/#p=testall&amp;f=Graffiti&amp;t=niumoo" target="_blank" rel="noopener">åœ¨çº¿å­—ç¬¦ç”Ÿæˆ</a>ï¼‰ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    (_)</span><br><span class="line"> _ __  _ _   _ _ __ ___   ___   ___</span><br><span class="line">| &apos;_ \| | | | | &apos;_ ` _ \ / _ \ / _ \</span><br><span class="line">| | | | | |_| | | | | | | (_) | (_) |</span><br><span class="line">|_| |_|_|\__,_|_| |_| |_|\___/ \___/ ç‰ˆæœ¬ï¼š$&#123;spring-boot.formatted-version&#125;</span><br></pre></td></tr></table></figure></p><p>å¯åŠ¨ Springboot åœ¨æ§åˆ¶å°çœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">     (_)</span><br><span class="line">  _ __  _ _   _ _ __ ___   ___   ___</span><br><span class="line"> | &apos;_ \| | | | | &apos;_ ` _ \ / _ \ / _ \</span><br><span class="line"> | | | | | |_| | | | | | | (_) | (_) |</span><br><span class="line"> |_| |_|_|\__,_|_| |_| |_|\___/ \___/ ç‰ˆæœ¬ï¼š(v2.1.3.RELEASE)</span><br><span class="line">2019-02-25 14:00:31.289  INFO 12312 --- [           main] net.codingme.banner.BannerApplication    : Starting BannerApplication on LAPTOP-L1S5MKTA with PID 12312 (D:\IdeaProjectMy\springboot-git\springboot-banner\target\classes started by Niu in D:\IdeaProjectMy\springboot-git\springboot-banner)</span><br><span class="line">2019-02-25 14:00:31.291  INFO 12312 --- [           main] net.codingme.banner.BannerApplication    : No active profile set, falling back to default profiles: default</span><br><span class="line">2019-02-25 14:00:32.087  INFO 12312 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)</span><br></pre></td></tr></table></figure></p><p>å‘ç°è‡ªå®šä¹‰ banner å·²ç»ç”Ÿæ•ˆäº†ï¼Œå®˜æ–¹æ–‡æ¡£çš„ä»‹ç»é‡Œè¯´è¿˜å¯ä»¥æ”¾ç½®å›¾ç‰‡ï¼Œä¸‹é¢æ”¾ç½®å›¾ç‰‡ banner.jpg æµ‹è¯•ã€‚<br>ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªå›¾ç‰‡ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/d9879377e30b5f37f9116e7927e35604.jpg" alt="Google Log">å†æ¬¡å¯åŠ¨è§‚å¯Ÿè¾“å‡ºã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/935928a0c76faa399a6f49252c713afa.png" alt="è‡ªå®šä¹‰ Banner">Springboot æŠŠå›¾æ¡ˆè½¬æˆäº† ASCII å›¾æ¡ˆã€‚</p><h1 id="2-ASCII-å›¾æ¡ˆç”ŸæˆåŸç†"><a href="#2-ASCII-å›¾æ¡ˆç”ŸæˆåŸç†" class="headerlink" title="2. ASCII å›¾æ¡ˆç”ŸæˆåŸç†"></a>2. ASCII å›¾æ¡ˆç”ŸæˆåŸç†</h1><p>çœ‹äº†ä¸Šé¢çš„ä¾‹å­ï¼Œå‘ç° Springboot å¯ä»¥æŠŠå›¾ç‰‡è½¬æ¢æˆ ASCII å›¾æ¡ˆï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿæˆ‘ä»¬æˆ–è®¸å¯ä»¥æƒ³è±¡å‡ºä¸€ä¸ªå¤§æ¦‚æµç¨‹ã€‚</p><ol><li>è·å–å›¾ç‰‡ã€‚</li><li>éå†å›¾ç‰‡åƒç´ ç‚¹ã€‚</li><li>åˆ†æåƒç´ ç‚¹ï¼Œæ¯ä¸ªåƒç´ ç‚¹æ ¹æ®é¢œè‰²æ·±åº¦å¾—å‡ºä¸€ä¸ªå€¼ï¼Œæ ¹æ®æ˜æš—åº¦åŒ¹é…ä¸åŒçš„å­—ç¬¦ã€‚</li><li>è¾“å‡ºå›¾æ¡ˆã€‚</li></ol><p>Springboot å¯¹å›¾ç‰‡ banner çš„å¤„ç†åˆ°åº•æ˜¯ä¸æ˜¯æˆ‘ä»¬ä¸Šé¢æƒ³æƒ³çš„é‚£æ ·å‘¢ï¼Ÿç›´æ¥å»æºç ä¸­å¯»æ‰¾ç­”æ¡ˆã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ä½ç½®ï¼šorg.springframework.boot.SpringApplicationBannerPrinter */</span></span><br><span class="line"><span class="comment">//æ–¹æ³•1ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Banner <span class="title">print</span><span class="params">(Environment environment, Class&lt;?&gt; sourceClass, Log logger)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å– banner  è°ƒç”¨æ–¹æ³•è®°ä¸º2</span></span><br><span class="line">Banner banner = getBanner(environment);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">logger.info(createStringFromBanner(banner, environment, sourceClass));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (UnsupportedEncodingException ex) &#123;</span><br><span class="line">logger.warn(<span class="string">"Failed to create String for banner"</span>, ex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰“å° banner</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> PrintedBanner(banner, sourceClass);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•2</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Banner <span class="title">getBanner</span><span class="params">(Environment environment)</span> </span>&#123;</span><br><span class="line">Banners banners = <span class="keyword">new</span> Banners();</span><br><span class="line"><span class="comment">// è·å–å›¾ç‰‡bannerï¼Œæˆ‘ä»¬åªå…³æ³¨è¿™ä¸ªï¼Œè°ƒç”¨æ–¹æ³•è®°ä¸º3</span></span><br><span class="line">banners.addIfNotNull(getImageBanner(environment));</span><br><span class="line">banners.addIfNotNull(getTextBanner(environment));</span><br><span class="line"><span class="keyword">if</span> (banners.hasAtLeastOneBanner()) &#123;</span><br><span class="line"><span class="keyword">return</span> banners;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.fallbackBanner != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.fallbackBanner;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> DEFAULT_BANNER;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•3</span></span><br><span class="line"><span class="comment">/** è·å–è‡ªå®šä¹‰banneræ–‡ä»¶ä¿¡æ¯ */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Banner <span class="title">getImageBanner</span><span class="params">(Environment environment)</span> </span>&#123;</span><br><span class="line"><span class="comment">// BANNER_IMAGE_LOCATION_PROPERTY = "spring.banner.image.location";</span></span><br><span class="line">String location = environment.getProperty(BANNER_IMAGE_LOCATION_PROPERTY);</span><br><span class="line"><span class="keyword">if</span> (StringUtils.hasLength(location)) &#123;</span><br><span class="line">Resource resource = <span class="keyword">this</span>.resourceLoader.getResource(location);</span><br><span class="line"><span class="keyword">return</span> resource.exists() ? <span class="keyword">new</span> ImageBanner(resource) : <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// IMAGE_EXTENSION = &#123; "gif", "jpg", "png" &#125;;</span></span><br><span class="line"><span class="keyword">for</span> (String ext : IMAGE_EXTENSION) &#123;</span><br><span class="line">Resource resource = <span class="keyword">this</span>.resourceLoader.getResource(<span class="string">"banner."</span> + ext);</span><br><span class="line"><span class="keyword">if</span> (resource.exists()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ImageBanner(resource);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢æ˜¯å¯»æ‰¾è‡ªå®šä¹‰å›¾ç‰‡ banner æ–‡ä»¶æºç ï¼Œå¦‚æœæŠŠå›¾ç‰‡è½¬æ¢æˆ ASCII å›¾æ¡ˆç»§ç»­è·Ÿè¿›ï¼Œè¿½è¸ªæ–¹æ³•1ä¸­çš„<code>PrintedBanner(banner, sourceClass)</code>æ–¹æ³•ã€‚æœ€ç»ˆæŸ¥æ‰¾è¾“å‡ºå›¾æ¡ˆçš„ä¸»è¦æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½ç½®ï¼šorg.springframework.boot.ImageBanner#printBanner</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printBanner</span><span class="params">(BufferedImage image, <span class="keyword">int</span> margin, <span class="keyword">boolean</span> invert,</span></span></span><br><span class="line"><span class="function"><span class="params">PrintStream out)</span> </span>&#123;</span><br><span class="line">AnsiElement background = invert ? AnsiBackground.BLACK : AnsiBackground.DEFAULT;</span><br><span class="line">out.print(AnsiOutput.encode(AnsiColor.DEFAULT));</span><br><span class="line">out.print(AnsiOutput.encode(background));</span><br><span class="line">out.println();</span><br><span class="line">out.println();</span><br><span class="line">AnsiColor lastColor = AnsiColor.DEFAULT;</span><br><span class="line"><span class="comment">// å›¾ç‰‡é«˜åº¦éå†</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; image.getHeight(); y++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; margin; i++) &#123;</span><br><span class="line">out.print(<span class="string">" "</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å›¾ç‰‡å®½åº¦éå†</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; image.getWidth(); x++) &#123;</span><br><span class="line"><span class="comment">// è·å–æ¯ä¸€ä¸ªåƒç´ ç‚¹</span></span><br><span class="line">Color color = <span class="keyword">new</span> Color(image.getRGB(x, y), <span class="keyword">false</span>);</span><br><span class="line">AnsiColor ansiColor = AnsiColors.getClosest(color);</span><br><span class="line"><span class="keyword">if</span> (ansiColor != lastColor) &#123;</span><br><span class="line">out.print(AnsiOutput.encode(ansiColor));</span><br><span class="line">lastColor = ansiColor;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åƒç´ ç‚¹è½¬æ¢æˆå­—ç¬¦è¾“å‡ºï¼Œè°ƒç”¨æ–¹æ³•è®°ä¸º2</span></span><br><span class="line">out.print(getAsciiPixel(color, invert));</span><br><span class="line">&#125;</span><br><span class="line">out.println();</span><br><span class="line">&#125;</span><br><span class="line">out.print(AnsiOutput.encode(AnsiColor.DEFAULT));</span><br><span class="line">out.print(AnsiOutput.encode(AnsiBackground.DEFAULT));</span><br><span class="line">out.println();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•2ï¼Œåƒç´ ç‚¹è½¬æ¢æˆå­—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">char</span> <span class="title">getAsciiPixel</span><span class="params">(Color color, <span class="keyword">boolean</span> dark)</span> </span>&#123;</span><br><span class="line"><span class="comment">// æ ¹æ® color ç®—å‡ºä¸€ä¸ªäº®åº¦å€¼</span></span><br><span class="line"><span class="keyword">double</span> luminance = getLuminance(color, dark);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; PIXEL.length; i++) &#123;</span><br><span class="line"><span class="comment">// å¯»æ‰¾äº®åº¦å€¼åŒ¹é…çš„å­—ç¬¦</span></span><br><span class="line"><span class="keyword">if</span> (luminance &gt;= (LUMINANCE_START - (i * LUMINANCE_INCREMENT))) &#123;</span><br><span class="line"><span class="comment">// PIXEL = &#123; ' ', '.', '*', ':', 'o', '&amp;', '8', '#', '@' &#125;;</span></span><br><span class="line"><span class="keyword">return</span> PIXEL[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> PIXEL[PIXEL.length - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡æŸ¥çœ‹æºç ï¼Œå‘ç° Springboot çš„å›¾ç‰‡ banner çš„è½¬æ¢å’Œæˆ‘ä»¬é¢„æƒ³çš„å¤§è‡´ä¸€è‡´ï¼Œè¿™ä¹ˆæœ‰è¶£çš„åŠŸèƒ½æˆ‘ä»¬èƒ½ä¸èƒ½è‡ªå·±å†™ä¸€ä¸ªå‘¢ï¼Ÿ</p><h1 id="3-è‡ªå·±å®ç°å›¾ç‰‡è½¬-ASCIIå­—ç¬¦"><a href="#3-è‡ªå·±å®ç°å›¾ç‰‡è½¬-ASCIIå­—ç¬¦" class="headerlink" title="3.è‡ªå·±å®ç°å›¾ç‰‡è½¬ ASCIIå­—ç¬¦"></a>3.è‡ªå·±å®ç°å›¾ç‰‡è½¬ ASCIIå­—ç¬¦</h1><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæ€»ç»“ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å†™ä¸€ä¸ªå›¾ç‰‡è½¬ ASCII å­—ç¬¦å›¾æ¡ˆã€‚<br>æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li>å›¾ç‰‡å¤§å°ç¼©æ”¾ï¼Œè°ƒæ•´åˆ°åˆé€‚å¤§å°ã€‚</li><li>éå†å›¾ç‰‡åƒç´ ã€‚</li><li>è·å–å›¾ç‰‡åƒç´ ç‚¹äº®åº¦ï¼ˆRGBé¢œè‰²é€šè¿‡å…¬å¼å¯ä»¥å¾—åˆ°äº®åº¦æ•°å€¼ï¼‰ã€‚</li><li>åŒ¹é…å­—ç¬¦ã€‚</li><li>è¾“å‡ºå›¾æ¡ˆã€‚</li></ol><p>ä¸Šé¢çš„5ä¸ªæ­¥éª¤ç›´æ¥ä½¿ç”¨ Java ä»£ç å°±å¯ä»¥å®Œæ•´å®ç°ï¼Œä¸‹é¢æ˜¯ç¼–å†™çš„æºç ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ ¹æ®å›¾ç‰‡ç”Ÿæˆå­—ç¬¦å›¾æ¡ˆ</span></span><br><span class="line"><span class="comment"> * 1.å›¾ç‰‡å¤§å°ç¼©æ”¾</span></span><br><span class="line"><span class="comment"> * 2.éå†å›¾ç‰‡åƒç´ ç‚¹</span></span><br><span class="line"><span class="comment"> * 3.è·å–å›¾ç‰‡åƒç´ ç‚¹äº®åº¦</span></span><br><span class="line"><span class="comment"> * 4.åŒ¹é…å­—ç¬¦</span></span><br><span class="line"><span class="comment"> * 5.è¾“å‡ºå›¾æ¡ˆ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>  niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@website</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019-02-25 23:03:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratorTextImage</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span>[] PIXEL = &#123;<span class="string">'@'</span>, <span class="string">'#'</span>, <span class="string">'8'</span>, <span class="string">'&amp;'</span>, <span class="string">'o'</span>, <span class="string">':'</span>, <span class="string">'*'</span>, <span class="string">'.'</span>, <span class="string">' '</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// å›¾ç‰‡ç¼©æ”¾</span></span><br><span class="line">        BufferedImage bufferedImage = makeSmallImage(<span class="string">"src/main/resources/banner.jpg"</span>);</span><br><span class="line">        <span class="comment">// è¾“å‡º</span></span><br><span class="line">        printImage(bufferedImage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printImage</span><span class="params">(BufferedImage image)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> width = image.getWidth();</span><br><span class="line">        <span class="keyword">int</span> height = image.getHeight();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; height; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; width; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> rgb = image.getRGB(j, i);</span><br><span class="line">                Color color = <span class="keyword">new</span> Color(rgb);</span><br><span class="line">                <span class="keyword">int</span> red = color.getRed();</span><br><span class="line">                <span class="keyword">int</span> green = color.getGreen();</span><br><span class="line">                <span class="keyword">int</span> blue = color.getBlue();</span><br><span class="line">                <span class="comment">// ä¸€ä¸ªç”¨äºè®¡ç®—RGBåƒç´ ç‚¹äº®åº¦çš„å…¬å¼</span></span><br><span class="line">                Double luminace = <span class="number">0.2126</span> * red + <span class="number">0.7152</span> * green + <span class="number">0.0722</span> * blue;</span><br><span class="line">                <span class="keyword">double</span> index = luminace / (Math.ceil(<span class="number">255</span> / PIXEL.length) + <span class="number">0.5</span>);</span><br><span class="line">                System.out.print(PIXEL[(<span class="keyword">int</span>)(Math.floor(index))]);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title">makeSmallImage</span><span class="params">(String srcImageName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        File srcImageFile = <span class="keyword">new</span> File(srcImageName);</span><br><span class="line">        <span class="keyword">if</span> (srcImageFile == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ–‡ä»¶ä¸å­˜åœ¨"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">        BufferedImage tagImage = <span class="keyword">null</span>;</span><br><span class="line">        Image srcImage = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            srcImage = ImageIO.read(srcImageFile);</span><br><span class="line">            <span class="keyword">int</span> srcWidth = srcImage.getWidth(<span class="keyword">null</span>);<span class="comment">// åŸå›¾ç‰‡å®½åº¦</span></span><br><span class="line">            <span class="keyword">int</span> srcHeight = srcImage.getHeight(<span class="keyword">null</span>);<span class="comment">// åŸå›¾ç‰‡é«˜åº¦</span></span><br><span class="line">            <span class="keyword">int</span> dstMaxSize = <span class="number">90</span>;<span class="comment">// ç›®æ ‡ç¼©ç•¥å›¾çš„æœ€å¤§å®½åº¦/é«˜åº¦ï¼Œå®½åº¦ä¸é«˜åº¦å°†æŒ‰æ¯”ä¾‹ç¼©å†™</span></span><br><span class="line">            <span class="keyword">int</span> dstWidth = srcWidth;<span class="comment">// ç¼©ç•¥å›¾å®½åº¦</span></span><br><span class="line">            <span class="keyword">int</span> dstHeight = srcHeight;<span class="comment">// ç¼©ç•¥å›¾é«˜åº¦</span></span><br><span class="line">            <span class="keyword">float</span> scale = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// è®¡ç®—ç¼©ç•¥å›¾çš„å®½å’Œé«˜</span></span><br><span class="line">            <span class="keyword">if</span> (srcWidth &gt; dstMaxSize) &#123;</span><br><span class="line">                dstWidth = dstMaxSize;</span><br><span class="line">                scale = (<span class="keyword">float</span>)srcWidth / (<span class="keyword">float</span>)dstMaxSize;</span><br><span class="line">                dstHeight = Math.round((<span class="keyword">float</span>)srcHeight / scale);</span><br><span class="line">            &#125;</span><br><span class="line">            srcHeight = dstHeight;</span><br><span class="line">            <span class="keyword">if</span> (srcHeight &gt; dstMaxSize) &#123;</span><br><span class="line">                dstHeight = dstMaxSize;</span><br><span class="line">                scale = (<span class="keyword">float</span>)srcHeight / (<span class="keyword">float</span>)dstMaxSize;</span><br><span class="line">                dstWidth = Math.round((<span class="keyword">float</span>)dstWidth / scale);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ç”Ÿæˆç¼©ç•¥å›¾</span></span><br><span class="line">            tagImage = <span class="keyword">new</span> BufferedImage(dstWidth, dstHeight, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">            tagImage.getGraphics().drawImage(srcImage, <span class="number">0</span>, <span class="number">0</span>, dstWidth, dstHeight, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> tagImage;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (fileOutputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileOutputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            tagImage = <span class="keyword">null</span>;</span><br><span class="line">            srcImage = <span class="keyword">null</span>;</span><br><span class="line">            System.gc();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿˜æ˜¯æ‹¿ä¸Šé¢çš„ Google log å›¾ç‰‡ä½œä¸ºå®éªŒå¯¹è±¡ï¼Œè¿è¡Œå¾—åˆ°å­—ç¬¦å›¾æ¡ˆè¾“å‡ºã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/ddc9487dd2050f9188825195427ed0a1.png" alt="å›¾ç‰‡è½¬ ASCII å­—ç¬¦"></p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/" target="_blank" rel="noopener">Spring Boot</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ &lt;strong&gt;v2.1.1.RELEASE&lt;/strong&gt; è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/33e6877404fed0daf8c894cec6a4d37c.png&quot; alt=&quot;Springboot å¯åŠ¨ banner&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨è¿‡ Springboot çš„å¯¹ä¸Šé¢è¿™ä¸ªå›¾æ¡ˆè‚¯å®šä¸ä¼šé™Œç”Ÿï¼ŒSpringboot å¯åŠ¨çš„åŒæ—¶ä¼šæ‰“å°ä¸Šé¢çš„å›¾æ¡ˆï¼Œå¹¶å¸¦æœ‰ç‰ˆæœ¬å·ã€‚æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥æ‰¾åˆ°å…³äº banner çš„æè¿°&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The banner that is printed on start up can be changed by adding a banner.txt file to your classpath or by setting the spring.banner.location property to the location of such a file. If the file has an encoding other than UTF-8, you can set spring.banner.charset. In addition to a text file, you can also add a banner.gif, banner.jpg, or banner.png image file to your classpath or set the spring.banner.image.location property. Images are converted into an ASCII art representation and printed above any text banner.&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆä¸ƒï¼‰web å¼€å‘ä¹‹å¼‚å¸¸é”™è¯¯å¤„ç†æœºåˆ¶å‰–æ</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-07-web-exception/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-07-web-exception/</id>
    <published>2019-02-22T00:00:01.000Z</published>
    <updated>2019-05-20T16:26:48.623Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç›¸ä¿¡å¤§å®¶åœ¨åˆšå¼€å§‹ä½“éªŒ Springboot çš„æ—¶å€™ä¸€å®šä¼šç»å¸¸ç¢°åˆ°è¿™ä¸ªé¡µé¢ï¼Œä¹Ÿå°±æ˜¯è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢çš„é»˜è®¤è¿”å›é¡µé¢ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/992cd6d0f9f75737d1088523d80a64c1.png" alt="Spring Boot é»˜è®¤é”™è¯¯é¡µé¢"><br><a id="more"></a><br>å¦‚æœæ˜¯å…¶ä»–å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¦‚æ¥å£æµ‹è¯•å·¥å…·ï¼Œä¼šé»˜è®¤è¿”å›JSONæ•°æ®ã€‚<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        <span class="attr">"timestamp"</span>:<span class="string">"2019-01-06 22:26:16"</span>,</span><br><span class="line">        <span class="attr">"status"</span>:<span class="number">404</span>,</span><br><span class="line">        <span class="attr">"error"</span>:<span class="string">"Not Found"</span>,</span><br><span class="line">        <span class="attr">"message"</span>:<span class="string">"No message available"</span>,</span><br><span class="line">        <span class="attr">"path"</span>:<span class="string">"/asdad"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜æ˜¾ï¼ŒSpringBoot æ ¹æ® <a href="https://www.codingme.net/2018/07/computer/protocol-http/">HTTP çš„è¯·æ±‚å¤´ä¿¡æ¯</a>è¿›è¡Œäº†ä¸åŒçš„å“åº”å¤„ç†ã€‚</p><h2 id="1-SpringBoot-å¼‚å¸¸å¤„ç†æœºåˆ¶"><a href="#1-SpringBoot-å¼‚å¸¸å¤„ç†æœºåˆ¶" class="headerlink" title="1. SpringBoot å¼‚å¸¸å¤„ç†æœºåˆ¶"></a>1. SpringBoot å¼‚å¸¸å¤„ç†æœºåˆ¶</h2><p>è¿½éš SpringBoot æºç å¯ä»¥åˆ†æå‡ºé»˜è®¤çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration</span></span><br><span class="line"><span class="comment">// ç»‘å®šä¸€äº›é”™è¯¯ä¿¡æ¯ è®°ä¸º 1</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>(value = ErrorAttributes.class, search = SearchStrategy.CURRENT)</span><br><span class="line"><span class="function"><span class="keyword">public</span> DefaultErrorAttributes <span class="title">errorAttributes</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> DefaultErrorAttributes(</span><br><span class="line"><span class="keyword">this</span>.serverProperties.getError().isIncludeException());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é»˜è®¤å¤„ç† /error è®°ä¸º 2</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>(value = ErrorController.class, search = SearchStrategy.CURRENT)</span><br><span class="line"><span class="function"><span class="keyword">public</span> BasicErrorController <span class="title">basicErrorController</span><span class="params">(ErrorAttributes errorAttributes)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> BasicErrorController(errorAttributes, <span class="keyword">this</span>.serverProperties.getError(),</span><br><span class="line"><span class="keyword">this</span>.errorViewResolvers);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é”™è¯¯å¤„ç†é¡µé¢ è®°ä¸º3</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ErrorPageCustomizer <span class="title">errorPageCustomizer</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ErrorPageCustomizer(<span class="keyword">this</span>.serverProperties, <span class="keyword">this</span>.dispatcherServletPath);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultErrorViewResolverConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ResourceProperties resourceProperties;</span><br><span class="line"></span><br><span class="line">DefaultErrorViewResolverConfiguration(ApplicationContext applicationContext,</span><br><span class="line">ResourceProperties resourceProperties) &#123;</span><br><span class="line"><span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line"><span class="keyword">this</span>.resourceProperties = resourceProperties;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å†³å®šå»å“ªä¸ªé”™è¯¯é¡µé¢ è®°ä¸º4</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnBean</span>(DispatcherServlet.class)</span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> DefaultErrorViewResolver <span class="title">conventionErrorViewResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> DefaultErrorViewResolver(<span class="keyword">this</span>.applicationContext,</span><br><span class="line"><span class="keyword">this</span>.resourceProperties);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç»“åˆä¸Šé¢çš„æ³¨é‡Šï¼Œä¸Šé¢ä»£ç é‡Œçš„å››ä¸ªæ–¹æ³•å°±æ˜¯ Springboot å®ç°é»˜è®¤è¿”å›é”™è¯¯é¡µé¢ä¸»è¦éƒ¨åˆ†ã€‚</p><h3 id="1-1-errorAttributes"><a href="#1-1-errorAttributes" class="headerlink" title="1.1. errorAttributes"></a>1.1. errorAttributes</h3><p><code>errorAttributes</code>ç›´è¯‘ä¸ºé”™è¯¯å±æ€§ï¼Œè¿™ä¸ªæ–¹æ³•ç¡®å®å¦‚æ­¤ï¼Œç›´æ¥è¿½è¸ªæºä»£ç ã€‚<br>ä»£ç ä½äºï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.boot.web.servlet.error.DefaultErrorAttributes</span></span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªç±»é‡Œä¸ºé”™è¯¯æƒ…å†µå…±äº«å¾ˆå¤šé”™è¯¯ä¿¡æ¯ï¼Œå¦‚ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">errorAttributes.put(&quot;timestamp&quot;, new Date());</span><br><span class="line">errorAttributes.put(&quot;status&quot;, status);</span><br><span class="line">errorAttributes.put(&quot;error&quot;, HttpStatus.valueOf(status).getReasonPhrase());</span><br><span class="line">errorAttributes.put(&quot;errors&quot;, result.getAllErrors());</span><br><span class="line">errorAttributes.put(&quot;exception&quot;, error.getClass().getName());</span><br><span class="line">errorAttributes.put(&quot;message&quot;, error.getMessage());</span><br><span class="line">errorAttributes.put(&quot;trace&quot;, stackTrace.toString());</span><br><span class="line">errorAttributes.put(&quot;path&quot;, path);</span><br></pre></td></tr></table></figure></p><p>è¿™äº›ä¿¡æ¯ç”¨ä½œå…±äº«ä¿¡æ¯è¿”å›ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨æ¨¡ç‰ˆå¼•æ“æ—¶ï¼Œä¹Ÿå¯ä»¥åƒå–å‡ºå…¶ä»–å‚æ•°ä¸€æ ·è½»æ¾å–å‡ºã€‚</p><h3 id="1-2-basicErrorControll"><a href="#1-2-basicErrorControll" class="headerlink" title="1.2. basicErrorControll"></a>1.2. basicErrorControll</h3><p>ç›´æ¥è¿½è¸ª <code>BasicErrorController</code> çš„æºç å†…å®¹å¯ä»¥å‘ç°ä¸‹é¢çš„ä¸€æ®µä»£ç ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">// å®šä¹‰è¯·æ±‚è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰error.pathè·¯å¾„ï¼Œåˆ™è·¯å¾„ä¸º/error</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"$&#123;server.error.path:$&#123;error.path:/error&#125;&#125;"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicErrorController</span> <span class="keyword">extends</span> <span class="title">AbstractErrorController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// å¦‚æœæ”¯æŒçš„æ ¼å¼ text/html</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(produces = MediaType.TEXT_HTML_VALUE)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">errorHtml</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">HttpStatus status = getStatus(request);</span><br><span class="line">        <span class="comment">// è·å–è¦è¿”å›çš„å€¼</span></span><br><span class="line">Map&lt;String, Object&gt; model = Collections.unmodifiableMap(getErrorAttributes(</span><br><span class="line">request, isIncludeStackTrace(request, MediaType.TEXT_HTML)));</span><br><span class="line">response.setStatus(status.value());</span><br><span class="line">        <span class="comment">// è§£æé”™è¯¯è§†å›¾ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢1.4ä¸­çš„é€»è¾‘</span></span><br><span class="line">ModelAndView modelAndView = resolveErrorView(request, response, status, model);</span><br><span class="line"><span class="comment">// è¿”å›è§†å›¾ï¼Œå¦‚æœæ²¡æœ‰å­˜åœ¨çš„é¡µé¢æ¨¡ç‰ˆï¼Œåˆ™ä½¿ç”¨é»˜è®¤é”™è¯¯è§†å›¾æ¨¡ç‰ˆ</span></span><br><span class="line">        <span class="keyword">return</span> (modelAndView != <span class="keyword">null</span>) ? modelAndView : <span class="keyword">new</span> ModelAndView(<span class="string">"error"</span>, model);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;Map&lt;String, Object&gt;&gt; error(HttpServletRequest request) &#123;</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯æ¥å—æ‰€æœ‰æ ¼å¼çš„HTTPè¯·æ±‚</span></span><br><span class="line">        Map&lt;String, Object&gt; body = getErrorAttributes(request,</span><br><span class="line">isIncludeStackTrace(request, MediaType.ALL));</span><br><span class="line">HttpStatus status = getStatus(request);</span><br><span class="line">        <span class="comment">// å“åº”HttpEntity</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(body, status);</span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç”±ä¸Šå¯çŸ¥ï¼Œ<code>basicErrorControll</code> ç”¨äºåˆ›å»ºç”¨äºè¯·æ±‚è¿”å›çš„ <code>controller</code>ç±»ï¼Œå¹¶æ ¹æ®HTTPè¯·æ±‚å¯æ¥å—çš„æ ¼å¼ä¸åŒè¿”å›å¯¹åº”çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æµè§ˆå™¨å’Œæ¥å£æµ‹è¯•å·¥å…·æµ‹è¯•æ—¶è¿”å›ç»“æœå­˜åœ¨å·®å¼‚ã€‚</p><h3 id="1-3-ererrorPageCustomizer"><a href="#1-3-ererrorPageCustomizer" class="headerlink" title="1.3. ererrorPageCustomizer"></a>1.3. ererrorPageCustomizer</h3><p>ç›´æ¥æŸ¥çœ‹æ–¹æ³•é‡Œçš„<code>new ErrorPageCustomizer(this.serverProperties, this.dispatcherServletPath);</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration.ErrorPageCustomizer</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> WebServerFactoryCustomizer&#125; that configures the server's error pages.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorPageCustomizer</span> <span class="keyword">implements</span> <span class="title">ErrorPageRegistrar</span>, <span class="title">Ordered</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ServerProperties properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> DispatcherServletPath dispatcherServletPath;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">ErrorPageCustomizer</span><span class="params">(ServerProperties properties,</span></span></span><br><span class="line"><span class="function"><span class="params">DispatcherServletPath dispatcherServletPath)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.properties = properties;</span><br><span class="line"><span class="keyword">this</span>.dispatcherServletPath = dispatcherServletPath;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ³¨å†Œé”™è¯¯é¡µé¢</span></span><br><span class="line">        <span class="comment">// this.dispatcherServletPath.getRelativePath(this.properties.getError().getPath())</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerErrorPages</span><span class="params">(ErrorPageRegistry errorPageRegistry)</span> </span>&#123;</span><br><span class="line">            <span class="comment">//getPath()å¾—åˆ°å¦‚ä¸‹åœ°å€ï¼Œå¦‚æœæ²¡æœ‰è‡ªå®šä¹‰error.pathå±æ€§ï¼Œåˆ™å»/errorä½ç½®</span></span><br><span class="line">            <span class="comment">//@Value("$&#123;error.path:/error&#125;")</span></span><br><span class="line"><span class="comment">//private String path = "/error";</span></span><br><span class="line">ErrorPage errorPage = <span class="keyword">new</span> ErrorPage(<span class="keyword">this</span>.dispatcherServletPath</span><br><span class="line">.getRelativePath(<span class="keyword">this</span>.properties.getError().getPath()));</span><br><span class="line">errorPageRegistry.addErrorPages(errorPage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç”±ä¸Šå¯çŸ¥ï¼Œå½“é‡åˆ°é”™è¯¯æ—¶ï¼Œå¦‚æœæ²¡æœ‰è‡ªå®šä¹‰ <code>error.path</code> å±æ€§ï¼Œåˆ™è¯·æ±‚è½¬å‘è‡³ <code>/error</code>.</p><h3 id="1-4-conventionErrorViewResolver"><a href="#1-4-conventionErrorViewResolver" class="headerlink" title="1.4. conventionErrorViewResolver"></a>1.4. conventionErrorViewResolver</h3><p>æ ¹æ®ä¸Šé¢çš„ä»£ç ï¼Œä¸€æ­¥æ­¥æ·±å…¥æŸ¥çœ‹ SpringBoot çš„é»˜è®¤é”™è¯¯å¤„ç†å®ç°ï¼ŒæŸ¥çœ‹çœ‹ <code>conventionErrorViewResolver</code>æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ DefaultErrorViewResolver ç±»çš„éƒ¨åˆ†ä»£ç ï¼Œæ³¨é‡Šè§£æã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.boot.autoconfigure.web.servlet.error.DefaultErrorViewResolver</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å‚æ•°ï¼Œkey æ˜¯HTTPçŠ¶æ€ç ç¬¬ä¸€ä½ã€‚</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">Map&lt;Series, String&gt; views = <span class="keyword">new</span> EnumMap&lt;&gt;(Series.class);</span><br><span class="line">views.put(Series.CLIENT_ERROR, <span class="string">"4xx"</span>);</span><br><span class="line">views.put(Series.SERVER_ERROR, <span class="string">"5xx"</span>);</span><br><span class="line">SERIES_VIEWS = Collections.unmodifiableMap(views);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveErrorView</span><span class="params">(HttpServletRequest request, HttpStatus status,</span></span></span><br><span class="line"><span class="function"><span class="params">Map&lt;String, Object&gt; model)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨HTTPå®Œæ•´çŠ¶æ€ç æ£€æŸ¥æ˜¯å¦æœ‰é¡µé¢å¯ä»¥åŒ¹é…</span></span><br><span class="line">ModelAndView modelAndView = resolve(String.valueOf(status.value()), model);</span><br><span class="line"><span class="keyword">if</span> (modelAndView == <span class="keyword">null</span> &amp;&amp; SERIES_VIEWS.containsKey(status.series())) &#123;</span><br><span class="line"><span class="comment">// ä½¿ç”¨ HTTP çŠ¶æ€ç ç¬¬ä¸€ä½åŒ¹é…åˆå§‹åŒ–ä¸­çš„å‚æ•°åˆ›å»ºè§†å›¾å¯¹è±¡</span></span><br><span class="line">            modelAndView = resolve(SERIES_VIEWS.get(status.series()), model);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> ModelAndView <span class="title">resolve</span><span class="params">(String viewName, Map&lt;String, Object&gt; model)</span> </span>&#123;</span><br><span class="line"><span class="comment">// æ‹¼æ¥é”™è¯¯è§†å›¾è·¯å¾„ /eroor/[viewname]</span></span><br><span class="line">        String errorViewName = <span class="string">"error/"</span> + viewName;</span><br><span class="line"><span class="comment">// ä½¿ç”¨æ¨¡ç‰ˆå¼•æ“å°è¯•åˆ›å»ºè§†å›¾å¯¹è±¡</span></span><br><span class="line">        TemplateAvailabilityProvider provider = <span class="keyword">this</span>.templateAvailabilityProviders</span><br><span class="line">.getProvider(errorViewName, <span class="keyword">this</span>.applicationContext);</span><br><span class="line"><span class="keyword">if</span> (provider != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(errorViewName, model);</span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment">// æ²¡æœ‰æ¨¡ç‰ˆå¼•æ“ï¼Œä½¿ç”¨é™æ€èµ„æºæ–‡ä»¶å¤¹è§£æè§†å›¾</span></span><br><span class="line"><span class="keyword">return</span> resolveResource(errorViewName, model);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> ModelAndView <span class="title">resolveResource</span><span class="params">(String viewName, Map&lt;String, Object&gt; model)</span> </span>&#123;</span><br><span class="line"><span class="comment">// éå†é™æ€èµ„æºæ–‡ä»¶å¤¹,æ£€æŸ¥æ˜¯å¦æœ‰å­˜åœ¨è§†å›¾</span></span><br><span class="line">        <span class="keyword">for</span> (String location : <span class="keyword">this</span>.resourceProperties.getStaticLocations()) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">Resource resource = <span class="keyword">this</span>.applicationContext.getResource(location);</span><br><span class="line">resource = resource.createRelative(viewName + <span class="string">".html"</span>);</span><br><span class="line"><span class="keyword">if</span> (resource.exists()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="keyword">new</span> HtmlResourceView(resource), model);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è€Œ Thymeleaf å¯¹äºé”™è¯¯é¡µé¢çš„è§£æå®ç°ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//org.springframework.boot.autoconfigure.thymeleaf.ThymeleafTemplateAvailabilityProvider</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThymeleafTemplateAvailabilityProvider</span></span></span><br><span class="line"><span class="class"><span class="keyword">implements</span> <span class="title">TemplateAvailabilityProvider</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isTemplateAvailable</span><span class="params">(String view, Environment environment,</span></span></span><br><span class="line"><span class="function"><span class="params">ClassLoader classLoader, ResourceLoader resourceLoader)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (ClassUtils.isPresent(<span class="string">"org.thymeleaf.spring5.SpringTemplateEngine"</span>,</span><br><span class="line">classLoader)) &#123;</span><br><span class="line">String prefix = environment.getProperty(<span class="string">"spring.thymeleaf.prefix"</span>,</span><br><span class="line">ThymeleafProperties.DEFAULT_PREFIX);</span><br><span class="line">String suffix = environment.getProperty(<span class="string">"spring.thymeleaf.suffix"</span>,</span><br><span class="line">ThymeleafProperties.DEFAULT_SUFFIX);</span><br><span class="line"><span class="keyword">return</span> resourceLoader.getResource(prefix + view + suffix).exists();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»è€Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œé”™è¯¯é¡µé¢é¦–å…ˆä¼šæ£€æŸ¥<code>æ¨¡ç‰ˆå¼•æ“</code>æ–‡ä»¶å¤¹ä¸‹çš„ <code>/error/HTTPçŠ¶æ€ç </code> æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ£€æŸ¥å»æ¨¡ç‰ˆå¼•æ“ä¸‹çš„<code>/error/4xx</code>æˆ–è€… <code>/error/5xx</code> æ–‡ä»¶ï¼Œå¦‚æœè¿˜ä¸å­˜åœ¨ï¼Œåˆ™æ£€æŸ¥<code>é™æ€èµ„æº</code>æ–‡ä»¶å¤¹ä¸‹å¯¹åº”çš„ä¸Šè¿°æ–‡ä»¶ã€‚</p><h2 id="2-è‡ªå®šä¹‰å¼‚å¸¸é¡µé¢"><a href="#2-è‡ªå®šä¹‰å¼‚å¸¸é¡µé¢" class="headerlink" title="2. è‡ªå®šä¹‰å¼‚å¸¸é¡µé¢"></a>2. è‡ªå®šä¹‰å¼‚å¸¸é¡µé¢</h2><p>ç»è¿‡ä¸Šé¢çš„ SpringBoot é”™è¯¯æœºåˆ¶æºç åˆ†æï¼ŒçŸ¥é“å½“é‡åˆ°é”™è¯¯æƒ…å†µæ—¶å€™ï¼ŒSpringBoot ä¼šé¦–å…ˆè¿”å›åˆ°<code>æ¨¡ç‰ˆå¼•æ“</code>æ–‡ä»¶å¤¹ä¸‹çš„ <code>/error/HTTP</code>çŠ¶æ€ç  æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ£€æŸ¥å»æ¨¡ç‰ˆå¼•æ“ä¸‹çš„<code>/error/4xx</code>æˆ–è€… <code>/error/5xx</code> æ–‡ä»¶ï¼Œå¦‚æœè¿˜ä¸å­˜åœ¨ï¼Œåˆ™æ£€æŸ¥<code>é™æ€èµ„æº</code>æ–‡ä»¶å¤¹ä¸‹å¯¹åº”çš„ä¸Šè¿°æ–‡ä»¶ã€‚å¹¶ä¸”åœ¨è¿”å›æ—¶ä¼šå…±äº«ä¸€äº›é”™è¯¯ä¿¡æ¯ï¼Œè¿™äº›é”™è¯¯ä¿¡æ¯å¯ä»¥åœ¨æ¨¡ç‰ˆå¼•æ“ä¸­ç›´æ¥ä½¿ç”¨ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">errorAttributes.put(<span class="string">"timestamp"</span>, <span class="keyword">new</span> Date());</span><br><span class="line">errorAttributes.put(<span class="string">"status"</span>, status);</span><br><span class="line">errorAttributes.put(<span class="string">"error"</span>, HttpStatus.valueOf(status).getReasonPhrase());</span><br><span class="line">errorAttributes.put(<span class="string">"errors"</span>, result.getAllErrors());</span><br><span class="line">errorAttributes.put(<span class="string">"exception"</span>, error.getClass().getName());</span><br><span class="line">errorAttributes.put(<span class="string">"message"</span>, error.getMessage());</span><br><span class="line">errorAttributes.put(<span class="string">"trace"</span>, stackTrace.toString());</span><br><span class="line">errorAttributes.put(<span class="string">"path"</span>, path);</span><br></pre></td></tr></table></figure></p><p>å› æ­¤ï¼Œéœ€è¦è‡ªå®šä¹‰é”™è¯¯é¡µé¢ï¼Œåªéœ€è¦åœ¨æ¨¡ç‰ˆæ–‡ä»¶å¤¹ä¸‹çš„ error æ–‡ä»¶å¤¹ä¸‹é˜²æ­¢4xx æˆ–è€… 5xx æ–‡ä»¶å³å¯ã€‚<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>[[$&#123;status&#125;]]<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Bootstrap core CSS --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/webjars/bootstrap/4.1.3/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"m-5"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>é”™è¯¯ç ï¼š[[$&#123;status&#125;]]<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> &gt;</span>ä¿¡æ¯ï¼š[[$&#123;message&#125;]]<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> &gt;</span>æ—¶é—´ï¼š[[$&#123;#dates.format(timestamp,'yyyy-MM-dd hh:mm:ss ')&#125;]]<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> &gt;</span>è¯·æ±‚è·¯å¾„ï¼š[[$&#123;path&#125;]]<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>éšæ„è®¿é—®ä¸å­˜åœ¨è·¯å¾„å¾—åˆ°ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/6ceefac5c6b7a0a8c7ab800e718c033d.png" alt="Spring Boot è‡ªå®šä¹‰é”™è¯¯é¡µé¢"><br>å‘ç°é”™è¯¯é¡µé¢å·²ç»è·³è½¬åˆ°æˆ‘ä»¬çš„è‡ªå®šä¹‰é¡µé¢ã€‚</p><h2 id="3-è‡ªå®šä¹‰é”™è¯¯JSON"><a href="#3-è‡ªå®šä¹‰é”™è¯¯JSON" class="headerlink" title="3. è‡ªå®šä¹‰é”™è¯¯JSON"></a>3. è‡ªå®šä¹‰é”™è¯¯JSON</h2><p>æ ¹æ®ä¸Šé¢çš„ SpringBoot é”™è¯¯å¤„ç†åŸç†åˆ†æï¼Œå¾—çŸ¥æœ€ç»ˆè¿”å›çš„ JSON ä¿¡æ¯æ˜¯ä»ä¸€ä¸ª map å¯¹è±¡ä¸­è½¬æ¢å‡ºæ¥çš„ï¼Œé‚£ä¹ˆï¼Œåªè¦èƒ½è‡ªå®šä¹‰ map ä¸­çš„å€¼ï¼Œå°±å¯ä»¥è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯çš„ json æ ¼å¼äº†ã€‚ç›´æ¥é‡å†™ <code>DefaultErrorAttributes</code>ç±»çš„  <code>getErrorAttributes</code> æ–¹æ³•å³å¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.error.DefaultErrorAttributes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.WebRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯JSONå€¼</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/7 15:21</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorAttributesCustom</span> <span class="keyword">extends</span> <span class="title">DefaultErrorAttributes</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getErrorAttributes</span><span class="params">(WebRequest webRequest, <span class="keyword">boolean</span> includeStackTrace)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">super</span>.getErrorAttributes(webRequest, includeStackTrace);</span><br><span class="line">        String code = map.get(<span class="string">"status"</span>).toString();</span><br><span class="line">        String message = map.get(<span class="string">"error"</span>).toString();</span><br><span class="line">        HashMap&lt;String, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">"code"</span>, code);</span><br><span class="line">        hashMap.put(<span class="string">"message"</span>, message);</span><br><span class="line">        <span class="keyword">return</span> hashMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ postman è¯·æ±‚æµ‹è¯•ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/1ba2dec88ba06b58011350b31a93e5e1.png" alt="Postman æµ‹è¯•ç»“æœ"></p><h2 id="4-ç»Ÿä¸€å¼‚å¸¸å¤„ç†"><a href="#4-ç»Ÿä¸€å¼‚å¸¸å¤„ç†" class="headerlink" title="4. ç»Ÿä¸€å¼‚å¸¸å¤„ç†"></a>4. ç»Ÿä¸€å¼‚å¸¸å¤„ç†</h2><p>ä½¿ç”¨ <code>@ControllerAdvice</code> ç»“åˆ<code>@ExceptionHandler</code> æ³¨è§£å¯ä»¥å®ç°ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†ï¼Œ<code>@ExceptionHandler</code>æ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨åº”ç”¨åœ¨æ¯ä¸€ä¸ªè¢« <code>@RequestMapping</code> æ³¨è§£çš„æ–¹æ³•ã€‚å½“ç¨‹åºä¸­å‡ºç°å¼‚å¸¸æ—¶ä¼šå±‚å±‚ä¸ŠæŠ›<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Response;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.enums.ResponseEnum;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.utils.ResponseUtill;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/7 14:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionHandle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(Exception.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">handleException</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"å¼‚å¸¸ &#123;&#125;"</span>, e);</span><br><span class="line">        <span class="keyword">if</span> (e <span class="keyword">instanceof</span> BaseException) &#123;</span><br><span class="line">            BaseException exception = (BaseException) e;</span><br><span class="line">            String code = exception.getCode();</span><br><span class="line">            String message = exception.getMessage();</span><br><span class="line">            <span class="keyword">return</span> ResponseUtill.error(code, message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseUtill.error(ResponseEnum.UNKNOW_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¯·æ±‚å¼‚å¸¸é¡µé¢å¾—åˆ°å“åº”å¦‚ä¸‹ã€‚<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="attr">"code"</span>: <span class="string">"-1"</span>,</span><br><span class="line"> <span class="attr">"data"</span>: [],</span><br><span class="line"> <span class="attr">"message"</span>: <span class="string">"æœªçŸ¥é”™è¯¯"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-error" target="_blank" rel="noopener">Spring Boot Webå¼€å‘ - é”™è¯¯æœºåˆ¶</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç›¸ä¿¡å¤§å®¶åœ¨åˆšå¼€å§‹ä½“éªŒ Springboot çš„æ—¶å€™ä¸€å®šä¼šç»å¸¸ç¢°åˆ°è¿™ä¸ªé¡µé¢ï¼Œä¹Ÿå°±æ˜¯è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢çš„é»˜è®¤è¿”å›é¡µé¢ã€‚&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/992cd6d0f9f75737d1088523d80a64c1.png&quot; alt=&quot;Spring Boot é»˜è®¤é”™è¯¯é¡µé¢&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆå…­ï¼‰web å¼€å‘ä¹‹æ‹¦æˆªå™¨å’Œä¸‰å¤§ç»„ä»¶</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-06-web-filter-apo-webbase/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-06-web-filter-apo-webbase/</id>
    <published>2019-02-21T00:32:01.000Z</published>
    <updated>2019-05-20T16:26:48.618Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ‹¦æˆªå™¨"><a href="#1-æ‹¦æˆªå™¨" class="headerlink" title="1. æ‹¦æˆªå™¨"></a>1. æ‹¦æˆªå™¨</h2><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/e678416c36eaf0969de279423d0e1d16.png" alt="">Springboot ä¸­çš„ Interceptor æ‹¦æˆªå™¨ä¹Ÿå°±æ˜¯ mvc ä¸­çš„æ‹¦æˆªå™¨ï¼Œåªæ˜¯çœå»äº† xml é…ç½®éƒ¨åˆ†ã€‚å¹¶æ²¡æœ‰æœ¬è´¨çš„ä¸åŒï¼Œéƒ½æ˜¯é€šè¿‡å®ç° HandlerInterceptor ä¸­å‡ ä¸ªæ–¹æ³•å®ç°ã€‚å‡ ä¸ªæ–¹æ³•çš„ä½œç”¨ä¸€ä¸€å¦‚ä¸‹ã€‚</p><ol><li><strong>preHandle</strong><br>è¿›å…¥ Habdler æ–¹æ³•ä¹‹å‰æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºèº«ä»½è®¤è¯æˆæƒç­‰ã€‚</li><li><strong>postHandle</strong><br>è¿›å…¥ Handler æ–¹æ³•ä¹‹åè¿”å› modelAndView ä¹‹å‰æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºå¡å…¥å…¬å…±æ¨¡å‹æ•°æ®ç­‰ã€‚</li><li><strong>afterCompletion</strong><br>æœ€åå¤„ç†ï¼Œä¸€èˆ¬ç”¨äºæ—¥å¿—æ”¶é›†ï¼Œç»Ÿä¸€åç»­å¤„ç†ç­‰ã€‚<a id="more"></a></li></ol><h3 id="1-1-å¼•å…¥ä¾èµ–"><a href="#1-1-å¼•å…¥ä¾èµ–" class="headerlink" title="1.1 å¼•å…¥ä¾èµ–"></a>1.1 å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="1-2-ç¼–å†™æ‹¦æˆªå™¨"><a href="#1-2-ç¼–å†™æ‹¦æˆªå™¨" class="headerlink" title="1.2 ç¼–å†™æ‹¦æˆªå™¨"></a>1.2 ç¼–å†™æ‹¦æˆªå™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/6 16:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·æ±‚æ–¹æ³•æ‰§è¡Œä¹‹å‰</span></span><br><span class="line"><span class="comment">     * è¿”å›trueåˆ™é€šè¿‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> </span>&#123;</span><br><span class="line">        StringBuffer requestURL = request.getRequestURL();</span><br><span class="line">        log.info(<span class="string">"preHandleè¯·æ±‚URLï¼š"</span> + requestURL.toString());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›modelAndViewä¹‹å‰æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> modelAndView</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"postHandleè¿”å›modelAndViewä¹‹å‰"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡ŒHandlerå®Œæˆæ‰§è¡Œæ­¤æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ex</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"afterCompletionæ‰§è¡Œå®Œè¯·æ±‚æ–¹æ³•å®Œå…¨è¿”å›ä¹‹å"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-é…ç½®æ‹¦æˆªå™¨"><a href="#1-3-é…ç½®æ‹¦æˆªå™¨" class="headerlink" title="1.3 é…ç½®æ‹¦æˆªå™¨"></a>1.3 é…ç½®æ‹¦æˆªå™¨</h3><p>çœå»äº† XML ä¸­çš„æ‹¦æˆªå™¨é…ç½®éƒ¨åˆ†åï¼Œä½¿ç”¨ springboot æ¨èçš„æ–¹å¼é…ç½®è‡ªå®šä¹‰æ‹¦æˆªå™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.config;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.serializer.SerializerFeature;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.support.config.FastJsonConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1.ä½¿ç”¨FastJSON</span></span><br><span class="line"><span class="comment"> * 2.é…ç½®æ—¶é—´æ ¼å¼åŒ–</span></span><br><span class="line"><span class="comment"> * 3.è§£å†³ä¸­æ–‡ä¹±ç </span></span><br><span class="line"><span class="comment"> * 4.æ·»åŠ è‡ªå®šä¹‰æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/13 15:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰JSONè½¬æ¢å™¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converters</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</span><br><span class="line">        FastJsonHttpMessageConverter converter = <span class="keyword">new</span> FastJsonHttpMessageConverter();</span><br><span class="line">        FastJsonConfig fastJsonConfig = <span class="keyword">new</span> FastJsonConfig();</span><br><span class="line">        fastJsonConfig.setSerializerFeatures(SerializerFeature.PrettyFormat);</span><br><span class="line">        <span class="comment">//æ—¥æœŸæ ¼å¼åŒ–</span></span><br><span class="line">        fastJsonConfig.setDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        <span class="comment">//å¤„ç†ä¸­æ–‡ä¹±ç é—®é¢˜</span></span><br><span class="line">        List&lt;MediaType&gt; fastMediaTypes = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        fastMediaTypes.add(MediaType.APPLICATION_JSON_UTF8);</span><br><span class="line"></span><br><span class="line">        converter.setSupportedMediaTypes(fastMediaTypes);</span><br><span class="line">        converter.setFastJsonConfig(fastJsonConfig);</span><br><span class="line">        converters.add(converter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ è‡ªå®šä¹‰æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment">     * .addPathPatterns("/**")  æ‹¦æˆªçš„è¯·æ±‚è·¯å¾„</span></span><br><span class="line"><span class="comment">     * .excludePathPatterns("/user"); æ’é™¤çš„è¯·æ±‚è·¯å¾„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> registry</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> LogHandlerInterceptor())</span><br><span class="line">                .addPathPatterns(<span class="string">"/**"</span>)</span><br><span class="line">                .excludePathPatterns(<span class="string">"/user"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-åˆ‡é¢ç¼–ç¨‹"><a href="#2-åˆ‡é¢ç¼–ç¨‹" class="headerlink" title="2 åˆ‡é¢ç¼–ç¨‹"></a>2 åˆ‡é¢ç¼–ç¨‹</h2><ol><li>AOPï¼šé¢å‘åˆ‡é¢ï¼ˆæ–¹é¢ï¼‰ç¼–ç¨‹ï¼Œæ‰©å±•åŠŸèƒ½ä¸ä¿®æ”¹æºä»£ç å®ç°</li><li>AOPé‡‡å–æ¨ªå‘æŠ½å–æœºåˆ¶ï¼Œå–ä»£äº†ä¼ ç»Ÿçºµå‘ç»§æ‰¿ä½“ç³»é‡å¤æ€§ä»£ç </li><li>AOPåº•å±‚ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°<ul><li>æœ‰æ¥å£æƒ…å†µä½¿ç”¨åŠ¨æ€ä»£ç†åˆ›å»ºæ¥å£å®ç°ç±»ä»£ç†å¯¹è±¡</li><li>æ²¡æœ‰æ¥å£æƒ…å†µä½¿ç”¨åŠ¨æ€ä»£ç†åˆ›å»ºç±»çš„å­ç±»ä»£ç†å¯¹è±¡</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨AOPè®°å½•è®¿é—®æ—¥å¿—</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨<span class="doctag">@Before</span>åœ¨åˆ‡å…¥ç‚¹å¼€å§‹å¤„åˆ‡å…¥å†…å®¹</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨<span class="doctag">@After</span>åœ¨åˆ‡å…¥ç‚¹ç»“å°¾å¤„åˆ‡å…¥å†…å®¹</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨<span class="doctag">@AfterReturning</span>åœ¨åˆ‡å…¥ç‚¹returnå†…å®¹ä¹‹ååˆ‡å…¥å†…å®¹ï¼ˆå¯ä»¥ç”¨æ¥å¯¹å¤„ç†è¿”å›å€¼åšä¸€äº›åŠ å·¥å¤„ç†ï¼‰</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨<span class="doctag">@Around</span>åœ¨åˆ‡å…¥ç‚¹å‰ååˆ‡å…¥å†…å®¹ï¼Œå¹¶è‡ªå·±æ§åˆ¶ä½•æ—¶æ‰§è¡Œåˆ‡å…¥ç‚¹è‡ªèº«çš„å†…å®¹</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨<span class="doctag">@AfterThrowing</span>ç”¨æ¥å¤„ç†å½“åˆ‡å…¥å†…å®¹éƒ¨åˆ†æŠ›å‡ºå¼‚å¸¸ä¹‹åçš„å¤„ç†é€»è¾‘</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ³¨è§£ï¼š</span></span><br><span class="line"><span class="comment"> * Aspect:AOP</span></span><br><span class="line"><span class="comment"> * Componentï¼šBean</span></span><br><span class="line"><span class="comment"> * Slf4jï¼šå¯ä»¥ç›´æ¥ä½¿ç”¨logè¾“å‡ºæ—¥å¿—</span></span><br><span class="line"><span class="comment"> * Orderï¼šå¤šä¸ªAOPåˆ‡åŒä¸€ä¸ªæ–¹æ³•æ—¶çš„ä¼˜å…ˆçº§ï¼Œè¶Šå°ä¼˜å…ˆçº§è¶Šé«˜è¶Šå¤§ã€‚</span></span><br><span class="line"><span class="comment"> * åœ¨åˆ‡å…¥ç‚¹å‰çš„æ“ä½œï¼ŒæŒ‰orderçš„å€¼ç”±å°åˆ°å¤§æ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> * åœ¨åˆ‡å…¥ç‚¹åçš„æ“ä½œï¼ŒæŒ‰orderçš„å€¼ç”±å¤§åˆ°å°æ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/4 23:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Order</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogAspect</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çº¿ç¨‹å­˜æ”¾ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ThreadLocal&lt;Long&gt; startTime = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®šä¹‰åˆ‡å…¥ç‚¹</span></span><br><span class="line"><span class="comment">     * ç¬¬ä¸€ä¸ª*ï¼šæ ‡è¯†æ‰€æœ‰è¿”å›ç±»å‹</span></span><br><span class="line"><span class="comment">     * å­—æ¯è·¯å¾„ï¼šåŒ…è·¯å¾„</span></span><br><span class="line"><span class="comment">     * ä¸¤ä¸ªç‚¹..ï¼šå½“å‰åŒ…ä»¥åŠå­åŒ…</span></span><br><span class="line"><span class="comment">     * ç¬¬äºŒä¸ª*ï¼šæ‰€æœ‰çš„ç±»</span></span><br><span class="line"><span class="comment">     * ç¬¬ä¸‰ä¸ª*ï¼šæ‰€æœ‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * æœ€åçš„ä¸¤ä¸ªç‚¹ï¼šæ‰€æœ‰ç±»å‹çš„å‚æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(public * net.codingme.boot.controller..*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">webLog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨åˆ‡å…¥ç‚¹å¼€å§‹å¤„åˆ‡å…¥å†…å®¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBefore</span><span class="params">(JoinPoint joinPoint)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è®°å½•è¯·æ±‚æ—¶é—´</span></span><br><span class="line">        startTime.set(System.currentTimeMillis());</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚åŸŸ</span></span><br><span class="line">        ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">        HttpServletRequest request = requestAttributes.getRequest();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®°å½•è¯·æ±‚å†…å®¹</span></span><br><span class="line">        log.info(<span class="string">"Aspect-URL: "</span> + request.getRequestURI().toLowerCase());</span><br><span class="line">        log.info(<span class="string">"Aspect-HTTP_METHOD: "</span> + request.getMethod());</span><br><span class="line">        log.info(<span class="string">"Aspect-IP: "</span> + request.getRemoteAddr());</span><br><span class="line">        log.info(<span class="string">"Aspect-REQUEST_METHOD: "</span> + joinPoint.getSignature().getDeclaringTypeName() + <span class="string">"."</span> + joinPoint.getSignature().getName());</span><br><span class="line">        log.info(<span class="string">"Aspect-Args: "</span> + Arrays.toString(joinPoint.getArgs()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨åˆ‡å…¥ç‚¹ä¹‹åå¤„ç†å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfter</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨åˆ‡å…¥ç‚¹returnå†…å®¹ä¹‹ååˆ‡å…¥å†…å®¹ï¼ˆå¯ä»¥ç”¨æ¥å¯¹å¤„ç†è¿”å›å€¼åšä¸€äº›åŠ å·¥å¤„ç†ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterReturning</span>(returning = <span class="string">"ret"</span>, pointcut = <span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterReturning</span><span class="params">(Object ret)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Aspect-Response: "</span> + ret);</span><br><span class="line">        Long endTime = System.currentTimeMillis();</span><br><span class="line">        log.info(<span class="string">"Aspect-SpeedTime: "</span> + (endTime - startTime.get()) + <span class="string">"ms"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—®æŸ¥çœ‹æ‹¦æˆªå™¨å’Œ AOP çš„æ—¥å¿—è¾“å‡ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">09:57:15.408  INFO 2836 --- [nio-8080-exec-1] n.c.boot.config.LogHandlerInterceptor    : preHandleè¯·æ±‚URLï¼šhttp://localhost:8080/</span><br><span class="line">09:57:15.413  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-URL: /</span><br><span class="line">09:57:15.413  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-HTTP_METHOD: GET</span><br><span class="line">09:57:15.413  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-IP: 0:0:0:0:0:0:0:1</span><br><span class="line">09:57:15.414  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-REQUEST_METHOD: net.codingme.boot.controller.HelloController.index</span><br><span class="line">09:57:15.415  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-Args: []</span><br><span class="line">09:57:15.424  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-Response: Greetings from Spring Boot!SpringBootæ˜¯ä¸€ä¸ªspringåº”ç”¨ç¨‹åº</span><br><span class="line">09:57:15.425  INFO 2836 --- [nio-8080-exec-1] net.codingme.boot.config.LogAspect       : Aspect-SpeedTime: 12ms</span><br><span class="line">09:57:15.436  INFO 2836 --- [nio-8080-exec-1] n.c.boot.config.LogHandlerInterceptor    : postHandleè¿”å›modelAndViewä¹‹å‰</span><br><span class="line">09:57:15.437  INFO 2836 --- [nio-8080-exec-1] n.c.boot.config.LogHandlerInterceptor    : afterCompletionæ‰§è¡Œå®Œè¯·æ±‚æ–¹æ³•å®Œå…¨è¿”å›ä¹‹å</span><br></pre></td></tr></table></figure><h2 id="3-Servlet-Filter-Listener"><a href="#3-Servlet-Filter-Listener" class="headerlink" title="3. Servlet,Filter,Listener"></a>3. Servlet,Filter,Listener</h2><p>Servlet, Filter, Listener æ˜¯ Java web çš„æ ¸å¿ƒå†…å®¹ï¼Œé‚£ä¹ˆåœ¨ Springboot ä¸­å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ</p><h3 id="3-1-ç¼–å†™-Servlet"><a href="#3-1-ç¼–å†™-Servlet" class="headerlink" title="3.1 ç¼–å†™ Servlet"></a>3.1 ç¼–å†™ Servlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@WebServlet</span>(urlPatterns = "/myservlet") // å®šä¹‰è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/24 16:25</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@WebServlet</span>(urlPatterns = <span class="string">"/myservlet"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Servlet å¼€å§‹åˆå§‹åŒ–"</span>);</span><br><span class="line">        <span class="keyword">super</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Servlet å¼€å§‹å¤„ç† GET æ–¹æ³•"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"Hello Servlet"</span>);</span><br><span class="line">        writer.flush();</span><br><span class="line">        writer.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPut</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Servlet å¼€å§‹é”€æ¯"</span>);</span><br><span class="line">        <span class="keyword">super</span>.destroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-ç¼–å†™-Filter"><a href="#3-2-ç¼–å†™-Filter" class="headerlink" title="3.2 ç¼–å†™ Filter"></a>3.2 ç¼–å†™ Filter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/24 16:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@WebFilter</span>(urlPatterns = <span class="string">"/*"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        log.info(<span class="string">"æ‹¦æˆªå™¨å¼€å§‹æ‹¦æˆª"</span>);</span><br><span class="line">        filterChain.doFilter(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-ç¼–å†™-Listener"><a href="#3-3-ç¼–å†™-Listener" class="headerlink" title="3.3 ç¼–å†™ Listener"></a>3.3 ç¼–å†™ Listener</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebListener;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/24 16:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyListener</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"ç›‘å¬å™¨å¼€å§‹åˆå§‹åŒ–"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"ç›‘å¬å™¨å¼€å§‹é”€æ¯"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-æ·»åŠ åˆ°å®¹å™¨"><a href="#3-4-æ·»åŠ åˆ°å®¹å™¨" class="headerlink" title="3.4 æ·»åŠ åˆ°å®¹å™¨"></a>3.4 æ·»åŠ åˆ°å®¹å™¨</h3><p>æ·»åŠ åˆ°å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§ä½¿ç”¨æ³¨è§£æ‰«æã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ServletComponentScan</span> æ‰«æServlet,Filter,Listener æ·»åŠ åˆ°å®¹å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ServletComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨é…ç½®ç±»æƒ³å®¹å™¨ä¸­æ·»åŠ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * åœ¨è¿™é‡Œæ³¨å†ŒServlet Filter Listener æˆ–è€…ä½¿ç”¨ <span class="doctag">@ServletComponentScan</span></span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/24 16:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebCoreConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">myServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ServletRegistrationBean&lt;&gt;(<span class="keyword">new</span> MyServlet());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">myFitler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;(<span class="keyword">new</span> MyFilter());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletListenerRegistrationBean <span class="title">myListener</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ServletListenerRegistrationBean(<span class="keyword">new</span> MyListener());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°ç›‘å¬å™¨å¯åŠ¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">11:35:03.744  INFO 8616 --- [           main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1364 ms</span><br><span class="line">11:35:03.798  INFO 8616 --- [           main] net.codingme.boot.listener.MyListener    : ç›‘å¬å™¨å¼€å§‹åˆå§‹åŒ–</span><br><span class="line">11:35:03.892  INFO 8616 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService &apos;applicationTaskExecutor&apos;</span><br><span class="line">11:35:04.055  INFO 8616 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path &apos;&apos;</span><br></pre></td></tr></table></figure><p>è®¿é—® Servlet å¯ä»¥çœ‹åˆ°æ‹¦æˆªå™¨å’Œ Servlet ç”Ÿæ•ˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">11:36:55.552  INFO 3760 --- [nio-8080-exec-1] net.codingme.boot.servlet.MyServlet      : Servlet å¼€å§‹åˆå§‹åŒ–</span><br><span class="line">11:36:55.556  INFO 3760 --- [nio-8080-exec-1] net.codingme.boot.filter.MyFilter        : æ‹¦æˆªå™¨å¼€å§‹æ‹¦æˆª</span><br><span class="line">11:36:55.556  INFO 3760 --- [nio-8080-exec-1] net.codingme.boot.servlet.MyServlet      : Servlet å¼€å§‹å¤„ç† GET æ–¹æ³•</span><br></pre></td></tr></table></figure><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-interceptor" target="_blank" rel="noopener">Spring Boot Webå¼€å‘ - æ‹¦æˆªå¤„ç†</a>ã€‚<br>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-servlet-filter-listener" target="_blank" rel="noopener">Spring Boot Webå¼€å‘ - Servlet,Filter,Listener</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-æ‹¦æˆªå™¨&quot;&gt;&lt;a href=&quot;#1-æ‹¦æˆªå™¨&quot; class=&quot;headerlink&quot; title=&quot;1. æ‹¦æˆªå™¨&quot;&gt;&lt;/a&gt;1. æ‹¦æˆªå™¨&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/e678416c36eaf0969de279423d0e1d16.png&quot; alt=&quot;&quot;&gt;Springboot ä¸­çš„ Interceptor æ‹¦æˆªå™¨ä¹Ÿå°±æ˜¯ mvc ä¸­çš„æ‹¦æˆªå™¨ï¼Œåªæ˜¯çœå»äº† xml é…ç½®éƒ¨åˆ†ã€‚å¹¶æ²¡æœ‰æœ¬è´¨çš„ä¸åŒï¼Œéƒ½æ˜¯é€šè¿‡å®ç° HandlerInterceptor ä¸­å‡ ä¸ªæ–¹æ³•å®ç°ã€‚å‡ ä¸ªæ–¹æ³•çš„ä½œç”¨ä¸€ä¸€å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;preHandle&lt;/strong&gt;&lt;br&gt;è¿›å…¥ Habdler æ–¹æ³•ä¹‹å‰æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºèº«ä»½è®¤è¯æˆæƒç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;postHandle&lt;/strong&gt;&lt;br&gt;è¿›å…¥ Handler æ–¹æ³•ä¹‹åè¿”å› modelAndView ä¹‹å‰æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äºå¡å…¥å…¬å…±æ¨¡å‹æ•°æ®ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;afterCompletion&lt;/strong&gt;&lt;br&gt;æœ€åå¤„ç†ï¼Œä¸€èˆ¬ç”¨äºæ—¥å¿—æ”¶é›†ï¼Œç»Ÿä¸€åç»­å¤„ç†ç­‰ã€‚
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆäº”ï¼‰web å¼€å‘ä¹‹é™æ€èµ„æºå’Œæ¨¡ç‰ˆå¼•æ“</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-05-web-static-template/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-05-web-static-template/</id>
    <published>2019-02-15T14:32:01.000Z</published>
    <updated>2019-05-20T16:26:48.610Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Spring Boot å¤©ç”Ÿçš„é€‚åˆ web åº”ç”¨å¼€å‘ï¼Œå®ƒå¯ä»¥å¿«é€Ÿçš„åµŒå…¥ Tomcat, Jetty  æˆ– Netty ç”¨äºåŒ…å«ä¸€ä¸ª HTTP æœåŠ¡å™¨ã€‚ä¸”å¼€å‘ååˆ†ç®€å•ï¼Œåªéœ€è¦å¼•å…¥ web å¼€å‘æ‰€éœ€çš„åŒ…ï¼Œç„¶åç¼–å†™ä¸šåŠ¡ä»£ç å³å¯ã€‚</p><h2 id="è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ"><a href="#è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ" class="headerlink" title="è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ"></a><strong>è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ</strong></h2><p>åœ¨è¿›è¡Œ web å¼€å‘ä¹‹å‰è®©æˆ‘å†æ¥å›é¡¾ä¸€ä¸‹è‡ªåŠ¨é…ç½®ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¸‰ç¯‡ã€‚Spring Boot ä¸º Spring MVC æä¾›äº†è‡ªåŠ¨é…ç½®ï¼Œæ·»åŠ äº†å¦‚ä¸‹çš„åŠŸèƒ½ï¼š</p><ul><li>è§†å›¾è§£æçš„æ”¯æŒã€‚</li><li>é™æ€èµ„æºæ˜ å°„ï¼ŒWebJars çš„æ”¯æŒã€‚</li><li>è½¬æ¢å™¨ Converter çš„æ”¯æŒã€‚</li><li>è‡ªå®šä¹‰ Favicon çš„æ”¯æŒã€‚</li><li>ç­‰ç­‰<a id="more"></a>åœ¨å¼•å…¥æ¯ä¸ªåŒ…æ—¶å€™æˆ‘ä»¬éœ€è¦æ€è€ƒæ˜¯å¦‚ä½•å®ç°è‡ªåŠ¨é…ç½®çš„ï¼Œä»¥åŠæˆ‘ä»¬èƒ½è‡ªå·±æ¥é…ç½®å“ªäº›ä¸œè¥¿ï¼Œè¿™æ ·å¼€å‘èµ·æ¥æ‰ä¼šå¾—å¿ƒåº”æ‰‹ã€‚</li></ul><p><a href="https://docs.spring.io/spring-boot/docs/2.1.x/reference/html/boot-features-developing-web-applications.html" target="_blank" rel="noopener">å…³äº Spring Boot Web å¼€å‘çš„æ›´è¯¦ç»†ä»‹ç»å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚</a></p><h2 id="1-JSON-æ ¼å¼è½¬æ¢"><a href="#1-JSON-æ ¼å¼è½¬æ¢" class="headerlink" title="1. JSON æ ¼å¼è½¬æ¢"></a>1. JSON æ ¼å¼è½¬æ¢</h2><p>Spring Boot é»˜è®¤ä½¿ç”¨ Jackson è¿›è¡Œ JSON åŒ–å¤„ç†ï¼Œå¦‚æœæƒ³è¦åˆ‡æ¢æˆ FastJson å¯ä»¥é¦–å…ˆä»<a href="https://docs.spring.io/spring-boot/docs/2.1.x/reference/html/howto-spring-mvc.html#howto-customize-the-responsebody-rendering" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>é‡ŒæŸ¥è¯¢ä¿¡æ¯ã€‚ä»è¿™é‡ŒçŸ¥é“å¯¹äº ResponseBody çš„æ¸²æŸ“ä¸»è¦æ˜¯é€šè¿‡ HttpMessageConvertersï¼Œ è€Œé¦–å…ˆå¼•å…¥FastJson Pomä¾èµ–å¹¶æ’é™¤ Spring Boot è‡ªå¸¦çš„ Jacksonã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™è½¬æ¢å™¨å¤„ç† json çš„æ—¥æœŸæ ¼å¼åŒæ—¶å¤„ç†ä¸­æ–‡ä¹±ç é—®é¢˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰JSONè½¬æ¢å™¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converters</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</span><br><span class="line">        FastJsonHttpMessageConverter converter = <span class="keyword">new</span> FastJsonHttpMessageConverter();</span><br><span class="line">        FastJsonConfig fastJsonConfig = <span class="keyword">new</span> FastJsonConfig();</span><br><span class="line">        fastJsonConfig.setSerializerFeatures(SerializerFeature.PrettyFormat);</span><br><span class="line">        <span class="comment">//æ—¥æœŸæ ¼å¼åŒ–</span></span><br><span class="line">        fastJsonConfig.setDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        <span class="comment">//å¤„ç†ä¸­æ–‡ä¹±ç é—®é¢˜</span></span><br><span class="line">        List&lt;MediaType&gt; fastMediaTypes = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        fastMediaTypes.add(MediaType.APPLICATION_JSON_UTF8);</span><br><span class="line"></span><br><span class="line">        converter.setSupportedMediaTypes(fastMediaTypes);</span><br><span class="line">        converter.setFastJsonConfig(fastJsonConfig);</span><br><span class="line"></span><br><span class="line">        converters.add(converter);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-é™æ€èµ„æºæ˜ å°„"><a href="#2-é™æ€èµ„æºæ˜ å°„" class="headerlink" title="2. é™æ€èµ„æºæ˜ å°„"></a>2. é™æ€èµ„æºæ˜ å°„</h2><blockquote><p>By default, Spring Boot serves static content from a directory called <code>/static</code> (or <code>/public</code> or <code>/resources</code> or <code>/META-INF/resources</code>) in the classpath or from the root of the <code>ServletContext</code>.</p></blockquote><h3 id="2-1-é»˜è®¤æ˜ å°„"><a href="#2-1-é»˜è®¤æ˜ å°„" class="headerlink" title="2.1 é»˜è®¤æ˜ å°„"></a>2.1 é»˜è®¤æ˜ å°„</h3><p>å®˜æ–¹æ–‡æ¡£å‘Šè¯‰æˆ‘ä»¬ Spring Boot å¯¹äºé™æ€èµ„æºçš„æ˜ å°„ç›®å½•æ˜¯ /static , /public , /resources ä»¥åŠ /META-INF/resourceã€‚é™¤æ­¤ä¹‹å¤–å…¶å®è¿˜æ˜ å°„äº† <code>/webjars/**</code> åˆ° <code>classpath:/META-INF/resources/webjars</code>ã€‚</p><p>å¾ˆæ˜æ˜¾æ­¤å¤„æ˜¯è‡ªåŠ¨é…ç½®å®ç°çš„ï¼Œé€šè¿‡æŸ¥çœ‹æºç åˆ†æè¿™æ®µé…ç½®ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/746f53d54281496bb8aafcc2e7f1ada6.png" alt="Mvcé™æ€èµ„æºæ˜ å°„"></p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/03afb17acb7e7a3ccd45a5b434f111d1.png" alt="Mvcé™æ€èµ„æºæ˜ å°„"></p><p>è€Œå¯¹äºç½‘ç«™å›¾æ ‡ï¼ŒSpring Boot ä¹Ÿå·²ç»é…ç½®äº†é»˜è®¤ä½ç½®ï¼Œå¯ä»¥åœ¨çœ‹åˆ°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// path: org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SimpleUrlHandlerMapping <span class="title">faviconHandlerMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">SimpleUrlHandlerMapping mapping = <span class="keyword">new</span> SimpleUrlHandlerMapping();</span><br><span class="line">mapping.setOrder(Ordered.HIGHEST_PRECEDENCE + <span class="number">1</span>);</span><br><span class="line">mapping.setUrlMap(Collections.singletonMap(<span class="string">"**/favicon.ico"</span>, <span class="comment">// å›¾è¡¨</span></span><br><span class="line">faviconRequestHandler()));</span><br><span class="line"><span class="keyword">return</span> mapping;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ResourceHttpRequestHandler <span class="title">faviconRequestHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">ResourceHttpRequestHandler requestHandler = <span class="keyword">new</span> ResourceHttpRequestHandler();</span><br><span class="line">requestHandler.setLocations(resolveFaviconLocations());</span><br><span class="line"><span class="keyword">return</span> requestHandler;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> List&lt;Resource&gt; <span class="title">resolveFaviconLocations</span><span class="params">()</span> </span>&#123;</span><br><span class="line">String[] staticLocations = getResourceLocations(</span><br><span class="line"><span class="keyword">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">List&lt;Resource&gt; locations = <span class="keyword">new</span> ArrayList&lt;&gt;(staticLocations.length + <span class="number">1</span>);</span><br><span class="line">Arrays.stream(staticLocations).map(<span class="keyword">this</span>.resourceLoader::getResource)</span><br><span class="line">.forEach(locations::add);</span><br><span class="line">locations.add(<span class="keyword">new</span> ClassPathResource(<span class="string">"/"</span>));</span><br><span class="line"><span class="keyword">return</span> Collections.unmodifiableList(locations);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ® Spring Boot é»˜è®¤çš„é™æ€èµ„æºæ˜ å°„è§„åˆ™ï¼Œå¯ä»¥ç›´æ¥æŠŠéœ€è¦çš„é™æ€èµ„æºæ”¾åœ¨å“åº”çš„æ–‡ä»¶å¤¹ä¸‹ç„¶åç›´æ¥å¼•ç”¨å³å¯ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/4d1f6c2368dce288a2187741fc4dc0c7.png" alt="é™æ€èµ„æºæ˜ å°„"></p><p>è€Œæ”¾åœ¨ Public æ–‡ä»¶å¤¹ä¸‹çš„ HTML é¡µé¢ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/79377b2dadbeee45f00da8921190938b.png" alt="é™æ€èµ„æºæ˜ å°„"></p><h3 id="2-2-webjars"><a href="#2-2-webjars" class="headerlink" title="2.2 webjars"></a>2.2 webjars</h3><p><a href="https://www.webjars.org/" target="_blank" rel="noopener">webjars</a> çš„æ€æƒ³æ˜¯æŠŠé™æ€èµ„æºæ‰“åŒ…åˆ° Jar åŒ…ä¸­ï¼Œç„¶åä½¿ç”¨ JVM æ„å»ºå·¥å…·è¿›è¡Œç®¡ç†ï¼Œå¦‚ maven , Gradle ç­‰ã€‚</p><p>ä½¿ç”¨ webjars ç¬¬ä¸€æ­¥éœ€è¦è¿›å…¥ä¾èµ–ï¼Œå¦‚è¦ä½¿ç”¨ bootstrapã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- Web Jars é™æ€èµ„æºæ–‡ä»¶ --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥ä¹‹åæŸ¥çœ‹ bootstrap èµ„æºã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/3626437cd5104cea9ed5a82ea25aac0c.png" alt="WebJars å¼•å…¥ bootstrap"></p><p>ç”±äº Springboot æ˜ å°„äº† <code>/webjars/**</code> åˆ° <code>classpath:/META-INF/resources/webjars</code>. å› æ­¤å¯ä»¥ç›´æ¥åœ¨æ–‡ä»¶ä¸­å¼•ç”¨ webjars çš„é™æ€èµ„æºã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Bootstrap core CSS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/webjars/bootstrap/4.1.3/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/webjars/bootstrap/4.1.3/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-æ¨¡ç‰ˆå¼•æ“"><a href="#3-æ¨¡ç‰ˆå¼•æ“" class="headerlink" title="3. æ¨¡ç‰ˆå¼•æ“"></a>3. æ¨¡ç‰ˆå¼•æ“</h2><p>Spring MVC æ”¯æŒå„ç§æ¨¡ç‰ˆæŠ€æœ¯ï¼Œå¦‚ Thymeleaf , FreeMarker , JSP ç­‰ã€‚è€ŒThyemeleaf åŸå‹å³é¡µé¢çš„ç‰¹æ€§æˆ–è®¸æ›´ç¬¦åˆ Spring Boot å¿«é€Ÿå¼€å‘çš„æ€æƒ³è€Œè¢«å®˜æ–¹æ¨èã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/02c76ef91580600fb7265155822d5619.png" alt="æ¨¡ç‰ˆå¼•æ“åŸç†"></p><p><a href="https://www.thymeleaf.org/" target="_blank" rel="noopener">Thymeleaf</a> æ˜¯é€‚ç”¨äº Web å¼€å‘çš„æœåŠ¡ç«¯ Java æ¨¡ç‰ˆå¼•æ“ï¼ŒThymeleaf ä¸ºå¼€å‘å·¥ä½œæµç¨‹å¸¦æ¥ä¼˜é›…è‡ªç„¶çš„æ¨¡ç‰ˆï¼Œç”±äºå…¶éä¾µå…¥çš„ç‰¹æ€§ï¼Œå¯ä»¥è®©é¡µé¢ä¸ç®¡æ˜¯åœ¨é™æ€åŸå‹ä¸‹è¿˜æ˜¯ç”¨ä½œæ¨¡ç‰ˆå¼•æ“æ—¶éƒ½æœ‰è‰¯å¥½çš„é¡µé¢å±•ç°ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">th:text</span>=<span class="string">"#&#123;msgs.headers.name&#125;"</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">th:text</span>=<span class="string">"#&#123;msgs.headers.price&#125;"</span>&gt;</span>Price<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"prod: $&#123;allProducts&#125;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;prod.name&#125;"</span>&gt;</span>Oranges<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#numbers.formatDecimal(prod.price, 1, 2)&#125;"</span>&gt;</span>0.99<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-1-å¼•å…¥-Thymeleaf"><a href="#3-1-å¼•å…¥-Thymeleaf" class="headerlink" title="3.1 å¼•å…¥ Thymeleaf"></a>3.1 å¼•å…¥ Thymeleaf</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- thymeleaf æ¨¡ç‰ˆ--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-ä½¿ç”¨-Thymeleaf"><a href="#3-2-ä½¿ç”¨-Thymeleaf" class="headerlink" title="3.2 ä½¿ç”¨ Thymeleaf"></a>3.2 ä½¿ç”¨ Thymeleaf</h3><p>æ ¹æ® Spring Boot è‡ªåŠ¨é…ç½®åŸç†ï¼Œå…ˆçœ‹ä¸€ä¸‹ Thymeleaf çš„é…ç½®ç±»ï¼Œä»ä¸­å¯ä»¥çœ‹å‡º Thymeleaf çš„ç›¸å…³é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥çŸ¥é“ é»˜è®¤å­˜æ”¾ç›®å½•æ˜¯ templates æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶åç¼€ä¸º <code>.html</code> ä¸”å¼€å¯äº†ç¼“å­˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.thymeleaf"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThymeleafProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_ENCODING = StandardCharsets.UTF_8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PREFIX = <span class="string">"classpath:/templates/"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SUFFIX = <span class="string">".html"</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Whether to enable template caching.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> cache = <span class="keyword">true</span>;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†åœ¨å¼€å‘ä¸­ç¼–å†™æ¨¡ç‰ˆæ–‡ä»¶æ—¶ä¸ç”¨é‡å¯ï¼Œå¯ä»¥åœ¨é…ç½®ä¸­å…³é—­ç¼“å­˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å…³é—­æ¨¡ç‰ˆç¼“å­˜</span><br><span class="line">spring.thymeleaf.cache=false</span><br><span class="line"># å¦‚æœéœ€è¦è¿›è¡Œå…¶ä»–çš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒé…ç½®ç±»ï¼šThymeleafProperties</span><br><span class="line"># org.springframework.boot.autoconfigure.thymeleaf.ThymeleafProperties</span><br></pre></td></tr></table></figure><p>ç¼–å†™ Controller å“åº”ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è·å–IDä¸º1çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@GetMapping</span>(value = <span class="string">"/user/1"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getUserById</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">      User user1 = <span class="keyword">new</span> User(<span class="string">"Darcy"</span>, <span class="string">"password"</span>, <span class="number">24</span>, <span class="keyword">new</span> Date(), Arrays.asList(<span class="string">"Java"</span>, <span class="string">"GoLang"</span>));</span><br><span class="line">      User user2 = <span class="keyword">new</span> User(<span class="string">"Chris"</span>, <span class="string">"password"</span>, <span class="number">22</span>, <span class="keyword">new</span> Date(), Arrays.asList(<span class="string">"Java"</span>, <span class="string">"Web"</span>));</span><br><span class="line">      ArrayList&lt;User&gt; userList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      userList.add(user1);</span><br><span class="line">      userList.add(user2);</span><br><span class="line">      model.addAttribute(<span class="string">"userList"</span>, userList);</span><br><span class="line">      model.addAttribute(<span class="string">"user"</span>, user1);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"user"</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å› ä¸º Thymelaf é»˜è®¤æ¨¡ç‰ˆä½ç½®åœ¨ templates æ–‡ä»¶å¤¹ä¸‹ï¼Œå› æ­¤åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ç¼–å†™é¡µé¢ä¿¡æ¯ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Thymeleaf çš„åŸºæœ¬ä½¿ç”¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥JSæ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;script th:src="@&#123;/static/js/alert.js&#125;"&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Hello Thymeleaf Index<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åç§°ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:id</span>=<span class="string">"$&#123;user.username&#125;"</span> <span class="attr">th:name</span>=<span class="string">"$&#123;user.username&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;user.username&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    ç”¨æˆ·æŠ€èƒ½ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">"$&#123;user.skills&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">"$&#123;user.age&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    ç”¨æˆ·ç”Ÿæ—¥ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">"$&#123;#dates.format(user.birthday,'yyyy-MM-dd hh:mm:ss ')&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:object</span>=<span class="string">"$&#123;user&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Hello Thymeleaf Index<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ç”¨æˆ·åç§°ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:id</span>=<span class="string">"*&#123;username&#125;"</span> <span class="attr">th:name</span>=<span class="string">"*&#123;username&#125;"</span> <span class="attr">th:value</span>=<span class="string">"*&#123;username&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    ç”¨æˆ·æŠ€èƒ½ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">"*&#123;skills&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">"*&#123;age&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    ç”¨æˆ·ç”Ÿæ—¥ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">"*&#123;#dates.format(birthday,'yyyy-MM-dd hh:mm:ss')&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Text ä¸ utext<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- th:text æ˜¾ç¤ºHTMLæºç ï¼Œä½œä¸ºå­—ç¬¦ä¸² --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;user.username&#125;"</span>&gt;</span>abc<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;user.username&#125;"</span>&gt;</span>abc<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>URL çš„å¼•ç”¨<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;https://www.baidu.com&#125;"</span>&gt;</span>ç½‘ç«™ç½‘å€<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>è¡¨å•çš„ä½¿ç”¨<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">"@&#123;/th/postform&#125;"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;user&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        ç”¨æˆ·åç§°ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">th:field</span>=<span class="string">"*&#123;username&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        ç”¨æˆ·æŠ€èƒ½ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">th:field</span>=<span class="string">"*&#123;skills&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">th:field</span>=<span class="string">"*&#123;age&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>åˆ¤æ–­çš„ä½¿ç”¨<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user.age&#125; == 18"</span>&gt;</span>18å²äº†<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user.age&#125; gt 18"</span>&gt;</span>å¤§äº18å²<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user.age&#125; lt 18"</span>&gt;</span>å°äº18å²<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user.age&#125; ge 18"</span>&gt;</span>å¤§äºç­‰äº<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">"$&#123;user.age&#125; le 18"</span>&gt;</span>å°äºç­‰äº<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>é€‰æ‹©æ¡†<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>è¯·é€‰æ‹©ä¸€æœ¬ä¹¦<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">"$&#123;user.username eq 'admin'&#125;"</span>&gt;</span>ç®¡ç†å‘˜<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">"$&#123;user.username eq 'Darcy'&#125;"</span>&gt;</span>Darcy<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">"$&#123;user.username eq 'Chris'&#125;"</span>&gt;</span>Chris<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>éå†åŠŸèƒ½<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>ç”¨æˆ·åç§°<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>å¹´é¾„<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>æŠ€èƒ½<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"u:$&#123;userList&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;u.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;u.age&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;u.skills&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>SwitchåŠŸèƒ½<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:switch</span>=<span class="string">"$&#123;user.username&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">"'admin'"</span>&gt;</span>æ¬¢è¿ç®¡ç†å‘˜<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®é¡µé¢å¯ä»¥çœ‹åˆ°æ•°æ®æ­£å¸¸æ˜¾ç¤ºã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/5e7b0da4afded072ed59c42a34b3f7fc.png" alt="è®¿é—®é¡µé¢"></p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-staticfile" target="_blank" rel="noopener">Spring Boot Webå¼€å‘ - é™æ€èµ„æº</a>ã€‚<br>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-template" target="_blank" rel="noopener">Spring Boot Webå¼€å‘ - æ¨¡ç‰ˆå¼•æ“</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;Spring Boot å¤©ç”Ÿçš„é€‚åˆ web åº”ç”¨å¼€å‘ï¼Œå®ƒå¯ä»¥å¿«é€Ÿçš„åµŒå…¥ Tomcat, Jetty  æˆ– Netty ç”¨äºåŒ…å«ä¸€ä¸ª HTTP æœåŠ¡å™¨ã€‚ä¸”å¼€å‘ååˆ†ç®€å•ï¼Œåªéœ€è¦å¼•å…¥ web å¼€å‘æ‰€éœ€çš„åŒ…ï¼Œç„¶åç¼–å†™ä¸šåŠ¡ä»£ç å³å¯ã€‚&lt;/p&gt;
&lt;h2 id=&quot;è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ&quot;&gt;&lt;a href=&quot;#è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ&quot;&gt;&lt;/a&gt;&lt;strong&gt;è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;åœ¨è¿›è¡Œ web å¼€å‘ä¹‹å‰è®©æˆ‘å†æ¥å›é¡¾ä¸€ä¸‹è‡ªåŠ¨é…ç½®ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¸‰ç¯‡ã€‚Spring Boot ä¸º Spring MVC æä¾›äº†è‡ªåŠ¨é…ç½®ï¼Œæ·»åŠ äº†å¦‚ä¸‹çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§†å›¾è§£æçš„æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;é™æ€èµ„æºæ˜ å°„ï¼ŒWebJars çš„æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;è½¬æ¢å™¨ Converter çš„æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰ Favicon çš„æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;ç­‰ç­‰
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆå››ï¼‰Spring Boot æ—¥å¿—æ¡†æ¶</title>
    <link href="https://www.codingme.net/2019/01/springboot/springboot04-log/"/>
    <id>https://www.codingme.net/2019/01/springboot/springboot04-log/</id>
    <published>2019-01-15T14:02:02.000Z</published>
    <updated>2019-05-20T16:26:48.668Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ <strong>v2.1.1.RELEASE</strong> è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/6ceaab90e32e1c0de8dd4ed097900509.png" alt="">Spring æ¡†æ¶é€‰æ‹©ä½¿ç”¨äº† JCL ä½œä¸ºé»˜è®¤æ—¥å¿—è¾“å‡ºã€‚è€Œ Spring Boot é»˜è®¤é€‰æ‹©äº† SLF4J ç»“åˆ LogBackã€‚é‚£æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­è¯¥ä½¿ç”¨å“ªç§æ—¥å¿—æ¡†æ¶å‘¢ï¼Ÿåœ¨å¯¹äºä¸åŒçš„ç¬¬ä¸‰æ–¹ jar ä½¿ç”¨äº†ä¸åŒçš„æ—¥å¿—æ¡†æ¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ<br><a id="more"></a></p><h2 id="1-æ—¥å¿—æ¡†æ¶ä»‹ç»"><a href="#1-æ—¥å¿—æ¡†æ¶ä»‹ç»" class="headerlink" title="1. æ—¥å¿—æ¡†æ¶ä»‹ç»"></a>1. æ—¥å¿—æ¡†æ¶ä»‹ç»</h2><p>æ—¥å¿—å¯¹äºåº”ç”¨ç¨‹åºçš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œä¸ç®¡æ˜¯è®°å½•è¿è¡Œæƒ…å†µè¿˜æ˜¯è¿½è¸ªçº¿ä¸Šé—®é¢˜ï¼Œéƒ½ç¦»ä¸å¼€å¯¹æ—¥å¿—çš„åˆ†æï¼Œåœ¨ Java é¢†åŸŸé‡Œå­˜åœ¨ç€å¤šç§æ—¥å¿—æ¡†æ¶ï¼Œå¦‚ JUL, Log4j, Log4j2, Commons Loggin, Slf4j, Logback ç­‰ã€‚å…³äº Log4j, Log4j2 å’Œ Slf4j ç›´æ¥çš„æ•…äº‹è¿™é‡Œä¸åšä»‹ç»ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œç™¾åº¦ã€‚</p><h2 id="2-SLF4-çš„ä½¿ç”¨"><a href="#2-SLF4-çš„ä½¿ç”¨" class="headerlink" title="2. SLF4 çš„ä½¿ç”¨"></a>2. SLF4 çš„ä½¿ç”¨</h2><p>åœ¨å¼€å‘çš„æ—¶å€™ä¸åº”è¯¥ç›´æ¥ä½¿ç”¨æ—¥å¿—å®ç°ç±»ï¼Œåº”è¯¥ä½¿ç”¨æ—¥å¿—çš„æŠ½è±¡å±‚ã€‚å…·ä½“å‚è€ƒ <a href="https://www.slf4j.org/manual.html" target="_blank" rel="noopener">SLF4J  å®˜æ–¹</a>ã€‚<br>ä¸‹å›¾æ˜¯ SLF4J ç»“åˆå„ç§æ—¥å¿—æ¡†æ¶çš„å®˜æ–¹ç¤ºä¾‹ï¼Œä»å›¾ä¸­å¯ä»¥æ¸…æ™°çš„çœ‹å‡º SLF4J API æ°¸è¿œä½œä¸ºæ—¥å¿—çš„é—¨é¢ï¼Œç›´æ¥åº”ç”¨ä¸åº”ç”¨ç¨‹åºä¸­ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/180c77a1bfd179623888aa83faf4519d.png" alt="SLF4"></p><p>åŒæ—¶ SLF4 å®˜æ–¹ç»™å‡ºäº†ç®€å•ç¤ºä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Logger logger = LoggerFactory.getLogger(HelloWorld.class);</span><br><span class="line">    logger.info(<span class="string">"Hello World"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦ä¸ºç³»ç»Ÿå¯¼å…¥ SLF4J çš„ jar å’Œ æ—¥å¿—æ¡†æ¶çš„å®ç° jar. ç”±äºæ¯ä¸€ä¸ªæ—¥å¿—çš„å®ç°æ¡†æ¶éƒ½æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ SLF4 ä¹‹åï¼Œé…ç½®æ–‡ä»¶è¿˜æ˜¯è¦ä½¿ç”¨å®ç°æ—¥å¿—æ¡†æ¶çš„é…ç½®æ–‡ä»¶ã€‚</p><h2 id="3-ç»Ÿä¸€æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨"><a href="#3-ç»Ÿä¸€æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨" class="headerlink" title="3. ç»Ÿä¸€æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨"></a>3. ç»Ÿä¸€æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨é¡¹ç›®ä¸­å­˜åœ¨ç€å„ç§ä¸åŒçš„ç¬¬ä¸‰æ–¹ jar ï¼Œä¸”å®ƒä»¬çš„æ—¥å¿—é€‰æ‹©ä¹Ÿå¯èƒ½ä¸å°½ç›¸åŒï¼Œæ˜¾ç„¶è¿™æ ·æ˜¯ä¸åˆ©äºæˆ‘ä»¬ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³ä¸ºé¡¹ç›®è®¾ç½®ç»Ÿä¸€çš„æ—¥å¿—æ¡†æ¶è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>åœ¨ <a href="https://www.slf4j.org/legacy.html" target="_blank" rel="noopener">SLF4J å®˜æ–¹</a>ï¼Œä¹Ÿç»™äº†æˆ‘ä»¬å‚è€ƒçš„ä¾‹å­ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/4d3f93aedfdfff372bf2908f5ef876bd.png" alt="Bridging legacy APIs">ä»å›¾ä¸­æˆ‘ä»¬å¾—åˆ°ä¸€ç§ç»Ÿä¸€æ—¥å¿—æ¡†æ¶ä½¿ç”¨çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç§å’Œè¦æ›¿æ¢çš„æ—¥å¿—æ¡†æ¶ç±»å®Œå…¨ä¸€æ ·çš„ jar è¿›è¡Œæ›¿æ¢ï¼Œè¿™æ ·ä¸è‡³äºåŸæ¥çš„ç¬¬ä¸‰æ–¹ jar æŠ¥é”™ï¼Œè€Œè¿™ä¸ªæ›¿æ¢çš„ jar å…¶å®ä½¿ç”¨äº† SLF4J API. è¿™æ ·é¡¹ç›®ä¸­çš„æ—¥å¿—å°±éƒ½å¯ä»¥é€šè¿‡ SLF4J API ç»“åˆè‡ªå·±é€‰æ‹©çš„æ¡†æ¶è¿›è¡Œæ—¥å¿—è¾“å‡ºã€‚<br><strong>ç»Ÿä¸€æ—¥å¿—æ¡†æ¶ä½¿ç”¨æ­¥éª¤å½’çº³å¦‚ä¸‹</strong>ï¼š</p><ol><li>æ’é™¤ç³»ç»Ÿä¸­çš„å…¶ä»–æ—¥å¿—æ¡†æ¶ã€‚</li><li>ä½¿ç”¨ä¸­é—´åŒ…æ›¿æ¢è¦æ›¿æ¢çš„æ—¥å¿—æ¡†æ¶ã€‚</li><li>å¯¼å…¥æˆ‘ä»¬é€‰æ‹©çš„ SLF4J å®ç°ã€‚</li></ol><h2 id="4-Spring-Boot-çš„æ—¥å¿—å…³ç³»"><a href="#4-Spring-Boot-çš„æ—¥å¿—å…³ç³»" class="headerlink" title="4. Spring Boot çš„æ—¥å¿—å…³ç³»"></a>4. Spring Boot çš„æ—¥å¿—å…³ç³»</h2><h3 id="4-1-æ’é™¤å…¶ä»–æ—¥å¿—æ¡†æ¶"><a href="#4-1-æ’é™¤å…¶ä»–æ—¥å¿—æ¡†æ¶" class="headerlink" title="4.1. æ’é™¤å…¶ä»–æ—¥å¿—æ¡†æ¶"></a>4.1. æ’é™¤å…¶ä»–æ—¥å¿—æ¡†æ¶</h3><p>æ ¹æ®ä¸Šé¢æ€»ç»“çš„è¦ç»Ÿä¸€æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨ï¼Œç¬¬ä¸€æ­¥è¦æ’é™¤å…¶ä»–çš„æ—¥å¿—æ¡†æ¶ï¼Œåœ¨ Spring Boot çš„ Maven ä¾èµ–é‡Œå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ° Spring Boot æ’é™¤äº†å…¶ä»–æ—¥å¿—æ¡†æ¶ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/f24ff63ebb75a90c0d85b3dd74840cb5.png" alt="Spring Boot æ’é™¤å…¶ä»–æ—¥å¿—æ¡†æ¶">æˆ‘ä»¬è‡ªè¡Œæ’é™¤ä¾èµ–æ—¶ä¹Ÿåªéœ€è¦æŒ‰ç…§å›¾ä¸­çš„æ–¹å¼å°±å¥½äº†ã€‚</p><h3 id="4-2-ç»Ÿä¸€æ¡†æ¶å¼•å…¥æ›¿æ¢åŒ…"><a href="#4-2-ç»Ÿä¸€æ¡†æ¶å¼•å…¥æ›¿æ¢åŒ…" class="headerlink" title="4.2. ç»Ÿä¸€æ¡†æ¶å¼•å…¥æ›¿æ¢åŒ…"></a>4.2. ç»Ÿä¸€æ¡†æ¶å¼•å…¥æ›¿æ¢åŒ…</h3><p>å…¶å® Spring Boot ä¹Ÿæ˜¯ä½¿ç”¨äº† SLF4J+logback çš„æ—¥å¿—æ¡†æ¶ç»„åˆï¼ŒæŸ¥çœ‹ Spring Boot é¡¹ç›®çš„ Maven ä¾èµ–å…³ç³»å¯ä»¥çœ‹åˆ° Spring Boot çš„æ ¸å¿ƒå¯åŠ¨å™¨ spring-boot-starter å¼•å…¥äº† spring-boot-starter-logging.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>è€Œ spring-boot-starter-logging çš„ Maven ä¾èµ–ä¸»è¦å¼•å…¥äº† logback-classic (åŒ…å«äº†æ—¥å¿—æ¡†æ¶ Logback çš„å®ç°)ï¼Œlog4j-to-slf4j (åœ¨ log4j æ—¥å¿—æ¡†æ¶ä½œè€…å¼€å‘æ­¤æ¡†æ¶çš„æ—¶å€™è¿˜æ²¡æœ‰æƒ³åˆ°ä½¿ç”¨æ—¥å¿—æŠ½è±¡å±‚è¿›è¡Œå¼€å‘ï¼Œå› æ­¤å‡ºç°äº† log4j å‘ slf4j è½¬æ¢çš„å·¥å…·)ï¼Œjul-to-slf4j ( Java è‡ªå¸¦çš„æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸º slf4j).<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-to-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jul-to-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä»ä¸Šé¢çš„åˆ†æï¼ŒSpring Boot å¯¹æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨å·²ç»æ˜¯æ¸…æ™°æ˜äº†äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ IDEA å·¥å…·æŸ¥çœ‹ Maven ä¾èµ–å…³ç³»ï¼Œå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°æ—¥å¿—æ¡†æ¶çš„å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰ IDEA å·¥å…·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Maven å‘½ä»¤æŸ¥çœ‹ä¾èµ–å…³ç³»ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn dependency:tree</span><br></pre></td></tr></table></figure></p><p><img src="https://user-images.githubusercontent.com/26371673/50733360-33660980-11c7-11e9-8742-1f24e7449db2.png" alt="Spring Boot Maven ä¾èµ–">ç”±æ­¤å¯è§ï¼ŒSpring Boot å¯ä»¥è‡ªåŠ¨çš„é€‚é…æ—¥å¿—æ¡†æ¶ï¼Œè€Œä¸”åº•å±‚ä½¿ç”¨ <strong>SLF4 + LogBack</strong> è®°å½•æ—¥å¿—ï¼Œå¦‚æœæˆ‘ä»¬è‡ªè¡Œå¼•å…¥å…¶ä»–æ¡†æ¶ï¼Œéœ€è¦æ’é™¤å…¶æ—¥å¿—æ¡†æ¶ã€‚</p><h2 id="5-Spring-Boot-çš„æ—¥å¿—ä½¿ç”¨"><a href="#5-Spring-Boot-çš„æ—¥å¿—ä½¿ç”¨" class="headerlink" title="5. Spring Boot çš„æ—¥å¿—ä½¿ç”¨"></a>5. Spring Boot çš„æ—¥å¿—ä½¿ç”¨</h2><h3 id="5-1-æ—¥å¿—çº§åˆ«å’Œæ ¼å¼"><a href="#5-1-æ—¥å¿—çº§åˆ«å’Œæ ¼å¼" class="headerlink" title="5.1. æ—¥å¿—çº§åˆ«å’Œæ ¼å¼"></a>5.1. æ—¥å¿—çº§åˆ«å’Œæ ¼å¼</h3><p>ä»ä¸Šé¢çš„åˆ†æï¼Œå‘ç° Spring Boot é»˜è®¤å·²ç»ä½¿ç”¨äº† <strong>SLF4J + LogBack</strong> . æ‰€ä»¥æˆ‘ä»¬åœ¨ä¸è¿›è¡Œä»»ä½•é¢å¤–æ“ä½œçš„æƒ…å†µä¸‹å°±å¯ä»¥ä½¿ç”¨ <strong>SLF4J + Logback</strong> è¿›è¡Œæ—¥å¿—è¾“å‡ºã€‚<br>ç¼–å†™ Java æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•æ—¥å¿—è¾“å‡ºï¼Œ</span></span><br><span class="line"><span class="comment"> * SLF4J æ—¥å¿—çº§åˆ«ä»å°åˆ°å¤§trace,debug,info,warn,error</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/11 21:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogbackTest</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        logger.trace(<span class="string">"Trace æ—¥å¿—..."</span>);</span><br><span class="line">        logger.debug(<span class="string">"Debug æ—¥å¿—..."</span>);</span><br><span class="line">        logger.info(<span class="string">"Info æ—¥å¿—..."</span>);</span><br><span class="line">        logger.warn(<span class="string">"Warn æ—¥å¿—..."</span>);</span><br><span class="line">        logger.error(<span class="string">"Error æ—¥å¿—..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å·²çŸ¥æ—¥å¿—çº§åˆ«ä»å°åˆ°å¤§ä¸º trace &lt; debug &lt; info &lt; warn &lt; error . è¿è¡Œå¾—åˆ°è¾“å‡ºå¦‚ä¸‹ã€‚ç”±æ­¤å¯è§  <strong><em>Spring Boot é»˜è®¤æ—¥å¿—çº§åˆ«ä¸º INFO</em></strong>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2018-12-11 23:02:58.028 [main] INFO  n.c.boot.LogbackTest - Info æ—¥å¿—...</span><br><span class="line">2018-12-11 23:02:58.029 [main] WARN  n.c.boot.LogbackTest - Warn æ—¥å¿—...</span><br><span class="line">2018-12-11 23:02:58.029 [main] ERROR n.c.boot.LogbackTest - Error æ—¥å¿—...</span><br></pre></td></tr></table></figure></p><p>ä»ä¸Šé¢çš„æ—¥å¿—ç»“åˆ Logback æ—¥å¿—æ ¼å¼å¯ä»¥çŸ¥é“ Spring Boot é»˜è®¤æ—¥å¿—æ ¼å¼æ˜¯ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span>d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n</span><br><span class="line"><span class="meta">#</span> %d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; æ—¶é—´</span><br><span class="line"><span class="meta">#</span> %thread çº¿ç¨‹åç§°</span><br><span class="line"><span class="meta">#</span> %-5level æ—¥å¿—çº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦</span><br><span class="line"><span class="meta">#</span> %logger&#123;50&#125; ç±»å</span><br><span class="line"><span class="meta">#</span> %msg%n æ—¥å¿—ä¿¡æ¯åŠ æ¢è¡Œ</span><br></pre></td></tr></table></figure></p><p>è‡³äºä¸ºä»€ä¹ˆ Spring Boot çš„é»˜è®¤æ—¥å¿—è¾“å‡ºæ ¼å¼æ˜¯è¿™æ ·ï¼Ÿ<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/09754e106f158d8e2dfcf540ca00cb2c.png" alt="Spring Boot é»˜è®¤æ—¥å¿—è¾“å‡º">æˆ‘ä»¬å¯ä»¥åœ¨ Spring Boot çš„æºç é‡Œæ‰¾åˆ°ç­”æ¡ˆã€‚</p><h3 id="5-2-è‡ªå®šä¹‰æ—¥å¿—è¾“å‡º"><a href="#5-2-è‡ªå®šä¹‰æ—¥å¿—è¾“å‡º" class="headerlink" title="5.2 è‡ªå®šä¹‰æ—¥å¿—è¾“å‡º"></a>5.2 è‡ªå®šä¹‰æ—¥å¿—è¾“å‡º</h3><p>å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ç¼–å†™æ—¥å¿—ç›¸å…³é…ç½®ã€‚<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ—¥å¿—é…ç½®</span></span><br><span class="line"><span class="comment"># æŒ‡å®šå…·ä½“åŒ…çš„æ—¥å¿—çº§åˆ«</span></span><br><span class="line"><span class="string">logging.level.net.codingme=debug</span></span><br><span class="line"><span class="comment"># æ§åˆ¶å°å’Œæ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼</span></span><br><span class="line"><span class="string">logging.pattern.console=%d&#123;yyyy-MM-dd</span> <span class="attr">HH:mm:ss.SSS&#125;</span> <span class="string">[%thread]</span> <span class="string">%-5level</span> <span class="string">%logger&#123;50&#125;</span> <span class="bullet">-</span> <span class="string">%msg%n</span></span><br><span class="line"><span class="string">logging.pattern.file=%d&#123;yyyy-MM-dd</span> <span class="attr">HH:mm:ss.SSS&#125;</span> <span class="string">[%thread]</span> <span class="string">%-5level</span> <span class="string">%logger&#123;50&#125;</span> <span class="bullet">-</span> <span class="string">%msg%n</span></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶å¤§å°</span></span><br><span class="line"><span class="string">logging.file.max-size=10MB</span></span><br><span class="line"><span class="comment"># ä¿ç•™çš„æ—¥å¿—æ—¶é—´</span></span><br><span class="line"><span class="string">logging.file.max-history=10</span></span><br><span class="line"><span class="comment"># æ—¥å¿—è¾“å‡ºè·¯å¾„ï¼Œé»˜è®¤æ–‡ä»¶spring.log</span></span><br><span class="line"><span class="string">logging.path=systemlog</span></span><br><span class="line"><span class="comment">#logging.file=log.log</span></span><br></pre></td></tr></table></figure></p><p>å…³äºæ—¥å¿—çš„è¾“å‡ºè·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ logging.file æˆ–è€… logging.path è¿›è¡Œå®šä¹‰ï¼Œä¸¤è€…å­˜åœ¨å…³ç³»å¦‚ä¸‹è¡¨ã€‚</p><table><thead><tr><th><code>logging.file</code></th><th><code>logging.path</code></th><th>ä¾‹å­</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>ï¼ˆæ²¡æœ‰ï¼‰</em></td><td><em>ï¼ˆæ²¡æœ‰ï¼‰</em></td><td></td><td>ä»…æ§åˆ¶å°è®°å½•ã€‚</td></tr><tr><td>å…·ä½“æ–‡ä»¶</td><td><em>ï¼ˆæ²¡æœ‰ï¼‰</em></td><td><code>my.log</code></td><td>å†™å…¥æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶ï¼Œåç§°å¯ä»¥æ˜¯ç²¾ç¡®ä½ç½®æˆ–ç›¸å¯¹äºå½“å‰ç›®å½•ã€‚</td></tr><tr><td><em>ï¼ˆæ²¡æœ‰ï¼‰</em></td><td>å…·ä½“ç›®å½•</td><td><code>/var/log</code></td><td>å†™å…¥<code>spring.log</code>æŒ‡å®šçš„ç›®å½•ï¼Œåç§°å¯ä»¥æ˜¯ç²¾ç¡®ä½ç½®æˆ–ç›¸å¯¹äºå½“å‰ç›®å½•ã€‚</td></tr></tbody></table><h2 id="6-æ›¿æ¢æ—¥å¿—æ¡†æ¶"><a href="#6-æ›¿æ¢æ—¥å¿—æ¡†æ¶" class="headerlink" title="6. æ›¿æ¢æ—¥å¿—æ¡†æ¶"></a>6. æ›¿æ¢æ—¥å¿—æ¡†æ¶</h2><p>å› ä¸º Log4j æ—¥å¿—æ¡†æ¶å·²ç»å¹´ä¹…å¤±ä¿®ï¼ŒåŸä½œè€…éƒ½è§‰å¾—å†™çš„ä¸å¥½ï¼Œæ‰€ä»¥ä¸‹é¢æ¼”ç¤ºæ›¿æ¢æ—¥å¿—æ¡†æ¶ä¸º Log4j2 çš„æ–¹å¼ã€‚æ ¹æ®<a href="https://docs.spring.io/spring-boot/docs/2.1.x/reference/html/using-boot-build-systems.html#using-boot-starter" target="_blank" rel="noopener">å®˜ç½‘</a>æˆ‘ä»¬ Log4j2 ä¸ logging éœ€è¦äºŒé€‰ä¸€ï¼Œå› æ­¤ä¿®æ”¹ pomå¦‚ä¸‹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-logback" target="_blank" rel="noopener">Spring Boot æ—¥å¿—ç³»ç»Ÿ</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ &lt;strong&gt;v2.1.1.RELEASE&lt;/strong&gt; è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/6ceaab90e32e1c0de8dd4ed097900509.png&quot; alt=&quot;&quot;&gt;Spring æ¡†æ¶é€‰æ‹©ä½¿ç”¨äº† JCL ä½œä¸ºé»˜è®¤æ—¥å¿—è¾“å‡ºã€‚è€Œ Spring Boot é»˜è®¤é€‰æ‹©äº† SLF4J ç»“åˆ LogBackã€‚é‚£æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­è¯¥ä½¿ç”¨å“ªç§æ—¥å¿—æ¡†æ¶å‘¢ï¼Ÿåœ¨å¯¹äºä¸åŒçš„ç¬¬ä¸‰æ–¹ jar ä½¿ç”¨äº†ä¸åŒçš„æ—¥å¿—æ¡†æ¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆä¸‰ï¼‰Spring Boot è‡ªåŠ¨é…ç½®</title>
    <link href="https://www.codingme.net/2019/01/springboot/springboot03-auto-config/"/>
    <id>https://www.codingme.net/2019/01/springboot/springboot03-auto-config/</id>
    <published>2019-01-10T15:01:01.000Z</published>
    <updated>2019-05-20T16:26:48.664Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ <strong>v2.1.1.RELEASE</strong> è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/90be321394ddff7aa6dfdc9910888fda.png" alt=""></p><p>å…³äºé…ç½®æ–‡ä»¶å¯ä»¥é…ç½®çš„å†…å®¹ï¼Œåœ¨ <a href="https://docs.spring.io/spring-boot/docs/2.1.1.RELEASE/reference/htmlsingle/#common-application-properties" target="_blank" rel="noopener">Spring Boot å®˜æ–¹ç½‘ç«™</a>å·²ç»æä¾›äº†å®Œæ•´äº†é…ç½®ç¤ºä¾‹å’Œè§£é‡Šã€‚</p><p>å¯ä»¥è¿™ä¹ˆè¯´ï¼ŒSpring Boot çš„ä¸€å¤§ç²¾é«“å°±æ˜¯è‡ªåŠ¨é…ç½®ï¼Œä¸ºå¼€å‘çœå»äº†å¤§é‡çš„é…ç½®æ—¶é—´ï¼Œå¯ä»¥æ›´å¿«çš„èå…¥ä¸šåŠ¡é€»è¾‘çš„å¼€å‘ï¼Œé‚£ä¹ˆè‡ªåŠ¨é…ç½®æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ<br><a id="more"></a></p><h2 id="1-SpringBootApplication"><a href="#1-SpringBootApplication" class="headerlink" title="1.  @SpringBootApplication"></a>1.  <code>@SpringBootApplication</code></h2><p>è·Ÿç€ Spring Boot çš„å¯åŠ¨ç±»çš„æ³¨è§£ <code>@SpringBootApplication</code> è¿›è¡Œæºç è·Ÿè¸ªï¼Œå¯»æ‰¾è‡ªåŠ¨é…ç½®çš„åŸç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan</span>(</span><br><span class="line">    excludeFilters = &#123;<span class="meta">@Filter</span>(</span><br><span class="line">    type = FilterType.CUSTOM,</span><br><span class="line">    classes = &#123;TypeExcludeFilter.class&#125;</span><br><span class="line">), <span class="meta">@Filter</span>(</span><br><span class="line">    type = FilterType.CUSTOM,</span><br><span class="line">    classes = &#123;AutoConfigurationExcludeFilter.class&#125;</span><br><span class="line">)&#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootApplication &#123;</span><br></pre></td></tr></table></figure><p><code>@EnableAutoConfiguration</code> å¼€å¯è‡ªåŠ¨é…ç½®ã€‚</p><p><code>@ComponentScan</code> å¼€å¯æ³¨è§£æ‰«æ</p><p>ä» <code>SpringBootApplication</code> æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€ä¾¿çš„æ³¨è§£é…ç½®ï¼Œå®ƒåŒ…å«äº†è‡ªåŠ¨é…ç½®ï¼Œé…ç½®ç±»ï¼ŒåŒ…æ‰«æç­‰ä¸€ç³»åˆ—åŠŸèƒ½ã€‚</p><h2 id="2-EnableAutoConfiguration"><a href="#2-EnableAutoConfiguration" class="headerlink" title="2. @EnableAutoConfiguration"></a>2. <code>@EnableAutoConfiguration</code></h2><p>ç»§ç»­è·Ÿè¸ªï¼ŒæŸ¥çœ‹<code>@EnableAutoConfiguration</code> æºç ï¼Œé‡Œé¢æ¯”è¾ƒé‡è¦çš„æ˜¯ <code>@Import</code> ï¼Œå¯¼å…¥äº†ä¸€ä¸ªç¿»è¯‘åä¸ºè‡ªåŠ¨é…ç½®çš„é€‰æ‹©å™¨çš„ç±»ã€‚è¿™ä¸ªç±»å…¶å®å°±æ˜¯è‡ªåŠ¨é…ç½®çš„åŠ è½½é€‰æ‹©å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@AutoConfigurationPackage</span></span><br><span class="line"><span class="meta">@Import</span>(&#123;AutoConfigurationImportSelector.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableAutoConfiguration &#123;</span><br><span class="line">    String ENABLED_OVERRIDE_PROPERTY = <span class="string">"spring.boot.enableautoconfiguration"</span>;</span><br><span class="line"></span><br><span class="line">    Class&lt;?&gt;[] exclude() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    String[] excludeName() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§ç»­è·Ÿè¸ª <code>AutoConfigurationImportSelector.class</code> .åœ¨è¿™ä¸ªç±»æœ‰ä¸€ä¸ªé‡è¦çš„æ–¹æ³• <code>getCandidateConfigurations</code>.ç”¨äºåŠ è½½ Spring Boot é…ç½®çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</p><p><code>getAutoConfigurationEntry</code> ä¼šç­›é€‰å‡ºæœ‰æ•ˆçš„è‡ªåŠ¨é…ç½®ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> AutoConfigurationEntry <span class="title">getAutoConfigurationEntry</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">AutoConfigurationMetadata autoConfigurationMetadata,</span></span></span><br><span class="line"><span class="function"><span class="params">AnnotationMetadata annotationMetadata)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!isEnabled(annotationMetadata)) &#123;</span><br><span class="line"><span class="keyword">return</span> EMPTY_ENTRY;</span><br><span class="line">&#125;</span><br><span class="line">AnnotationAttributes attributes = getAttributes(annotationMetadata);</span><br><span class="line">List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata,</span><br><span class="line">attributes);</span><br><span class="line">configurations = removeDuplicates(configurations);</span><br><span class="line">Set&lt;String&gt; exclusions = getExclusions(annotationMetadata, attributes);</span><br><span class="line">checkExcludedClasses(configurations, exclusions);</span><br><span class="line">configurations.removeAll(exclusions);</span><br><span class="line">configurations = filter(configurations, autoConfigurationMetadata);</span><br><span class="line">fireAutoConfigurationImportEvents(configurations, exclusions);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AutoConfigurationEntry(configurations, exclusions);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> List&lt;String&gt; <span class="title">getCandidateConfigurations</span><span class="params">(AnnotationMetadata metadata,</span></span></span><br><span class="line"><span class="function"><span class="params">AnnotationAttributes attributes)</span> </span>&#123;</span><br><span class="line">List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(</span><br><span class="line">getSpringFactoriesLoaderFactoryClass(), getBeanClassLoader());</span><br><span class="line">Assert.notEmpty(configurations,</span><br><span class="line"><span class="string">"No auto configuration classes found in META-INF/spring.factories. If you "</span></span><br><span class="line">+ <span class="string">"are using a custom packaging, make sure that file is correct."</span>);</span><br><span class="line"><span class="keyword">return</span> configurations;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹å›¾æ˜¯ DEBUG æ¨¡å¼ä¸‹ç­›é€‰ä¹‹åçš„ç»“æœï¼Œå› ä¸ºæˆ‘åªæ·»åŠ äº† web æ¨¡å—ï¼Œæ‰€ä»¥åªæœ‰ web ç›¸å…³çš„è‡ªåŠ¨é…ç½®ã€‚</p><p><img src="https://user-images.githubusercontent.com/26371673/50733348-ec781400-11c6-11e9-8f0d-01797d797d69.png" alt="ç­›é€‰è¿‡åçš„è‡ªåŠ¨é…ç½®"></p><h2 id="3-xxxAutoConfiguration-ä¸-xxxProperties"><a href="#3-xxxAutoConfiguration-ä¸-xxxProperties" class="headerlink" title="3. xxxAutoConfiguration ä¸ xxxProperties"></a>3. xxxAutoConfiguration ä¸ xxxProperties</h2><p>åœ¨ä¸Šé¢çš„ debug é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æˆåŠŸåŠ è½½çš„è‡ªåŠ¨é…ç½®ï¼Œç›®å‰åªçœ‹åˆ°äº†é…ç½®ç±»ï¼Œå´è¿˜æ²¡æœ‰å‘ç°è‡ªåŠ¨é…ç½®å€¼ï¼Œéšä¾¿é€‰æ‹©ä¸€ä¸ª <code>AutoConfiguration</code> æŸ¥çœ‹æºç ã€‚</p><p>è¿™é‡Œé€‰æ‹©äº† <code>ServletWebServerFactoryAutoConfiguration</code>.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@AutoConfigureOrder</span>(Ordered.HIGHEST_PRECEDENCE)</span><br><span class="line"><span class="comment">//åˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ²¡æœ‰è¿™ä¸ªç±»</span></span><br><span class="line"><span class="comment">//CharacterEncodingFilterï¼›SpringMVCä¸­è¿›è¡Œä¹±ç è§£å†³çš„è¿‡æ»¤å™¨ï¼›</span></span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(ServletRequest.class)</span><br><span class="line"><span class="comment">//Springåº•å±‚@Conditionalæ³¨è§£ï¼ˆSpringæ³¨è§£ç‰ˆï¼‰ï¼Œæ ¹æ®ä¸åŒçš„æ¡ä»¶ï¼Œå¦‚æœ</span></span><br><span class="line"><span class="comment">//æ»¡è¶³æŒ‡å®šçš„æ¡ä»¶ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„é…ç½®å°±ä¼šç”Ÿæ•ˆï¼› åˆ¤æ–­å½“å‰åº”ç”¨æ˜¯å¦æ˜¯webåº”ç”¨ï¼Œå¦‚æœæ˜¯ï¼Œå½“å‰é…ç½®ç±»ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication</span>(type = Type.SERVLET)</span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(ServerProperties.class)</span><br><span class="line"><span class="meta">@Import</span>(&#123; ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class,</span><br><span class="line">ServletWebServerFactoryConfiguration.EmbeddedTomcat.class,</span><br><span class="line">ServletWebServerFactoryConfiguration.EmbeddedJetty.class,</span><br><span class="line">ServletWebServerFactoryConfiguration.EmbeddedUndertow.class &#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletWebServerFactoryAutoConfiguration</span> </span>&#123;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ <code>@EnableConfigurationProperties(ServerProperties.class)</code>.ä»–çš„æ„æ€æ˜¯å¯åŠ¨æŒ‡å®šç±»çš„<br><code>ConfigurationProperties</code>åŠŸèƒ½ï¼›å°†é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„å€¼å’Œ <code>ServerProperties</code> ç»‘å®šèµ·æ¥ï¼›å¹¶æŠŠ<br><code>ServerProperties</code> åŠ å…¥åˆ° IOC å®¹å™¨ä¸­ã€‚</p><p>å†æ¥çœ‹ä¸€ä¸‹ <code>ServerProperties</code> .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"server"</span>, ignoreUnknownFields = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Server HTTP port.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Integer port;</span><br></pre></td></tr></table></figure><p>æ˜¾è€Œæ˜“è§äº†ï¼Œè¿™é‡Œä½¿ç”¨ ConfigurationProperties ç»‘å®šå±æ€§æ˜ å°„æ–‡ä»¶ä¸­çš„ server å¼€å¤´çš„å±æ€§ã€‚ç»“åˆé»˜è®¤é…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># è·¯å¾„spring-boot-autoconfigure-2.1.1.RELEASE.jar</span><br><span class="line"># /META-INF/spring-configuration-metadata.json</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;server.port&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;java.lang.Integer&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Server HTTP port.&quot;,</span><br><span class="line">      &quot;sourceType&quot;: &quot;org.springframework.boot.autoconfigure.web.ServerProperties&quot;,</span><br><span class="line">      &quot;defaultValue&quot;: 8080</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>è¾¾åˆ°äº†è‡ªåŠ¨é…ç½®çš„ç›®çš„ã€‚</p><h2 id="4-è‡ªåŠ¨é…ç½®æ€»ç»“"><a href="#4-è‡ªåŠ¨é…ç½®æ€»ç»“" class="headerlink" title="4. è‡ªåŠ¨é…ç½®æ€»ç»“"></a>4. è‡ªåŠ¨é…ç½®æ€»ç»“</h2><ol><li>SpringBoot å¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ @EnableAutoConfiguration ã€‚</li><li>@EnableAutoConfiguration  ç»™å®¹å™¨å¯¼å…¥META-INF/spring.factories  é‡Œå®šä¹‰çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li><li>ç­›é€‰æœ‰æ•ˆçš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li><li>æ¯ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»ç»“åˆå¯¹åº”çš„ xxxProperties.java è¯»å–é…ç½®æ–‡ä»¶è¿›è¡Œè‡ªåŠ¨é…ç½®åŠŸèƒ½ ã€‚</li></ol><h2 id="5-é…ç½®ç±»"><a href="#5-é…ç½®ç±»" class="headerlink" title="5. é…ç½®ç±»"></a>5. é…ç½®ç±»</h2><p>é€šè¿‡è‡ªåŠ¨é…ç½®ï¼Œæˆ‘ä»¬å‘ç°å·²ç»å¸®æˆ‘ä»¬çœå»äº†å¤§é‡çš„é…ç½®æ–‡ä»¶çš„ç¼–å†™ï¼Œé‚£ä¹ˆåœ¨è‡ªå®šä¹‰é…ç½®çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯éœ€è¦ç¼–å†™XMLå‘¢ï¼ŸSpring boot å°½ç®¡å¯ä»¥ä½¿ç”¨ <code>SpringApplication</code>XML æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ <code>@Configuration</code> ç±»è¿›è¡Œä»£æ›¿ï¼Œè¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„æ–¹å¼ã€‚</p><h3 id="5-1-XMLé…ç½®"><a href="#5-1-XMLé…ç½®" class="headerlink" title="5.1 XMLé…ç½®"></a>5.1 XMLé…ç½®</h3><p>å®šä¹‰ helloService Bean.</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloService"</span> <span class="attr">class</span>=<span class="string">"net.codingme.boot.service.HelloService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥é…ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ImportResource</span>(value = <span class="string">"classpath:spring-service.xml"</span>)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-æ³¨è§£é…ç½®"><a href="#5-2-æ³¨è§£é…ç½®" class="headerlink" title="5.2 æ³¨è§£é…ç½®"></a>5.2 æ³¨è§£é…ç½®</h3><p>æ­¤ç§æ–¹å¼å’Œä¸Šé¢çš„XMLé…ç½®æ˜¯ç­‰æ•ˆçš„ï¼Œä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„æ–¹å¼ã€‚<code>@Configuration</code> æ³¨è§£çš„ç±»ï¼ˆè¦åœ¨æ‰«æçš„åŒ…è·¯å¾„ä¸­ï¼‰ä¼šè¢«æ‰«æåˆ°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * é…ç½®ç±»ï¼Œç›¸å½“äºä¼ ç»ŸSpring å¼€å‘ä¸­çš„ xml-&gt; beançš„é…ç½®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/7 0:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤æ·»åŠ åˆ°å®¹å™¨ä¸­çš„ ID ä¸ºæ–¹æ³•åï¼ˆhelloServiceï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloService <span class="title">helloService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HelloService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-é™„å½•"><a href="#6-é™„å½•" class="headerlink" title="6. é™„å½•"></a>6. é™„å½•</h2><table><thead><tr><th>@Conditionalæ‰©å±•æ³¨è§£</th><th>ä½œç”¨ï¼ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³å½“å‰æŒ‡å®šæ¡ä»¶ï¼‰</th></tr></thead><tbody><tr><td>@ConditionalOnJava</td><td>ç³»ç»Ÿçš„javaç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚</td></tr><tr><td>@ConditionalOnBean</td><td>å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBeanï¼›</td></tr><tr><td>@ConditionalOnMissingBean</td><td>å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBeanï¼›</td></tr><tr><td>@ConditionalOnExpression</td><td>æ»¡è¶³SpELè¡¨è¾¾å¼æŒ‡å®š</td></tr><tr><td>@ConditionalOnClass</td><td>ç³»ç»Ÿä¸­æœ‰æŒ‡å®šçš„ç±»</td></tr><tr><td>@ConditionalOnMissingClass</td><td>ç³»ç»Ÿä¸­æ²¡æœ‰æŒ‡å®šçš„ç±»</td></tr><tr><td>@ConditionalOnSingleCandidate</td><td>å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å®šçš„Beanï¼Œæˆ–è€…è¿™ä¸ªBeanæ˜¯é¦–é€‰Bean</td></tr><tr><td>@ConditionalOnProperty</td><td>ç³»ç»Ÿä¸­æŒ‡å®šçš„å±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼</td></tr><tr><td>@ConditionalOnResource</td><td>ç±»è·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šèµ„æºæ–‡ä»¶</td></tr><tr><td>@ConditionalOnWebApplication</td><td>å½“å‰æ˜¯webç¯å¢ƒ</td></tr><tr><td>@ConditionalOnNotWebApplication</td><td>å½“å‰ä¸æ˜¯webç¯å¢ƒ</td></tr><tr><td>@ConditionalOnJndi</td><td>JNDIå­˜åœ¨æŒ‡å®šé¡¹</td></tr></tbody></table><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-config" target="_blank" rel="noopener">Spring Boot è‡ªåŠ¨é…ç½®</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ &lt;strong&gt;v2.1.1.RELEASE&lt;/strong&gt; è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/90be321394ddff7aa6dfdc9910888fda.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;å…³äºé…ç½®æ–‡ä»¶å¯ä»¥é…ç½®çš„å†…å®¹ï¼Œåœ¨ &lt;a href=&quot;https://docs.spring.io/spring-boot/docs/2.1.1.RELEASE/reference/htmlsingle/#common-application-properties&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Spring Boot å®˜æ–¹ç½‘ç«™&lt;/a&gt;å·²ç»æä¾›äº†å®Œæ•´äº†é…ç½®ç¤ºä¾‹å’Œè§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è¿™ä¹ˆè¯´ï¼ŒSpring Boot çš„ä¸€å¤§ç²¾é«“å°±æ˜¯è‡ªåŠ¨é…ç½®ï¼Œä¸ºå¼€å‘çœå»äº†å¤§é‡çš„é…ç½®æ—¶é—´ï¼Œå¯ä»¥æ›´å¿«çš„èå…¥ä¸šåŠ¡é€»è¾‘çš„å¼€å‘ï¼Œé‚£ä¹ˆè‡ªåŠ¨é…ç½®æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆäºŒï¼‰Spring Boot é…ç½®æ–‡ä»¶</title>
    <link href="https://www.codingme.net/2019/01/springboot/springboot02-config/"/>
    <id>https://www.codingme.net/2019/01/springboot/springboot02-config/</id>
    <published>2019-01-05T14:14:17.000Z</published>
    <updated>2019-05-20T16:26:48.661Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ <strong>v2.1.1.RELEASE</strong> è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/dc649482e7380cbe546f92550cef3c51.png" alt=""></p><p>ä¸ç®¡æ˜¯é€šè¿‡å®˜æ–¹æä¾›çš„æ–¹å¼è·å– Spring Boot é¡¹ç›®ï¼Œè¿˜æ˜¯é€šè¿‡ IDEA å¿«é€Ÿçš„åˆ›å»º Spring Boot é¡¹ç›®ï¼Œæˆ‘ä»¬éƒ½ä¼šå‘ç°åœ¨ resource æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ <code>application.properties</code>,ä¹Ÿæœ‰å¯èƒ½æ˜¯<code>application.yml</code>.è¿™ä¸ªæ–‡ä»¶ä¹Ÿå°±æ˜¯ Spring Boot çš„é…ç½®æ–‡ä»¶ã€‚</p><a id="more"></a><h2 id="1-YAML-æ–‡ä»¶"><a href="#1-YAML-æ–‡ä»¶" class="headerlink" title="1. YAML æ–‡ä»¶"></a>1. YAML æ–‡ä»¶</h2><p>åœ¨ <code>Spring Boot</code> ä¸­ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>properties</code> æˆ–è€… <code>YAML</code> æ–‡ä»¶æ¥å®Œæˆé…ç½®ï¼Œå¯¹äº <code>YAML</code> æ–‡ä»¶æ ¼å¼è¿˜ä¸äº†è§£çš„å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„å…·ä½“æ ¼å¼ï¼Œè¿™é‡Œåªåšç®€å•ä»‹ç»ã€‚  </p><p><strong>YAML è¯­æ³•è§„åˆ™ï¼š</strong></p><ul><li>å¤§å°å†™æ•æ„Ÿ</li><li>ç¼©è¿›è¡¨ç¤ºå±‚çº§</li><li>ç¼©è¿›åªèƒ½ä½¿ç”¨ç©ºæ ¼</li><li>ç©ºæ ¼çš„æ•°é‡ä¸é‡è¦ï¼Œä½†æ˜¯ç›¸åŒå±‚çº§çš„å…ƒç´ è¦å·¦ä¾§å¯¹é½</li><li><code>#</code> å¼€å¤´çš„è¡Œè¡¨ç¤ºæ³¨é‡Š</li></ul><p><strong>YAML æ”¯æŒçš„æ•°æ®ç»“æ„ï¼š</strong></p><ol><li><p>å•çº¯çš„å˜é‡ï¼Œä¸å¯å†åˆ†çš„å•ä¸ªçš„å€¼ï¼Œå¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ç­‰ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Darcy</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">12</span></span><br><span class="line"><span class="comment"># ~è¡¨ç¤ºNULLå€¼</span></span><br><span class="line"><span class="attr">email:</span> <span class="string">~</span> </span><br><span class="line"><span class="comment"># å¤šè¡Œå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨|ä¿ç•™æ¢è¡Œç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨&gt;æŠ˜å æ¢è¡Œã€‚</span></span><br><span class="line"><span class="comment"># +è¡¨ç¤ºä¿ç•™æ–‡å­—å—æœ«å°¾çš„æ¢è¡Œï¼Œ-è¡¨ç¤ºåˆ é™¤å­—ç¬¦ä¸²æœ«å°¾çš„æ¢è¡Œã€‚</span></span><br><span class="line"><span class="attr">message:</span><span class="string">|-</span></span><br><span class="line">  <span class="string">Hello</span> <span class="string">world</span></span><br></pre></td></tr></table></figure></li><li><p>æ•°ç»„ï¼Œä¸€ç»„æŒ‰æ¬¡åºæ’åˆ—çš„å€¼ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lang:</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">java</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">golang</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">c</span></span><br><span class="line"><span class="comment"># æˆ–è€…è¡Œå†…å†™æ³•</span></span><br><span class="line"><span class="attr">lang:</span><span class="string">[java,golang,c]</span></span><br></pre></td></tr></table></figure></li><li><p>å¯¹è±¡ï¼Œé”®å€¼å¯¹çš„é›†åˆã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line"><span class="attr">  name:</span><span class="string">Darcy</span></span><br><span class="line"><span class="attr">  age:</span><span class="number">20</span></span><br><span class="line"><span class="comment"># æˆ–è€…è¡Œå†…å†™æ³•</span></span><br><span class="line"><span class="attr">person:</span><span class="string">&#123;name:Darcy,age:20&#125;</span></span><br></pre></td></tr></table></figure></li></ol><p>ä½¿ç”¨ <code>YAML</code> æ”¯æŒçš„ä¸‰ç§æ•°æ®ç»“æ„é€šè¿‡ç»„åˆå¯ä»¥å½¢æˆå¤æ‚çš„å¤åˆç»“æ„ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"><span class="comment"># é…ç½®personå±æ€§å€¼</span></span><br><span class="line"><span class="attr">person:</span></span><br><span class="line"><span class="attr">  last-name:</span> <span class="string">Darcy</span></span><br><span class="line"><span class="attr">  age:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">  birth:</span> <span class="number">2018</span><span class="string">/01/01</span></span><br><span class="line"><span class="attr">  email:</span> <span class="string">gmail@gmail.com</span></span><br><span class="line"><span class="attr">  maps:</span></span><br><span class="line"><span class="attr">    key1:</span><span class="string">java</span></span><br><span class="line"><span class="attr">    key2:</span><span class="string">golang</span></span><br><span class="line"><span class="attr">  lists:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">a</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">b</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">c</span></span><br><span class="line"><span class="attr">  dog:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">æ—ºè´¢</span></span><br><span class="line"><span class="attr">    age:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ <code>YAML</code> æ–‡ä»¶ä¸èƒ½ä½¿ç”¨<code>@PropertySource</code> åŠ è½½</p><h2 id="2-Properties-æ–‡ä»¶"><a href="#2-Properties-æ–‡ä»¶" class="headerlink" title="2. Properties æ–‡ä»¶"></a>2. Properties æ–‡ä»¶</h2><p><code>properties</code> é…ç½®æ–‡ä»¶ç®€å•å¥½ç”¨ï¼Œåœ¨å„ç§é…ç½®ç¯å¢ƒé‡Œéƒ½å¯ä»¥çœ‹åˆ°å®ƒçš„èº«å½±ï¼Œå®ƒç®€å•æ˜“ç”¨ï¼Œä½†æ˜¯åœ¨é…ç½®å¤æ‚ç»“æ„æ—¶ä¸å¦‚<code>YAML</code> ä¼˜é›…ç¾è§‚ã€‚åŒæ ·æ‹¿ä¸Šé¢çš„ <code>YAML</code> çš„å¤åˆç»“æ„ä¸¾ä¾‹ï¼Œæ¼”ç¤ºåŒæ ·çš„é…ç½®åœ¨ <code>properties</code>æ–‡ä»¶ä¸­çš„å†™æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line"># é…ç½®å±æ€§å€¼ï¼ˆä½¿ç”¨IDEè¿›è¡Œé…ç½®éœ€è¦å¤„ç†ç¼–ç é—®é¢˜ï¼Œä¸ç„¶ä¸­æ–‡ä¼šå‘é€ä¹±ç ç°è±¡ï¼‰</span><br><span class="line">person.last-name=å¼ ä¸‰</span><br><span class="line">person.age=18</span><br><span class="line">person.birth=2018/12/06</span><br><span class="line">person.email=niu@gmail.com</span><br><span class="line">person.maps.key1=c</span><br><span class="line">person.maps.key2=java</span><br><span class="line">person.maps.key3=golang</span><br><span class="line">person.lists=a,b,c,d</span><br><span class="line">person.dog.name=æ—ºè´¢</span><br><span class="line">person.dog.age=1</span><br></pre></td></tr></table></figure><h2 id="3-éšæœºæ•°ä¸å ä½ç¬¦"><a href="#3-éšæœºæ•°ä¸å ä½ç¬¦" class="headerlink" title="3. éšæœºæ•°ä¸å ä½ç¬¦"></a>3. éšæœºæ•°ä¸å ä½ç¬¦</h2><p><code>RandomValuePropertySource</code> ç±»å¯¹äºæ³¨å…¥éšæœºå€¼å¾ˆæœ‰ç”¨ï¼ˆä¾‹å¦‚ï¼Œæ³¨å…¥ç§˜å¯†æˆ–æµ‹è¯•ç”¨ä¾‹ï¼‰ã€‚å®ƒå¯ä»¥ç”Ÿæˆæ•´æ•°ï¼Œé•¿æ•´æ•°ï¼Œuuid æˆ–å­—ç¬¦ä¸²ç­‰ï¼Œé€šè¿‡ Spring Boot å¯¹æˆ‘ä»¬çš„å°è£…ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾çš„ä½¿ç”¨ã€‚</p><p>å ä½ç¬¦å…è®¸åœ¨é…ç½®çš„å€¼ä¸­å¼•ç”¨ä¹‹å‰å®šä¹‰è¿‡çš„å˜é‡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ç”Ÿæˆéšæœºå€¼</span><br><span class="line">bootapp.secret=$ &#123;random.value&#125;</span><br><span class="line">bootapp.number=$ &#123;random.int&#125;</span><br><span class="line">bootapp.bignumber=$ &#123;random.long&#125;</span><br><span class="line">bootapp.uuid=$ &#123;random.uuid&#125;</span><br><span class="line">bootapp.number.less.than.ten=$ &#123;random.intï¼ˆ10ï¼‰&#125;</span><br><span class="line">bootapp.number.in.range=$ &#123;random.int [1024,65536]&#125;</span><br><span class="line"># å±æ€§çš„å ä½ç¬¦</span><br><span class="line">bootapp.name=SpringBoot</span><br><span class="line">bootapp.description=$&#123;bootapp.name&#125;æ˜¯ä¸€ä¸ªspringåº”ç”¨ç¨‹åº</span><br></pre></td></tr></table></figure><h2 id="4-é…ç½®çš„ä½¿ç”¨"><a href="#4-é…ç½®çš„ä½¿ç”¨" class="headerlink" title="4. é…ç½®çš„ä½¿ç”¨"></a>4. é…ç½®çš„ä½¿ç”¨</h2><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¯ä»¥å‘ç°ä¸ç®¡æ˜¯ä½¿ç”¨ <code>YAML</code> è¿˜æ˜¯ <code>Properties</code> éƒ½å¯ä»¥è¿›è¡Œé…ç½®æ–‡ä»¶çš„ç¼–å†™ï¼Œä½†æ˜¯è¿˜ä¸çŸ¥é“å…·ä½“çš„ä½¿ç”¨æ–¹å¼ï¼Œé€šè¿‡ä¸‹é¢çš„å‡ ä¸ªæ³¨è§£ï¼Œå¯ä»¥è®©æˆ‘ä»¬äº†è§£åˆ°è¿™äº›é…ç½®çš„å…·ä½“ä½¿ç”¨æ–¹å¼ã€‚</p><p>åœ¨ä½¿ç”¨é…ç½®ä¹‹å‰ï¼Œæ·»åŠ æ‰€éœ€ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®ç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-1-ConfigurationProperties"><a href="#4-1-ConfigurationProperties" class="headerlink" title="4.1 ConfigurationProperties"></a>4.1 ConfigurationProperties</h3><p><code>@ConfigurationProperties</code> æ³¨è§£æ˜¯ <code>Spring Boot</code> æä¾›çš„ä¸€ç§ä½¿ç”¨å±æ€§çš„æ³¨å…¥æ–¹æ³•ã€‚ä¸ä»…å¯ä»¥æ–¹ä¾¿çš„æŠŠé…ç½®æ–‡ä»¶ä¸­çš„å±æ€§å€¼ä¸æ‰€æ³¨è§£ç±»ç»‘å®šï¼Œè¿˜æ”¯æŒæ¾æ•£ç»‘å®šï¼ŒJSR-303 æ•°æ®æ ¡éªŒç­‰åŠŸèƒ½ã€‚ä»¥ä¸Šé¢æ¼”ç¤ºçš„ <code>Properties</code> çš„é…ç½®ä¸ºä¾‹æ¼”ç¤º <code>@ConfigurationProperties</code> æ³¨è§£çš„ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Email;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/6 22:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"person"</span>)</span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; lists;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯æŒæ•°æ®æ ¡éªŒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Email</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>@Data</code> æ˜¯ Lombok çš„æ³¨è§£ï¼Œä¼šä¸ºè¿™ä¸ªç±»æ‰€æœ‰å±æ€§æ·»åŠ  getting å’Œ setting æ–¹æ³•ï¼Œæ­¤å¤–è¿˜æä¾›äº†equalsã€canEqualã€hashCodeã€toString æ–¹æ³•ã€‚</li><li><code>@Component</code> è‡ªåŠ¨æ·»åŠ  bean åˆ° spring å®¹å™¨ä¸­ã€‚</li><li><code>@ConfigurationProperties</code> å‘Šè¯‰è¿™ä¸ªç±»çš„å±æ€§éƒ½æ˜¯é…ç½®æ–‡ä»¶é‡Œçš„å±æ€§ï¼Œprefix æŒ‡å®šè¯»å–é…ç½®æ–‡ä»¶çš„å‰ç¼€ã€‚</li></ul><h3 id="4-2-Value"><a href="#4-2-Value" class="headerlink" title="4.2 Value"></a>4.2 Value</h3><p><code>@Value</code> æ”¯æŒç›´æ¥ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å€¼ï¼ŒåŒæ—¶æ”¯æŒ SpEL è¡¨è¾¾å¼ï¼Œä½†æ˜¯ä¸æ”¯æŒå¤æ‚æ•°æ®ç±»å‹å’Œæ•°æ®éªŒè¯ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Email;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonValue</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›´æ¥ä»é…ç½®æ–‡ä»¶è¯»å–ä¸€ä¸ªå€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;person.last-name&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯æŒSpELè¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"#&#123;11*4/2&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;person.birth&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸æ”¯æŒå¤æ‚ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; lists;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸æ”¯æŒæ•°æ®æ ¡éªŒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Email</span></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"xxx@@@@"</span>)</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™å•å…ƒæµ‹è¯•ä»£ç æµ‹è¯•ä»£ç æŸ¥çœ‹å±æ€§ç»‘å®šæ˜¯å¦æˆåŠŸã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Person;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.PersonValue;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@AutoConfigureMockMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MockMvc mvc;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PersonValue personValue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¨¡æ‹Ÿè¯·æ±‚æµ‹è¯•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetHello</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        mvc.perform(MockMvcRequestBuilders.get(<span class="string">"/"</span>).accept(MediaType.APPLICATION_JSON))</span><br><span class="line">                .andExpect(status().isOk())</span><br><span class="line">                .andExpect(content().string(<span class="string">"Greetings from Spring Boot!"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•<span class="doctag">@ConfigurationProperties</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•<span class="doctag">@Value</span> å¼•å…¥é…ç½®å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPersionValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(personValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå‘ç°æ•°æ®å·²ç»æ­£å¸¸ç»‘å®šã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/69bca4a567c0c6a4d5d2434812eb65b7.png" alt="å•å…ƒæµ‹è¯•"></p><p>é€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ï¼Œä¹Ÿå¯ä»¥å‘ç° <code>@ConfigurationProperties</code> å’Œ <code>@Value</code>çš„åŒºåˆ«ã€‚</p><table><thead><tr><th>ç‰¹å¾</th><th>@ConfigurationProperties</th><th>@Value</th></tr></thead><tbody><tr><td>åŠŸèƒ½</td><td>æ‰¹é‡æ³¨å…¥é…ç½®æ–‡ä»¶å±æ€§</td><td>ä¸€ä¸ªä¸€ä¸ªæ³¨å…¥</td></tr><tr><td>æ¾æ•£ç»‘å®šï¼ˆæ¾æ•£çš„è¯­æ³•ï¼‰</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>SpEL</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>JSR-303 æ•°æ®æ ¡éªŒ</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>å¤æ‚ç±»å‹</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr></tbody></table><p><code>@ConfigurationProperties</code> å’Œ <code>@Value</code>çš„ä½¿ç”¨åœºæ™¯ã€‚</p><p>å¦‚æœè¯´ï¼Œåªæ˜¯åœ¨æŸä¸ªä¸šåŠ¡é€»è¾‘ä¸­è·å–é…ç½®æ–‡ä»¶çš„æŸä¸ªå€¼ï¼Œä½¿ç”¨ <code>@Value</code>.</p><p>å¦‚æœè¯´ï¼Œä¸“é—¨ç¼–å†™æœ‰ä¸€ä¸ª Java Bean æ¥å’Œé…ç½®æ–‡ä»¶æ˜ å°„ï¼Œä½¿ç”¨ <code>@ConfigurationProperties</code>.</p><h3 id="4-3-PropertySource"><a href="#4-3-PropertySource" class="headerlink" title="4.3 PropertySource"></a>4.3 PropertySource</h3><p>éšç€ä¸šåŠ¡å¤æ‚æ€§çš„å¢åŠ ï¼Œé…ç½®æ–‡ä»¶ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä»¬ä¼šè§‰å¾—æ‰€æœ‰çš„é…ç½®éƒ½å†™åœ¨ä¸€ä¸ª properties æ–‡ä»¶ä¼šä½¿é…ç½®æ˜¾å¾—ç¹æ‚ä¸åˆ©äºç®¡ç†ï¼Œå› æ­¤å¸Œæœ›å¯ä»¥æŠŠæ˜ å°„å±æ€§ç±»çš„é…ç½®å•ç‹¬çš„æŠ½å–å‡ºæ¥ã€‚ç”±äº Spring Boot é»˜è®¤è¯»å–<code>application.properties</code>ï¼Œå› æ­¤åœ¨æŠ½å–ä¹‹åä¹‹å‰å•ç‹¬çš„<code>@ConfigurationProperties(prefix = &quot;person&quot;)</code>å·²ç»æ— æ³•è¯»å–åˆ°ä¿¡æ¯ã€‚è¿™æ˜¯å¯ä»¥ä½¿ç”¨ <code>@PropertySource</code>  æ³¨è§£æ¥æŒ‡å®šè¦è¯»å–çš„é…ç½®æ–‡ä»¶ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ <code>@PropertySource</code> åŠ è½½è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ï¼Œï¼Œç”±äº <code>@PropertySource</code> æŒ‡å®šçš„æ–‡ä»¶ä¼šä¼˜å…ˆåŠ è½½ï¼Œæ‰€ä»¥å¦‚æœåœ¨ <code>applocation.properties</code> ä¸­å­˜åœ¨ç›¸åŒçš„å±æ€§é…ç½®ï¼Œä¼šè¦†ç›–å‰è€…ä¸­å¯¹äºçš„å€¼ã€‚</p><p>å¦‚æœæŠ½å– <code>person</code> é…ç½®ä¸ºå•ç‹¬æ–‡ä»¶<code>domain-person.properties</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Email;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/6 22:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="meta">@PropertySource</span>(value = <span class="string">"classpath:domain-person.properties"</span>)</span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(value = <span class="string">"person"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonSource</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; lists;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯æŒæ•°æ®æ ¡éªŒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Email</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-å¤šç¯å¢ƒé…ç½®"><a href="#5-å¤šç¯å¢ƒé…ç½®" class="headerlink" title="5. å¤šç¯å¢ƒé…ç½®"></a>5. å¤šç¯å¢ƒé…ç½®</h2><p>åœ¨ä¸»é…ç½®æ–‡ä»¶ç¼–å†™çš„æ—¶å€™ï¼Œæ–‡ä»¶åå¯ä»¥æ˜¯ <code>application-{name}.properties</code>.é»˜è®¤ä½¿ç”¨çš„æ˜¯<code>application.properties</code>.</p><h3 id="5-1-properties-å¤šç¯å¢ƒ"><a href="#5-1-properties-å¤šç¯å¢ƒ" class="headerlink" title="5.1 properties å¤šç¯å¢ƒ"></a>5.1 properties å¤šç¯å¢ƒ</h3><p>é‚£ä¹ˆå¦‚ä½•åœ¨é…ç½®æ–‡ä»¶ä¸­æ¿€æ´»å…¶ä»–çš„é…ç½®æ–‡ä»¶å‘¢ï¼Ÿåªéœ€è¦åœ¨ <code>application.properties</code> å¯ç”¨å…¶ä»–æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æ¿€æ´» application-prod.propertiesæ–‡ä»¶</span><br><span class="line">spring.profiles.active=prod</span><br></pre></td></tr></table></figure><h3 id="5-2-YAML-å¤šç¯å¢ƒ"><a href="#5-2-YAML-å¤šç¯å¢ƒ" class="headerlink" title="5.2 YAML å¤šç¯å¢ƒ"></a>5.2 YAML å¤šç¯å¢ƒ</h3><p>å¦‚æœæ˜¯ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä»¶å—çš„å½¢å¼ï¼Œåœ¨ä¸€ä¸ª YAML æ–‡ä»¶å°±å¯ä»¥è¾¾åˆ°å¤šæ–‡ä»¶é…ç½®çš„æ•ˆæœï¼Œä¸‹é¢æ˜¯ Spring Boot ä½¿ç”¨ YAML æ–‡ä»¶è¿›è¡Œå¤šç¯å¢ƒé…ç½®çš„æ–¹å¼ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8083</span></span><br><span class="line"><span class="attr">  profiles:</span></span><br><span class="line"><span class="attr">    active:</span> <span class="string">dev</span> <span class="comment"># æŒ‡å®šç¯å¢ƒä¸ºdev</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ä¸‰ä¸ª---è¿›è¡Œæ–‡æ¡£å—åŒºåˆ†</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8084</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  profiles:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8085</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  profiles:</span> <span class="string">prod</span></span><br></pre></td></tr></table></figure><h3 id="5-3-å¤šç¯å¢ƒæ¿€æ´»æ–¹å¼"><a href="#5-3-å¤šç¯å¢ƒæ¿€æ´»æ–¹å¼" class="headerlink" title="5.3 å¤šç¯å¢ƒæ¿€æ´»æ–¹å¼"></a>5.3 å¤šç¯å¢ƒæ¿€æ´»æ–¹å¼</h3><p>é™¤äº†ä»¥ä¸Šçš„ä¸¤ç§é…ç½®æ–‡ä»¶æ¿€æ´»æ–¹å¼ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸¤ç§ç§æ¿€æ´»æ–¹å¼ã€‚</p><ul><li>å‘½ä»¤è¡Œ ï¼Œè¿è¡Œæ—¶æ·»åŠ  <code>--spring.profiles.active=prod</code></li><li>Jvm å‚æ•° ï¼Œè¿è¡Œæ—¶æ·»åŠ  <code>-Dspring.profiles.active=prod</code></li></ul><p>å¦‚æœéœ€è¦æ¿€æ´»å…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>spring.config.location=G:/application.properties</code> è¿›è¡Œé…ç½®ã€‚</p><h2 id="6-é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº"><a href="#6-é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº" class="headerlink" title="6. é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº"></a>6. é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº</h2><p>é…ç½®æ–‡ä»¶é»˜è®¤ä¼šä»å››ä¸ªåœ°æ–¹åŠ è½½ï¼Œä¸”ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ã€‚ä¼˜å…ˆçº§é«˜çš„é…ç½®ä¼šè¦†ç›–ä¼˜å…ˆçº§ä½çš„é…ç½®ã€‚å¦‚æœå¤šä¸ªä½ç½®çš„é…ç½®åŒæ—¶å­˜åœ¨ï¼Œä¸åŒçš„é…ç½®ä¿¡æ¯ä¼šå½¢æˆäº’è¡¥é…ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-file: ./config/</span><br><span class="line">-file: ./</span><br><span class="line">-classpath: /config/</span><br><span class="line">-classpath: /</span><br></pre></td></tr></table></figure><h2 id="7-å¤–éƒ¨é…ç½®æ–‡ä»¶"><a href="#7-å¤–éƒ¨é…ç½®æ–‡ä»¶" class="headerlink" title="7. å¤–éƒ¨é…ç½®æ–‡ä»¶"></a>7. å¤–éƒ¨é…ç½®æ–‡ä»¶</h2><p>Spring Boot çš„å¤–éƒ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://docs.spring.io/spring-boot/docs/2.1.x/reference/html/boot-features-external-config.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚è¿™å†™é…ç½®åŠ è½½ä¼˜å…ˆçº§ä»é«˜åˆ°åº•ï¼Œä¼˜å…ˆçº§é«˜çš„é…ç½®ä¼šè¦†ç›–ä¼˜å…ˆçº§ä½çš„é…ç½®ã€‚</p><p>ä¸‹é¢ä»‹ç»å‡ ç§å¸¸è§çš„åŠ è½½é…ç½®çš„é¡ºåºã€‚</p><ol><li><p>å‘½ä»¤è¡Œå‚æ•°è¿è¡Œï¼Œæ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸Šæ‰§è¡Œï¼Œå¤šä¸ªé…ç½®ç©ºæ ¼éš”å¼€ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar springboot-0.0.1-SNAPSHOT.jar --server.port=9999 --sercer.context-path=/spring</span><br></pre></td></tr></table></figure></li><li><p>jar åŒ…ç›®å½•ä¸‹çš„ application-{profile}.properties ï¼ˆæˆ–ymlï¼‰æ–‡ä»¶</p></li><li>jar åŒ…é‡Œçš„ application-{profile}.properties ï¼ˆæˆ–ymlï¼‰æ–‡ä»¶</li><li>jar åŒ…ç›®å½•ä¸‹çš„ application.properties ï¼ˆæˆ–ymlï¼‰æ–‡ä»¶</li><li>jar åŒ…é‡Œä¸‹çš„ application.properties ï¼ˆæˆ–ymlï¼‰æ–‡ä»¶</li></ol><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-properties" target="_blank" rel="noopener">Spring Boot é…ç½®æ–‡ä»¶</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ &lt;strong&gt;v2.1.1.RELEASE&lt;/strong&gt; è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/dc649482e7380cbe546f92550cef3c51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ç®¡æ˜¯é€šè¿‡å®˜æ–¹æä¾›çš„æ–¹å¼è·å– Spring Boot é¡¹ç›®ï¼Œè¿˜æ˜¯é€šè¿‡ IDEA å¿«é€Ÿçš„åˆ›å»º Spring Boot é¡¹ç›®ï¼Œæˆ‘ä»¬éƒ½ä¼šå‘ç°åœ¨ resource æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ &lt;code&gt;application.properties&lt;/code&gt;,ä¹Ÿæœ‰å¯èƒ½æ˜¯&lt;code&gt;application.yml&lt;/code&gt;.è¿™ä¸ªæ–‡ä»¶ä¹Ÿå°±æ˜¯ Spring Boot çš„é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆä¸€ï¼‰Spring Boot å…¥é—¨ç¯‡</title>
    <link href="https://www.codingme.net/2019/01/springboot/springboot01-quick-start/"/>
    <id>https://www.codingme.net/2019/01/springboot/springboot01-quick-start/</id>
    <published>2019-01-01T07:14:17.000Z</published>
    <updated>2019-05-20T16:26:48.657Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ <strong>v2.1.1.RELEASE</strong> è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/a60be3362289ed4d901bae342a685f84.png" alt=""></p><p>ç”±äº J2EE çš„å¼€å‘å˜å¾—ç¬¨é‡ï¼Œç¹å¤šçš„é…ç½®ï¼Œé”™ä¹±çš„ä¾èµ–ç®¡ç†ï¼Œä½ä¸‹çš„å¼€å‘æ•ˆç‡ï¼Œå¤æ‚çš„éƒ¨ç½²æµç¨‹ï¼Œç¬¬ä¸‰æ–¹æŠ€æœ¯çš„é›†æˆéš¾åº¦è¾ƒå¤§ç­‰ã€‚åŒæ—¶éšç€å¤æ‚é¡¹ç›®çš„æ¼”è¿›ï¼Œå¾®æœåŠ¡åˆ†å¸ƒå¼æ¶æ„æ€æƒ³é€æ¸è¿›å…¥å¼€å‘è€…çš„è§†é‡ã€‚</p><h2 id="1-Spring-Boot-ä»‹ç»"><a href="#1-Spring-Boot-ä»‹ç»" class="headerlink" title="1. Spring Boot ä»‹ç»"></a>1. Spring Boot ä»‹ç»</h2><p><code>Spring Boot</code> æä¾›äº†ä¸€ç»„å·¥å…·åªéœ€è¦æå°‘çš„é…ç½®å°±å¯ä»¥å¿«é€Ÿçš„æ„å»ºå¹¶å¯åŠ¨åŸºäº Spring çš„åº”ç”¨ç¨‹åºã€‚è§£å†³äº†ä¼ ç»Ÿ Spring å¼€å‘éœ€è¦é…ç½®å¤§é‡é…ç½®æ–‡ä»¶çš„ç—›ç‚¹ï¼ŒåŒæ—¶ <code>Spring Boot</code> å¯¹äºç¬¬ä¸‰æ–¹åº“è®¾ç½®äº†åˆç†çš„é»˜è®¤å€¼ï¼Œå¯ä»¥å¿«é€Ÿçš„æ„å»ºèµ·åº”ç”¨ç¨‹åºã€‚å½“ç„¶ <code>Spring Boot</code> ä¹Ÿå¯ä»¥è½»æ¾çš„è‡ªå®šä¹‰å„ç§é…ç½®ï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘çš„åˆå§‹é˜¶æ®µè¿˜æ˜¯æŠ•å…¥ç”Ÿæˆçš„åæœŸé˜¶æ®µã€‚</p><a id="more"></a><h2 id="2-Spring-Boot-ä¼˜ç‚¹"><a href="#2-Spring-Boot-ä¼˜ç‚¹" class="headerlink" title="2. Spring Boot ä¼˜ç‚¹"></a>2. Spring Boot ä¼˜ç‚¹</h2><ul><li>å¿«é€Ÿçš„åˆ›å»ºå¯ä»¥ç‹¬ç«‹è¿è¡Œçš„ Spring é¡¹ç›®ä»¥åŠä¸ä¸»æµæ¡†æ¶çš„é›†æˆã€‚</li><li>ä½¿ç”¨åµŒå…¥å¼çš„ Servlet å®¹å™¨ï¼Œç”¨äºä¸éœ€è¦æ‰“æˆwaråŒ…ã€‚</li><li>ä½¿ç”¨å¾ˆå¤šçš„å¯åŠ¨å™¨ï¼ˆStartersï¼‰è‡ªåŠ¨ä¾èµ–ä¸ç‰ˆæœ¬æ§åˆ¶ã€‚</li><li>å¤§é‡çš„è‡ªåŠ¨åŒ–é…ç½®ï¼Œç®€åŒ–äº†å¼€å‘ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹é»˜è®¤å€¼ã€‚</li><li>ä¸éœ€è¦é…ç½® XML æ–‡ä»¶ï¼Œæ— ä»£ç ç”Ÿæˆï¼Œå¼€ç®±å³ç”¨ã€‚</li><li>å‡†ç”Ÿäº§ç¯å¢ƒçš„è¿è¡Œæ—¶åº”ç”¨ç›‘æ§ã€‚</li><li>ä¸äº‘è®¡ç®—çš„å¤©ç„¶é›†æˆã€‚</li></ul><h2 id="3-Spring-Boot-å‰ç½®"><a href="#3-Spring-Boot-å‰ç½®" class="headerlink" title="3. Spring Boot å‰ç½®"></a>3. Spring Boot å‰ç½®</h2><p>è¯´äº†é‚£ä¹ˆå¤šçš„ Spring Boot çš„å¥½å¤„ï¼Œé‚£ä¹ˆä½¿ç”¨ Spring Boot éœ€è¦å“ªäº›å‰ç½®çŸ¥è¯†å‘¢ï¼Ÿæˆ‘ç®€å•åˆ—ä¸¾äº†ä¸€ä¸‹ã€‚</p><ul><li>Spring æ¡†æ¶çš„ä½¿ç”¨ã€‚</li><li>Maven æ„å»ºå·¥å…·çš„ä½¿ç”¨ã€‚</li><li>IDEA æˆ–å…¶ä»–å¼€å‘å·¥å…·çš„ä½¿ç”¨ã€‚</li></ul><h2 id="4-Spring-Boot-ä½“éªŒ"><a href="#4-Spring-Boot-ä½“éªŒ" class="headerlink" title="4. Spring Boot ä½“éªŒ"></a>4. Spring Boot ä½“éªŒ</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº† Spring Boot æ˜¯ä»€ä¹ˆï¼Œä¸‹é¢æˆ‘ä»¬å°†ä½¿ç”¨ Spring Boot å¼€å‘ä¸€ä¸ªå…¥é—¨æ¡ˆä¾‹ï¼Œæ¥ä½“éªŒ Spring Boot å¼€å‘å§¿åŠ¿æ˜¯å¦‚ä½•çš„ä¼˜é›…ä¸è¿…é€Ÿã€‚<br>Spring Boot å®˜æ–¹å·²ç»ä¸ºæˆ‘ä»¬å¦‚ä½•å¿«é€Ÿå¯åŠ¨ Spring Boot åº”ç”¨ç¨‹åºæä¾›äº†å¤šç§æ–¹å¼ã€‚</p><p>ä½ å¯ä»¥åœ¨ Spring å®˜æ–¹ç½‘ç«™ç›´æ¥ç”Ÿæˆé¡¹ç›®ä¸‹è½½å¯¼å…¥IDEè¿›è¡Œå¼€å‘ã€‚</p><blockquote><p><a href="https://start.spring.io/" target="_blank" rel="noopener">https://start.spring.io/</a></p></blockquote><p>ä¹Ÿå¯ä»¥ç›´æ¥å…‹éš† GitHub ä¸Šçš„åˆå§‹é¡¹ç›®è¿›è¡Œä½“éªŒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/spring-guides/gs-spring-boot.git</span><br><span class="line">cd gs-spring-boot/initial</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©åè€…ï¼Œç›´æ¥å…‹éš†è¿›å…¥åˆ° initial æ–‡ä»¶å¤¹ä½¿ç”¨ maven è¿›è¡Œç¼–è¯‘å¯åŠ¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn package &amp;&amp; java -jar target/gs-spring-boot-0.1.0.jar</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡ç¼–è¯‘éœ€è¦ä¸‹è½½éœ€è¦çš„ä¾èµ–ï¼Œè€—æ—¶ä¼šæ¯”è¾ƒé•¿ï¼Œç¼–è¯‘å®Œæˆä¹‹åç´§æ¥ç€å¯ä»¥çœ‹åˆ° Spring çš„å¯åŠ¨æ ‡å¿—ã€‚è¿™æ—¶ Spring Boot çš„ webç¨‹åºå·²ç»è¿è¡Œåœ¨8080ç«¯å£äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl -s localhost:8080</span><br><span class="line">Greetings from Spring Boot!</span><br></pre></td></tr></table></figure><h2 id="5-Spring-Boot-å¼€å‘"><a href="#5-Spring-Boot-å¼€å‘" class="headerlink" title="5. Spring Boot å¼€å‘"></a>5. Spring Boot å¼€å‘</h2><p>ä¸‹é¢æ‰‹åŠ¨ç¼–å†™ä¸€ä¸ª Spring Boot å…¥é—¨æ¡ˆä¾‹ï¼Œå¿«é€Ÿçš„å¼€å‘ä¸€ä¸ª web mvc åº”ç”¨ã€‚<br>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/8b8a006da0df292015c9895b337a3ba4.png" alt="Spring boot é¡¹ç›®ç»“æ„"></p><h3 id="5-1-ä¾èµ–é¡¹"><a href="#5-1-ä¾èµ–é¡¹" class="headerlink" title="5.1 ä¾èµ–é¡¹"></a>5.1 ä¾èµ–é¡¹</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>spring-boot-starter-parent</code> æ˜¯Spring Boot çš„æ ¸å¿ƒä¾èµ–ï¼Œå®ƒé‡Œé¢å®šä¹‰äº†å„ç§åœ¨å¼€å‘ä¸­ä¼šç”¨åˆ°çš„ç¬¬ä¸‰æ–¹ jar  çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å¼•å…¥å…¶ä»–çš„ Spring Boot ä¸ºæˆ‘ä»¬å°è£…çš„å¯åŠ¨å™¨çš„æ—¶å€™éƒ½ä¸åœ¨éœ€è¦æŒ‡å®šç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥è¦†ç›–ç‰ˆæœ¬å±æ€§å€¼å³å¯ã€‚</p><p><code>spring-boot-starter-web</code>  æä¾› web ä»¥åŠ MVC å’Œ validator ç­‰webå¼€å‘æ¡†æ¶çš„æ”¯æŒã€‚</p><p><code>spring-boot-starter-test</code>  æä¾›æµ‹è¯•æ¨¡å—çš„æ”¯æŒã€‚å¦‚ Junitï¼ŒMockitoã€‚</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒSpring Boot ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šçš„å·²ç»å°è£…å¥½çš„ç§°ä¸ºå¯åŠ¨å™¨ï¼ˆstarterï¼‰çš„ä¾èµ–é¡¹ã€‚è®©æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ä¸éœ€è¦å†è¿›è¡Œå¤æ‚çš„é…ç½®å°±å¯ä»¥è¿…é€Ÿçš„è¿›è¡Œåº”ç”¨é›†æˆã€‚æ‰€æœ‰çš„å®˜æ–¹å¯åŠ¨å™¨ä¾èµ–å¯ä»¥åœ¨<a href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot-starters" target="_blank" rel="noopener">è¿™é‡Œ</a>æŸ¥çœ‹ã€‚</p><blockquote><p>æ‰€æœ‰<strong>å®˜æ–¹</strong>å‘å¸ƒçš„å¯åŠ¨å™¨éƒ½éµå¾ªç±»ä¼¼çš„å‘½åæ¨¡å¼; <code>spring-boot-starter-*</code>ï¼Œè¿™é‡Œ<code>*</code>æ˜¯æŒ‡ç‰¹å®šç±»å‹çš„åº”ç”¨ç¨‹åºã€‚æ­¤å‘½åç»“æ„æ—¨åœ¨å¸®åŠ©æ‚¨å¯»æ‰¾å¯åŠ¨å™¨ã€‚</p><p>æ³¨æ„ï¼šç¼–å†™è‡ªå·±çš„å¯åŠ¨å™¨çš„æ—¶å€™ä¸åº”è¯¥ä½¿ç”¨è¿™ç§å‘½åæ–¹å¼ã€‚</p></blockquote><h3 id="5-2-å¯åŠ¨ç±»"><a href="#5-2-å¯åŠ¨ç±»" class="headerlink" title="5.2 å¯åŠ¨ç±»"></a>5.2 å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(HelloApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">commandLineRunner</span><span class="params">(ApplicationContext ctx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> args -&gt; &#123;</span><br><span class="line">            <span class="comment">// å¼€å§‹æ£€æŸ¥spring boot æä¾›çš„ beans</span></span><br><span class="line">            System.out.println(<span class="string">"Let's inspect the beans provided by Spring Boot:"</span>);</span><br><span class="line">            String[] beanNames = ctx.getBeanDefinitionNames();</span><br><span class="line">            Arrays.sort(beanNames);</span><br><span class="line">            <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">                System.out.println(beanName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@SpringBootApplication</code>  æ³¨è§£æ˜¯ä¸€ä¸ªä¾¿åˆ©çš„æ³¨è§£ï¼Œå®ƒåŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªæ³¨è§£ã€‚</p><ol><li><p><code>@Configuration</code> å®šä¹‰é…ç½®ç±»ã€‚</p></li><li><p><code>@EnableAutoConfiguration</code> å¼€å¯è‡ªåŠ¨é…ç½®ã€‚</p></li><li><p><code>@EnableWebMvc</code> æ ‡è®°ä¸º webåº”ç”¨ç¨‹åºã€‚</p></li><li><p><code>@ComponentScan</code> ç»„ä»¶æ‰«æã€‚</p></li></ol><h3 id="5-3-æ§åˆ¶å™¨"><a href="#5-3-æ§åˆ¶å™¨" class="headerlink" title="5.3 æ§åˆ¶å™¨"></a>5.3 æ§åˆ¶å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Greetings from Spring Boot!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@RestController</code> æ˜¯ <code>@RestController</code> ä¸ <code>@ResponseBody</code> çš„ç»“åˆä½“ã€‚</p><h3 id="5-4-è®¿é—®æµ‹è¯•"><a href="#5-4-è®¿é—®æµ‹è¯•" class="headerlink" title="5.4 è®¿é—®æµ‹è¯•"></a>5.4 è®¿é—®æµ‹è¯•</h3><p>ç›´æ¥å¯åŠ¨ <code>HelloApplication.java</code> ç±»å°±å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°å¯åŠ¨è¾“å‡ºï¼Œç„¶åè®¿é—®8080ç«¯å£æŸ¥çœ‹å¯åŠ¨æ˜¯å¦æ­£å¸¸ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/f8d782a2b291c6e082c116f5792088bb.png" alt="Spring boot é¡¹ç›®ç»“æ„"></p><p>ç»è¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œå·²ç»ä½¿ç”¨ Spring Boot å¿«é€Ÿçš„åˆ›å»ºäº†ä¸€ä¸ª web åº”ç”¨å¹¶è¿›è¡Œäº†ç®€å•çš„è®¿é—®æµ‹è¯•ã€‚</p><h2 id="6-Spring-Boot-å•å…ƒæµ‹è¯•"><a href="#6-Spring-Boot-å•å…ƒæµ‹è¯•" class="headerlink" title="6. Spring Boot å•å…ƒæµ‹è¯•"></a>6. Spring Boot å•å…ƒæµ‹è¯•</h2><p>ç»“åˆä¸Šé¢æåˆ°çš„ Spring Boot å¯åŠ¨å™¨çŸ¥è¯†ï¼ŒSpring Boot å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œæµ‹è¯•æ¡†æ¶ä¹Ÿä¸ä¾‹å¤–ã€‚</p><p>å¯¼å…¥å•å…ƒæµ‹è¯•ä¾èµ–ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">    &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="6-1-æ¨¡æ‹Ÿè¯·æ±‚æµ‹è¯•"><a href="#6-1-æ¨¡æ‹Ÿè¯·æ±‚æµ‹è¯•" class="headerlink" title="6.1 æ¨¡æ‹Ÿè¯·æ±‚æµ‹è¯•"></a>6.1 æ¨¡æ‹Ÿè¯·æ±‚æµ‹è¯•</h3><p>ç¼–å†™å•å…ƒæµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•å…ƒæµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@AutoConfigureMockMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MockMvc mvc;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        mvc.perform(MockMvcRequestBuilders.get(<span class="string">"/"</span>).accept(MediaType.APPLICATION_JSON))</span><br><span class="line">                .andExpect(status().isOk())</span><br><span class="line">                .andExpect(content().string(<span class="string">"Greetings from Spring Boot!"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºä¸Šé¢ä»£ç çš„ä¸€äº›è¯´æ˜ã€‚</p><ul><li><strong>MockMvc</strong> å…è®¸æˆ‘ä»¬æ–¹ä¾¿çš„å‘é€ HTTP è¯·æ±‚ã€‚</li><li><strong>SpringBootTest</strong> æ–¹ä¾¿çš„åˆ›å»ºä¸€ä¸ª Spring Boot é¡¹ç›®çš„æµ‹è¯•ç¨‹åºã€‚</li></ul><p>è¿è¡Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸è¯´æ˜ç¨‹åºæµ‹è¯•é€šè¿‡ã€‚</p><h3 id="6-2-Spring-Boot-é›†æˆæµ‹è¯•"><a href="#6-2-Spring-Boot-é›†æˆæµ‹è¯•" class="headerlink" title="6.2 Spring Boot é›†æˆæµ‹è¯•"></a>6.2 Spring Boot é›†æˆæµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.web.client.TestRestTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.server.LocalServerPort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.ResponseEntity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * åµŒå…¥å¼æœåŠ¡å™¨ç”±éšæœºç«¯å£å¯åŠ¨webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT</span></span><br><span class="line"><span class="comment"> * å¹¶ä¸”åœ¨è¿è¡Œæ—¶å‘ç°å®é™…ç«¯å£<span class="doctag">@LocalServerPort</span></span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/4 15:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span>(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplicationTestBySpringBoot</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LocalServerPort</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> URL base;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TestRestTemplate template;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.base = <span class="keyword">new</span> URL(<span class="string">"http://localhost:"</span> + port + <span class="string">"/"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getHello</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ResponseEntity&lt;String&gt; response = template.getForEntity(base.toString(), String.class);</span><br><span class="line">        <span class="keyword">assert</span> (response.getBody().equals(<span class="string">"Greetings from Spring Boot!"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åµŒå…¥å¼æœåŠ¡å™¨ç”±éšæœºç«¯å£å¯åŠ¨ <code>webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT</code></p><p>å¹¶ä¸”åœ¨è¿è¡Œæ—¶ä½¿ç”¨æ³¨è§£ <code>@LocalServerPort</code> å‘ç°å®é™…ç«¯å£ã€‚</p><p>è¿è¡Œæµ‹è¯•ç±»é€šè¿‡è¾“å‡ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2018-12-06 22:28:01.914  INFO 14320 --- [o-auto-1-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet &apos;dispatcherServlet&apos;</span><br><span class="line">2018-12-06 22:28:01.914  INFO 14320 --- [o-auto-1-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet &apos;dispatcherServlet&apos;</span><br><span class="line">2018-12-06 22:28:01.937  INFO 14320 --- [o-auto-1-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 23 ms</span><br></pre></td></tr></table></figure><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-hello" target="_blank" rel="noopener">Spring Boot å…¥é—¨æ¡ˆä¾‹</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ &lt;strong&gt;v2.1.1.RELEASE&lt;/strong&gt; è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/a60be3362289ed4d901bae342a685f84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº J2EE çš„å¼€å‘å˜å¾—ç¬¨é‡ï¼Œç¹å¤šçš„é…ç½®ï¼Œé”™ä¹±çš„ä¾èµ–ç®¡ç†ï¼Œä½ä¸‹çš„å¼€å‘æ•ˆç‡ï¼Œå¤æ‚çš„éƒ¨ç½²æµç¨‹ï¼Œç¬¬ä¸‰æ–¹æŠ€æœ¯çš„é›†æˆéš¾åº¦è¾ƒå¤§ç­‰ã€‚åŒæ—¶éšç€å¤æ‚é¡¹ç›®çš„æ¼”è¿›ï¼Œå¾®æœåŠ¡åˆ†å¸ƒå¼æ¶æ„æ€æƒ³é€æ¸è¿›å…¥å¼€å‘è€…çš„è§†é‡ã€‚&lt;/p&gt;
&lt;h2 id=&quot;1-Spring-Boot-ä»‹ç»&quot;&gt;&lt;a href=&quot;#1-Spring-Boot-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1. Spring Boot ä»‹ç»&quot;&gt;&lt;/a&gt;1. Spring Boot ä»‹ç»&lt;/h2&gt;&lt;p&gt;&lt;code&gt;Spring Boot&lt;/code&gt; æä¾›äº†ä¸€ç»„å·¥å…·åªéœ€è¦æå°‘çš„é…ç½®å°±å¯ä»¥å¿«é€Ÿçš„æ„å»ºå¹¶å¯åŠ¨åŸºäº Spring çš„åº”ç”¨ç¨‹åºã€‚è§£å†³äº†ä¼ ç»Ÿ Spring å¼€å‘éœ€è¦é…ç½®å¤§é‡é…ç½®æ–‡ä»¶çš„ç—›ç‚¹ï¼ŒåŒæ—¶ &lt;code&gt;Spring Boot&lt;/code&gt; å¯¹äºç¬¬ä¸‰æ–¹åº“è®¾ç½®äº†åˆç†çš„é»˜è®¤å€¼ï¼Œå¯ä»¥å¿«é€Ÿçš„æ„å»ºèµ·åº”ç”¨ç¨‹åºã€‚å½“ç„¶ &lt;code&gt;Spring Boot&lt;/code&gt; ä¹Ÿå¯ä»¥è½»æ¾çš„è‡ªå®šä¹‰å„ç§é…ç½®ï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘çš„åˆå§‹é˜¶æ®µè¿˜æ˜¯æŠ•å…¥ç”Ÿæˆçš„åæœŸé˜¶æ®µã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä½¿ç”¨ Lombok è¿›è¡Œä¼˜é›…çš„ç¼–ç </title>
    <link href="https://www.codingme.net/2018/12/develop/tool-Lombok/"/>
    <id>https://www.codingme.net/2018/12/develop/tool-Lombok/</id>
    <published>2018-12-29T16:08:10.000Z</published>
    <updated>2019-05-20T16:26:48.490Z</updated>
    
    <content type="html"><![CDATA[<p>Project Lombok æ˜¯ä¸€ä¸ª java åº“ï¼Œå®ƒå¯ä»¥é€šè¿‡æ³¨è§£è‡ªåŠ¨ä¸ºä½ è¦ç¼–å†™çš„ç±»æ·»åŠ ç›¸åº”åŠŸèƒ½ï¼Œå¦‚ get/set æ–¹æ³•ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p><p>å¼•å…¥ POM ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Lombokæ ¸å¿ƒä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ·»åŠ logbackæ—¥å¿—æ¡†æ¶æ”¯æŒï¼Œï¼ˆå¯æœ‰å¯æ— ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>æŸ¥çœ‹ä¾èµ–å…³ç³»å¯ä»¥å‘ç° <code>logback-classic</code> ä¾èµ–äº† <code>SLF4J-API</code> æ—¥å¿—é—¨é¢ä»¥åŠ l<code>ogback-core</code> æ—¥å¿—å®ç°æ¡†æ¶ã€‚</p><p><img src="/assets/1544414938730.png" alt="æ·»åŠ çš„pomä¾èµ–"><br>å…³äºæ—¥å¿—æ³¨è§£çš„é€‰æ‹©ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.projectlombok.org/features/log" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚é»˜è®¤çš„æ—¥å¿—è¾“å‡ºæ³¨é‡Šç±»ä¸ºè¢«æ³¨é‡Šçš„ç±»è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ topic å‚æ•°è‡ªå®šä¹‰ï¼Œå¦‚<code>@Slf4j(topic=&quot;reporting&quot;)</code>. ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šé€‰æ‹© <code>@Slf4j</code> è¿™ä¸ªæ—¥å¿—æŠ½è±¡ç±»ã€‚åœ¨ä½¿ç”¨è¿™ä¸ªæ³¨è§£çš„æ—¶å€™éœ€è¦å¯¼å…¥ SLF4-API æŠ½è±¡å±‚ä»¥åŠå…·ä½“çš„æ—¥å¿—å®ç°æ¡†æ¶ï¼Œä¸Šæ–¹çš„ä¾èµ–ä¸­æˆ‘ä»¬å·²ç»æ·»åŠ äº†æ—¥å¿—ä¾èµ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CommonsLog</span></span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.apache.commons.logging.Log log = org.apache.commons.logging.LogFactory.getLog(LogExample.class);</span><br><span class="line"><span class="meta">@Flogger</span></span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> com.google.common.flogger.FluentLogger log = com.google.common.flogger.FluentLogger.forEnclosingClass();</span><br><span class="line"><span class="meta">@JBossLog</span></span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.jboss.logging.Logger log = org.jboss.logging.Logger.getLogger(LogExample.class);</span><br><span class="line"><span class="meta">@Log</span></span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> java.util.logging.Logger log = java.util.logging.Logger.getLogger(LogExample.class.getName());</span><br><span class="line"><span class="meta">@Log</span>4j</span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.apache.log4j.Logger log = org.apache.log4j.Logger.getLogger(LogExample.class);</span><br><span class="line"><span class="meta">@Log</span>4j2</span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.apache.logging.log4j.Logger log = org.apache.logging.log4j.LogManager.getLogger(LogExample.class);</span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LogExample.class);</span><br><span class="line"><span class="meta">@XSlf</span>4j</span><br><span class="line">Creates <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.slf4j.ext.XLogger log = org.slf4j.ext.XLoggerFactory.getXLogger(LogExample.class);</span><br></pre></td></tr></table></figure><p><code>Lombok</code> çš„ä½¿ç”¨ä¸»è¦æ˜¯å‡ ä¸ªæ³¨è§£ï¼Œä¸‹é¢ä»‹ç»å¸¸ç”¨çš„å‡ ä¸ªæ³¨è§£ã€‚</p><p><code>@Getter/@Setter</code>   ä¸ºå±æ€§ç”Ÿæˆ get å’Œ set æ–¹æ³•ã€‚</p><p><code>@ToString</code> ç”Ÿæˆ toString æ–¹æ³•ï¼Œè¾“å‡ºå„ä¸ªå±æ€§å€¼ã€‚</p><p><code>@EqualsAndHashCode</code> ç”Ÿæˆ equals å’Œ hashCode æ–¹æ³•ã€‚</p><p><code>@NoArgsConstructor</code> ç”Ÿæˆæ— æƒ¨æ„é€ å™¨ã€‚</p><p><code>@AllArgsConstructor</code> ç”Ÿæˆå…¨å‚æ•°æ„é€ å™¨ã€‚</p><p><code>@Data</code> æ˜¯ä¸€ä¸ªæ–¹ä¾¿æ³¨è§£ï¼Œå®ƒæ†ç»‘äº† <code>@ToString</code> <code>@Getter/@Setter</code>  <code>@EqualsAndHashCode</code> ä»¥åŠ <code>@RequiredArgsConstructor</code>.</p><p>æ ¹æ®ä¸Šé¢çš„è§£é‡Šï¼Œç”¨ä¸‹é¢çš„ä¸€ä¸ªä¾‹å­æ¼”ç¤ºç”¨æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.*;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Lombokä½¿ç”¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/10 11:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j(topic = <span class="string">"Lombok"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LombokTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person person1 = <span class="keyword">new</span> Person();</span><br><span class="line">        person1.setName(<span class="string">"Darcy"</span>);</span><br><span class="line">        person1.setAge(<span class="number">22</span>);</span><br><span class="line">        person1.setTeacher(<span class="keyword">true</span>);</span><br><span class="line">        log.info(person1.toString());</span><br><span class="line"></span><br><span class="line">        Person person2 = <span class="keyword">new</span> Person(<span class="string">"Darcy"</span>, <span class="number">22</span>, <span class="keyword">true</span>);</span><br><span class="line">        log.info(person2.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> equals = person1.equals(person2);</span><br><span class="line">        log.info(<span class="string">"Equals:"</span> + equals);</span><br><span class="line">        log.info(person1.hashCode() + <span class="string">" and "</span> + person2.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@Getter</span></span><br><span class="line"><span class="comment">//@Setter</span></span><br><span class="line"><span class="comment">//@ToString</span></span><br><span class="line"><span class="comment">//@EqualsAndHashCode</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isTeacher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° Person ç±»é™¤äº†å‡ ä¸ªå±æ€§å®šä¹‰ä¹‹å¤–æ²¡æœ‰å…¶ä»–ä»»ä½•æ–¹æ³•ä»£ç ï¼Œè¿è¡Œ LombokTest å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°è¾“å‡ºå¦‚ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">12:12:57.687 [main] INFO  Lombok - Person(name=Darcy, age=22, isTeacher=true)</span><br><span class="line">12:12:57.690 [main] INFO  Lombok - Person(name=Darcy, age=22, isTeacher=true)</span><br><span class="line">12:12:57.690 [main] INFO  Lombok - Equals:true</span><br><span class="line">12:12:57.690 [main] INFO  Lombok - 1423350487 and 1423350487</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Project Lombok æ˜¯ä¸€ä¸ª java åº“ï¼Œå®ƒå¯ä»¥é€šè¿‡æ³¨è§£è‡ªåŠ¨ä¸ºä½ è¦ç¼–å†™çš„ç±»æ·»åŠ ç›¸åº”åŠŸèƒ½ï¼Œå¦‚ get/set æ–¹æ³•ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;å¼•å…¥ POM ä¾èµ–ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Lombokæ ¸å¿ƒä¾èµ– --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.projectlombok&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;lombok&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.18.4&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;provided&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- æ·»åŠ logbackæ—¥å¿—æ¡†æ¶æ”¯æŒï¼Œï¼ˆå¯æœ‰å¯æ— ï¼‰ --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;ch.qos.logback&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;logback-classic&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0.6&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="ç”Ÿäº§å·¥å…·" scheme="https://www.codingme.net/categories/%E7%94%9F%E4%BA%A7%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ï¼ˆä¸‰ï¼‰Kafka å…¥é—¨æŒ‡å—</title>
    <link href="https://www.codingme.net/2018/12/io/mq-kafka-introduction/"/>
    <id>https://www.codingme.net/2018/12/io/mq-kafka-introduction/</id>
    <published>2018-12-02T12:59:48.000Z</published>
    <updated>2019-05-20T16:26:48.584Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/c4725e4c2f3e90dc9908e6d0b974f7cc.png" alt="Apache Kafka"></p><h2 id="Kafka-æ¥æº"><a href="#Kafka-æ¥æº" class="headerlink" title="Kafka æ¥æº"></a>Kafka æ¥æº</h2><p><code>Kafka</code>çš„å‰èº«æ˜¯ç”±<code>LinkedIn</code>å¼€æºçš„ä¸€æ¬¾äº§å“ï¼Œ2011å¹´åˆå¼€å§‹å¼€æºï¼ŒåŠ å…¥äº† Apache åŸºé‡‘ä¼šï¼Œ2012å¹´ä» Apache Incubator æ¯•ä¸šå˜æˆäº† Apache é¡¶çº§å¼€æºé¡¹ç›®ã€‚åŒæ—¶LinkedInè¿˜æœ‰è®¸å¤šè‘—åçš„å¼€æºäº§å“ã€‚å¦‚ï¼š</p><ul><li>åˆ†å¸ƒå¼æ•°æ®åŒæ­¥ç³»ç»Ÿ<code>Databus</code></li><li>é«˜æ€§èƒ½è®¡ç®—å¼•æ“<code>Cubert</code></li><li>Javaå¼‚æ­¥å¤„ç†æ¡†æ¶<code>ParSeq</code></li><li><code>Kafka</code>æµå¤„ç†å¹³å°<a id="more"></a></li></ul><h2 id="Kafka-ä»‹ç»"><a href="#Kafka-ä»‹ç»" class="headerlink" title="Kafka ä»‹ç»"></a>Kafka ä»‹ç»</h2><p>Kafka ç”¨äºæ„å»ºå®æ—¶æ•°æ®ç®¡é“å’Œæµåº”ç”¨ç¨‹åºã€‚å®ƒå…·æœ‰æ°´å¹³å¯æ‰©å±•æ€§ï¼Œå®¹é”™æ€§ï¼Œå¿«é€Ÿæ€§ï¼Œå¹¶åœ¨æ•°åƒå®¶å…¬å¸çš„ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œã€‚</p><p>ä»å®˜æ–¹æˆ‘ä»¬å¯ä»¥çŸ¥é“<code>ApacheKafka</code>æ˜¯<em>ä¸€ä¸ªåˆ†å¸ƒå¼æµåª’ä½“å¹³å°</em>ã€‚è¿™åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><p>æµåª’ä½“å¹³å°æœ‰ä¸‰ä¸ªå…³é”®åŠŸèƒ½ï¼š</p><ul><li>å‘å¸ƒå’Œè®¢é˜…è®°å½•æ•°æ®æµï¼Œç±»ä¼¼äºæ¶ˆæ¯é˜Ÿåˆ—æˆ–ä¼ä¸šæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿã€‚</li><li>æœ‰å®¹é”™èƒ½åŠ›çš„å¯ä»¥æŒä¹…åŒ–çš„å­˜å‚¨æ•°æ®æµã€‚</li><li>è®°å½•å‘ç”Ÿæ—¶å¯ä»¥è¿›è¡Œæµå¤„ç†ã€‚</li></ul><p>Kafka é€šå¸¸ç”¨äºä¸¤å¤§ç±»åº”ç”¨ï¼š</p><ul><li>æ„å»ºå¯åœ¨ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºä¹‹é—´å¯é è·å–æ•°æ®çš„å®æ—¶æµæ•°æ®ç®¡é“</li><li>æ„å»ºè½¬æ¢æˆ–å“åº”æ•°æ®æµçš„å®æ—¶æµå¤„ç†</li></ul><h2 id="Kafka-åŸºæœ¬æ¦‚å¿µ"><a href="#Kafka-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="Kafka åŸºæœ¬æ¦‚å¿µ"></a>Kafka åŸºæœ¬æ¦‚å¿µ</h2><ul><li><strong>Producer</strong> - æ¶ˆæ¯å’Œæ•°æ®çš„ç”Ÿäº§è€…ï¼Œå‘ Kafka çš„ä¸€ä¸ª Topic å‘å¸ƒæ¶ˆæ¯çš„è¿›ç¨‹/ä»£ç /æœåŠ¡ã€‚</li><li><strong>Consumer </strong>- æ¶ˆæ¯å’Œæ•°æ®çš„æ¶ˆè´¹è€…ï¼Œè®¢é˜…æ•°æ®ï¼ˆTopicï¼‰å¹¶ä¸”å¤„ç†å…¶å‘å¸ƒçš„æ¶ˆæ¯çš„è¿›ç¨‹/ä»£ç /æœåŠ¡ã€‚</li><li><strong>Consumer Group</strong> - é€»è¾‘æ¦‚å¿µï¼Œå¯¹äºåŒä¸€ä¸ª Topicï¼Œä¼šå¹¿æ’­ä¸åŒçš„ Groupï¼Œä¸€ä¸ªGroupä¸­ï¼Œåªæœ‰ä¸€ä¸ªconsumer å¯ä»¥æ¶ˆè´¹è¯¥æ¶ˆæ¯ã€‚</li><li><strong>Broker</strong> - ç‰©ç†æ¦‚å¿µï¼ŒKafka é›†ç¾¤ä¸­çš„æ¯ä¸ª Kafka èŠ‚ç‚¹ã€‚</li><li><strong>Topic</strong> - é€»è¾‘æ¦‚å¿µï¼ŒKafkaæ¶ˆæ¯çš„ç±»åˆ«ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŒºåˆ†ï¼Œéš”ç¦»ã€‚</li><li><strong>Partition</strong> - ç‰©ç†æ¦‚å¿µï¼Œåˆ†ç‰‡ï¼ŒKafka ä¸‹æ•°æ®å­˜å‚¨çš„åŸºæœ¬å•å…ƒï¼Œä¸€ä¸ª Topic æ•°æ®ï¼Œä¼šè¢«åˆ†æ•£å­˜å‚¨åˆ°å¤šä¸ªPartitionï¼Œæ¯ä¸€ä¸ªPartitionæ˜¯æœ‰åºçš„ã€‚</li><li><strong>Replication </strong>- å‰¯æœ¬ï¼ŒåŒä¸€ä¸ª Partition å¯èƒ½ä¼šæœ‰å¤šä¸ª Replica ï¼Œå¤šä¸ª Replica ä¹‹é—´æ•°æ®æ˜¯ä¸€æ ·çš„ã€‚</li><li><strong>Replication Leader</strong> - ä¸€ä¸ª Partition çš„å¤šä¸ª Replica ä¸Šï¼Œéœ€è¦ä¸€ä¸ª Leade rè´Ÿè´£è¯¥ Partition ä¸Šä¸ Produce å’Œ Consumer äº¤äº’</li><li><strong>ReplicaManager</strong> - è´Ÿè´£ç®¡ç†å½“å‰çš„ broker æ‰€æœ‰åˆ†åŒºå’Œå‰¯æœ¬çš„ä¿¡æ¯ï¼Œå¤„ç† KafkaController å‘èµ·çš„ä¸€äº›è¯·æ±‚ï¼Œå‰¯æœ¬çŠ¶æ€çš„åˆ‡æ¢ï¼Œæ·»åŠ /è¯»å–æ¶ˆæ¯ç­‰ã€‚</li></ul><h3 id="æ¦‚å¿µçš„å»¶ä¼¸"><a href="#æ¦‚å¿µçš„å»¶ä¼¸" class="headerlink" title="æ¦‚å¿µçš„å»¶ä¼¸"></a>æ¦‚å¿µçš„å»¶ä¼¸</h3><p>Partition</p><ul><li>æ¯ä¸€ä¸ªTopicè¢«åˆ‡åˆ†ä¸ºå¤šä¸ªPartitions</li><li>æ¶ˆè´¹è€…æ•°æ®è¦å°äºç­‰äºPartitionçš„æ•°é‡</li><li>Broker Groupä¸­çš„æ¯ä¸€ä¸ªBrokerä¿å­˜Topicçš„ä¸€ä¸ªæˆ–å¤šä¸ªPartitions</li><li>Consumer Groupä¸­çš„ä»…æœ‰ä¸€ä¸ªConsumerè¯»å–Topicçš„ä¸€ä¸ªæˆ–å¤šä¸ªPartionsï¼Œå¹¶ä¸”æ˜¯å”¯ä¸€çš„Consumerã€‚</li></ul><p>Replication</p><ul><li>å½“é›†ç¾¤ä¸­æœ‰BrokeræŒ‚æ‰çš„æ—¶å€™ï¼Œç³»ç»Ÿå¯ä»¥ä¸»åŠ¨çš„ä½¿ç”¨Replicasæä¾›æœåŠ¡ã€‚</li><li>ç³»ç»Ÿé»˜è®¤è®¾ç½®æ¯ä¸€ä¸ªTopicçš„Replicationçš„ç³»æ•°ä¸º1ï¼Œå¯ä»¥åœ¨åˆ›å»ºTopicçš„æ—¶å€™å•ç‹¬è®¾ç½®ã€‚</li></ul><p>Replicationç‰¹ç‚¹</p><ul><li>Replicationçš„åŸºæœ¬å•ä½æ˜¯Topicçš„Partitionã€‚</li><li>æ‰€æœ‰çš„è¯»å’Œå†™éƒ½ä»Leaderè¿›ï¼ŒFollowersåªæ˜¯ä½œä¸ºå¤‡ä»½ã€‚</li><li>Followerå¿…é¡»èƒ½å¤ŸåŠæ—¶çš„å¤åˆ¶Leaderçš„æ•°æ®</li><li>å¢åŠ å®¹é”™æ€§ä¸å¯æ‰©å±•æ€§ã€‚</li></ul><h2 id="Kafka-æ¶ˆæ¯ç»“æ„"><a href="#Kafka-æ¶ˆæ¯ç»“æ„" class="headerlink" title="Kafka æ¶ˆæ¯ç»“æ„"></a>Kafka æ¶ˆæ¯ç»“æ„</h2><p>åœ¨ Kafka2.0 ä¸­çš„æ¶ˆæ¯ç»“æ„å¦‚ä¸‹ï¼ˆæ•´ç†è‡ªå®˜ç½‘ï¼‰ã€‚</p><blockquote><p>baseOffset: int64 - ç”¨äºè®°å½•Kafkaè¿™ä¸ªæ¶ˆæ¯æ‰€å¤„çš„åç§»ä½ç½®<br>batchLength: int32 - ç”¨äºè®°å½•æ•´ä¸ªæ¶ˆæ¯çš„é•¿åº¦<br>partitionLeaderEpoch: int32<br>magic: int8 (current magic value is 2) -  ä¸€ä¸ªå›ºå®šå€¼ï¼Œç”¨äºå¿«é€Ÿåˆ¤æ–­æ˜¯å¦æ˜¯Kafkaæ¶ˆæ¯<br>crc: int32 - ç”¨äºæ ¡éªŒä¿¡æ¯çš„å®Œæ•´æ€§<br>attributes: int16 - å½“å‰æ¶ˆæ¯çš„ä¸€äº›å±æ€§</p><blockquote><p> bit 0~2:</p><blockquote><p>0: no compression<br>1: gzip<br>2: snappy<br>3: lz4</p></blockquote><p>  bit 3: timestampType<br>â€‹ bit 4: isTransactional (0 means not transactional)<br>â€‹ bit 5: isControlBatch (0 means not a control batch)<br>â€‹ bit 6~15: unused</p></blockquote><p>lastOffsetDelta: int32<br> firstTimestamp : int64<br> maxTimestamp: int64<br> producerId: int64<br> producerEpoch: int16<br> baseSequence: int32<br> records: </p><blockquote><p> length: varint<br> attributes: int8</p><blockquote><p>   bit 0~7: unused</p></blockquote><p> timestampDelta: varint<br> offsetDelta: varint<br> keyLength: varint<br> key: byte[]<br> valueLen: varint<br> value: byte[]<br> Headers =&gt; [Header]</p><blockquote><p>headerKeyLength: varint<br>headerKey: String<br>headerValueLength: varint<br>Value: byte[]</p></blockquote></blockquote></blockquote><p>å…³äºæ¶ˆæ¯ç»“æ„çš„ä¸€äº›é‡Šä¹‰ã€‚</p><ul><li>Offset -ç”¨äºè®°å½•Kafkaè¿™ä¸ªæ¶ˆæ¯æ‰€å¤„çš„åç§»ä½ç½®</li><li>Length - ç”¨äºè®°å½•æ•´ä¸ªæ¶ˆæ¯çš„é•¿åº¦ </li><li>CRC32 - ç”¨äºæ ¡éªŒä¿¡æ¯çš„å®Œæ•´æ€§</li><li>Magic - ä¸€ä¸ªå›ºå®šå€¼ï¼Œç”¨äºå¿«é€Ÿåˆ¤æ–­æ˜¯å¦æ˜¯Kafkaæ¶ˆæ¯</li><li>Attributes - å½“å‰æ¶ˆæ¯çš„ä¸€äº›å±æ€§</li><li>Timestamp - æ¶ˆæ¯çš„æ—¶é—´æˆ³</li><li>Key Length - keyçš„é•¿åº¦</li><li>Key - Keyçš„å…·ä½“å€¼</li><li>Value Length - å€¼çš„é•¿åº¦</li><li>Value - å…·ä½“çš„æ¶ˆæ¯å€¼</li></ul><h2 id="Kafka-ä¼˜ç‚¹"><a href="#Kafka-ä¼˜ç‚¹" class="headerlink" title="Kafka ä¼˜ç‚¹"></a>Kafka ä¼˜ç‚¹</h2><ol><li>åˆ†å¸ƒå¼ - Kafkaæ˜¯åˆ†å¸ƒå¼çš„ï¼Œå¤šåˆ†åŒºï¼Œå¤šå‰¯æœ¬çš„å’Œå¤šè®¢é˜…è€…çš„ï¼ŒåŸºäºZookeeperè°ƒåº¦ã€‚</li><li>æŒä¹…æ€§å’Œæ‰©å±•æ€§ - Kafkaä½¿ç”¨åˆ†å¸ƒå¼æäº¤æ—¥å¿—ï¼Œè¿™æ„å‘³ç€æ¶ˆæ¯ä¼šå°½å¯èƒ½å¿«åœ°ä¿ç•™åœ¨ç£ç›˜ä¸Šï¼Œå› æ­¤å®ƒæ˜¯æŒä¹…çš„ã€‚åŒæ—¶å…·æœ‰ä¸€å®šçš„å®¹é”™æ€§ï¼ŒKafkaæ”¯æŒåœ¨çº¿çš„æ°´å¹³æ‰©å±•ï¼Œæ¶ˆæ¯çš„è‡ªå¹³è¡¡ã€‚</li><li>é«˜æ€§èƒ½ - Kafkaå¯¹äºå‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯éƒ½å…·æœ‰é«˜ååé‡ã€‚ å³ä½¿å­˜å‚¨äº†è®¸å¤šTBçš„æ¶ˆæ¯ï¼Œå®ƒä¹Ÿä¿æŒç¨³å®šçš„æ€§èƒ½ã€‚ä¸”å»¶è¿Ÿä½ï¼Œé€‚ç”¨é«˜å¹¶å‘ã€‚æ—¶é—´å¤æ‚çš„ä¸ºo(1)ã€‚</li></ol><h2 id="Kafka-åº”ç”¨"><a href="#Kafka-åº”ç”¨" class="headerlink" title="Kafka åº”ç”¨"></a>Kafka åº”ç”¨</h2><ol><li>ç”¨äºèšåˆåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºä¸­çš„æ¶ˆæ¯ã€‚è¿›è¡Œæ“ä½œç›‘æ§ã€‚</li><li>ç”¨äºè·¨ç»„ç»‡çš„ä»å¤šä¸ªæœåŠ¡æ”¶é›†æ—¥å¿—ï¼Œç„¶åæä¾›ç»™å¤šä¸ªæœåŠ¡å™¨ï¼Œè§£å†³æ—¥å¿—èšåˆé—®é¢˜ã€‚</li><li>ç”¨äºæµå¤„ç†ï¼Œå¦‚Stormå’ŒSpark Streamingï¼Œä»kafkaä¸­è¯»å–æ•°æ®ï¼Œç„¶åå¤„ç†åœ¨å†™å…¥kafkaä¾›åº”ç”¨ä½¿ç”¨ã€‚</li></ol><h2 id="Kafka-å®‰è£…"><a href="#Kafka-å®‰è£…" class="headerlink" title="Kafka å®‰è£…"></a>Kafka å®‰è£…</h2><h3 id="å®‰è£…-Jdk"><a href="#å®‰è£…-Jdk" class="headerlink" title="å®‰è£… Jdk"></a>å®‰è£… Jdk</h3><p>å…·ä½“æ­¥éª¤æ­¤å¤„ä¸è¯´ã€‚</p><h3 id="å®‰è£…-Kafka"><a href="#å®‰è£…-Kafka" class="headerlink" title="å®‰è£… Kafka"></a>å®‰è£… Kafka</h3><p>ç›´æ¥<a href="http://kafka.apache.org/downloads" target="_blank" rel="noopener">å®˜æ–¹ç½‘ç«™</a>ä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„ç‰ˆæœ¬è§£å‹å³å¯ã€‚<br>ç”±äºKafkaå¯¹äºwindowså’ŒUnixå¹³å°çš„æ§åˆ¶è„šæœ¬æ˜¯ä¸åŒçš„ï¼Œå› æ­¤å¦‚æœæ˜¯windowså¹³å°ï¼Œè¦ä½¿ç”¨<code>bin\windows\</code>è€Œä¸æ˜¯<code>bin/</code>ï¼Œå¹¶å°†è„šæœ¬æ‰©å±•åæ›´æ”¹ä¸º<code>.bat</code>ã€‚ä»¥ä¸‹å‘½ä»¤æ˜¯åŸºäºUnixå¹³å°çš„ä½¿ç”¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> è§£å‹</span><br><span class="line">tar -xzf kafka_2.11-2.0.0.tgz</span><br><span class="line"><span class="meta">#</span> å¯åŠ¨Zookeeper</span><br><span class="line">bin/zookeeper-server-start.sh config/zookeeper.properties</span><br><span class="line"><span class="meta">#</span> å¯åŠ¨Kafka</span><br><span class="line">bin/kafka-server-start.sh config/server.properties</span><br><span class="line"><span class="meta">#</span> æˆ–è€…åå°å¯åŠ¨</span><br><span class="line">bin/kafka-server-start.sh config/server.properties &amp;</span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸ºâ€œtestâ€çš„ä¸»é¢˜ï¼Œå®ƒåªåŒ…å«ä¸€ä¸ªåˆ†åŒºï¼Œåªæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`&gt; bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬è¿è¡Œlist topicå‘½ä»¤ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥çœ‹åˆ°è¯¥ä¸»é¢˜ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`&gt; bin/kafka-topics.sh --list --zookeeper localhost:2181 test</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°†ä»£ç†é…ç½®ä¸ºåœ¨å‘å¸ƒä¸å­˜åœ¨çš„ä¸»é¢˜æ—¶è‡ªåŠ¨åˆ›å»ºä¸»é¢˜ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨åˆ›å»ºä¸»é¢˜ã€‚</p><p>æŸ¥çœ‹Topicçš„ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kafka-topics.sh --describe --zookeeper localhost:2181 --topic Hello-Kafka</span><br></pre></td></tr></table></figure><p>è¿è¡Œç”Ÿäº§è€…ï¼Œç„¶ååœ¨æ§åˆ¶å°ä¸­é”®å…¥ä¸€äº›æ¶ˆæ¯ä»¥å‘é€åˆ°æœåŠ¡å™¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test </span><br><span class="line">This is a message</span><br><span class="line">This is another message`</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ¶ˆè´¹è€…ï¼ŒæŸ¥çœ‹æ”¶åˆ°çš„æ¶ˆæ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning</span><br><span class="line"><span class="meta">&gt;</span> This is a message</span><br><span class="line"><span class="meta">&gt;</span> This is another message</span><br></pre></td></tr></table></figure><h2 id="Kafka-å·¥ç¨‹å®ä¾‹"><a href="#Kafka-å·¥ç¨‹å®ä¾‹" class="headerlink" title="Kafka å·¥ç¨‹å®ä¾‹"></a>Kafka å·¥ç¨‹å®ä¾‹</h2><h3 id="POM-ä¾èµ–"><a href="#POM-ä¾èµ–" class="headerlink" title="POM ä¾èµ–"></a>POM ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.kafka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>kafka-clients<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç”Ÿäº§è€…"><a href="#ç”Ÿäº§è€…" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h3><p>ç¼–å†™ç”Ÿäº§è€… Java ä»£ç ã€‚å…³äº Properties ä¸­çš„å€¼çš„æ„æ€æè¿°å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ° <a href="http://kafka.apache.org/documentation.html#producerconfigs" target="_blank" rel="noopener">http://kafka.apache.org/</a> ã€‚ä¸‹é¢çš„ç”Ÿäº§è€…å‘ Kafka æ¨é€äº†10æ¡æ¶ˆæ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.KafkaProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.Producer;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerRecord;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Kafkaç”Ÿäº§è€…,å‘é€10ä¸ªæ•°æ®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/11/16 15:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyProducer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Properties props = <span class="keyword">new</span> Properties();</span><br><span class="line">        props.put(<span class="string">"bootstrap.servers"</span>, <span class="string">"192.168.110.132:9092"</span>);</span><br><span class="line">        props.put(<span class="string">"acks"</span>, <span class="string">"all"</span>);</span><br><span class="line">        props.put(<span class="string">"retries"</span>, <span class="number">0</span>);</span><br><span class="line">        props.put(<span class="string">"batch.size"</span>, <span class="number">16384</span>);</span><br><span class="line">        props.put(<span class="string">"linger.ms"</span>, <span class="number">1</span>);</span><br><span class="line">        props.put(<span class="string">"buffer.memory"</span>, <span class="number">33554432</span>);</span><br><span class="line">        props.put(<span class="string">"key.serializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringSerializer"</span>);</span><br><span class="line">        props.put(<span class="string">"value.serializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringSerializer"</span>);</span><br><span class="line"></span><br><span class="line">        Producer&lt;String, String&gt; producer = <span class="keyword">new</span> KafkaProducer&lt;&gt;(props);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            producer.send(<span class="keyword">new</span> ProducerRecord&lt;String, String&gt;(<span class="string">"test"</span>, Integer.toString(i), Integer.toString(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        producer.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h3><p>ç¼–å†™æ¶ˆè´¹è€… Java ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.ConsumerRecord;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.ConsumerRecords;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.KafkaConsumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Kafkaæ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/11/19 15:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Properties props = <span class="keyword">new</span> Properties();</span><br><span class="line">        props.put(<span class="string">"bootstrap.servers"</span>, <span class="string">"192.168.110.132:9092"</span>);</span><br><span class="line">        props.put(<span class="string">"group.id"</span>, <span class="string">"test"</span>);</span><br><span class="line">        props.put(<span class="string">"enable.auto.commit"</span>, <span class="string">"true"</span>);</span><br><span class="line">        props.put(<span class="string">"auto.commit.interval.ms"</span>, <span class="string">"1000"</span>);</span><br><span class="line">        props.put(<span class="string">"key.deserializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringDeserializer"</span>);</span><br><span class="line">        props.put(<span class="string">"value.deserializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringDeserializer"</span>);</span><br><span class="line">        KafkaConsumer&lt;String, String&gt; consumer = <span class="keyword">new</span> KafkaConsumer&lt;&gt;(props);</span><br><span class="line">        consumer.subscribe(Arrays.asList(<span class="string">"test"</span>));</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            ConsumerRecords&lt;String, String&gt; records = consumer.poll(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">for</span> (ConsumerRecord&lt;String, String&gt; record : records) &#123;</span><br><span class="line">                System.out.printf(<span class="string">"offset = %d, key = %s, value = %s%n"</span>, record.offset(), record.key(), record.value());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°æˆåŠŸè¿è¡Œåçš„è¾“å‡ºï¼Œç”± offset å¯ä»¥çœ‹åˆ°å·²ç»æ¶ˆè´¹äº†10æ¡æ¶ˆæ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> INFO | Kafka version : 2.0.0</span><br><span class="line"> INFO | Kafka commitId : 3402a8361b734732</span><br><span class="line"> INFO | Cluster ID: 0Xrk5M1CSJet0m1ut3zbiw</span><br><span class="line"> INFO | [Consumer clientId=consumer-1, groupId=test] Discovered group coordinator 192.168.110.132:9092 (id: 2147483647 rack: null)</span><br><span class="line"> INFO | [Consumer clientId=consumer-1, groupId=test] Revoking previously assigned partitions []</span><br><span class="line"> INFO | [Consumer clientId=consumer-1, groupId=test] (Re-)joining group</span><br><span class="line"> INFO | [Consumer clientId=consumer-1, groupId=test] Successfully joined group with generation 4</span><br><span class="line"> INFO | [Consumer clientId=consumer-1, groupId=test] Setting newly assigned partitions [test-0]</span><br><span class="line">offset = 38, key = 0, value = 0</span><br><span class="line">offset = 39, key = 1, value = 1</span><br><span class="line">offset = 40, key = 2, value = 2</span><br><span class="line">offset = 41, key = 3, value = 3</span><br><span class="line">offset = 42, key = 4, value = 4</span><br><span class="line">offset = 43, key = 5, value = 5</span><br><span class="line">offset = 44, key = 6, value = 6</span><br><span class="line">offset = 45, key = 7, value = 7</span><br><span class="line">offset = 46, key = 8, value = 8</span><br><span class="line">offset = 47, key = 9, value = 9</span><br></pre></td></tr></table></figure></p><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>å¦‚æœ<code>java.net.InetAddress.getCanonicalHostName</code> å–åˆ°çš„æ˜¯ä¸»æœºåã€‚éœ€è¦ä¿®æ”¹ Kafka çš„é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim server.properties</span><br><span class="line"><span class="meta">#</span> x.x.x.xæ˜¯æœåŠ¡å™¨IP</span><br><span class="line">advertised.listeners=PLAINTEXT://x.x.x.x:9092</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/c4725e4c2f3e90dc9908e6d0b974f7cc.png&quot; alt=&quot;Apache Kafka&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Kafka-æ¥æº&quot;&gt;&lt;a href=&quot;#Kafka-æ¥æº&quot; class=&quot;headerlink&quot; title=&quot;Kafka æ¥æº&quot;&gt;&lt;/a&gt;Kafka æ¥æº&lt;/h2&gt;&lt;p&gt;&lt;code&gt;Kafka&lt;/code&gt;çš„å‰èº«æ˜¯ç”±&lt;code&gt;LinkedIn&lt;/code&gt;å¼€æºçš„ä¸€æ¬¾äº§å“ï¼Œ2011å¹´åˆå¼€å§‹å¼€æºï¼ŒåŠ å…¥äº† Apache åŸºé‡‘ä¼šï¼Œ2012å¹´ä» Apache Incubator æ¯•ä¸šå˜æˆäº† Apache é¡¶çº§å¼€æºé¡¹ç›®ã€‚åŒæ—¶LinkedInè¿˜æœ‰è®¸å¤šè‘—åçš„å¼€æºäº§å“ã€‚å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼æ•°æ®åŒæ­¥ç³»ç»Ÿ&lt;code&gt;Databus&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é«˜æ€§èƒ½è®¡ç®—å¼•æ“&lt;code&gt;Cubert&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Javaå¼‚æ­¥å¤„ç†æ¡†æ¶&lt;code&gt;ParSeq&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kafka&lt;/code&gt;æµå¤„ç†å¹³å°
    
    </summary>
    
      <category term="ä¸­é—´ä»¶" scheme="https://www.codingme.net/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
      <category term="ä¸­é—´ä»¶" scheme="https://www.codingme.net/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
      <category term="æ¶ˆæ¯é˜Ÿåˆ—" scheme="https://www.codingme.net/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    
      <category term="Kafka" scheme="https://www.codingme.net/tags/Kafka/"/>
    
  </entry>
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ï¼ˆäºŒï¼‰ä½¿ç”¨ ActiveMQ</title>
    <link href="https://www.codingme.net/2018/12/io/mq-activemq/"/>
    <id>https://www.codingme.net/2018/12/io/mq-activemq/</id>
    <published>2018-12-01T08:59:48.000Z</published>
    <updated>2019-05-20T16:26:48.577Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/fc60f07d8257056ab302149f1ebc6290.png" alt="ActiveMQ-log"></p><h2 id="ActiveMQ-ä»‹ç»"><a href="#ActiveMQ-ä»‹ç»" class="headerlink" title="ActiveMQ ä»‹ç»"></a>ActiveMQ ä»‹ç»</h2><p>Active MQ æ˜¯ç”± Apache å‡ºå“çš„ä¸€æ¬¾æµè¡Œçš„åŠŸèƒ½å¼ºå¤§çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒé€Ÿåº¦å¿«ï¼Œæ”¯æŒè·¨è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œå…·æœ‰æ˜“äºä½¿ç”¨çš„ä¼ä¸šé›†æˆæ¨¡å¼å’Œè®¸å¤šçš„é«˜çº§åŠŸèƒ½ï¼ŒåŒæ—¶å®Œå…¨æ”¯æŒ <a href="https://www.oracle.com/technetwork/java/jms/index.html" target="_blank" rel="noopener">JSM1.1</a> å’Œ J2EE1.4 ã€‚</p><ul><li><p>å®˜æ–¹ä¸‹è½½åœ°å€ï¼š <a href="http://activemq.apache.org/download.html" target="_blank" rel="noopener">http://activemq.apache.org/download.html</a></p></li><li><p>å®˜æ–¹å®‰è£…æ•™ç¨‹ï¼š <a href="http://activemq.apache.org/getting-started.html#GettingStarted-InstallationProcedureforWindows" target="_blank" rel="noopener">http://activemq.apache.org/getting-started.html</a></p></li><li><p>é»˜è®¤ç®¡ç†é¡µé¢ï¼š<a href="http://127.0.0.1:8161/admin/" target="_blank" rel="noopener">http://127.0.0.1:8161/admin/</a>  </p><p>é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸ºadmin / adminã€‚æ‚¨å¯ä»¥åœ¨conf / jetty-real.propertiesæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚</p></li><li><p>é»˜è®¤æœåŠ¡ç«¯å£ï¼š61616</p><a id="more"></a></li></ul><h2 id="ActiveMQ-ç‰¹ç‚¹"><a href="#ActiveMQ-ç‰¹ç‚¹" class="headerlink" title="ActiveMQ ç‰¹ç‚¹"></a>ActiveMQ ç‰¹ç‚¹</h2><ul><li>æ”¯æŒJavaï¼ŒCï¼ŒC ++ï¼ŒCï¼ƒï¼ŒRubyï¼ŒPerlï¼ŒPythonï¼ŒPHPç­‰å„ç§è·¨è¯­è¨€å®¢æˆ·ç«¯å’Œåè®®ï¼Œå¦‚ OpenWire , Stomp , AMQP , MQTT.</li><li>å®Œå…¨æ”¯æŒJMS 1.1å’Œ J2EE 1.4ï¼Œæ”¯æŒç¬æ€ï¼ŒæŒä¹…ï¼Œäº‹åŠ¡å’ŒXAæ¶ˆæ¯ä¼ é€’ã€‚</li><li>å¯¹ Spring æ¡†æ¶çš„æ”¯æŒä»¥ä¾¿ActiveMQå¯ä»¥è½»æ¾åµŒå…¥åˆ°Springåº”ç”¨ç¨‹åºä¸­ã€‚</li><li>é€šè¿‡äº†å¸¸è§çš„ J2EE æœåŠ¡å™¨æµ‹è¯•ï¼Œå¦‚ TomEEï¼ŒGeronimoï¼ŒJBossï¼ŒGlassFish å’Œ WebLogic ã€‚</li><li>è¿æ¥æ–¹å¼çš„å¤šæ ·åŒ–ï¼ŒActiveMQ æä¾›äº†å¤šç§è¿æ¥æ¨¡å¼ï¼Œä¾‹å¦‚ in-VMã€TCPã€SSLã€NIOã€UDPã€å¤šæ’­ã€JGroupsã€JXTAã€‚</li><li>å¯ä»¥é€šè¿‡ä½¿ç”¨ JDBC å’Œ journal å®ç°æ¶ˆæ¯çš„å¿«é€ŸæŒä¹…åŒ–ã€‚</li><li>ä¸“ä¸ºé«˜æ€§èƒ½ç¾¤é›†ï¼Œå®¢æˆ·ç«¯ - æœåŠ¡å™¨ï¼Œç‚¹å¯¹ç‚¹é€šä¿¡è€Œè®¾è®¡ã€‚</li><li>æä¾›ä¸è¯­è¨€æ— å…³çš„ REST APIã€‚</li><li>æ”¯æŒ Ajax æ–¹å¼è°ƒç”¨ ActiveMQã€‚</li><li>ActiveMQ å¯ä»¥è½»æ¾åœ°ä¸ CXFã€Axis ç­‰ Web Service æŠ€æœ¯æ•´åˆï¼Œä»¥æä¾›å¯é çš„æ¶ˆæ¯ä¼ é€’ã€‚</li><li>å¯ç”¨ä½œä¸ºå†…å­˜ä¸­çš„ JMS æä¾›è€…ï¼Œéå¸¸é€‚åˆ JMS å•å…ƒæµ‹è¯•ã€‚</li></ul><h2 id="ActiveMQ-æ¶ˆæ¯"><a href="#ActiveMQ-æ¶ˆæ¯" class="headerlink" title="ActiveMQ æ¶ˆæ¯"></a>ActiveMQ æ¶ˆæ¯</h2><ol><li>ç‚¹å¯¹ç‚¹é˜Ÿåˆ—æ¨¡å¼<br>æ¶ˆæ¯åˆ°è¾¾æ¶ˆæ¯ç³»ç»Ÿï¼Œè¢«ä¿ç•™åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œä¸€ä¸ªæ¶ˆæ¯åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç„¶åå°±ä¼šè¢«ç§»é™¤ã€‚ä¾‹å¦‚è®¢å•å¤„ç†ç³»ç»Ÿã€‚</li><li>å‘å¸ƒ-è®¢é˜…æ¨¡å¼<br>æ¶ˆæ¯å‘é€æ—¶æŒ‡å®šä¸»é¢˜ï¼ˆæˆ–è€…è¯´é€šé“ï¼‰ï¼Œæ¶ˆæ¯è¢«ä¿ç•™åœ¨æŒ‡å®šçš„ä¸»é¢˜ä¸­ï¼Œæ¶ˆè´¹è€…å¯ä»¥è®¢é˜…å¤šä¸ªä¸»é¢˜ï¼Œå¹¶ä½¿ç”¨ä¸»é¢˜ä¸­çš„æ‰€æœ‰çš„æ¶ˆæ¯ï¼Œä¾‹å¦‚ç°å®ä¸­çš„ç”µè§†ä¸ç”µè§†é¢‘é“ã€‚æ‰€æœ‰å®¢æˆ·ç«¯åŒ…æ‹¬å‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼Œä¸»é¢˜ä¸­çš„æ¶ˆæ¯å¯ä»¥è¢«æ‰€æœ‰çš„è®¢é˜…è€…æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…åªèƒ½æ¶ˆè´¹è®¢é˜…ä¹‹åå‘é€åˆ°ä¸»é¢˜ä¸­çš„æ¶ˆæ¯ã€‚</li></ol><h2 id="ActiveMQ-æ¦‚å¿µ"><a href="#ActiveMQ-æ¦‚å¿µ" class="headerlink" title="ActiveMQ æ¦‚å¿µ"></a>ActiveMQ æ¦‚å¿µ</h2><ul><li>Brokerï¼Œæ¶ˆæ¯ä»£ç†ï¼Œè¡¨ç¤ºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“ï¼Œæ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Œæä¾›æ¶ˆæ¯é€šä¿¡çš„æ ¸å¿ƒæœåŠ¡ã€‚</li><li>Producerï¼Œæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œä¸šåŠ¡çš„å‘èµ·æ–¹ï¼Œè´Ÿè´£ç”Ÿäº§æ¶ˆæ¯å¹¶ä¼ è¾“ç»™ Broker ã€‚</li><li>Consumerï¼Œæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œä¸šåŠ¡çš„å¤„ç†æ–¹ï¼Œè´Ÿè´£ä» Broker è·å–æ¶ˆæ¯å¹¶è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚</li><li>Topicï¼Œä¸»é¢˜ï¼Œå‘å¸ƒè®¢é˜…æ¨¡å¼ä¸‹çš„æ¶ˆæ¯ç»Ÿä¸€æ±‡é›†åœ°ï¼Œä¸åŒç”Ÿäº§è€…å‘ Topic å‘é€æ¶ˆæ¯ï¼Œç”± Broker åˆ†å‘åˆ°ä¸åŒçš„è®¢é˜…è€…ï¼Œå®ç°æ¶ˆæ¯çš„å¹¿æ’­ã€‚</li><li>Queueï¼Œé˜Ÿåˆ—ï¼Œç‚¹å¯¹ç‚¹æ¨¡å¼ä¸‹ç‰¹å®šç”Ÿäº§è€…å‘ç‰¹å®šé˜Ÿåˆ—å‘é€æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…è®¢é˜…ç‰¹å®šé˜Ÿåˆ—æ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚</li><li>Messageï¼Œæ¶ˆæ¯ä½“ï¼Œæ ¹æ®ä¸åŒé€šä¿¡åè®®å®šä¹‰çš„å›ºå®šæ ¼å¼è¿›è¡Œç¼–ç çš„æ•°æ®åŒ…ï¼Œæ¥å°è£…ä¸šåŠ¡ æ•°æ®ï¼Œå®ç°æ¶ˆæ¯çš„ä¼ è¾“ã€‚</li></ul><h2 id="ActiveMQ-å·¥ç¨‹å®ä¾‹"><a href="#ActiveMQ-å·¥ç¨‹å®ä¾‹" class="headerlink" title="ActiveMQ å·¥ç¨‹å®ä¾‹"></a>ActiveMQ å·¥ç¨‹å®ä¾‹</h2><p>ä¸‹é¢æ˜¯ä½¿ç”¨ ActiveMQ çš„é˜Ÿåˆ—æ¨¡å¼å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ Java ä»£ç ç¤ºä¾‹ã€‚</p><h3 id="POM-ä¾èµ–"><a href="#POM-ä¾èµ–" class="headerlink" title="POM ä¾èµ–"></a>POM ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Active-MQ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.activemq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activemq-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.15.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="é˜Ÿåˆ—æ¨¡å¼æ¶ˆè´¹è€…"><a href="#é˜Ÿåˆ—æ¨¡å¼æ¶ˆè´¹è€…" class="headerlink" title="é˜Ÿåˆ—æ¨¡å¼æ¶ˆè´¹è€…"></a>é˜Ÿåˆ—æ¨¡å¼æ¶ˆè´¹è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œç”¨äºæ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/9/4 23:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String url = <span class="string">"tcp://127.0.0.1:61616"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String queueName = <span class="string">"queue-test"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºConnectionFactory</span></span><br><span class="line">        ActiveMQConnectionFactory connectionFactory = <span class="keyword">new</span> ActiveMQConnectionFactory();</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = connectionFactory.createConnection();</span><br><span class="line">        <span class="comment">// 3.å¯åŠ¨è¿æ¥</span></span><br><span class="line">        connection.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºä¼šè¯,falseï¼Œä¸ä½¿ç”¨äº‹åŠ¡ï¼Œè‡ªåŠ¨åº”ç­”æ¨¡å¼</span></span><br><span class="line">        Session session = connection.createSession(<span class="keyword">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="comment">// 5.åˆ›å»ºä¸€ä¸ªç›®æ ‡</span></span><br><span class="line">        Destination destination = session.createQueue(queueName);</span><br><span class="line">        <span class="comment">// 6.åˆ›å»ºæ¶ˆè´¹è€…</span></span><br><span class="line">        MessageConsumer consumer = session.createConsumer(destination);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7.åˆ›å»ºä¸€ä¸ªç›‘å¬å™¨</span></span><br><span class="line">        consumer.setMessageListener(<span class="keyword">new</span> MessageListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">                TextMessage textMessage = (TextMessage) message;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">"æ¥æ”¶æ¶ˆæ¯ï¼š"</span> + textMessage.getText());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 8.å…³é—­è¿æ¥</span></span><br><span class="line">        <span class="comment">//connection.close();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é˜Ÿåˆ—æ¨¡å¼ç”Ÿäº§è€…"><a href="#é˜Ÿåˆ—æ¨¡å¼ç”Ÿäº§è€…" class="headerlink" title="é˜Ÿåˆ—æ¨¡å¼ç”Ÿäº§è€…"></a>é˜Ÿåˆ—æ¨¡å¼ç”Ÿäº§è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯æä¾›è€…ï¼Œç”¨äºå‘æ¶ˆæ¯ä¸­é—´ä»¶å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/9/4 23:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppProducer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String url = <span class="string">"tcp://127.0.0.1:61616"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String queueName = <span class="string">"queue-test"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºConnectionFactory</span></span><br><span class="line">        ActiveMQConnectionFactory connectionFactory = <span class="keyword">new</span> ActiveMQConnectionFactory();</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = connectionFactory.createConnection();</span><br><span class="line">        <span class="comment">// 3.å¯åŠ¨è¿æ¥</span></span><br><span class="line">        connection.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºä¼šè¯,falseï¼Œä¸ä½¿ç”¨äº‹åŠ¡ï¼Œè‡ªåŠ¨åº”ç­”æ¨¡å¼</span></span><br><span class="line">        Session session = connection.createSession(<span class="keyword">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="comment">// 5.åˆ›å»ºä¸€ä¸ªç›®æ ‡</span></span><br><span class="line">        Destination destination = session.createQueue(queueName);</span><br><span class="line">        <span class="comment">// 6.åˆ›å»ºç”Ÿäº§è€…</span></span><br><span class="line">        MessageProducer producer = session.createProducer(destination);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7.åˆ›å»ºæ¶ˆæ¯å¹¶å‘é€</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæ¶ˆæ¯</span></span><br><span class="line">            TextMessage textMessage = session.createTextMessage(<span class="string">"textMessage"</span> + i);</span><br><span class="line">            <span class="comment">// å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">            producer.send(textMessage);</span><br><span class="line">            System.out.println(<span class="string">"å‘é€æ¶ˆæ¯ï¼š"</span> + textMessage.getText());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 8.å…³é—­è¿æ¥</span></span><br><span class="line">        connection.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ä¸»é¢˜æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œç”¨äºæ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/9/4 23:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String url = <span class="string">"tcp://127.0.0.1:61616"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String topicName = <span class="string">"topic-test"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºConnectionFactory</span></span><br><span class="line">        ActiveMQConnectionFactory connectionFactory = <span class="keyword">new</span> ActiveMQConnectionFactory();</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = connectionFactory.createConnection();</span><br><span class="line">        <span class="comment">// 3.å¯åŠ¨è¿æ¥</span></span><br><span class="line">        connection.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºä¼šè¯,falseï¼Œä¸ä½¿ç”¨äº‹åŠ¡ï¼Œè‡ªåŠ¨åº”ç­”æ¨¡å¼</span></span><br><span class="line">        Session session = connection.createSession(<span class="keyword">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="comment">// 5.åˆ›å»ºä¸€ä¸ªç›®æ ‡</span></span><br><span class="line">        Destination destination = session.createTopic(topicName);</span><br><span class="line">        <span class="comment">// 6.åˆ›å»ºæ¶ˆè´¹è€…</span></span><br><span class="line">        MessageConsumer consumer = session.createConsumer(destination);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7.åˆ›å»ºä¸€ä¸ªç›‘å¬å™¨</span></span><br><span class="line">        consumer.setMessageListener(<span class="keyword">new</span> MessageListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">                TextMessage textMessage = (TextMessage) message;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">"æ¥æ”¶æ¶ˆæ¯ï¼š"</span> + textMessage.getText());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 8.å…³é—­è¿æ¥</span></span><br><span class="line">        <span class="comment">//connection.close();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…-1"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…-1" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼ç”Ÿäº§è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ä¸»é¢˜æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯æä¾›è€…ï¼Œç”¨äºå‘æ¶ˆæ¯ä¸­é—´ä»¶å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/9/4 23:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppProducer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String url = <span class="string">"tcp://127.0.0.1:61616"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String topicName = <span class="string">"topic-test"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºConnectionFactory</span></span><br><span class="line">        ActiveMQConnectionFactory connectionFactory = <span class="keyword">new</span> ActiveMQConnectionFactory();</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºConnection</span></span><br><span class="line">        Connection connection = connectionFactory.createConnection();</span><br><span class="line">        <span class="comment">// 3.å¯åŠ¨è¿æ¥</span></span><br><span class="line">        connection.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºä¼šè¯,falseï¼Œä¸ä½¿ç”¨äº‹åŠ¡ï¼Œè‡ªåŠ¨åº”ç­”æ¨¡å¼</span></span><br><span class="line">        Session session = connection.createSession(<span class="keyword">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">        <span class="comment">// 5.åˆ›å»ºä¸€ä¸ªç›®æ ‡</span></span><br><span class="line">        Destination destination = session.createTopic(topicName);</span><br><span class="line">        <span class="comment">// 6.åˆ›å»ºç”Ÿäº§è€…</span></span><br><span class="line">        MessageProducer producer = session.createProducer(destination);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7.åˆ›å»ºæ¶ˆæ¯å¹¶å‘é€</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæ¶ˆæ¯</span></span><br><span class="line">            TextMessage textMessage = session.createTextMessage(<span class="string">"textMessage"</span> + i);</span><br><span class="line">            <span class="comment">// å‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">            producer.send(textMessage);</span><br><span class="line">            System.out.println(<span class="string">"å‘é€æ¶ˆæ¯ï¼š"</span> + textMessage.getText());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 8.å…³é—­è¿æ¥</span></span><br><span class="line">        connection.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>GitHubæºç ï¼š</strong><a href="https://github.com/niumoo/message-queue/tree/master/mq-activemq" target="_blank" rel="noopener">https://github.com/niumoo/message-queue</a></p><h2 id="Spring-æ•´åˆ-ActiveMQ"><a href="#Spring-æ•´åˆ-ActiveMQ" class="headerlink" title="Spring æ•´åˆ ActiveMQ"></a>Spring æ•´åˆ ActiveMQ</h2><p>åœ¨ Spring ä¸­é…ç½® Active MQ å°±åƒSpring æ•´åˆå…¶ä»–åŠŸèƒ½ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ XML é…ç½®ä¸­é…ç½®å‡ ä¸ªå…³é”®çš„å®ä¾‹å³å¯ã€‚åœ¨ Active MQ ä¸­æœ‰å‡ ä¸ªå¯¹è±¡çš„å®ä¾‹æ˜¯è‡³å…³é‡è¦çš„ï¼Œå¦‚ Active MQ jms è¿æ¥å·¥å‚ï¼Œä¸ºäº†å‡å°‘è¿æ¥æ–­å¼€æ€§èƒ½æ—¶é—´æ¶ˆè€—çš„ jms è¿æ¥æ± ä»¥åŠç”Ÿäº§è€…æ¶ˆè´¹è€…ç­‰ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›è¯¦ç»†è¯´æ˜ã€‚</p><ul><li>ConnectionFactory ç”¨äºç®¡ç†è¿æ¥çš„è¿æ¥å·¥å‚ï¼ˆSpringæä¾›ï¼‰ã€‚<ul><li>ä¸€ä¸ª Spring ä¸ºæˆ‘ä»¬æä¾›çš„è¿æ¥æ± ã€‚</li><li>JmsTemplate æ¯æ¬¡å‘é€éƒ½ä¼šé‡æ–°åˆ›å»ºè¿æ¥ï¼Œä¼šè¯å’Œ Productorã€‚</li><li>Spring ä¸­æä¾›äº†SingleConnectionFactory å’ŒCachingConnectionFactoryï¼ˆå¢åŠ äº†ç¼“å­˜åŠŸèƒ½ï¼‰ã€‚</li></ul></li><li>JmsTemplate æ˜¯ç”¨äºå‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„æ¨¡æ¿ç±»ã€‚<ul><li>æ˜¯springæä¾›çš„ï¼Œåªéœ€è¦å‘Spring å®¹å™¨å†…æ³¨å†Œè¿™ä¸ªç±»å°±å¯ä»¥ä½¿ç”¨ JmsTemplate æ–¹ä¾¿çš„æ“ä½œjmsã€‚</li><li>JmsTemplate ç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨èŒƒå›´ä½¿ç”¨ã€‚</li></ul></li><li>MessageListerner æ¶ˆæ¯ç›‘å¬å™¨<ul><li>ä½¿ç”¨ä¸€ä¸ªonMessageæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åªæ¥æ”¶ä¸€ä¸ªMessageå‚æ•°ã€‚</li></ul></li></ul><h3 id="POM-ä¾èµ–-1"><a href="#POM-ä¾èµ–-1" class="headerlink" title="POM ä¾èµ–"></a>POM ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.0.4.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- è¿™ä¸ªç‰ˆæœ¬çš„Springéœ€è¦ä½¿ç”¨JMS 2.0ç‰ˆæœ¬ï¼Œä½†spring-jmsçš„ä¾èµ–æ²¡æœ‰è‡ªåŠ¨å¯¼å…¥JMS 2.0ï¼Œè€Œactivemq-coreä¼šå¯¼å…¥JMS 1.1çš„ä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.jms<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.jms-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.activemq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activemq-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.geronimo.specs<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>geronimo-jms_1.1_spec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="XML-é…ç½®"><a href="#XML-é…ç½®" class="headerlink" title="XML é…ç½®"></a>XML é…ç½®</h3><h4 id="XML-å…¬å…±é…ç½®"><a href="#XML-å…¬å…±é…ç½®" class="headerlink" title="XML å…¬å…±é…ç½®"></a>XML å…¬å…±é…ç½®</h4><p>ä¸ºäº†ä»½æ–‡ä»¶é…ç½®æ–¹ä¾¿ç®¡ç†ï¼Œä¸‹é¢æ˜¯æå–å‡ºæ¥çš„å…¬å…±é…ç½®ï¼Œä¸ºäº†åœ¨ç‹¬ç«‹é…ç½®ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… XMLæ–‡ä»¶æ—¶å¼•å…¥ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æŠŠç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä»¥åŠæ‰€æœ‰çš„ XML bean é…ç½®åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:content</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">content:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ActiveMQä¸ºæˆ‘ä»¬æä¾›çš„connection factory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"targerConnectionFactory"</span> <span class="attr">class</span>=<span class="string">"org.apache.activemq.ActiveMQConnectionFactory"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"brokerURL"</span> <span class="attr">value</span>=<span class="string">"tcp://127.0.0.1:61616"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- spring jmsä¸ºæˆ‘ä»¬æä¾›çš„è¿æ¥æ±  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"connectionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jms.connection.SingleConnectionFactory"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"targetConnectionFactory"</span> <span class="attr">ref</span>=<span class="string">"targerConnectionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€ä¸ªé˜Ÿåˆ—æ¨¡å¼ç›®çš„åœ°ï¼ˆé˜Ÿåˆ—åç§°ï¼‰ï¼Œç‚¹å¯¹ç‚¹çš„æ¶ˆæ¯æ¨¡å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"queueDestination"</span> <span class="attr">class</span>=<span class="string">"org.apache.activemq.command.ActiveMQQueue"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"queue-spring"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€ä¸ªä¸»é¢˜æ¨¡å¼ç›®çš„åœ°ï¼ˆä¸»é¢˜åç§°ï¼‰ï¼Œå‘å¸ƒè®¢é˜…æ¶ˆæ¯æ¨¡å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"topicDestination"</span> <span class="attr">class</span>=<span class="string">"org.apache.activemq.command.ActiveMQTopic"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"topic-spring"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="XML-æ¶ˆè´¹è€…"><a href="#XML-æ¶ˆè´¹è€…" class="headerlink" title="XML æ¶ˆè´¹è€…"></a>XML æ¶ˆè´¹è€…</h4><p>æ¶ˆè´¹è€…ä¸»è¦æ˜¯ä¸€ä¸ªæ¶ˆæ¯ç›‘å¬å™¨ï¼Œç›‘å¬æŒ‡å®šçš„é˜Ÿåˆ—æˆ–è€…ä¸»é¢˜çš„æ¶ˆæ¯ä¿¡æ¯ï¼Œæ¥æœ‰æ¶ˆæ¯æ—¶è°ƒç”¨å›è°ƒç›‘å¬å¤„ç†æ–¹æ³•ã€‚è¿™é‡Œæˆ‘æ³¨é‡Šæ‰äº†ç›‘å¬çš„é˜Ÿåˆ—æ¨¡å¼ï¼ŒæŒ‡å®šäº†ä¸»é¢˜æ¨¡å¼ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:content</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¯¼å…¥å…¬å…±é…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"common.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®æ¶ˆæ¯ç›‘å¬å™¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"consumerMessageListener"</span> <span class="attr">class</span>=<span class="string">"net.codingme.jms.consumer.ConsumerMessageListener"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®æ¶ˆæ¯ç›‘å¬å®¹å™¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jmsContainer"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jms.listener.DefaultMessageListenerContainer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"connectionFactory"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é˜Ÿåˆ—æ¨¡å¼ --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;property name="destination" ref="queueDestination"/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ä¸»é¢˜æ¨¡å¼ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"destination"</span> <span class="attr">ref</span>=<span class="string">"topicDestination"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"messageListener"</span> <span class="attr">ref</span>=<span class="string">"consumerMessageListener"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="XML-ç”Ÿäº§è€…"><a href="#XML-ç”Ÿäº§è€…" class="headerlink" title="XML ç”Ÿäº§è€…"></a>XML ç”Ÿäº§è€…</h4><p>ç”Ÿæˆè€…çš„é…ç½®ä¸»è¦æ˜¯ä½¿ç”¨ spring jms æ¨¡ç‰ˆå¯¹è±¡ï¼Œåˆ›å»ºç”Ÿäº§è€…å®ä¾‹ç”¨äºç”Ÿäº§æ¶ˆæ¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:content</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¯¼å…¥å…¬å…±é…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"common.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- jmsæ¨¡ç‰ˆ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jmsTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jms.core.JmsTemplate"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"connectionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"net.codingme.jms.producer.ProducerServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç”Ÿäº§è€…ç¼–å†™"><a href="#ç”Ÿäº§è€…ç¼–å†™" class="headerlink" title="ç”Ÿäº§è€…ç¼–å†™"></a>ç”Ÿäº§è€…ç¼–å†™</h3><p><strong>1. å®šä¹‰æ¥å£</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.jms.producer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/11/2518:19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProducerService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(String message)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2. ä¸»é¢˜æ¨¡å¼ç”Ÿäº§è€…</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.jms.producer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jms.core.JmsTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jms.core.MessageCreator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.jms.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/11/25 19:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProducerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JmsTemplate jmsTemplate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é¢˜æ¨¡å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Resource</span>(name = <span class="string">"topicDestination"</span>)</span><br><span class="line">    Destination destination;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨jmsTemplateå‘é€æ¶ˆæ¯</span></span><br><span class="line">        jmsTemplate.send(destination, <span class="keyword">new</span> MessageCreator() &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæ¶ˆæ¯</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Message <span class="title">createMessage</span><span class="params">(Session session)</span> <span class="keyword">throws</span> JMSException </span>&#123;</span><br><span class="line">                TextMessage textMessage = session.createTextMessage(message);</span><br><span class="line">                <span class="keyword">return</span> textMessage;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(<span class="string">"å‘é€æ¶ˆæ¯ï¼š"</span> + message);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3. Spring å¯åŠ¨ ç”Ÿäº§è€…</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.jms.producer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * å¯åŠ¨å™¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/11/25 21:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppProducer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è£…è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:producer.xml"</span>);</span><br><span class="line">        ProducerService service = context.getBean(ProducerService.class);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            service.sendMessage(<span class="string">"test"</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆè´¹è€…ç¼–å†™"><a href="#æ¶ˆè´¹è€…ç¼–å†™" class="headerlink" title="æ¶ˆè´¹è€…ç¼–å†™"></a>æ¶ˆè´¹è€…ç¼–å†™</h3><p>Springå¯åŠ¨å’Œç”Ÿäº§è€…ç±»ä¼¼ã€‚ä¸‹é¢æ˜¯æ¶ˆè´¹è€…ç›‘å¬å™¨çš„å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.jms.consumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.jms.JMSException;</span><br><span class="line"><span class="keyword">import</span> javax.jms.Message;</span><br><span class="line"><span class="keyword">import</span> javax.jms.MessageListener;</span><br><span class="line"><span class="keyword">import</span> javax.jms.TextMessage;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯ç›‘å¬å™¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/11/25 22:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerMessageListener</span> <span class="keyword">implements</span> <span class="title">MessageListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        TextMessage textMessage = (TextMessage) message;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ¥æ”¶æ¶ˆæ¯ï¼š"</span> + textMessage.getText());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JMSException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿è¡Œæµ‹è¯•"><a href="#è¿è¡Œæµ‹è¯•" class="headerlink" title="è¿è¡Œæµ‹è¯•"></a>è¿è¡Œæµ‹è¯•</h3><p>é¦–å…ˆä¸»é¢˜æ¨¡å¼ä¸‹å¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œä½¿ç”¨ç”Ÿäº§è€…æ¨é€10æ¡æ¶ˆæ¯ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/64b0c8878167331cbcce3fe60dfb084a.png" alt="æµ‹è¯•"></p><p>åœ¨æ¯ä¸ªæ¶ˆè´¹è€…ä¸‹é¢éƒ½å¯ä»¥çœ‹åˆ°æ¨é€çš„å®Œæ•´æ¶ˆæ¯ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/fb01f346bfa248e42bbe9af183697762.png" alt="æµ‹è¯•"></p><p>æ–‡ä¸­ä»£ç å·²ç»ä¸Šä¼ åˆ°GitHubï¼š<a href="https://github.com/niumoo/message-queue" target="_blank" rel="noopener">https://github.com/niumoo/message-queue</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/fc60f07d8257056ab302149f1ebc6290.png&quot; alt=&quot;ActiveMQ-log&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;ActiveMQ-ä»‹ç»&quot;&gt;&lt;a href=&quot;#ActiveMQ-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ActiveMQ ä»‹ç»&quot;&gt;&lt;/a&gt;ActiveMQ ä»‹ç»&lt;/h2&gt;&lt;p&gt;Active MQ æ˜¯ç”± Apache å‡ºå“çš„ä¸€æ¬¾æµè¡Œçš„åŠŸèƒ½å¼ºå¤§çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒé€Ÿåº¦å¿«ï¼Œæ”¯æŒè·¨è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œå…·æœ‰æ˜“äºä½¿ç”¨çš„ä¼ä¸šé›†æˆæ¨¡å¼å’Œè®¸å¤šçš„é«˜çº§åŠŸèƒ½ï¼ŒåŒæ—¶å®Œå…¨æ”¯æŒ &lt;a href=&quot;https://www.oracle.com/technetwork/java/jms/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JSM1.1&lt;/a&gt; å’Œ J2EE1.4 ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å®˜æ–¹ä¸‹è½½åœ°å€ï¼š &lt;a href=&quot;http://activemq.apache.org/download.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://activemq.apache.org/download.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®˜æ–¹å®‰è£…æ•™ç¨‹ï¼š &lt;a href=&quot;http://activemq.apache.org/getting-started.html#GettingStarted-InstallationProcedureforWindows&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://activemq.apache.org/getting-started.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é»˜è®¤ç®¡ç†é¡µé¢ï¼š&lt;a href=&quot;http://127.0.0.1:8161/admin/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://127.0.0.1:8161/admin/&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸ºadmin / adminã€‚æ‚¨å¯ä»¥åœ¨conf / jetty-real.propertiesæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é»˜è®¤æœåŠ¡ç«¯å£ï¼š61616&lt;/p&gt;
    
    </summary>
    
      <category term="ä¸­é—´ä»¶" scheme="https://www.codingme.net/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
      <category term="ä¸­é—´ä»¶" scheme="https://www.codingme.net/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
      <category term="activemq" scheme="https://www.codingme.net/tags/activemq/"/>
    
  </entry>
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ï¼ˆä¸€ï¼‰ä»‹ç»</title>
    <link href="https://www.codingme.net/2018/11/io/mq-introduction/"/>
    <id>https://www.codingme.net/2018/11/io/mq-introduction/</id>
    <published>2018-11-23T08:59:48.000Z</published>
    <updated>2019-05-20T16:26:48.579Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/09ec812b08047f011dcca4e8e6809e35.jpg" alt=""></p><h2 id="æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»"><a href="#æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»"></a>æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»</h2><p>æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶æ˜¯å¤§å‹ç³»ç»Ÿä¸­çš„é‡è¦ç»„ä»¶ï¼Œå·²ç»é€æ¸æˆä¸ºä¼ä¸šç³»ç»Ÿå†…éƒ¨é€šä¿¡çš„æ ¸å¿ƒæ‰‹æ®µã€‚å®ƒå…·æœ‰æ¾è€¦åˆã€å¼‚æ­¥æ¶ˆæ¯ã€æµé‡å‰Šå³°ã€å¯é æŠ•é€’ã€å¹¿æ’­ã€æµé‡æ§åˆ¶ã€æœ€ç»ˆä¸€è‡´æ€§ç­‰ä¸€ç³»åˆ—åŠŸèƒ½ï¼Œå·²ç»æˆä¸ºå¼‚æ­¥RPCçš„ä¸»è¦æ‰‹æ®µä¹‹ä¸€ã€‚<br>ç›®å‰å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶æœ‰ActiveMQã€RabbitMQã€ZeroMQã€Kafkaã€MetaMQã€RocketMQç­‰ã€‚<br><a id="more"></a></p><h2 id="æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨åœºæ™¯"><a href="#æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨åœºæ™¯" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨åœºæ™¯"></a>æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨åœºæ™¯</h2><p>æ¶ˆæ¯é˜Ÿåˆ—åœ¨å®é™…ä¸­å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰åº”ç”¨è§£è€¦ã€å¼‚æ­¥å¤„ç†ã€æµé‡é”™å³°ä¸æµæ§ã€æ—¥å¿—å¤„ç†ç­‰ç­‰ã€‚</p><h3 id="åº”ç”¨è§£è€¦"><a href="#åº”ç”¨è§£è€¦" class="headerlink" title="åº”ç”¨è§£è€¦"></a>åº”ç”¨è§£è€¦</h3><p>æ¶ˆæ¯ä¸­é—´ä»¶é¡¾åæ€ä¹‰æ˜¯ç”¨äºæ¶ˆæ¯å­˜æ”¾çš„ä¸­é—´ä»¶ã€‚æ‹¿æ”¯ä»˜è®¢å•æµç¨‹ä¸¾ä¾‹ï¼Œåœ¨æ²¡æœ‰ä¸­é—´ä»¶çš„æƒ…å†µä¸‹ï¼Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ul><li>ç”¨æˆ·æ”¯ä»˜è®¢å•ï¼Œæ›´æ–°è®¢å•çŠ¶æ€</li><li>è°ƒç”¨åº“å­˜æœåŠ¡ï¼Œå®Œæˆå“åº”åŠŸèƒ½</li><li>è°ƒç”¨ç§¯åˆ†æœåŠ¡ï¼Œå®Œæˆå“åº”åŠŸèƒ½</li><li>è°ƒç”¨çŸ­ä¿¡æœåŠ¡ï¼Œå‘é€çŸ­ä¿¡é€šçŸ¥</li></ul><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œå¦‚æœåº“å­˜å’Œç§¯åˆ†æˆ–è€…çŸ­ä¿¡æœåŠ¡æ²¡æœ‰åŠæ—¶å“åº”ï¼Œæˆ–è€…çŸ­ä¿¡æœåŠ¡å¤„ç†å µå¡ï¼Œå®¢æˆ·ç«¯ç”¨æˆ·æ”¶åˆ°å“åº”çš„æ—¶é—´å°†ä¼šå»¶é•¿ï¼Œä½“éªŒå˜å·®ã€‚<br>å…¶å®æˆ‘ä»¬çŸ¥é“å¯¹äºè®¢å•æµç¨‹ï¼Œåªæœ‰è®¢å•å¤„ç†æ‰æ˜¯æ ¸å¿ƒæœåŠ¡ï¼Œå…¶ä»–ä¾èµ–ç³»ç»Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œå¯ä»¥é€šçŸ¥åˆ°å³å¯ã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬åœ¨å¤„ç†å®Œæ¯•è®¢å•ä¹‹åæ”¾å…¥ä¸­é—´ä»¶ç«‹åˆ»è¿”å›ï¼Œç„¶ååç»­æœåŠ¡ä»ä¸­é—´ä»¶ä¸­æ‹¿åˆ°æ•°æ®è¿›è¡Œåç»­çš„å¤„ç†ã€‚</p><h3 id="å¼‚æ­¥å¤„ç†"><a href="#å¼‚æ­¥å¤„ç†" class="headerlink" title="å¼‚æ­¥å¤„ç†"></a>å¼‚æ­¥å¤„ç†</h3><p>å¼‚æ­¥å¤„ç†æ˜¯ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½ï¼Œæ‹¿ç”¨æˆ·æ³¨å†Œæ¥è¯´ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ul><li>æäº¤æ³¨å†Œä¿¡æ¯ï¼Œä¿å­˜æ³¨å†Œä¿¡æ¯â‘ </li><li>å‘é€æ³¨å†Œé€šçŸ¥é‚®ä»¶â‘¡</li><li>å‘é€çŸ­ä¿¡éªŒè¯ç â‘¢</li></ul><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯é¡ºåºçš„ï¼Œå¾ˆæ˜æ˜¾åœ¨å‘é€é‚®ä»¶æˆ–çŸ­ä¿¡æ—¶å€™æœ‰å¯èƒ½å› ä¸ºç½‘ç»œç­‰åŸå› å‘é€æœ‰ä¸€å®šå»¶è¿Ÿï¼Œè¿™æ—¶å€™å“åº”æ—¶é—´å˜é•¿ã€‚æ—¶é—´ä¸ºâ‘ +â‘¡+â‘¢ã€‚<br>åœ¨ä¸ä½¿ç”¨ä¸­é—´ä»¶çš„æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ç¨å¾®æ”¹è¿›ï¼Œå¯ä»¥åœ¨æ³¨å†Œä¿¡æ¯è®°å½•å®Œæ¯•ä¹‹ååŒæ—¶è°ƒç”¨å‘é€é€šçŸ¥é‚®ä»¶å’Œå‘é€çŸ­ä¿¡éªŒè¯ç çš„ç¨‹åºã€‚æ—¶é—´ä¸ºâ‘ +ï¼ˆmax(â‘¡ï¼Œâ‘¢)ï¼‰ã€‚è™½ç„¶æ”¹è¿›ï¼Œä½†æ˜¯å› ä¸ºä½¿ç”¨äº†å¹¶è¡Œå¤„ç†ï¼Œç”±äºCPUçš„å¹¶è¡Œå¤„ç†èƒ½åŠ›æœ‰é™ï¼Œç“¶é¢ˆå¾ˆå¿«å°±ä¼šåˆ°æ¥ã€‚<br>å¯ä»¥ç»§ç»­æ”¹è¿›ï¼Œæ³¨å†Œä¿¡æ¯è®°å½•å®Œæ¯•ä¹‹åå†™å…¥ä¸­é—´ä»¶ï¼Œç«‹å³è¿”å›ã€‚çŸ­ä¿¡æœåŠ¡å’Œé‚®ä»¶æœåŠ¡ä»ä¸­é—´ä»¶ä¸­å–å‡ºä¿¡æ¯å‘é€é€šçŸ¥ï¼Œæ—¶é—´ä¸ºâ‘ +å†™å…¥ä¸­é—´ä»¶æ—¶é—´ã€‚</p><h3 id="æµé‡é”™å³°"><a href="#æµé‡é”™å³°" class="headerlink" title="æµé‡é”™å³°"></a>æµé‡é”™å³°</h3><p>åœ¨ç±»ä¼¼äºç§’æ€è¿™æ ·çš„åœºæ™¯ä¸­ä¼šåœ¨æŸä¸ªæ—¶é—´æµé‡çªå¢ï¼Œå¤§é‡çš„è¯·æ±‚åŒæ—¶åˆ°è¾¾æœåŠ¡ç«¯ï¼Œæ— ç–‘å¯¹åç«¯çš„å‹åŠ›ä¼šå¤§å¤§å¢åŠ ï¼Œå¦‚æœéƒ½ç­‰ç€å¤„ç†å®Œæˆå¯èƒ½ä¼šå µæ­»åç»­çš„è¯·æ±‚ã€‚è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶æŠŠéœ€è¦å¤„ç†çš„ä¿¡æ¯å…ˆå­˜å‚¨åœ¨ä¸­é—´ä»¶ï¼Œä¹Ÿå¯ä»¥æ§åˆ¶æ´»åŠ¨çš„å‚ä¸äººæ•°ã€‚åœ¨åç»­æœåŠ¡ç¨‹åºæœ‰èƒ½åŠ›æ—¶å†æ‹¿å‡ºä¿¡æ¯è¿›è¡Œå¤„ç†ï¼Œå°±å¯ä»¥å‰Šå¹³æµé‡å³°å€¼ã€‚ä¿è¯å¤„ç†ç¨‹åºçš„æ­£å¸¸è¿è¡Œã€‚</p><h3 id="æ—¥å¿—å¤„ç†"><a href="#æ—¥å¿—å¤„ç†" class="headerlink" title="æ—¥å¿—å¤„ç†"></a>æ—¥å¿—å¤„ç†</h3><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ºäº†ç›‘æ§æ—¥å¿—ï¼Œä¼šæœ‰å¤§é‡çš„æ—¥å¿—éœ€è¦ä¼ è¾“å­˜å‚¨æ£€ç´¢ï¼Œç°åœ¨æ¯”è¾ƒæœ‰åçš„æ—¥å¿—å¤„ç†æ¶æ„æœ‰ELKï¼Œåœ¨åˆ†å¸ƒå¼åº”ç”¨ä¸­ç”±äºæ—¥å¿—çš„æ•°é‡çº§è¶Šæ¥è¶Šå¤§ï¼Œå­˜å‚¨èµ·æ¥å¯¹é€Ÿåº¦çš„è¦æ±‚ä¹Ÿè¶Šå¿«è¶Šå¿«ã€‚è¿™æ—¶å€™éœ€è¦ä½¿ç”¨ä¸­é—´ä»¶è§£å†³å¤§é‡æ—¥å¿—ä¼ è¾“çš„é—®é¢˜ï¼Œæ¯”å¦‚Kafkaã€‚<br>ä¸‹å›¾æ˜¯ä¸€ä¸ªå¸¸è§çš„æ—¥å¿—å¤„ç†æ¶æ„ï¼š<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/09ec812b08047f011dcca4e8e6809e35.jpg" alt=""></p><ol><li><p>Kafkaï¼šæ¥æ”¶ç”¨æˆ·æ—¥å¿—çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li><li><p>Logstashï¼šåšæ—¥å¿—è§£æï¼Œç»Ÿä¸€æˆJSONè¾“å‡ºç»™Elasticsearchã€‚</p></li><li><p>Elasticsearchï¼šå®æ—¶æ—¥å¿—åˆ†ææœåŠ¡çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸€ä¸ªschemalessï¼Œå®æ—¶çš„æ•°æ®å­˜å‚¨æœåŠ¡ï¼Œé€šè¿‡indexç»„ç»‡æ•°æ®ï¼Œå…¼å…·å¼ºå¤§çš„æœç´¢å’Œç»Ÿè®¡åŠŸèƒ½ã€‚</p></li><li><p>Kibanaï¼šåŸºäºElasticsearchçš„æ•°æ®å¯è§†åŒ–ç»„ä»¶ï¼Œè¶…å¼ºçš„æ•°æ®å¯è§†åŒ–èƒ½åŠ›æ˜¯ä¼—å¤šå…¬å¸é€‰æ‹©ELK stackçš„é‡è¦åŸå› ã€‚</p></li></ol><h2 id="JMSæ¶ˆæ¯æœåŠ¡"><a href="#JMSæ¶ˆæ¯æœåŠ¡" class="headerlink" title="JMSæ¶ˆæ¯æœåŠ¡"></a>JMSæ¶ˆæ¯æœåŠ¡</h2><p>JMSæ˜¯Javaæ¶ˆæ¯æœåŠ¡ï¼ˆJava Message Serviceï¼‰åº”ç”¨ç¨‹åºæ¥å£ï¼Œæ˜¯ä¸€ä¸ªJavaå¹³å°ä¸­å…³äºé¢å‘æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMOMï¼‰çš„APIï¼Œç”¨äºåœ¨ä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´ï¼Œæˆ–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥é€šä¿¡ã€‚Javaæ¶ˆæ¯æœåŠ¡æ˜¯ä¸€ä¸ªä¸å…·ä½“å¹³å°æ— å…³çš„APIï¼Œç»å¤§å¤šæ•°MOMæä¾›å•†éƒ½å¯¹JMSæä¾›æ”¯æŒã€‚ActiveMQå°±æ˜¯JMSæ¥å£çš„å®ç°ã€‚</p><h3 id="JMSæ¶ˆæ¯æ¨¡å¼"><a href="#JMSæ¶ˆæ¯æ¨¡å¼" class="headerlink" title="JMSæ¶ˆæ¯æ¨¡å¼"></a>JMSæ¶ˆæ¯æ¨¡å¼</h3><p>å¤§éƒ¨åˆ†çš„æ¶ˆæ¯é˜Ÿåˆ—éƒ½æœ‰ä¸¤ç§é€šä¿¡æ¨¡å¼ã€‚</p><ul><li>ç‚¹å¯¹ç‚¹ï¼ˆPoint-to-Point Messaging Domainï¼‰</li><li>å‘å¸ƒ-è®¢é˜…ï¼ˆPublish/Subscribe Messaging Domainï¼‰</li></ul><p>JMSä¹Ÿä¸ä¾‹å¤–çš„å®šä¹‰äº†è¿™ä¸¤ç§æ¶ˆæ¯å‘é€æ¨¡å‹çš„è§„èŒƒï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç»™äºˆå®ç°,å®ç°JMSæ¥å£çš„æ¶ˆæ¯ä¸­é—´ä»¶(MOM)ç§°ä¸ºJMS Providerã€‚</p><p><strong>ç‚¹å¯¹ç‚¹</strong><br>æ¶ˆæ¯åˆ°è¾¾æ¶ˆæ¯ç³»ç»Ÿï¼Œè¢«ä¿ç•™åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œä¸€ä¸ªæ¶ˆæ¯åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç„¶åå°±ä¼šè¢«ç§»é™¤ã€‚ä¾‹å¦‚è®¢å•å¤„ç†ç³»ç»Ÿã€‚<br><strong>å‘å¸ƒ-è®¢é˜…</strong><br>æ¶ˆæ¯å‘é€æ—¶æŒ‡å®šä¸»é¢˜ï¼ˆæˆ–è€…è¯´é€šé“ï¼‰ï¼Œæ¶ˆæ¯è¢«ä¿ç•™åœ¨æŒ‡å®šçš„ä¸»é¢˜ä¸­ï¼Œæ¶ˆè´¹è€…å¯ä»¥è®¢é˜…å¤šä¸ªä¸»é¢˜ï¼Œå¹¶ä½¿ç”¨ä¸»é¢˜ä¸­çš„æ‰€æœ‰çš„æ¶ˆæ¯ï¼Œä¾‹å¦‚ç°å®ä¸­çš„ç”µè§†ä¸ç”µè§†é¢‘é“ã€‚æ‰€æœ‰å®¢æˆ·ç«¯åŒ…æ‹¬å‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼Œä¸»é¢˜ä¸­çš„æ¶ˆæ¯å¯ä»¥è¢«æ‰€æœ‰çš„è®¢é˜…è€…æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…åªèƒ½æ¶ˆè´¹è®¢é˜…ä¹‹åå‘é€åˆ°ä¸»é¢˜ä¸­çš„æ¶ˆæ¯ã€‚</p><h3 id="JMSç¼–ç æ¥å£"><a href="#JMSç¼–ç æ¥å£" class="headerlink" title="JMSç¼–ç æ¥å£"></a>JMSç¼–ç æ¥å£</h3><ul><li>ConnectionFactory ç”¨äºåˆ›å»ºè¿æ¥åˆ°æ¶ˆè´¹ä¸­é—´ä»¶çš„è¿æ¥å·¥å‚</li><li>Connection ä»£è¡¨äº†åº”ç”¨ç¨‹åºå’Œæ¶ˆæ¯æœåŠ¡å™¨ä¹‹é—´é€šä¿¡çš„çº¿è·¯</li><li>Destination æŒ‡æ¶ˆæ¯å‘å¸ƒå’Œæ¥æ”¶çš„åœ°ç‚¹ï¼ŒåŒ…æ‹¬é˜Ÿåˆ—å’Œä¸»é¢˜</li><li>Session è¡¨ç¤ºä¸€ä¸ªå•çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ï¼Œç”¨äºå‘é€å’Œæ¥æ”¶æ¶ˆæ¯</li><li>MessageConsumer ç”±ä¼šè¯åˆ›å»ºï¼Œç”¨äºæ¥æ”¶å‘é€åˆ°ç›®æ ‡çš„æ¶ˆæ¯</li><li>MessageProducer ç”±ä¼šè¯åˆ›å»ºï¼Œç”¨äºå‘é€æ¶ˆæ¯åˆ°ç›®æ ‡</li><li>Message æ˜¯æ¶ˆè´¹è€…åœ¨ç”Ÿäº§è€…ä¹‹é—´ä¼ é€çš„å¯¹è±¡ï¼Œæ¶ˆæ¯å¤´ï¼Œä¸€ç»„æ¶ˆæ¯å±æ€§ï¼Œæ¶ˆæ¯ä½“</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/09ec812b08047f011dcca4e8e6809e35.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»&quot;&gt;&lt;a href=&quot;#æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»&quot;&gt;&lt;/a&gt;æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç»&lt;/h2&gt;&lt;p&gt;æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶æ˜¯å¤§å‹ç³»ç»Ÿä¸­çš„é‡è¦ç»„ä»¶ï¼Œå·²ç»é€æ¸æˆä¸ºä¼ä¸šç³»ç»Ÿå†…éƒ¨é€šä¿¡çš„æ ¸å¿ƒæ‰‹æ®µã€‚å®ƒå…·æœ‰æ¾è€¦åˆã€å¼‚æ­¥æ¶ˆæ¯ã€æµé‡å‰Šå³°ã€å¯é æŠ•é€’ã€å¹¿æ’­ã€æµé‡æ§åˆ¶ã€æœ€ç»ˆä¸€è‡´æ€§ç­‰ä¸€ç³»åˆ—åŠŸèƒ½ï¼Œå·²ç»æˆä¸ºå¼‚æ­¥RPCçš„ä¸»è¦æ‰‹æ®µä¹‹ä¸€ã€‚&lt;br&gt;ç›®å‰å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶æœ‰ActiveMQã€RabbitMQã€ZeroMQã€Kafkaã€MetaMQã€RocketMQç­‰ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="ä¸­é—´ä»¶" scheme="https://www.codingme.net/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
      <category term="ä¸­é—´ä»¶" scheme="https://www.codingme.net/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
      <category term="æ¶ˆæ¯é˜Ÿåˆ—" scheme="https://www.codingme.net/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu18 çš„è¶…è¯¦ç»†å¸¸ç”¨è½¯ä»¶å®‰è£…</title>
    <link href="https://www.codingme.net/2018/11/linux/start-ubuntu/"/>
    <id>https://www.codingme.net/2018/11/linux/start-ubuntu/</id>
    <published>2018-11-16T01:51:11.000Z</published>
    <updated>2019-05-20T16:26:48.592Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/877fecc7f272598c29084c2a621df2c1.png" alt="Ubuntu-desktop"></p><p>å¿ƒè¡€æ¥æ½®ï¼Œåœ¨ç¬”è®°æœ¬å®‰è£…äº†Ubuntu 18 ç”¨äºæ—¥å¸¸å­¦ä¹ ï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢çš„å®‰è£…è®°å½•ã€‚</p><h2 id="Gnome-Tweak-Tool"><a href="#Gnome-Tweak-Tool" class="headerlink" title="Gnome-Tweak-Tool"></a>Gnome-Tweak-Tool</h2><p>gnome-tweak-toolå¯ä»¥æ‰“å¼€éšè—çš„è®¾ç½®ï¼Œå¯ä»¥è¯¦ç»†çš„å¯¹ç³»ç»Ÿè¿›è¡Œé…ç½®ï¼Œä»¥åŠå®‰è£…ä¸»é¢˜å’Œæ‰©å±•ç­‰åŠŸèƒ½ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£…</span><br><span class="line">sudo apt install gnome-tweak-tool</span><br><span class="line">// å®‰è£…æ‰©å±•</span><br><span class="line">sudo apt install gnome-shell-extensions</span><br><span class="line">alt+f2 r å›è½¦</span><br><span class="line">// å®‰è£…æµè§ˆå™¨æ‰©å±•å·¥å…·</span><br><span class="line">sudo apt install chrome-gnome-shell</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="Nå¡é©±åŠ¨å¼‚å¸¸"><a href="#Nå¡é©±åŠ¨å¼‚å¸¸" class="headerlink" title="Nå¡é©±åŠ¨å¼‚å¸¸"></a>Nå¡é©±åŠ¨å¼‚å¸¸</h2><h3 id="å¼€æœºå…³æœºå¼‚å¸¸"><a href="#å¼€æœºå…³æœºå¼‚å¸¸" class="headerlink" title="å¼€æœºå…³æœºå¼‚å¸¸"></a>å¼€æœºå…³æœºå¼‚å¸¸</h3><p>å› ä¸ºä½¿ç”¨äº†Nå¡<code>å¼€æº</code>é©±åŠ¨ï¼Œ<code>Nå¡é©±åŠ¨</code>å’Œubuntuç³»ç»Ÿçš„å…¼å®¹æ€§å­˜åœ¨é—®é¢˜ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´æ— æ³•å¼€æœºï¼Œå¼€æœºå¾ªç¯ç™»å½•ï¼Œå…³æœºæ³¨é”€å¡æ­»ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œå¦‚æœä½ ä¹Ÿç¢°åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œå¯ä»¥ç»§ç»­å‘ä¸‹çœ‹ã€‚ç¬”è€…åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦åŒæ ·é—®é¢˜ï¼Œå‡çº§é©±åŠ¨æ— æœä¹‹åå†³å®šç›´æ¥ç¦ç”¨æ‰Nå¡é©±åŠ¨ã€‚</p><p>å¼€æœºå…ˆè¿›å…¥ç™»å½•é¡µé¢ï¼Œ<code>CTRL+ALT+F2</code>è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// purgeï¼ˆå½»åº•åˆ é™¤è½¯ä»¶å’Œé…ç½®ï¼‰</span><br><span class="line">sudo apt-get purge nvidia-*</span><br><span class="line">// è¿›å…¥ /é…ç½®æ–‡ä»¶/è‡ªåŠ¨è½½å…¥æ¨¡å—(ç±»ä¼¼windowsç³»ç»Ÿä¸‹çš„æœåŠ¡)é…ç½®æ–‡ä»¶</span><br><span class="line">cd /etc/modprobe.d/</span><br><span class="line">// ä½¿ç”¨vim ç¼–è¾‘ï¼ˆä¸å­˜åœ¨ä¼šæ–°å»ºï¼‰ä¸€ä¸ªå«blacklist-nouveau.confçš„æ–‡ä»¶</span><br><span class="line">sudo vim blacklist-nouveau.conf</span><br><span class="line">// åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ï¼ŒæŒ‰i(insert)è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥</span><br><span class="line">blacklist nouveau</span><br><span class="line">options nouveau modeset=0</span><br><span class="line">// æŒ‰ä¸€æ¬¡escé€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå†æŒ‰ä¸€æ¬¡â€œå†’å·â€ï¼Œè¾“å…¥wqï¼ˆä¿å­˜å¹¶é€€å‡ºï¼‰</span><br><span class="line">// é‡ç½®å†…æ ¸å¼•å¯¼</span><br><span class="line">sudo update-initramfs -u</span><br><span class="line">// é‡å¯ubuntu</span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>é‡å¯ä¹‹åå°±å¯ä»¥æ­£å¸¸ç™»å½•è¿›æ¡Œé¢äº†ï¼Œä½†æ˜¯ç¬”è€…å‘ç°å½“è¿æ¥å¤šä¸ªæ˜¾ç¤ºå™¨çš„æ—¶å€™ï¼Œä¸èƒ½è¿›è¡Œæ‰©å±•æ˜¾ç¤ºï¼Œåº”è¯¥æ˜¯æ²¡æœ‰Nå¡é©±åŠ¨å½±å“åˆ°çš„ï¼Œå¦‚æœæ²¡æœ‰å¤šä¸ªæ˜¾ç¤ºï¼Œé‚£ä¹ˆå¯ä»¥å°±æ­¤åœæ­¢æŠ˜è…¾äº†ã€‚</p><h3 id="å®‰è£…Nå¡é©±åŠ¨"><a href="#å®‰è£…Nå¡é©±åŠ¨" class="headerlink" title="å®‰è£…Nå¡é©±åŠ¨"></a>å®‰è£…Nå¡é©±åŠ¨</h3><p>æ— å¥ˆæœ‰ä¸¤ä¸ªæ˜¾ç¤ºå™¨ï¼Œä¸ç”¨èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹ä¸èˆ’æœçš„ï¼Œå› æ­¤æœ‰äº†ä¸‹é¢çš„æ“ä½œï¼Œå®‰è£…nvidiaå®˜æ–¹é©±åŠ¨ã€‚</p><p>æŠŠ nouveau é©±åŠ¨åŠ å…¥é»‘åå•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>sudo nano /etc/modprobe.d/blacklist-nouveau.conf</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶ blacklist-nouveau.conf ä¸­åŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">blacklist nouveau</span><br><span class="line">blacklist lbm-nouveau</span><br><span class="line">options nouveau modeset=0</span><br><span class="line">alias nouveau off</span><br><span class="line">alias lbm-nouveau off</span><br></pre></td></tr></table></figure></p><p>ç¦ç”¨ nouveau å†…æ ¸æ¨¡å—<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>echo options nouveau modeset=0 | sudo tee -a /etc/modprobe.d/nouveau-kms.conf</span><br><span class="line"><span class="meta">$</span>sudo update-initramfs -u</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥ç”¨lsmodçœ‹çœ‹ç¦æ­¢æˆåŠŸæ²¡æœ‰<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep nouveau</span><br></pre></td></tr></table></figure></p><p>ç„¶åå¼€å§‹å®‰è£…Nvidiaé©±åŠ¨<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:graphics-drivers/ppa</span><br><span class="line">sudo apt update</span><br><span class="line">sudo ubuntu-drivers autoinstall</span><br></pre></td></tr></table></figure></p><p>é‡å¯<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-cuda-toolkit gcc-6</span><br><span class="line">nvcc --version</span><br></pre></td></tr></table></figure></p><p>ç”¨lsmodçœ‹çœ‹é©±åŠ¨å®‰è£…æˆåŠŸæ²¡æœ‰<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep nvidia</span><br></pre></td></tr></table></figure></p><p>å®‰è£…cuda-toolkitï¼Œä»‹ç»å¯ä»¥å‚è€ƒ <a href="https://developer.nvidia.com/cuda-toolkit" target="_blank" rel="noopener">https://developer.nvidia.com/cuda-toolkit</a><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-cuda-toolkit gcc-6</span><br><span class="line">nvcc --version</span><br></pre></td></tr></table></figure></p><h2 id="çº¸é£æœºShadowsocks"><a href="#çº¸é£æœºShadowsocks" class="headerlink" title="çº¸é£æœºShadowsocks"></a>çº¸é£æœºShadowsocks</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt install shadowsocks</span><br><span class="line">// è‡ªè¡Œç¼–å†™é…ç½®æ–‡ä»¶ /etc/shadowsocks.json</span><br><span class="line">// å¯åŠ¨</span><br><span class="line">sslocal -c /etc/shadowsocks.json</span><br></pre></td></tr></table></figure><h2 id="JDKç¯å¢ƒå˜é‡"><a href="#JDKç¯å¢ƒå˜é‡" class="headerlink" title="JDKç¯å¢ƒå˜é‡"></a>JDKç¯å¢ƒå˜é‡</h2><p>JDKä¸‹è½½è§£å‹æ­¤å¤„ä¸è¯´ã€‚ç¯å¢ƒå˜é‡é…ç½®å¦‚ä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/home/niu/develop/program/jdk1.8.0_191</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/home/niu/develop/program/jdk1.8.0_191</span><br><span class="line">export JRE_HOME=/home/niu/develop/program/jdk1.8.0_191/jre</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH</span><br><span class="line">export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH</span><br></pre></td></tr></table></figure><h2 id="IDEAå›¾æ ‡"><a href="#IDEAå›¾æ ‡" class="headerlink" title="IDEAå›¾æ ‡"></a>IDEAå›¾æ ‡</h2><p>IDEAä¸‹è½½è§£å‹æ­¤å¤„ä¸è¯´ã€‚</p><p>/usr/share/applicationsç›®å½•ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼ï¼Œéœ€è¦åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºâ€œidea.desktopâ€çš„æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[Desktop Entry]</span><br><span class="line">Name=IdeaIU</span><br><span class="line">Comment=IdeaIU</span><br><span class="line">Exec=env JAVA_HOME=/home/niu/develop/program/jdk1.8.0_191 /home/niu/develop/program/idea-IU-182.4892.20/bin/idea.sh</span><br><span class="line">Icon=/home/niu/develop/program/idea-IU-182.4892.20/bin/idea.png</span><br><span class="line">Terminal=false</span><br><span class="line">Type=Application</span><br><span class="line">Categories=Application;Development;</span><br></pre></td></tr></table></figure><h2 id="Sublime-Text-3"><a href="#Sublime-Text-3" class="headerlink" title="Sublime Text 3"></a>Sublime Text 3</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</span><br><span class="line">echo "deb https://download.sublimetext.com/ apt/stable/" | sudo tee /etc/apt/sources.list.d/sublime-text.list</span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install sublime-text</span><br></pre></td></tr></table></figure><h2 id="å­—ä½“YaHeiConsolas"><a href="#å­—ä½“YaHeiConsolas" class="headerlink" title="å­—ä½“YaHeiConsolas"></a>å­—ä½“YaHeiConsolas</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.mycode.net.cn/wp-content/uploads/2015/07/YaHeiConsolas.tar.gz</span><br><span class="line">tar -zxvf YaHeiConsolas.tar.gz</span><br><span class="line">sudo mkdir -p /usr/share/fonts/YaHeiConsolas</span><br><span class="line">sudo cp YaHeiConsolas.ttf /usr/share/fonts/YaHeiConsolas</span><br><span class="line">cd /usr/share/fonts/YaHeiConsolas</span><br><span class="line">sudo chmod 644 YaHeiConsolas.ttf</span><br><span class="line">sudo mkfontscale</span><br><span class="line">sudo mkfontdir</span><br><span class="line">sudo fc-cache -fv</span><br></pre></td></tr></table></figure><h2 id="SecureCRT"><a href="#SecureCRT" class="headerlink" title="SecureCRT"></a>SecureCRT</h2><p>ç›´æ¥åˆ°å®˜ç½‘æ³¨å†Œä¸‹è½½ã€‚ä¸‹è½½å®Œæ¯•ä¹‹åå¯ä»¥è¯•ç”¨30å¤©ã€‚</p><p>ä¸‹é¢æ˜¯æ³¨å†Œä¿¡æ¯çš„ç”Ÿæˆï¼Œå¯èƒ½ä¸é€‚ç”¨äºæœ€æ–°ç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">âœ  software sudo perl securecrt_linux_crack.pl /usr/bin/SecureCRT</span><br><span class="line">crack successful</span><br><span class="line"></span><br><span class="line">License:</span><br><span class="line"></span><br><span class="line">Name:xiaobo_l</span><br><span class="line">Company:www.boll.me</span><br><span class="line">Serial Number:03-94-294583</span><br><span class="line">License Key:ABJ11G 85V1F9 NENFBK RBWB5W ABH23Q 8XBZAC 324TJJ KXRE5D</span><br><span class="line">Issue Date:04-20-2017</span><br></pre></td></tr></table></figure><h2 id="mysql5-7"><a href="#mysql5-7" class="headerlink" title="mysql5.7"></a>mysql5.7</h2><h3 id="å®‰è£…Mysql5-7"><a href="#å®‰è£…Mysql5-7" class="headerlink" title="å®‰è£…Mysql5.7"></a>å®‰è£…Mysql5.7</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> å®‰è£…mysqlæœåŠ¡</span><br><span class="line">sudo apt-get install mysql-server</span><br><span class="line"><span class="meta">#</span> å®‰è£…å®¢æˆ·ç«¯</span><br><span class="line">sudo apt install mysql-client</span><br><span class="line"><span class="meta">#</span> å®‰è£…ä¾èµ–</span><br><span class="line">sudo apt install libmysqlclient-dev</span><br><span class="line"><span class="meta">#</span> æ£€æŸ¥çŠ¶æ€</span><br><span class="line">sudo netstat -tap | grep mysql</span><br></pre></td></tr></table></figure><blockquote><p>mysql5.7å®‰è£…å®Œæˆåæ™®é€šç”¨æˆ·ä¸èƒ½è¿›mysqlï¼ŒåŸå› ï¼šrootçš„pluginè¢«ä¿®æ”¹æˆäº†auth_socketï¼Œç”¨å¯†ç ç™»é™†çš„pluginåº”è¯¥æ˜¯mysql_native_passwordï¼Œç›´æ¥ç”¨rootæƒé™ç™»å½•å°±ä¸ç”¨å¯†ç ,ä¿®æ”¹rootå¯†ç å’Œç™»å½•éªŒè¯æ–¹å¼ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> rootæƒé™è¿›å…¥mysql</span><br><span class="line">sudo mysql</span><br><span class="line"><span class="meta">mysql&gt;</span> select user, plugin from mysql.user;</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">| user             | plugin                |</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">| root             | auth_socket           |</span><br><span class="line">| mysql.session    | mysql_native_password |</span><br><span class="line">| mysql.sys        | mysql_native_password |</span><br><span class="line">| debian-sys-maint | mysql_native_password |</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> update mysql.user set authentication_string=PASSWORD('123456'), plugin='mysql_native_password' where user='root';</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.01 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 1</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> exit</span><br><span class="line">Bye</span><br><span class="line"><span class="meta">#</span> é‡å¯mysql</span><br><span class="line">niu@ubuntu:~$ sudo /etc/init.d/mysql restart</span><br><span class="line">[ ok ] Restarting mysql (via systemctl): mysql.service.</span><br></pre></td></tr></table></figure><h3 id="è¿œç¨‹ç™»å½•mysql"><a href="#è¿œç¨‹ç™»å½•mysql" class="headerlink" title="è¿œç¨‹ç™»å½•mysql"></a>è¿œç¨‹ç™»å½•mysql</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ³¨é‡Šæ‰bind-address = 127.0.0.1</span><br><span class="line">niu@ubuntu:~$ sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf </span><br><span class="line">niu@ubuntu:~$ mysql -uroot -p</span><br><span class="line">Enter password: </span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> grant all on *.* to root@'%' identified by '123456' with grant option;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span>  exit</span><br><span class="line">Bye</span><br><span class="line"><span class="meta">#</span> é‡å¯mysql</span><br><span class="line">niu@ubuntu:~$ sudo /etc/init.d/mysql restart</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…typora"><a href="#å®‰è£…typora" class="headerlink" title="å®‰è£…typora"></a>å®‰è£…typora</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// or run:</span><br><span class="line">// sudo apt-key adv --keyserver keyserver.ubuntu.com--recv-keys BA300B7755AFCFAE</span><br><span class="line">wget -qO - https://typora.io/linux/public-key.asc | sudo apt-key add -</span><br><span class="line">// add Typora's repository</span><br><span class="line">sudo add-apt-repository 'deb https://typora.io/linux ./'</span><br><span class="line">sudo apt-get update</span><br><span class="line">// install typora</span><br><span class="line">sudo apt-get install typora</span><br></pre></td></tr></table></figure><h2 id="é‚®ä»¶å®¢æˆ·ç«¯"><a href="#é‚®ä»¶å®¢æˆ·ç«¯" class="headerlink" title="é‚®ä»¶å®¢æˆ·ç«¯"></a>é‚®ä»¶å®¢æˆ·ç«¯</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/nylas/nylas-mail/releases/download/2.0.14/NylasMail-2.0.14.deb</span><br><span class="line">sudo dpkg -i NylasMail-2.0.14.deb</span><br><span class="line">sudo apt-get -f install</span><br></pre></td></tr></table></figure><p>å®‰è£…ä¹‹åå‘ç°è¦è¿æ¥æœåŠ¡å™¨ï¼Œä½†æ˜¯æœåŠ¡å™¨æŠ¥é”™ï¼Œä¸”äº†è§£åˆ°éœ€è¦æ”¶è´¹ï¼Œå› æ­¤æ”¾å¼ƒã€‚</p><p>æ”¹ç”¨mailspringï¼Œç•Œé¢å¥½è¯„ï¼Œä½¿ç”¨ä¸€å¤©ä¹‹åå‘ç°åœ¨é‚®ä»¶å¾ˆå¤šçš„æ—¶å€™ä¼šå¡é¡¿ï¼Œè¿˜ä¼šå‡ºç°æœåŠ¡å™¨è¿æ¥ä¸ä¸Šçš„æƒ…å†µï¼Œä¸”æ²¡æœ‰è®¾ç½®pop3çš„åœ°æ–¹ï¼Œåªæœ‰imapè®¾ç½®ã€‚å› æ­¤æ”¾å¼ƒã€‚</p><p>æœ€åæ”¹ç”¨å¤§åé¼é¼Tï½ˆunderBirdã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install thunderbird-locale-uk thunderbird-locale-vi thunderbird-locale-zh-cn</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…æœç‹—æ‹¼éŸ³è¾“å…¥æ³•"><a href="#å®‰è£…æœç‹—æ‹¼éŸ³è¾“å…¥æ³•" class="headerlink" title="å®‰è£…æœç‹—æ‹¼éŸ³è¾“å…¥æ³•"></a>å®‰è£…æœç‹—æ‹¼éŸ³è¾“å…¥æ³•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// å¸è½½è‡ªå¸¦çš„ä¸­æ–‡è¾“å…¥æ³•</span><br><span class="line">sudo apt remove 'ibus*'</span><br><span class="line">// å®‰è£…fcitxè¾“å…¥æ³•é…ç½®æ¡†æ¶</span><br><span class="line">sudo apt install fcitx-bin fcitx-table</span><br><span class="line">// åœ¨è®¾ç½®è¯­è¨€ä¸­ï¼Œé€‰æ‹©è¯­è¨€è¾“å…¥æ¡†æ¶ä¸ºfcitxï¼Œåº”ç”¨åˆ°æ•´ä¸ªç³»ç»Ÿã€‚</span><br><span class="line">// ä¸‹è½½æœç‹—æ‹¼éŸ³linuxç‰ˆæœ¬</span><br><span class="line">https://pinyin.sogou.com/linux/</span><br><span class="line">// æœç‹—æ‹¼éŸ³çš„å®˜æ–¹å®‰è£…æ•™ç¨‹,å¯ä»¥å‚è€ƒï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆå®‰è£…fcitxæ¡†æ¶ï¼Œç„¶åå®‰è£…è¾“å…¥æ³•</span><br><span class="line">//https://pinyin.sogou.com/linux/help.php</span><br><span class="line">// åŒå‡»å®‰è£…</span><br></pre></td></tr></table></figure><p>å¸è½½æœç‹—æ‹¼éŸ³ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get  remove  sogoupinyin</span><br><span class="line">sudo apt-get  purge  sogoupinyin</span><br><span class="line">sudo apt-get autoremove</span><br></pre></td></tr></table></figure><h2 id="VLCæ’­æ”¾å™¨"><a href="#VLCæ’­æ”¾å™¨" class="headerlink" title="VLCæ’­æ”¾å™¨"></a>VLCæ’­æ”¾å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…è§£ç å™¨</span><br><span class="line">sudo apt-get install ubuntu-restricted-extras </span><br><span class="line">å®‰è£…VLC</span><br><span class="line">sudo apt-get install vlc browser-plugin-vlc</span><br></pre></td></tr></table></figure><h2 id="ç‚¹å‡»ä»»åŠ¡æ å›¾è¡¨æœ€å°åŒ–"><a href="#ç‚¹å‡»ä»»åŠ¡æ å›¾è¡¨æœ€å°åŒ–" class="headerlink" title="ç‚¹å‡»ä»»åŠ¡æ å›¾è¡¨æœ€å°åŒ–"></a>ç‚¹å‡»ä»»åŠ¡æ å›¾è¡¨æœ€å°åŒ–</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gsettings set org.gnome.shell.extensions.dash-to-dock click-action 'minimize'</span><br></pre></td></tr></table></figure><h2 id="QQ-TIM-è¿…é›·"><a href="#QQ-TIM-è¿…é›·" class="headerlink" title="QQ TIM è¿…é›·"></a>QQ TIM è¿…é›·</h2><p>Linuxä¸‹QQï¼ŒTIM ä¸€ç›´ä½“éªŒä¸å¥½ï¼Œåº†å¹¸å‘ç°äº†ç›®å‰ä½“éªŒæœ€å¥½çš„deepin ç§»æ¤ç‰ˆã€‚<br>ç›´æ¥çœ‹<a href="https://github.com/wszqkzqk/deepin-wine-ubuntu" target="_blank" rel="noopener">é“¾æ¥</a></p><h2 id="wineç¨‹åºå›¾æ ‡æ”¾åˆ°é¡¶éƒ¨"><a href="#wineç¨‹åºå›¾æ ‡æ”¾åˆ°é¡¶éƒ¨" class="headerlink" title="wineç¨‹åºå›¾æ ‡æ”¾åˆ°é¡¶éƒ¨"></a>wineç¨‹åºå›¾æ ‡æ”¾åˆ°é¡¶éƒ¨</h2><p>ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½éœ€è¦å…ˆå®‰è£…gnome-tweak-toolä»¥åŠgnome-shell-extensions</p><p><a href="https://extensions.gnome.org/extension/1031/topicons/" target="_blank" rel="noopener">https://extensions.gnome.org/extension/1031/topicons/</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TopIcons Plus</span><br><span class="line">Applications Menu</span><br></pre></td></tr></table></figure><h2 id="ç™»å½•é¡µé¢èƒŒæ™¯"><a href="#ç™»å½•é¡µé¢èƒŒæ™¯" class="headerlink" title="ç™»å½•é¡µé¢èƒŒæ™¯"></a>ç™»å½•é¡µé¢èƒŒæ™¯</h2><p>18.04ç™»å½•èƒŒæ™¯ç›¸å…³çš„é…ç½®æ˜¯ç”¨cssçš„ï¼š/etc/alternatives/gdm3.cssã€‚å¦‚æœä½ ç†Ÿæ‚‰CSSè§„åˆ™ï¼Œ å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç¼–å†™å‡ºè‡ªå·±å–œæ¬¢çš„ç™»å½•é¡µé¢æ ·å¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//æ‰¾åˆ°é»˜è®¤çš„è¿™ä¸ªéƒ¨åˆ†</span><br><span class="line"><span class="selector-tag">lockDialogGroup</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#2c001e</span> <span class="built_in">url</span>(resource:///org/gnome/shell/theme/noise-texture.png);</span><br><span class="line">  <span class="attribute">background-repeat</span>: repeat; </span><br><span class="line">&#125;</span><br><span class="line">//æ”¹ä¸º</span><br><span class="line"><span class="selector-tag">lockDialogGroup</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#2c001e</span> <span class="built_in">url</span>(file:///usr/share/backgrounds/mypicture.jpg); </span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">background-position</span>: center; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/7bcdeb5f8902fd0be6662bbb6397de32.png" alt="Ubuntu-desktop"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/877fecc7f272598c29084c2a621df2c1.png&quot; alt=&quot;Ubuntu-desktop&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¿ƒè¡€æ¥æ½®ï¼Œåœ¨ç¬”è®°æœ¬å®‰è£…äº†Ubuntu 18 ç”¨äºæ—¥å¸¸å­¦ä¹ ï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢çš„å®‰è£…è®°å½•ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Gnome-Tweak-Tool&quot;&gt;&lt;a href=&quot;#Gnome-Tweak-Tool&quot; class=&quot;headerlink&quot; title=&quot;Gnome-Tweak-Tool&quot;&gt;&lt;/a&gt;Gnome-Tweak-Tool&lt;/h2&gt;&lt;p&gt;gnome-tweak-toolå¯ä»¥æ‰“å¼€éšè—çš„è®¾ç½®ï¼Œå¯ä»¥è¯¦ç»†çš„å¯¹ç³»ç»Ÿè¿›è¡Œé…ç½®ï¼Œä»¥åŠå®‰è£…ä¸»é¢˜å’Œæ‰©å±•ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// å®‰è£…&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt install gnome-tweak-tool&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// å®‰è£…æ‰©å±•&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt install gnome-shell-extensions&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;alt+f2 r å›è½¦&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// å®‰è£…æµè§ˆå™¨æ‰©å±•å·¥å…·&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt install chrome-gnome-shell&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Linux" scheme="https://www.codingme.net/categories/Linux/"/>
    
    
      <category term="ubuntu" scheme="https://www.codingme.net/tags/ubuntu/"/>
    
      <category term="è½¯ä»¶" scheme="https://www.codingme.net/tags/%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>IOé€šä¿¡æ¨¡å‹ï¼ˆä¸‰ï¼‰å¤šè·¯å¤ç”¨IO</title>
    <link href="https://www.codingme.net/2018/10/io/io3-nio/"/>
    <id>https://www.codingme.net/2018/10/io/io3-nio/</id>
    <published>2018-10-27T00:08:08.000Z</published>
    <updated>2019-05-20T16:26:48.569Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/59a331b8fdebaf1dcecab9fe31bb8b80.png" alt="macèƒŒåŒ…"></p><h2 id="å¤šè·¯å¤ç”¨IO"><a href="#å¤šè·¯å¤ç”¨IO" class="headerlink" title="å¤šè·¯å¤ç”¨IO"></a>å¤šè·¯å¤ç”¨IO</h2><p>ä»<code>éé˜»å¡åŒæ­¥IO</code>çš„ä»‹ç»ä¸­å¯ä»¥å‘ç°ï¼Œä¸ºæ¯ä¸€ä¸ªæ¥å…¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹åœ¨è¯·æ±‚å¾ˆå¤šçš„æƒ…å†µä¸‹ä¸é‚£ä¹ˆé€‚ç”¨äº†ï¼Œå› ä¸ºè¿™ä¼šæ¸æ¸è€—å°½æœåŠ¡å™¨çš„èµ„æºï¼Œäººä»¬ä¹Ÿéƒ½æ„è¯†åˆ°äº†è¿™ä¸ª é—®é¢˜ï¼Œå› æ­¤ç»ˆäºæœ‰äººå‘æ˜äº†<code>IOå¤šè·¯å¤ç”¨</code>ã€‚æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯<code>ä¸éœ€è¦å¼€é‚£ä¹ˆå¤šçš„çº¿ç¨‹å’Œè¿›ç¨‹</code>ã€‚<br><code>å¤šè·¯å¤ç”¨IO</code>æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥æ£€æŸ¥å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆSocketï¼‰çš„å°±ç»ªçŠ¶æ€ï¼Œæ¯”å¦‚è°ƒç”¨selectå’Œpollå‡½æ•°ï¼Œä¼ å…¥å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦å°±ç»ªï¼Œåˆ™è¿”å›ï¼Œå¦åˆ™é˜»å¡ç›´åˆ°è¶…æ—¶ã€‚å¾—åˆ°å°±ç»ªçŠ¶æ€åè¿›è¡ŒçœŸæ­£çš„æ“ä½œå¯ä»¥åœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å¯åŠ¨çº¿ç¨‹æ‰§è¡Œï¼ˆæ¯”å¦‚ä½¿ç”¨çº¿ç¨‹æ± ï¼‰ã€‚<br><a id="more"></a><br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/083f9772318bc178ec518d6aaadca09e.png" alt="NIO"></p><p>å¦‚å›¾ï¼Œè¿™æ ·åœ¨å¤„ç†å¤šä¸ªè¿æ¥æ—¶ï¼Œå¯ä»¥åªéœ€è¦ä¸€ä¸ªçº¿ç¨‹ç›‘æ§å°±ç»ªçŠ¶æ€ï¼Œå¯¹å°±ç»ªçš„æ¯ä¸ªè¿æ¥å¼€ä¸€ä¸ªçº¿ç¨‹å¤„ç†å°±å¯ä»¥äº†ï¼Œè¿™æ ·éœ€è¦çš„çº¿ç¨‹æ•°å¤§å¤§å‡å°‘ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„CPUå¼€é”€ã€‚</p><p> å¤šè·¯å¤ç”¨IOæœ‰å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µï¼Œä¸‹é¢ä¸€ä¸€è®²è§£ã€‚</p><h2 id="ç¼“å†²åŒºBuffer"><a href="#ç¼“å†²åŒºBuffer" class="headerlink" title="ç¼“å†²åŒºBuffer"></a>ç¼“å†²åŒºBuffer</h2><p><code>Buffer</code>æœ¬è´¨æ˜¯å¯ä»¥å†™å…¥å¯ä»¥è¯»å–çš„å†…å­˜ï¼Œè¿™å—å†…å­˜è¢«åŒ…è£…æˆäº†NIOçš„Bufferå¯¹è±¡ï¼Œç„¶åä¸ºå®ƒæä¾›ä¸€ç»„ç”¨äºè®¿é—®çš„æ–¹æ³•ã€‚Javaåˆ™ä¸º<code>java.nio.Buffer</code>å®ç°äº†åŸºæœ¬æ•°æ®ç±»å‹çš„<code>Buffer</code>ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/1f344908223446333ce9db0f67bcc38f.png" alt="Buffer"><br>æ‰€æœ‰çš„Bufferç¼“å†²åŒºéƒ½æœ‰4ä¸ªå±æ€§ï¼Œå…·ä½“è§£é‡Šå¯ä»¥çœ‹è¡¨æ ¼ã€‚</p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>Capacity</td><td>å®¹é‡ï¼Œå¯ä»¥å®¹çº³çš„æœ€å¤§æ•°æ®é‡ï¼Œä¸å¯å˜</td></tr><tr><td>Limit</td><td>ä¸Šå±Šï¼Œç¼“å†²åŒºå½“å‰æ•°æ®é‡ï¼ŒCapacity=&gt;Limit</td></tr><tr><td>Position</td><td>ä½ç½®ï¼Œä¸‹ä¸€ä¸ªè¦è¢«è¯»å–æˆ–è€…å†™å…¥çš„å…ƒç´ çš„ä½ç½®ï¼ŒCapacity&gt;=Position</td></tr><tr><td>Mark</td><td>æ ‡è®°ï¼Œè°ƒç”¨mark()æ¥è®¾ç½®mark=positionï¼Œå†è°ƒç”¨reset()è®¾ç½®position=mark</td></tr></tbody></table><p>è¿™4ä¸ªå±æ€§éµå¾ªå¤§å°å…³ç³»ï¼š <code>mark &lt;= position &lt;= limit &lt;= capacity</code></p><h3 id="Bufferçš„åŸºæœ¬ç”¨æ³•"><a href="#Bufferçš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="Bufferçš„åŸºæœ¬ç”¨æ³•"></a>Bufferçš„åŸºæœ¬ç”¨æ³•</h3><p>ä½¿ç”¨Bufferè¯»å†™æ•°æ®ä¸€èˆ¬éµå¾ªä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p><ol><li>å†™å…¥æ•°æ®åˆ°<code>Buffer</code>ã€‚</li><li>è°ƒç”¨<code>flip()</code>æ–¹æ³•ã€‚</li><li>ä»Bufferä¸­è¯»å–æ•°æ®ã€‚</li><li>è°ƒç”¨<code>clear()</code>æ–¹æ³•æˆ–è€…<code>compact()</code>æ–¹æ³•ã€‚<h3 id="Bufferçš„æµ‹è¯•ä»£ç "><a href="#Bufferçš„æµ‹è¯•ä»£ç " class="headerlink" title="Bufferçš„æµ‹è¯•ä»£ç "></a>Bufferçš„æµ‹è¯•ä»£ç </h3>ä¸‹é¢æ˜¯å¯¹äºJavaä¸­<code>ByteBuffer</code>çš„æµ‹è¯•ä»£ç ï¼š<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”³è¯·ä¸€ä¸ªå¤§å°ä¸º1024bytesçš„ç¼“å†²buffer</span></span><br><span class="line">ByteBuffer byteBuffer = ByteBuffer.allocate(<span class="number">1024</span>);</span><br><span class="line">System.out.println(<span class="string">"ç”³è¯·åˆ°çš„Bufferï¼š"</span>+byteBuffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™å…¥helloworldåˆ°buffer</span></span><br><span class="line">byteBuffer.put(<span class="string">"HelloWorld"</span>.getBytes());</span><br><span class="line">System.out.println(<span class="string">"å†™å…¥HelloWorldåˆ°Bufferï¼š"</span>+byteBuffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ‡æ¢ä¸ºè¯»æ¨¡å¼</span></span><br><span class="line">byteBuffer.flip();</span><br><span class="line"><span class="comment">// å½“å‰Bufferå·²å­˜æ”¾çš„å¤§å°</span></span><br><span class="line"><span class="keyword">int</span> length = byteBuffer.remaining();</span><br><span class="line"><span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[length];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–bytesé•¿åº¦çš„æ•°æ®</span></span><br><span class="line">byteBuffer.get(bytes);</span><br><span class="line">System.out.println(<span class="string">"ä»bufferè¯»å–åˆ°æ•°æ®ï¼š"</span>+<span class="keyword">new</span> String(bytes,<span class="string">"UTF-8"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ‡æ¢ä¸ºcompact æ¸…ç©ºå·²è¯»å–çš„æ•°æ®</span></span><br><span class="line">byteBuffer.compact();</span><br><span class="line">System.out.println(<span class="string">"è¯»å–åçš„Bufferï¼š"</span>+byteBuffer);</span><br></pre></td></tr></table></figure></li></ol><p>å¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç”³è¯·åˆ°çš„Bufferï¼šjava.nio.HeapByteBuffer[pos=<span class="number">0</span> lim=<span class="number">1024</span> cap=<span class="number">1024</span>]</span><br><span class="line">å†™å…¥HelloWorldåˆ°Bufferï¼šjava.nio.HeapByteBuffer[pos=<span class="number">10</span> lim=<span class="number">1024</span> cap=<span class="number">1024</span>]</span><br><span class="line">ä»bufferè¯»å–åˆ°æ•°æ®ï¼šHelloWorld</span><br><span class="line">è¯»å–åçš„Bufferï¼šjava.nio.HeapByteBuffer[pos=<span class="number">0</span> lim=<span class="number">1024</span> cap=<span class="number">1024</span>]</span><br></pre></td></tr></table></figure></p><p>éœ€è¦è¯´æ˜çš„æ˜¯<code>flip()</code>æ–¹æ³•å°†<code>Buffer</code>ä»å†™æ¨¡å¼åˆ‡æ¢åˆ°è¯»æ¨¡å¼ï¼Œ<code>clear()</code>æ–¹æ³•ä¼šæ¸…ç©ºæ•´ä¸ªç¼“å†²åŒºã€‚<code>compact()</code>æ–¹æ³•åªä¼šæ¸…é™¤å·²ç»è¯»è¿‡çš„æ•°æ®ã€‚</p><h3 id="Bufferçš„è¯»å†™æ¨¡å¼"><a href="#Bufferçš„è¯»å†™æ¨¡å¼" class="headerlink" title="Bufferçš„è¯»å†™æ¨¡å¼"></a>Bufferçš„è¯»å†™æ¨¡å¼</h3><p>æ³¨æ„è¯»å†™æ¨¡å¼åˆ‡æ¢æ—¶å€™å‡ ä¸ªæ ‡è®°ä½çš„å˜åŒ–ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/ff580cf428b9f8e3b5f381df31d083f6.png" alt="IOè¯»å†™æ¨¡å¼"></p><h2 id="é€šé“Channel"><a href="#é€šé“Channel" class="headerlink" title="é€šé“Channel"></a>é€šé“Channel</h2><p>é€šé“Channelå’Œæµç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯é€šé“çš„å·¥ä½œæ¨¡å¼å¯ä»¥æ˜¯å…¨åŒå·¥ã€‚ä¹Ÿå°±æ˜¯è¯´æ—¢å¯ä»¥è¯»å–ï¼Œä¹Ÿå¯ä»¥å†™å…¥ã€‚åŒæ—¶ä¹Ÿå¯ä»¥å¼‚æ­¥çš„è¿›è¡Œè¯»å†™ã€‚<code>Channel</code>è¿æ¥ç€åº•å±‚æ•°æ®ä¸ç¼“å†²åŒº<code>Buffer</code>ã€‚<br>åŒæ ·çš„ï¼ŒJavaä¸­é’ˆå¯¹ä¸åŒçš„æƒ…å†µå®ç°äº†ä¸åŒçš„Channelæ“ä½œç±»ã€‚å¸¸ç”¨çš„æœ‰</p><ol><li>FileChannel ä»æ–‡ä»¶ä¸­è¯»å†™æ•°æ®ã€‚</li><li>DatagramChannel èƒ½é€šè¿‡UDPè¯»å†™ç½‘ç»œä¸­çš„æ•°æ®ã€‚</li><li>SocketChannel èƒ½é€šè¿‡TCPè¯»å†™ç½‘ç»œä¸­çš„æ•°æ®ã€‚</li><li>ServerSocketChannelå¯ä»¥ç›‘å¬æ–°è¿›æ¥çš„TCPè¿æ¥ï¼ŒåƒWebæœåŠ¡å™¨é‚£æ ·ã€‚å¯¹æ¯ä¸€ä¸ªæ–°è¿›æ¥çš„è¿æ¥éƒ½ä¼šåˆ›å»ºä¸€ä¸ªSocketChannelã€‚</li></ol><p>ä¸‹é¢æ˜¯å¯¹äºJavaä¸­Channelå’ŒBufferçš„ç®€å•æ¼”ç¤ºï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”³è¯·ä¸€ä¸ªå¤§å°ä¸º1024bytesçš„ç¼“å†²buffer</span></span><br><span class="line">ByteBuffer byteBuffer = ByteBuffer.allocate(<span class="number">1024</span>);</span><br><span class="line"> <span class="comment">// åˆå§‹åŒ–Channelæ•°æ®</span></span><br><span class="line">FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"f:/test.txt"</span>);</span><br><span class="line">FileChannel channel = fis.getChannel();</span><br><span class="line">System.out.println(<span class="string">"Init Channel sizeï¼š"</span> + channel.size());</span><br><span class="line"> <span class="comment">// ä»channelä¸­è¯»å–æ•°æ®</span></span><br><span class="line"><span class="keyword">int</span> read = channel.read(byteBuffer);</span><br><span class="line">System.out.println(<span class="string">"Read Size :"</span> + read);</span><br><span class="line">System.out.println(<span class="string">"byteBuffer:"</span>+byteBuffer);</span><br><span class="line"> <span class="comment">// åˆ‡æ¢åˆ°è¯»å–æ¨¡å¼</span></span><br><span class="line">byteBuffer.flip();</span><br><span class="line"> <span class="comment">// è¾“å‡ºbyteBufferå†…å®¹</span></span><br><span class="line">System.out.print(<span class="string">"print byteBufferï¼š"</span>);</span><br><span class="line"><span class="keyword">while</span> (byteBuffer.hasRemaining())&#123;</span><br><span class="line">    System.out.print((<span class="keyword">char</span>) byteBuffer.get());</span><br><span class="line">&#125;</span><br><span class="line"> byteBuffer.clear();</span><br><span class="line">System.out.println(byteBuffer);</span><br><span class="line">fis.close();</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Init Channel sizeï¼š<span class="number">10</span></span><br><span class="line">Read Size :<span class="number">10</span></span><br><span class="line">byteBuffer:java.nio.HeapByteBuffer[pos=<span class="number">10</span> lim=<span class="number">1024</span> cap=<span class="number">1024</span>]</span><br><span class="line">print byteBufferï¼šhelloworld</span><br></pre></td></tr></table></figure></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¯»å–ä¹‹å‰ä¸€å®šè¦è°ƒç”¨<code>flip()</code>åˆ‡æ¢åˆ°è¯»å–æ¨¡å¼ã€‚</p><h2 id="é€‰æ‹©å™¨Selector"><a href="#é€‰æ‹©å™¨Selector" class="headerlink" title="é€‰æ‹©å™¨Selector"></a>é€‰æ‹©å™¨Selector</h2><p>Selectorï¼ˆé€‰æ‹©å™¨ï¼‰æ˜¯Java NIOä¸­èƒ½å¤Ÿæ£€æµ‹ä¸€åˆ°å¤šä¸ªNIOé€šé“ï¼Œå¹¶èƒ½å¤ŸçŸ¥æ™“é€šé“æ˜¯å¦ä¸ºè¯¸å¦‚è¯»å†™äº‹ä»¶åšå¥½å‡†å¤‡çš„ç»„ä»¶ã€‚è¿™æ ·ï¼Œä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å¯ä»¥ç®¡ç†å¤šä¸ªchannelï¼Œä»è€Œç®¡ç†å¤šä¸ªç½‘ç»œè¿æ¥ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°<code>Selector</code>ä¸ºè½®è¯¢ä»£ç†å™¨ï¼Œäº‹ä»¶è®¢é˜…å™¨æˆ–è€…channelå®¹å™¨ç®¡ç†å™¨ã€‚<br>åº”ç”¨ç¨‹åºå°†å‘Selectorå¯¹è±¡æ³¨å†Œéœ€è¦å®ƒå…³æ³¨çš„Channelï¼Œä»¥åŠå…·ä½“çš„æŸä¸€ä¸ªChannelä¼šå¯¹å“ªäº›IOäº‹ä»¶æ„Ÿå…´è¶£ã€‚Selectorä¸­ä¹Ÿä¼šç»´æŠ¤ä¸€ä¸ªâ€œå·²ç»æ³¨å†Œçš„Channelâ€çš„å®¹å™¨ã€‚</p><p>å…³äºIOäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>SelectionKey</code>ç±»ä¸­æ‰¾åˆ°å‡ ä¸ªå¸¸ç”¨äº‹ä»¶ï¼š</p><ol><li>OP_READ å¯ä»¥è¯»å–</li><li>OP_WRITE å¯ä»¥å†™å…¥</li><li>OP_CONNECT å·²ç»è¿æ¥</li><li>OP_ACCEPT å¯ä»¥æ¥å—</li></ol><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç¨‹åºä¸­éƒ½æ˜¯é€šè¿‡ä¸æ–­çš„è½®è®­å·²ç»æ³¨å†Œçš„Channelï¼Œæ ¹æ®æ£€æŸ¥æ³¨å†Œæ—¶çš„æ„Ÿå…´è¶£äº‹ä»¶æ˜¯å¦å·²ç»å°±ç»ªæ¥å†³å®šæ˜¯å¦å¯ä»¥è¿›è¡Œåç»­æ“ä½œã€‚åŒæ—¶<code>Selector</code>ä¹Ÿæœ‰å‡ ä¸ªç»å¸¸ä½¿ç”¨çš„æ–¹æ³•ã€‚</p><ol><li><p>select() é˜»å¡åˆ°è‡³å°‘æœ‰ä¸€ä¸ªé€šé“åœ¨ä½ æ³¨å†Œçš„äº‹ä»¶ä¸Šå°±ç»ªäº†ã€‚</p></li><li><p>select(long timeout) æœ€é•¿ä¼šé˜»å¡timeoutæ¯«ç§’</p></li><li><p>selectNow() ä¼šé˜»å¡ï¼Œä¸ç®¡ä»€ä¹ˆé€šé“å°±ç»ªéƒ½ç«‹åˆ»è¿”å›</p></li><li><p>selectedKeys() è¿”å›å°±ç»ªçš„é€šé“</p></li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹Javaä¸­Selectorç¼–å†™æœåŠ¡ç«¯çš„ç®€å•ä½¿ç”¨æµ‹è¯•ï¼ˆå®¢æˆ·ç«¯ä¸åœ¨æ­¤ç¼–å†™äº†ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://www.codingme.net/2018/10/io/io1-bio/#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%A2%E6%88%B7%E7%AB%AF">IOé€šä¿¡æ¨¡å‹ï¼ˆä¸€ï¼‰åŒæ­¥é˜»å¡æ¨¡å¼BIOï¼ˆBlocking IOï¼‰</a>ä¸­çš„å®¢æˆ·ç«¯ä»£ç ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * NIO-Selector</span></span><br><span class="line"><span class="comment"> * é€‰æ‹©å™¨çš„ä½¿ç”¨æµ‹è¯•</span></span><br><span class="line"><span class="comment"> * Selectorï¼ˆé€‰æ‹©å™¨ï¼‰æ˜¯Java NIOä¸­èƒ½å¤Ÿæ£€æµ‹ä¸€åˆ°å¤šä¸ªNIOé€šé“ï¼Œå¹¶èƒ½å¤ŸçŸ¥æ™“é€šé“æ˜¯å¦ä¸ºè¯¸å¦‚è¯»</span></span><br><span class="line"><span class="comment"> * å†™äº‹ä»¶åšå¥½å‡†å¤‡çš„ç»„ä»¶ã€‚è¿™æ ·ï¼Œä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å¯ä»¥ç®¡ç†å¤šä¸ªchannelï¼Œä»è€Œç®¡ç†å¤šä¸ªç½‘ç»œè¿æ¥</span></span><br><span class="line"><span class="comment"> * ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°Selectorä¸ºè½®è¯¢ä»£ç†å™¨ï¼Œäº‹ä»¶è®¢é˜…å™¨æˆ–è€…channelå®¹å™¨ç®¡ç†å™¨ã€‚</span></span><br><span class="line"><span class="comment"> * åº”ç”¨ç¨‹åºå°†å‘Selectorå¯¹è±¡æ³¨å†Œéœ€è¦å®ƒå…³æ³¨çš„Channelï¼Œä»¥åŠå…·ä½“çš„æŸä¸€ä¸ªChannelä¼šå¯¹å“ªäº›</span></span><br><span class="line"><span class="comment"> * IOäº‹ä»¶æ„Ÿå…´è¶£ã€‚Selectorä¸­ä¹Ÿä¼šç»´æŠ¤ä¸€ä¸ªâ€œå·²ç»æ³¨å†Œçš„Channelâ€çš„å®¹å™¨ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/10/26 15:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NioSelector</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–channel</span></span><br><span class="line">        ServerSocketChannel channel = ServerSocketChannel.open();</span><br><span class="line">        <span class="comment">// channelæ˜¯å¦é˜»å¡</span></span><br><span class="line">        channel.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line">        <span class="comment">// ç›‘å¬88ç«¯å£</span></span><br><span class="line">        ServerSocket socket = channel.socket();</span><br><span class="line">        socket.bind(<span class="keyword">new</span> InetSocketAddress(<span class="number">83</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºé€‰æ‹©å™¨Selector</span></span><br><span class="line">        Selector selector = Selector.open();</span><br><span class="line">        <span class="comment">// åƒé€‰æ‹©å™¨ä¸­æ³¨å†Œchannel</span></span><br><span class="line">        channel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// é˜»å¡åˆ°æœ‰ä¸€ä¸ªå°±ç»ª</span></span><br><span class="line">            <span class="keyword">int</span> readyChannel = selector.select();</span><br><span class="line">            <span class="keyword">if</span> (readyChannel == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            Set&lt;SelectionKey&gt; selectionKeys = selector.selectedKeys();</span><br><span class="line">            Iterator&lt;SelectionKey&gt; iterator = selectionKeys.iterator();</span><br><span class="line">            <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">                SelectionKey selectionKey = iterator.next();</span><br><span class="line">                iterator.remove();</span><br><span class="line">                <span class="comment">// æ˜¯å¦å¯ä»¥æ¥å—</span></span><br><span class="line">                <span class="keyword">if</span> (selectionKey.isAcceptable()) &#123;</span><br><span class="line">                    System.out.println(<span class="string">"å‡†å¤‡å°±ç»ª"</span>);</span><br><span class="line">                    SelectableChannel selectableChannel = selectionKey.channel();</span><br><span class="line">                    ServerSocketChannel serverSocketChannel = (ServerSocketChannel) selectableChannel;</span><br><span class="line">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class="line">                    socketChannel.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line">                    <span class="comment">// æ³¨å†Œæ„Ÿå…´è¶£äº‹ä»¶-è¯»å–</span></span><br><span class="line">                    socketChannel.register(selector, SelectionKey.OP_READ, ByteBuffer.allocate(<span class="number">2048</span>));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (selectionKey.isConnectable()) &#123;</span><br><span class="line">                    System.out.println(<span class="string">"å·²è¿æ¥"</span>);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (selectionKey.isReadable()) &#123;</span><br><span class="line">                    System.out.println(<span class="string">"å¯ä»¥è¯»å–"</span>);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (selectionKey.isWritable()) &#123;</span><br><span class="line">                    System.out.println(<span class="string">"å¯ä»¥å†™å…¥"</span>);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Java-NIOç¼–ç¨‹"><a href="#Java-NIOç¼–ç¨‹" class="headerlink" title="Java NIOç¼–ç¨‹"></a>Java NIOç¼–ç¨‹</h2><p>åˆ°è¿™é‡Œï¼Œå·²ç»å¯¹<code>å¤šè·¯å¤ç”¨IO</code>æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„è®¤è¯†äº†ï¼Œå¯ä»¥ç»“åˆä¸Šé¢çš„ä¸‰ä¸ªæ¦‚å¿µå°±è¡Œå¤šè·¯å¤ç”¨IOç¼–ç¨‹äº†ï¼Œä¸‹é¢æ¼”ç¤ºä½¿ç”¨Javaè¯­è¨€ç¼–å†™ä¸€ä¸ª<code>å¤šè·¯å¤ç”¨IO</code>æœåŠ¡ç«¯ã€‚<br>NioSocketServer.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.channels.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨Java NIOæ¡†æ¶ï¼Œå®ç°ä¸€ä¸ªæ”¯æŒå¤šè·¯å¤ç”¨IOçš„æœåŠ¡å™¨ç«¯</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/10/16 0:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NioSocketServer</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ—¥å¿—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(NioSocketServer.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ServerSocketChannel serverChannel = ServerSocketChannel.open();</span><br><span class="line">        <span class="comment">// æ˜¯å¦é˜»å¡</span></span><br><span class="line">        serverChannel.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line">        ServerSocket serverSocket = serverChannel.socket();</span><br><span class="line">        serverSocket.setReuseAddress(<span class="keyword">true</span>);</span><br><span class="line">        serverSocket.bind(<span class="keyword">new</span> InetSocketAddress(<span class="number">83</span>));</span><br><span class="line"></span><br><span class="line">        Selector selector = Selector.open();</span><br><span class="line">        <span class="comment">// æœåŠ¡å™¨é€šé“åªèƒ½æ³¨å†ŒSelectionKey.OP_ACCEPTäº‹ä»¶</span></span><br><span class="line">        serverChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// javaç¨‹åºå¯¹å¤šè·¯å¤ç”¨IOçš„æ”¯æŒä¹ŸåŒ…æ‹¬äº†é˜»å¡æ¨¡å¼ å’Œéé˜»å¡æ¨¡å¼ä¸¤ç§ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (selector.select(<span class="number">100</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">//LOGGER.info("æœ¬æ¬¡è¯¢é—®selectoræ²¡æœ‰è·å–åˆ°ä»»ä½•å‡†å¤‡å¥½çš„äº‹ä»¶");</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è¯¢é—®ç³»ç»Ÿï¼Œæ‰€æœ‰è·å–åˆ°çš„äº‹ä»¶ç±»å‹</span></span><br><span class="line">            Iterator&lt;SelectionKey&gt; selectionKeys = selector.selectedKeys().iterator();</span><br><span class="line">            <span class="keyword">while</span> (selectionKeys.hasNext()) &#123;</span><br><span class="line">                SelectionKey readKey = selectionKeys.next();</span><br><span class="line">                <span class="comment">// ä¸Šé¢è·å–åˆ°çš„readKeyè¦ç§»é™¤ï¼Œä¸ç„¶ä¼šä¸€ç›´å­˜åœ¨selector.selectedKeys()çš„é›†åˆä¹‹ä¸­</span></span><br><span class="line">                selectionKeys.remove();</span><br><span class="line"></span><br><span class="line">                SelectableChannel selectableChannel = readKey.channel();</span><br><span class="line">                <span class="keyword">if</span> (readKey.isValid() &amp;&amp; readKey.isAcceptable()) &#123;</span><br><span class="line">                    LOGGER.info(<span class="string">"--------------channelé€šé“å·²ç»å‡†å¤‡å®Œæ¯•-------------"</span>);</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                     * å½“server socket channelé€šé“å·²ç»å‡†å¤‡å¥½ï¼Œå°±å¯ä»¥ä»server socket channelä¸­è·å–socketchanneläº†</span></span><br><span class="line"><span class="comment">                     * æ‹¿åˆ°socket channelåï¼Œè¦åšçš„äº‹æƒ…å°±æ˜¯é©¬ä¸Šåˆ°selectoræ³¨å†Œè¿™ä¸ªsocket channelæ„Ÿå…´è¶£çš„äº‹æƒ…ã€‚</span></span><br><span class="line"><span class="comment">                     * å¦åˆ™æ— æ³•ç›‘å¬åˆ°è¿™ä¸ªsocket channelåˆ°è¾¾çš„æ•°æ®</span></span><br><span class="line"><span class="comment">                     * */</span></span><br><span class="line">                    ServerSocketChannel serverSocketChannel = (ServerSocketChannel) selectableChannel;</span><br><span class="line">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class="line">                    registerSocketChannel(socketChannel, selector);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (readKey.isValid() &amp;&amp; readKey.isConnectable()) &#123;</span><br><span class="line">                    LOGGER.info(<span class="string">"--------------socket channel å»ºç«‹è¿æ¥-------------"</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (readKey.isValid() &amp;&amp; readKey.isReadable()) &#123;</span><br><span class="line">                    LOGGER.info(<span class="string">"--------------socket channel æ•°æ®å‡†å¤‡å®Œæˆï¼Œå¯ä»¥å¼€å§‹è¯»å–-------------"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        readSocketChannel(readKey);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        LOGGER.error(e.getMessage());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨server socket channelæ¥æ”¶åˆ°/å‡†å¤‡å¥½ ä¸€ä¸ªæ–°çš„ TCPè¿æ¥åã€‚</span></span><br><span class="line"><span class="comment">     * å°±ä¼šå‘ç¨‹åºè¿”å›ä¸€ä¸ªæ–°çš„socketChannelã€‚&lt;br&gt;</span></span><br><span class="line"><span class="comment">     * ä½†æ˜¯è¿™ä¸ªæ–°çš„socket channelå¹¶æ²¡æœ‰åœ¨selectorâ€œé€‰æ‹©å™¨/ä»£ç†å™¨â€ä¸­æ³¨å†Œï¼Œ</span></span><br><span class="line"><span class="comment">     * æ‰€ä»¥ç¨‹åºè¿˜æ²¡æ³•é€šè¿‡selectoré€šçŸ¥è¿™ä¸ªsocket channelçš„äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     * äºæ˜¯æˆ‘ä»¬æ‹¿åˆ°æ–°çš„socket channelåï¼Œè¦åšçš„ç¬¬ä¸€ä¸ªäº‹æƒ…å°±æ˜¯åˆ°selectorâ€œé€‰æ‹©å™¨/ä»£ç†å™¨â€ä¸­æ³¨å†Œè¿™ä¸ª</span></span><br><span class="line"><span class="comment">     * socket channelæ„Ÿå…´è¶£çš„äº‹ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> socketChannel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> selector</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerSocketChannel</span><span class="params">(SocketChannel socketChannel, Selector selector)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ˜¯å¦é˜»å¡</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socketChannel.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line">            <span class="comment">// è¯»æ¨¡å¼åªèƒ½è¯»ï¼Œå†™æ¨¡å¼å¯ä»¥åŒæ—¶è¯»</span></span><br><span class="line">            <span class="comment">// socketé€šé“å¯ä»¥ä¸”åªå¯ä»¥æ³¨å†Œä¸‰ç§äº‹ä»¶SelectionKey.OP_READ | SelectionKey.OP_WRITE | SelectionKey.OP_CONNECT</span></span><br><span class="line">            socketChannel.register(selector, SelectionKey.OP_READ, ByteBuffer.allocate(<span class="number">2048</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            LOGGER.info(e.toString(), e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readSocketChannel</span><span class="params">(SelectionKey readKey)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        SocketChannel clientSocketChannel = (SocketChannel) readKey.channel();</span><br><span class="line">        <span class="comment">//è·å–å®¢æˆ·ç«¯ä½¿ç”¨çš„ç«¯å£</span></span><br><span class="line">        InetSocketAddress sourceSocketAddress = (InetSocketAddress) clientSocketChannel.getRemoteAddress();</span><br><span class="line">        <span class="keyword">int</span> sourcePort = sourceSocketAddress.getPort();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‹¿åˆ°è¿™ä¸ªsocket channelä½¿ç”¨çš„ç¼“å­˜åŒºï¼Œå‡†å¤‡è¯»å–æ•°æ®</span></span><br><span class="line">        <span class="comment">// è§£ç¼“å­˜åŒºçš„ç”¨æ³•æ¦‚å¿µï¼Œå®é™…ä¸Šé‡è¦çš„å°±æ˜¯ä¸‰ä¸ªå…ƒç´ capacity,positionå’Œlimitã€‚</span></span><br><span class="line">        ByteBuffer contextBytes = (ByteBuffer) readKey.attachment();</span><br><span class="line">        <span class="comment">// é€šé“çš„æ•°æ®å†™å…¥åˆ°ã€ç¼“å­˜åŒºã€‘</span></span><br><span class="line">        <span class="comment">// ç”±äºä¹‹å‰è®¾ç½®äº†ByteBufferçš„å¤§å°ä¸º2048 byteï¼Œæ‰€ä»¥å¯ä»¥å­˜åœ¨å†™å…¥ä¸å®Œçš„æƒ…å†µï¼Œéœ€è¦è°ƒæ•´</span></span><br><span class="line">        <span class="keyword">int</span> realLen = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            realLen = clientSocketChannel.read(contextBytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(e.getMessage());</span><br><span class="line">            clientSocketChannel.close();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (realLen == -<span class="number">1</span>) &#123;</span><br><span class="line">            LOGGER.warn(<span class="string">"--------------ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®-------------"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†ç¼“å­˜åŒºè¯»å†™çŠ¶æ€æ¨¡å¼è¿›è¡Œåˆ‡æ¢</span></span><br><span class="line">        contextBytes.flip();</span><br><span class="line">        <span class="comment">// å¤„ç†ç¼–ç é—®é¢˜</span></span><br><span class="line">        <span class="keyword">byte</span>[] messageBytes = contextBytes.array();</span><br><span class="line">        String messageEncode = <span class="keyword">new</span> String(messageBytes, <span class="string">"UTF-8"</span>);</span><br><span class="line">        String message = URLDecoder.decode(messageEncode, <span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¥å—åˆ°äº†"over"åˆ™æ¸…ç©ºbuffer,å¹¶å“åº”,å¦åˆ™ä¸æ¸…ç©ºç¼“å­˜ï¼Œå¹¶è¿˜åŸBufferå†™çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span> (message.indexOf(<span class="string">"over"</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">//æ¸…ç©ºå·²ç»è¯»å–çš„ç¼“å­˜ï¼Œå¹¶ä»æ–°åˆ‡æ¢ä¸ºå†™çŠ¶æ€(è¿™é‡Œè¦æ³¨æ„clear()å’Œcapacity()ä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«)</span></span><br><span class="line">            contextBytes.clear();</span><br><span class="line">            LOGGER.info(<span class="string">"ç«¯å£ã€"</span> + sourcePort + <span class="string">"ã€‘å®¢æˆ·ç«¯å‘æ¥çš„ä¿¡æ¯ï¼š"</span> + message);</span><br><span class="line">            LOGGER.info(<span class="string">"ç«¯å£ã€"</span> + sourcePort + <span class="string">"ã€‘å®¢æˆ·ç«¯æ¶ˆæ¯å‘é€å®Œæ¯•"</span>);</span><br><span class="line">            <span class="comment">// å“åº”</span></span><br><span class="line">            ByteBuffer sendBuffer = ByteBuffer.wrap(URLEncoder.encode(<span class="string">"Done!"</span>, <span class="string">"UTF-8"</span>).getBytes());</span><br><span class="line">            clientSocketChannel.write(sendBuffer);</span><br><span class="line">            clientSocketChannel.close();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            LOGGER.info(<span class="string">"ç«¯å£ã€"</span> + sourcePort + <span class="string">"ã€‘å®¢æˆ·ç«¯å‘æ¥çš„ä¿¡æ¯è¿˜æœªå®Œæ¯•ï¼Œç»§ç»­æ¥æ”¶"</span>);</span><br><span class="line">            <span class="comment">// limitå’Œcapacityçš„å€¼ä¸€è‡´ï¼Œpositionçš„ä½ç½®æ˜¯realLençš„ä½ç½®</span></span><br><span class="line">            contextBytes.position(realLen);</span><br><span class="line">            contextBytes.limit(contextBytes.capacity());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤šè·¯å¤ç”¨IOä¼˜ç¼ºç‚¹"><a href="#å¤šè·¯å¤ç”¨IOä¼˜ç¼ºç‚¹" class="headerlink" title="å¤šè·¯å¤ç”¨IOä¼˜ç¼ºç‚¹"></a>å¤šè·¯å¤ç”¨IOä¼˜ç¼ºç‚¹</h2><ul><li>ä¸éœ€è¦ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡ŒIOå¤„ç†äº†</li><li>åŒä¸€ä¸ªç«¯å£å¯ä»¥å¤„ç†å¤šç§åè®®</li><li>å¤šè·¯å¤ç”¨IOå…·æœ‰æ“ä½œç³»ç»Ÿçº§åˆ«çš„ä¼˜åŒ–</li><li>å…¶å®åº•å±‚è¿˜éƒ½æ˜¯åŒæ­¥IO</li></ul><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ GitHubï¼š<a href="https://github.com/niumoo/java-toolbox/tree/master/src/main/java/net/codingme/box/io/jdknio" target="_blank" rel="noopener">https://github.com/niumoo/java-toolbox/</a></p><p>&lt;å®Œ&gt;</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/59a331b8fdebaf1dcecab9fe31bb8b80.png&quot; alt=&quot;macèƒŒåŒ…&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å¤šè·¯å¤ç”¨IO&quot;&gt;&lt;a href=&quot;#å¤šè·¯å¤ç”¨IO&quot; class=&quot;headerlink&quot; title=&quot;å¤šè·¯å¤ç”¨IO&quot;&gt;&lt;/a&gt;å¤šè·¯å¤ç”¨IO&lt;/h2&gt;&lt;p&gt;ä»&lt;code&gt;éé˜»å¡åŒæ­¥IO&lt;/code&gt;çš„ä»‹ç»ä¸­å¯ä»¥å‘ç°ï¼Œä¸ºæ¯ä¸€ä¸ªæ¥å…¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹åœ¨è¯·æ±‚å¾ˆå¤šçš„æƒ…å†µä¸‹ä¸é‚£ä¹ˆé€‚ç”¨äº†ï¼Œå› ä¸ºè¿™ä¼šæ¸æ¸è€—å°½æœåŠ¡å™¨çš„èµ„æºï¼Œäººä»¬ä¹Ÿéƒ½æ„è¯†åˆ°äº†è¿™ä¸ª é—®é¢˜ï¼Œå› æ­¤ç»ˆäºæœ‰äººå‘æ˜äº†&lt;code&gt;IOå¤šè·¯å¤ç”¨&lt;/code&gt;ã€‚æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯&lt;code&gt;ä¸éœ€è¦å¼€é‚£ä¹ˆå¤šçš„çº¿ç¨‹å’Œè¿›ç¨‹&lt;/code&gt;ã€‚&lt;br&gt;&lt;code&gt;å¤šè·¯å¤ç”¨IO&lt;/code&gt;æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥æ£€æŸ¥å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆSocketï¼‰çš„å°±ç»ªçŠ¶æ€ï¼Œæ¯”å¦‚è°ƒç”¨selectå’Œpollå‡½æ•°ï¼Œä¼ å…¥å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦å°±ç»ªï¼Œåˆ™è¿”å›ï¼Œå¦åˆ™é˜»å¡ç›´åˆ°è¶…æ—¶ã€‚å¾—åˆ°å°±ç»ªçŠ¶æ€åè¿›è¡ŒçœŸæ­£çš„æ“ä½œå¯ä»¥åœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å¯åŠ¨çº¿ç¨‹æ‰§è¡Œï¼ˆæ¯”å¦‚ä½¿ç”¨çº¿ç¨‹æ± ï¼‰ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="IOé€šä¿¡" scheme="https://www.codingme.net/categories/IO%E9%80%9A%E4%BF%A1/"/>
    
    
      <category term="IO" scheme="https://www.codingme.net/tags/IO/"/>
    
      <category term="éé˜»å¡" scheme="https://www.codingme.net/tags/%E9%9D%9E%E9%98%BB%E5%A1%9E/"/>
    
      <category term="NIO" scheme="https://www.codingme.net/tags/NIO/"/>
    
  </entry>
  
</feed>
