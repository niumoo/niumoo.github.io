<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æœªè¯»ä»£ç </title>
  
  <subtitle>ä¸“æ³¨Java</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.codingme.net/"/>
  <updated>2020-02-18T15:18:24.796Z</updated>
  <id>https://www.codingme.net/</id>
  
  <author>
    <name>æœªè¯»ä»£ç </name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk9 çš„æ–°ç‰¹æ€§è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ</title>
    <link href="https://www.codingme.net/2020/02/jdk/jdk9-feature/"/>
    <id>https://www.codingme.net/2020/02/jdk/jdk9-feature/</id>
    <published>2020-02-19T00:01:01.000Z</published>
    <updated>2020-02-18T15:18:24.796Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/assets/jdk-new-feature/140916143852191.png" alt="Java 9"></p><p><code>Java 9</code> ä¸­æœ€å¤§çš„äº®ç‚¹æ˜¯ <strong>Java å¹³å°æ¨¡å—åŒ–</strong>çš„å¼•å…¥ï¼Œä»¥åŠæ¨¡å—åŒ– JDKã€‚ä½†æ˜¯ <code>Java 9</code> è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–°åŠŸèƒ½ï¼Œè¿™ç¯‡æ–‡å­—ä¼šå°†é‡ç‚¹ä»‹ç»å¼€å‘äººå‘˜ç‰¹åˆ«æ„Ÿå…´è¶£çš„å‡ ç§åŠŸèƒ½ã€‚</p><p>è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯ Java æ–°ç‰¹æ€§ç³»åˆ—æ–‡ç« ä¸­çš„ä¸€ç¯‡ï¼Œå¾€æœŸæ–‡ç« å¯ä»¥æŸ¥çœ‹ä¸‹é¢é“¾æ¥ã€‚</p><p><a href="https://www.codingme.net/2019/11/jdk/jdk8-stream/">è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼Ÿè¶…å¼ºçš„ Stream æµæ“ä½œå§¿åŠ¿è¿˜ä¸å­¦ä¹ ä¸€ä¸‹</a></p><p><a href="https://www.codingme.net/2019/11/jdk/jdk8-lambda/">è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹</a></p><p><a href="https://www.codingme.net/2019/11/jdk/jdk8-optional/">Jdk14 éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ</a></p><p><a href="https://www.codingme.net/2019/10/jdk/jdk8-time/">Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk8 çš„æ—¶é—´å¤„ç†å§¿åŠ¿è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ</a></p><p><a href="https://www.codingme.net/2020/01/jdk/jdk7-start/">è¿˜çœ‹ä¸æ‡‚åŒäº‹ä»£ç ï¼Ÿå¿«æ¥è¡¥ä¸€æ³¢ Java 7 è¯­æ³•ç‰¹æ€§</a></p><a id="more"></a><h2 id="1-æ¨¡å—åŒ–"><a href="#1-æ¨¡å—åŒ–" class="headerlink" title="1.  æ¨¡å—åŒ–"></a>1.  æ¨¡å—åŒ–</h2><p><code>Java 9</code> ä¸­çš„<strong>æ¨¡å—åŒ–</strong>æ˜¯å¯¹ <code>Java</code> çš„ä¸€æ¬¡é‡å¤§æ”¹è¿›ã€‚ä½†æ˜¯<strong>æ¨¡å—åŒ–</strong>å¹¶ä¸æ˜¯æœ€è¿‘æ‰æå‡ºæ¥çš„ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„  <code>maven</code> æ„å»ºå·¥å…·ï¼Œå°±æ˜¯å…¸å‹çš„æ¨¡å—åŒ–æ„å»ºå·¥å…·ã€‚<strong>æ¨¡å—åŒ–</strong>ä¸ä»…è®©æ¨¡å—å‘½åæ¸…æ™°ï¼Œå†™å‡ºé«˜å†…èšä½è€¦åˆçš„ä»£ç ï¼Œæ›´å¯ä»¥æ–¹ä¾¿å¤„ç†æ¨¡å—ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚</p><p><img src="/assets/jdk-new-feature/Explicit-modules.png" alt="Java 9 æ¨¡å—ç³»ç»Ÿ"></p><p>åœ¨ Oracle å®˜æ–¹ä¸­ä¸º <code>Java 9</code> ä¸­çš„æ¨¡å—ç³»ç»Ÿçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><blockquote><p>the module, which is a named, self-describing collection of code and data. This module system.</p></blockquote><p>ç›´ç™½ç¿»è¯‘ï¼šæ¨¡å—æ˜¯ä¸€ä¸ªå‘½åçš„ï¼Œè‡ªæˆ‘æè¿°çš„ä»£ç å’Œæ•°æ®çš„é›†åˆã€‚</p><p><code>Java 9</code> ä¸ä»…æ”¯æŒäº†æ¨¡å—åŒ–å¼€å‘ï¼Œæ›´æ˜¯ç›´æ¥æŠŠ <code>JDK</code> è‡ªèº«è¿›è¡Œäº†æ¨¡å—åŒ–å¤„ç†ã€‚<code>JDK</code> è‡ªèº«çš„æ¨¡å—åŒ–å¯ä»¥å¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼Œæ¯”å¦‚ï¼š</p><ul><li>æ–¹ä¾¿ç®¡ç†ï¼Œè¶Šæ¥è¶Šå¤§çš„ JDK åœ¨æ¨¡å—åŒ–ä¸‹ç»“æ„å˜å¾—æ›´åŠ æ¸…æ™°ã€‚</li><li>æ¨¡å—åŒ– JDK å’Œ JRE è¿è¡Œæ—¶é•œåƒå¯ä»¥æé«˜æ€§èƒ½ã€å®‰å…¨æ€§ã€ç»´æŠ¤æ€§ã€‚</li><li>å¯ä»¥å®šåˆ¶ JREï¼Œä½¿ç”¨æ›´å°çš„è¿è¡Œæ—¶é•œåƒï¼Œæ¯”å¦‚ç½‘ç»œåº”ç”¨ä¸éœ€è¦ swing åº“ï¼Œå¯ä»¥åœ¨æ‰“åŒ…æ—¶é€‰æ‹©ä¸ç”¨ï¼Œå‡å°‘æ€§èƒ½æ¶ˆè€—ã€‚</li><li>æ¸…æ™°æ˜äº†çš„æ¨¡å—è°ƒç”¨å…³ç³»ï¼Œé¿å…è°ƒç”¨ä¸å½“å‡ºæ¥çš„å„ç§é—®é¢˜ã€‚</li></ul><p>ä¸Šé¢æåˆ°äº† JDK è‡ªèº«çš„æ¨¡å—åŒ–ï¼Œæˆ‘ä»¬é€šè¿‡æµè§ˆ JDK 9 çš„ç›®å½•ç»“æ„ä¹Ÿå¯ä»¥å‘ç°ä¸€äº›å˜åŒ–ã€‚</p><p><img src="/assets/jdk-new-feature/image-20200217111754648.png" alt="JDK æ¨¡å—åŒ–"></p><p>æœ€æ˜æ˜¾çš„æ˜¯åœ¨ JDK 9 ä¸­ jre æ–‡ä»¶å¤¹ä¸å­˜åœ¨äº†ã€‚ä¸‹é¢æ˜¯åœ¨ IDEA ä¸­æŸ¥çœ‹çš„ JDK 9 çš„ä¾èµ–ï¼Œå‘½åè§„èŒƒçš„æ¨¡å—çœ‹èµ·æ¥æ˜¯ä¸æ˜¯è®©äººèµå¿ƒæ‚¦ç›®å‘¢ï¼Ÿ</p><p><img src="/assets/jdk-new-feature/image-20200217112025069.png" alt="JDK 9 åœ¨ IDEA"></p><p>å½“ç„¶ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç» Java 9 çš„æ–°ç‰¹æ€§ï¼Œè€Œæ¨¡å—åŒ–æ˜¯ä¸€ä¸ªå·¨å¤§æ”¹å˜ï¼Œç»“åˆç¤ºä¾‹ä»‹ç»ä¸‹æ¥ç¯‡å¹…ä¼šæ¯”è¾ƒé•¿ï¼Œè¿™é‡Œå°±ä¸å ç”¨å¤ªå¤šç¯‡å¹…äº†ã€‚</p><p>æ¨¡å—åŒ–æ–‡ç« é¢„å‘Šï¼šå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ¨¡å—åŒ–ç³»ç»Ÿï¼Œå¦‚ä½•æ‰“åŒ…è®©æ²¡æœ‰å®‰è£… Java ç¯å¢ƒçš„ç³»ç»Ÿè¿è¡Œç¼–å†™çš„ä»£ç ï¼Œéƒ½å¯ä»¥é€šè¿‡æ¨¡å—åŒ–é€‰æ‹©è¿è¡Œæ—¶æ¨¡å—å®ç°ã€‚æˆ‘åé¢çš„æ–‡ç« å°±ä¼šé€šè¿‡ä¸€ä¸ªæ¨¡å—åŒ–é¡¹ç›®ä»‹ç»åˆ°ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å…³æ³¨æˆ‘åç»­æ–‡ç«  ğŸ˜ã€‚</p><h2 id="2-é›†åˆå·¥å‚æ–¹æ³•"><a href="#2-é›†åˆå·¥å‚æ–¹æ³•" class="headerlink" title="2. é›†åˆå·¥å‚æ–¹æ³•"></a>2. é›†åˆå·¥å‚æ–¹æ³•</h2><p>åœ¨ Java 9 ä¸­ä¸ºé›†åˆçš„åˆ›å»ºå¢åŠ äº†é™æ€å·¥å‚åˆ›å»ºæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ <code>of</code> æ–¹æ³•ï¼Œé€šè¿‡é™æ€å·¥å‚ <code>of</code> æ–¹æ³•åˆ›å»ºçš„é›†åˆæ˜¯<strong>åªè¯»é›†åˆ</strong>ï¼Œé‡Œé¢çš„å¯¹è±¡<strong>ä¸å¯æ”¹å˜</strong>ã€‚å¹¶åœ¨<strong>ä¸èƒ½å­˜åœ¨ <code>null</code> å€¼</strong>ï¼Œå¯¹äº <code>set</code> å’Œ <code>map</code> é›†åˆï¼Œä¹Ÿ<strong>ä¸èƒ½å­˜åœ¨ <code>key</code> å€¼é‡å¤</strong>ã€‚è¿™æ ·ä¸ä»…<strong>çº¿ç¨‹å®‰å…¨</strong>ï¼Œè€Œä¸”<strong>æ¶ˆè€—çš„å†…å­˜ä¹Ÿæ›´å°</strong>ã€‚</p><p>ä¸‹é¢æ˜¯ä¸‰ç§é›†åˆé€šè¿‡é™æ€å·¥å‚åˆ›å»ºçš„æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å·¥å‚æ–¹æ³•åˆ›å»ºé›†åˆ</span></span><br><span class="line">List&lt;String&gt; stringList = List.of(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>);</span><br><span class="line">Set&lt;String&gt; stringSet = Set.of(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>);</span><br><span class="line">Map&lt;String, Integer&gt; stringIntegerMap = Map.of(<span class="string">"key1"</span>, <span class="number">1</span>, <span class="string">"key2"</span>, <span class="number">2</span>, <span class="string">"key3"</span>, <span class="number">3</span>);</span><br><span class="line">Map&lt;String, Integer&gt; stringIntegerMap2 = Map.ofEntries(Map.entry(<span class="string">"key1"</span>, <span class="number">1</span>), Map.entry(<span class="string">"key2"</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// é›†åˆè¾“å‡º</span></span><br><span class="line">System.out.println(stringList);</span><br><span class="line">System.out.println(stringSet);</span><br><span class="line">System.out.println(stringIntegerMap);</span><br><span class="line">System.out.println(stringIntegerMap2);</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[a, b, c, d]</span><br><span class="line">[d, a, c, b]</span><br><span class="line">&#123;key2=2, key1=1, key3=3&#125;</span><br><span class="line">&#123;key2=2, key1=1&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡Œï¼Œå¾—åˆ°è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[a, b, c, d]</span><br><span class="line">[a, c, b, d]</span><br><span class="line">&#123;key3=3, key2=2, key1=1&#125;</span><br><span class="line">&#123;key2=2, key1=1&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆæˆ‘è´´äº†ä¸¤æ¬¡è¿è¡Œç»“æœå‘¢ï¼Ÿä¸»è¦æ˜¯è¦å±•ç¤ºé€šè¿‡ <code>of</code> æ–¹æ³•åˆ›å»ºçš„ <code>set</code> å’Œ <code>map</code> é›†åˆåœ¨éå†æ—¶ï¼Œåœ¨æ¯ä¸ª JVM å‘¨æœŸéå†é¡ºåºæ˜¯éšæœºçš„ï¼Œè¿™æ ·çš„æœºåˆ¶å¯ä»¥å‘ä¸‹ä»£ç ä¸­æœ‰æ²¡æœ‰å¯¹äºé¡ºåºæ•æ„Ÿçš„å¼‚å¸¸ä»£ç ã€‚</p><p>è¿™ç§åªè¯»é›†åˆåœ¨ Java 9 ä¹‹å‰åˆ›å»ºæ˜¯é€šè¿‡ <code>Collections.unmodifiableList</code> ä¿®æ”¹é›†åˆæ“ä½œæƒé™å®ç°çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">arrayList.add(<span class="string">"è¾¾è¥¿"</span>);</span><br><span class="line">arrayList.add(<span class="string">"æœªè¯»ä»£ç "</span>);</span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºåªè¯»é›†åˆ</span></span><br><span class="line">arrayList = Collections.unmodifiableList(arrayList);</span><br></pre></td></tr></table></figure><p>é™æ€å·¥å‚ <code>of</code> æ–¹æ³•åˆ›å»ºçš„é›†åˆè¿˜æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯å·¥å‚å†…éƒ¨ä¼šè‡ªç”±å¤ç”¨å·²æœ‰å®ä¾‹æˆ–è€…åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥åº”è¯¥é¿å…å¯¹ <code>of</code> åˆ›å»ºçš„é›†åˆè¿›è¡Œåˆ¤ç­‰æˆ–è€… <code>haseCode</code> æ¯”è¾ƒç­‰æ“ä½œã€‚</p><p>åƒä¸‹é¢è¿™æ ·ï¼Œåˆ›å»ºä¸¤ä¸ª <code>List</code>ï¼Œä½ ä¼šå‘ç°ä¸¤ä¸ª <code>List</code> çš„ <code>hashCode</code> æ˜¯ä¸€æ ·çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å·¥å‚å¯ä»¥è‡ªç”±åˆ›å»ºæ–°çš„å®ä¾‹æˆ–è€…å¤ç”¨ç°æœ‰å®ä¾‹ï¼Œæ‰€ä»¥ ä½¿ç”¨ of åˆ›å»ºçš„é›†åˆï¼Œé¿å… == æˆ–è€… hashCode åˆ¤æ–­æ“ä½œ</span></span><br><span class="line">List&lt;String&gt; stringList = List.of(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>);</span><br><span class="line">List&lt;String&gt; stringList2 = List.of(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>);</span><br><span class="line">System.out.println(stringList.hashCode());</span><br><span class="line">System.out.println(stringList2.hashCode());</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 3910595</span></span><br><span class="line"><span class="comment">// 3910596</span></span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿæ˜¯ä½¿ç”¨ <code>of</code> æ–¹æ³•åˆ›å»ºé›†åˆçš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œæ¶ˆè€—æ›´å°‘çš„ç³»ç»Ÿèµ„æºã€‚è¿™ä¸€ç‚¹ä¹Ÿä½“ç°åœ¨ <code>of</code> åˆ›å»ºçš„é›†åˆçš„æ•°æ®ç»“æ„å®ç°ä¸Šï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œç ”ç©¶ä¸‹ã€‚</p><h2 id="3-Stream-API"><a href="#3-Stream-API" class="headerlink" title="3. Stream API"></a>3. Stream API</h2><p><code>Stream</code> æµæ“ä½œè‡ªä» <code>Java 8</code> å¼•å…¥ä»¥æ¥ï¼Œä¸€ç›´å¹¿å—å¥½è¯„ã€‚ä¾¿æ·ä¸°å¯Œçš„ <code>Stream</code> æ“ä½œè®©äººçˆ±ä¸é‡Šæ‰‹ï¼Œæ›´è®©æ²¡çœ‹è¿‡çš„åŒäº‹çœ¼èŠ±ç¼­ä¹±ï¼Œåœ¨ä»‹ç» <code>Java 8</code> æ–°ç‰¹æ€§æ—¶å·²ç»å¯¹ <code>Stream</code> è¿›è¡Œäº†è¯¦ç»†çš„ä»‹ç»ï¼Œæ²¡çœ‹è¿‡çš„åŒå­¦å¯ä»¥çœ‹ä¸‹è¿™ç¯‡ï¼š</p><p><a href="https://www.codingme.net/2019/11/jdk/jdk8-stream/">è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼Ÿè¶…å¼ºçš„ Stream æµæ“ä½œå§¿åŠ¿è¿˜ä¸å­¦ä¹ ä¸€ä¸‹</a> </p><p>å½“ç„¶ï¼Œå­¦ä¹  <code>Stream</code> ä¹‹å‰è¦å…ˆå­¦ä¹  <code>Lambda</code> ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰çœ‹è¿‡ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹ä¹‹å‰è¿™ç¯‡ï¼š</p><p><a href="https://www.codingme.net/2019/11/jdk/jdk8-lambda/">è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹</a></p><p>åœ¨ <code>Java 9</code> ä¸­ï¼Œåˆå¯¹ <code>Stream</code> è¿›è¡Œäº†å¢å¼ºï¼Œä¸»è¦å¢åŠ äº† 4 ä¸ªæ–°çš„æ“ä½œæ–¹æ³•ï¼š<em>dropWhileï¼ŒtakeWhileï¼ŒofNullableï¼Œiterate</em>ã€‚</p><p>ä¸‹é¢å¯¹è¿™å‡ ä¸ªæ–¹æ³•åˆ†åˆ«åšä¸ªä»‹ç»ã€‚</p><ol><li><p>takeWhile: ä»å¤´å¼€å§‹ç­›é€‰ï¼Œé‡åˆ°ä¸æ»¡è¶³çš„å°±ç»“æŸäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// takeWhile ,ä»å¤´å¼€å§‹ç­›é€‰ï¼Œé‡åˆ°ä¸æ»¡è¶³çš„å°±ç»“æŸäº†</span></span><br><span class="line">List&lt;Integer&gt; list1 = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">List&lt;Integer&gt; listResult = list1.stream().takeWhile(x -&gt; x &lt; <span class="number">3</span>).collect(Collectors.toList());</span><br><span class="line">System.out.println(listResult);</span><br><span class="line"><span class="comment">// takeWhile ,ä»å¤´å¼€å§‹ç­›é€‰ï¼Œé‡åˆ°ä¸æ»¡è¶³çš„å°±ç»“æŸ</span></span><br><span class="line">List&lt;Integer&gt; list2 = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">List&lt;Integer&gt; listResult2 = list2.stream().takeWhile(x -&gt; x &lt; <span class="number">3</span>).collect(Collectors.toList());</span><br><span class="line">System.out.println(listResult2);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1, 2]</span><br><span class="line">[1, 2]</span><br></pre></td></tr></table></figure></li><li><p>dropWhile: ä»å¤´å¼€å§‹åˆ é™¤ï¼Œé‡åˆ°ä¸æ»¡è¶³çš„å°±ç»“æŸäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dropWhile ,ä»å¤´å¼€å§‹åˆ é™¤ï¼Œé‡åˆ°ä¸æ»¡è¶³çš„å°±ç»“æŸäº†</span></span><br><span class="line">List&lt;Integer&gt; list1 = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">List&lt;Integer&gt; listResult = list1.stream().dropWhile(x -&gt; x &lt; <span class="number">3</span>).collect(Collectors.toList());</span><br><span class="line">System.out.println(listResult);</span><br><span class="line"><span class="comment">// dropWhile ,ä»å¤´å¼€å§‹åˆ é™¤ï¼Œé‡åˆ°ä¸æ»¡è¶³çš„å°±ç»“æŸ</span></span><br><span class="line">List&lt;Integer&gt; list2 = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">List&lt;Integer&gt; listResult2 = list2.stream().dropWhile(x -&gt; x &lt; <span class="number">3</span>).collect(Collectors.toList());</span><br><span class="line">System.out.println(listResult2);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[3, 4, 5]</span><br><span class="line">[3, 4, 3, 0]</span><br></pre></td></tr></table></figure></li><li><p>ofNullable: åˆ›å»ºæ”¯æŒå…¨ null çš„ Stream.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; stream = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="keyword">null</span>);</span><br><span class="line">stream.forEach(System.out::print);</span><br><span class="line">System.out.println();</span><br><span class="line"><span class="comment">// ç©ºæŒ‡é’ˆå¼‚å¸¸</span></span><br><span class="line"><span class="comment">// stream = Stream.of(null);</span></span><br><span class="line">stream = Stream.ofNullable(<span class="keyword">null</span>);</span><br><span class="line">stream.forEach(System.out::print);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12null</span><br></pre></td></tr></table></figure></li><li><p>iterate: å¯ä»¥é‡è½½è¿­ä»£å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IntStream.iterate(<span class="number">0</span>, x -&gt; x &lt; <span class="number">10</span>, x -&gt; x + <span class="number">1</span>).forEach(System.out::print);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0123456789</span><br></pre></td></tr></table></figure></li></ol><p>åœ¨ <code>Stream</code> å¢å¼ºä¹‹å¤–ï¼Œè¿˜å¢å¼ºäº† <code>Optional</code> ï¼Œ<code>Optional</code> å¢åŠ äº†å¯ä»¥è½¬æ¢æˆ <code>Stream</code> çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s = Optional.of(<span class="number">1</span>).stream();</span><br><span class="line">s.forEach(System.out::print);</span><br></pre></td></tr></table></figure><h2 id="4-æ¥å£ç§æœ‰æ–¹æ³•"><a href="#4-æ¥å£ç§æœ‰æ–¹æ³•" class="headerlink" title="4. æ¥å£ç§æœ‰æ–¹æ³•"></a>4. æ¥å£ç§æœ‰æ–¹æ³•</h2><p>åœ¨ <code>Java 8</code> ä¸­å¢åŠ äº†é»˜è®¤æ–¹æ³•ï¼Œåœ¨ <code>Java 9</code> ä¸­åˆå¢åŠ äº†ç§æœ‰æ–¹æ³•ï¼Œè¿™æ—¶å¼€å§‹æ¥å£ä¸­ä¸ä»…ä»…æœ‰äº†å®šä¹‰ï¼Œè¿˜å…·æœ‰äº†è¡Œä¸ºã€‚æˆ‘æƒ³è¿™æ˜¯å‡ºäºä»£ç æ„é€ ä¸Šçš„è€ƒè™‘ï¼Œå¦‚æœæ²¡æœ‰ç§æœ‰æ–¹æ³•ï¼Œé‚£ä¹ˆå½“å¤šä¸ªé»˜è®¤æ–¹æ³•çš„è¡Œä¸ºä¸€æ ·æ—¶ï¼Œå°±è¦å†™å¤šä¸ªç›¸åŒçš„ä»£ç ã€‚è€Œæœ‰äº†ç§æœ‰æ–¹æ³•ï¼Œäº‹æƒ…å°±å˜å¾—ä¸ä¸€æ ·äº†ã€‚</p><p>å°±åƒä¸‹é¢çš„ä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> è¾¾è¥¿ - å…¬ä¼—å·ï¼šæœªè¯»ä»£ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Jdk9Interface</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ChinaPeople chinaPeople = <span class="keyword">new</span> ChinaPeople();</span><br><span class="line">        chinaPeople.sleep();</span><br><span class="line">        chinaPeople.eat();</span><br><span class="line">        chinaPeople.doXxx();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChinaPeople</span> <span class="keyword">implements</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"èººç€ç¡"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        drink();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">doXxx</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        drink();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drink</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å–æ°´"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾‹å­ä¸­çš„æ¥å£ <code>people</code> ä¸­çš„ <code>eat()</code> å’Œ <code>doXxx()</code> é»˜è®¤è¡Œä¸ºä¸€è‡´ï¼Œä½¿ç”¨ç§æœ‰æ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„æŠ½å–ä¸€ä¸ªæ–¹æ³•å‡ºæ¥ã€‚</p><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">èººç€ç¡</span><br><span class="line">å–æ°´</span><br><span class="line">å–æ°´</span><br></pre></td></tr></table></figure><h2 id="5-HTTP-2-Client"><a href="#5-HTTP-2-Client" class="headerlink" title="5. HTTP / 2 Client"></a>5. HTTP / 2 Client</h2><p><code>Java 9</code> å†…ç½®äº†æ–°çš„ HTTP/2 å®¢æˆ·ç«¯ï¼Œè¯·æ±‚æ›´åŠ æ–¹ä¾¿ã€‚</p><p>éšä¾¿è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ç½‘é¡µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HttpClient client = HttpClient.newHttpClient();</span><br><span class="line">URI uri = URI.create(<span class="string">"http://www.tianqiapi.com/api/xxx"</span>);</span><br><span class="line">HttpRequest req = HttpRequest.newBuilder(uri).header(<span class="string">"User-Agent"</span>, <span class="string">"Java"</span>).GET().build();</span><br><span class="line">HttpResponse&lt;String&gt; resp = client.send(req, HttpResponse.BodyHandler.asString());</span><br><span class="line">String body = resp.body();</span><br><span class="line">System.out.println(body);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¾—åˆ°çš„ç»“æœï¼Œè¿™é‡Œæ˜¯è¿™ä¸ªç½‘ç«™çš„æŠ¥é”™ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">There is no method xxxAction in ApiController</span><br></pre></td></tr></table></figure><p>å¯èƒ½ä½ è¿è¡Œçš„æ—¶å€™ä¼šæŠ¥æ‰¾ä¸åˆ° <code>httpClient</code> æ¨¡å—ä¹‹ç±»çš„é—®é¢˜ï¼Œè¿™æ—¶å€™éœ€è¦ä½ åœ¨ä½ é¡¹ç›®ä»£ç ç›®å½•æ·»åŠ  <code>httpClient æ¨¡å—</code> æ‰èƒ½è§£å†³ï¼Œæ·»åŠ æ–¹å¼çœ‹ä¸‹é¢çš„å›¾ã€‚</p><p><img src="/assets/jdk-new-feature/image-20200217225456437.png" alt="Java 9 å¯¼å…¥å¯¼å‡ºæ¨¡å—"></p><p><code>export</code> å†™è‡ªå·±çš„åŒ…è·¯å¾„ï¼Œ<code>requires</code> å†™å¼•å…¥çš„æ¨¡å—åã€‚</p><h2 id="6-Java-REPL-JShell"><a href="#6-Java-REPL-JShell" class="headerlink" title="6. Java REPL - JShell"></a>6. Java REPL - JShell</h2><p>äº¤äº’å¼çš„ç¼–ç¨‹ç¯å¢ƒåœ¨å…¶ä»–è¯­è¨€å¦‚ Python ä¸Šæ—©å°±æœ‰äº†ï¼Œè€Œ Java ä¸Šçš„äº¤äº’å¼è¯­è¨€åªåˆ° <code>Java 9</code>æ‰å‡ºç°ã€‚äº¤äº’å¼çš„ç¼–ç¨‹å¯ä»¥è®©å¼€å‘è€…åœ¨è¾“å…¥ä»£ç çš„æ—¶å€™å°±è·å–åˆ°ç¨‹åºçš„è¿è¡Œç»“æœï¼Œè€Œä¸ç”¨åƒä¹‹å‰ä¸€æ ·æ–°å»ºæ–‡ä»¶ã€åˆ›å»ºç±»ã€å¯¼åŒ…ã€æµ‹è¯•ä¸€ç³»åˆ—æµç¨‹ã€‚</p><p><code>JShell</code> ä¸­æ”¯æŒ <code>tab</code> è¡¥å…¨ä»£ç ä»¥åŠè‡ªåŠ¨æ·»åŠ åˆ†å·ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¼”ç¤º <code>JShell</code> çš„ä½¿ç”¨ã€‚</p><ol><li><p>è¿›å…¥ JShell. æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">C:\Users&gt;jshell</span><br><span class="line">|  æ¬¢è¿ä½¿ç”¨ JShell -- ç‰ˆæœ¬ 9</span><br><span class="line">|  è¦å¤§è‡´äº†è§£è¯¥ç‰ˆæœ¬, è¯·é”®å…¥: /help intro</span><br><span class="line"><span class="meta">jshell&gt;</span> /help</span><br><span class="line">|  é”®å…¥ Java è¯­è¨€è¡¨è¾¾å¼, è¯­å¥æˆ–å£°æ˜ã€‚</span><br><span class="line">|  æˆ–è€…é”®å…¥ä»¥ä¸‹å‘½ä»¤ä¹‹ä¸€:</span><br><span class="line">|  /list [&lt;åç§°æˆ– id&gt;|-all|-start]</span><br><span class="line">|       åˆ—å‡ºæ‚¨é”®å…¥çš„æº</span><br><span class="line">|  /edit &lt;åç§°æˆ– id&gt;</span><br><span class="line">|       ç¼–è¾‘æŒ‰åç§°æˆ– id å¼•ç”¨çš„æºæ¡ç›®</span><br><span class="line">|  /drop &lt;åç§°æˆ– id&gt;</span><br><span class="line">|       åˆ é™¤æŒ‰åç§°æˆ– id å¼•ç”¨çš„æºæ¡ç›®</span><br><span class="line">|  /save [-all|-history|-start] &lt;æ–‡ä»¶&gt;</span><br><span class="line">|       å°†ç‰‡æ®µæºä¿å­˜åˆ°æ–‡ä»¶ã€‚</span><br><span class="line">|  /open &lt;file&gt;</span><br><span class="line">|       æ‰“å¼€æ–‡ä»¶ä½œä¸ºæºè¾“å…¥</span><br><span class="line">|  /vars [&lt;åç§°æˆ– id&gt;|-all|-start]</span><br><span class="line">|       åˆ—å‡ºå·²å£°æ˜å˜é‡åŠå…¶å€¼</span><br><span class="line">|  /methods [&lt;åç§°æˆ– id&gt;|-all|-start]</span><br><span class="line">|       åˆ—å‡ºå·²å£°æ˜æ–¹æ³•åŠå…¶ç­¾å</span><br><span class="line">|  /types [&lt;åç§°æˆ– id&gt;|-all|-start]</span><br><span class="line">|       åˆ—å‡ºå·²å£°æ˜çš„ç±»å‹</span><br><span class="line">|  /imports</span><br><span class="line">|       åˆ—å‡ºå¯¼å…¥çš„é¡¹</span><br><span class="line">|  /exit</span><br><span class="line">|       é€€å‡º jshell</span><br><span class="line">|  /env [-class-path &lt;è·¯å¾„&gt;] [-module-path &lt;è·¯å¾„&gt;] [-add-modules &lt;æ¨¡å—&gt;] ...</span><br><span class="line">|       æŸ¥çœ‹æˆ–æ›´æ”¹è¯„ä¼°ä¸Šä¸‹æ–‡</span><br><span class="line">|  /reset [-class-path &lt;è·¯å¾„&gt;] [-module-path &lt;è·¯å¾„&gt;] [-add-modules &lt;æ¨¡å—&gt;]...</span><br><span class="line">|       é‡å¯ jshell</span><br><span class="line">|  /reload [-restore] [-quiet] [-class-path &lt;è·¯å¾„&gt;] [-module-path &lt;è·¯å¾„&gt;]...</span><br><span class="line">|       é‡ç½®å’Œé‡æ”¾ç›¸å…³å†å²è®°å½• -- å½“å‰å†å²è®°å½•æˆ–ä¸Šä¸€ä¸ªå†å²è®°å½• (-restore)</span><br><span class="line">|  /history</span><br><span class="line">|       æ‚¨é”®å…¥çš„å†…å®¹çš„å†å²è®°å½•</span><br><span class="line">|  /help [&lt;command&gt;|&lt;subject&gt;]</span><br><span class="line">|       è·å– jshell çš„ç›¸å…³ä¿¡æ¯</span><br><span class="line">|  /set editor|start|feedback|mode|prompt|truncation|format ...</span><br><span class="line">|       è®¾ç½® jshell é…ç½®ä¿¡æ¯</span><br><span class="line">|  /? [&lt;command&gt;|&lt;subject&gt;]</span><br><span class="line">|       è·å– jshell çš„ç›¸å…³ä¿¡æ¯</span><br><span class="line">|  /!</span><br><span class="line">|       é‡æ–°è¿è¡Œä¸Šä¸€ä¸ªç‰‡æ®µ</span><br><span class="line">|  /&lt;id&gt;</span><br><span class="line">|       æŒ‰ id é‡æ–°è¿è¡Œç‰‡æ®µ</span><br><span class="line">|  /-&lt;n&gt;</span><br><span class="line">|       é‡æ–°è¿è¡Œå‰é¢çš„ç¬¬ n ä¸ªç‰‡æ®µ</span><br><span class="line">|</span><br><span class="line">|  æœ‰å…³è¯¦ç»†ä¿¡æ¯, è¯·é”®å…¥ '/help', åè·Ÿ</span><br><span class="line">|  å‘½ä»¤æˆ–ä¸»é¢˜çš„åç§°ã€‚</span><br><span class="line">|  ä¾‹å¦‚ '/help /list' æˆ– '/help intro'ã€‚ä¸»é¢˜:</span><br><span class="line">|</span><br><span class="line">|  intro</span><br><span class="line">|       jshell å·¥å…·çš„ç®€ä»‹</span><br><span class="line">|  shortcuts</span><br><span class="line">|       ç‰‡æ®µå’Œå‘½ä»¤è¾“å…¥æç¤º, ä¿¡æ¯è®¿é—®ä»¥åŠ</span><br><span class="line">|       è‡ªåŠ¨ä»£ç ç”Ÿæˆçš„æŒ‰é”®è¯´æ˜</span><br><span class="line">|  context</span><br><span class="line">|       /env /reload å’Œ /reset çš„è¯„ä¼°ä¸Šä¸‹æ–‡é€‰é¡¹</span><br><span class="line"></span><br><span class="line"><span class="meta">jshell&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å®šä¹‰ä¸€ä¸ªå˜é‡ï¼ša = 10ï¼Œéå†ä» 0 åˆ° a çš„æ•°å­—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; <span class="keyword">int</span> a =<span class="number">10</span>;</span><br><span class="line">a ==&gt; <span class="number">10</span></span><br><span class="line">jshell&gt; <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;a;i++)&#123;System.out.println(i);&#125;</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure></li><li><p>å®šä¹‰ä¸€ä¸ªé›†åˆï¼Œèµ‹å€¼1,2,3,4,5ã€‚ç„¶åè¾“å‡ºé›†åˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; List list = List.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">list ==&gt; [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">jshell&gt; list</span><br><span class="line">list ==&gt; [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹è¾“å…¥è¿‡çš„ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; /list</span><br><span class="line">   <span class="number">1</span> : <span class="keyword">int</span> a =<span class="number">10</span>;</span><br><span class="line">   <span class="number">2</span> : <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;a;i++)&#123;System.out.println(i);&#125;</span><br><span class="line">   <span class="number">3</span> : List list = List.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">   <span class="number">4</span> : list</span><br></pre></td></tr></table></figure></li><li><p>åˆ—å‡ºå¯¼å…¥çš„åŒ…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; /imports</span><br><span class="line">|    <span class="keyword">import</span> java.io.*</span><br><span class="line">|    <span class="keyword">import</span> java.math.*</span><br><span class="line">|    <span class="keyword">import</span> java.net.*</span><br><span class="line">|    <span class="keyword">import</span> java.nio.file.*</span><br><span class="line">|    <span class="keyword">import</span> java.util.*</span><br><span class="line">|    <span class="keyword">import</span> java.util.concurrent.*</span><br><span class="line">|    <span class="keyword">import</span> java.util.function.*</span><br><span class="line">|    <span class="keyword">import</span> java.util.prefs.*</span><br><span class="line">|    <span class="keyword">import</span> java.util.regex.*</span><br><span class="line">|    <span class="keyword">import</span> java.util.stream.*</span><br></pre></td></tr></table></figure></li><li><p>å°†ä»£ç ä¿å­˜åˆ°æ–‡ä»¶å¹¶é€€å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; /save d:/JShell.java</span><br><span class="line">jshell&gt; /exit</span><br><span class="line">  å†è§</span><br></pre></td></tr></table></figure><p>åœ¨ D ç›˜çœ‹åˆ°çš„ä¿å­˜çš„ä»£ç ç‰‡æ®µã€‚</p><p><img src="/assets/jdk-new-feature/image-20200217232617028.png" alt="JShell ä¿å­˜çš„ä»£ç "></p></li></ol><p>æ“ä½œèµ·æ¥è¿˜æ˜¯æŒºç®€å•çš„ï¼Œè¿˜è®°å¾—ä¸Šé¢ä»‹ç»é›†åˆå·¥å‚ <code>of</code> æ–¹æ³•åˆ›å»ºå‡ºæ¥çš„ <code>set</code> å’Œ <code>map</code> æ•°æ®åœ¨æ¯ä¸ª <code>JVM</code> å‘¨æœŸé‡Œæ˜¯æ— åºçš„å˜›ï¼Ÿä¹Ÿå¯ä»¥ç”¨ <code>JShell</code> å®éªŒä¸‹ã€‚</p><p><img src="/assets/jdk-new-feature/image-20200218113246293.png" alt="Set.of çš„éšæœºéå†"></p><h2 id="7-å…¶ä»–æ›´æ–°"><a href="#7-å…¶ä»–æ›´æ–°" class="headerlink" title="7. å…¶ä»–æ›´æ–°"></a>7. å…¶ä»–æ›´æ–°</h2><p><code>Java 9</code> ä¸­å¢åŠ æˆ–è€…ä¼˜åŒ–çš„åŠŸèƒ½è¿œä¸æ­¢è¿™äº›ï¼Œä¸Šé¢åªæ˜¯åˆ—ä¸¾äº†å¸¸ç”¨çš„ä¸€äº›æ–°ç‰¹æ€§ï¼Œæ›´å¤šçš„æ–°ç‰¹æ€§å¦‚ï¼š</p><ul><li>ä¸èƒ½ä½¿ç”¨ä¸‹åˆ’çº¿ _ ä½œä¸ºå˜é‡åï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…³é”®å­—ã€‚</li><li>Javadoc æ”¯æŒ HTML5 å¹¶ä¸”æ”¯æŒæœç´¢åŠŸèƒ½ã€‚</li><li>Nashorn å¼•æ“å‡çº§ï¼Œæ›´å¥½çš„æ”¯æŒ Javascript.</li><li>String å­˜å‚¨ç»“æ„å˜æ›´ä» char -&gt; byte.</li><li>â€¦â€¦â€¦</li></ul><p>æ–°ç‰¹æ€§å¾ˆå¤šï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±äº†è§£ä¸‹ã€‚</p><p><strong>å†æ¬¡é¢„å‘Š</strong>ï¼Œåç»­æ–‡ç« ä¼šç»“åˆæ¡ˆä¾‹å›¾æ–‡å¹¶èŒ‚è¯¦ç»†ä»‹ç» <strong>Java 9 å¼€å§‹çš„æ¨¡å—ç³»ç»Ÿ</strong>ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å…³æ³¨æˆ‘ã€‚æ­¤å»å±±é«˜æ°´è¿œï¼Œæ„¿ä½ æˆ‘ä¸€è·¯åŒè¡Œã€‚</p><p>æ–‡ç« æ¡ˆä¾‹éƒ½å·²ç»ä¸Šä¼ åˆ° Githubï¼š<a href="https://github.com/niumoo/jdk-feature" target="_blank" rel="noopener">niumoo/jdk-feature</a></p><p><strong>å‚è€ƒèµ„æ–™</strong></p><ul><li><a href="https://docs.oracle.com/javase/9/whatsnew/toc.htm" target="_blank" rel="noopener">Java Platform, Standard Edition Whatâ€™s New in Oracle JDK 9</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/assets/jdk-new-feature/140916143852191.png&quot; alt=&quot;Java 9&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Java 9&lt;/code&gt; ä¸­æœ€å¤§çš„äº®ç‚¹æ˜¯ &lt;strong&gt;Java å¹³å°æ¨¡å—åŒ–&lt;/strong&gt;çš„å¼•å…¥ï¼Œä»¥åŠæ¨¡å—åŒ– JDKã€‚ä½†æ˜¯ &lt;code&gt;Java 9&lt;/code&gt; è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–°åŠŸèƒ½ï¼Œè¿™ç¯‡æ–‡å­—ä¼šå°†é‡ç‚¹ä»‹ç»å¼€å‘äººå‘˜ç‰¹åˆ«æ„Ÿå…´è¶£çš„å‡ ç§åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯ Java æ–°ç‰¹æ€§ç³»åˆ—æ–‡ç« ä¸­çš„ä¸€ç¯‡ï¼Œå¾€æœŸæ–‡ç« å¯ä»¥æŸ¥çœ‹ä¸‹é¢é“¾æ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.codingme.net/2019/11/jdk/jdk8-stream/&quot;&gt;è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼Ÿè¶…å¼ºçš„ Stream æµæ“ä½œå§¿åŠ¿è¿˜ä¸å­¦ä¹ ä¸€ä¸‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.codingme.net/2019/11/jdk/jdk8-lambda/&quot;&gt;è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.codingme.net/2019/11/jdk/jdk8-optional/&quot;&gt;Jdk14 éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.codingme.net/2019/10/jdk/jdk8-time/&quot;&gt;Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk8 çš„æ—¶é—´å¤„ç†å§¿åŠ¿è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.codingme.net/2020/01/jdk/jdk7-start/&quot;&gt;è¿˜çœ‹ä¸æ‡‚åŒäº‹ä»£ç ï¼Ÿå¿«æ¥è¡¥ä¸€æ³¢ Java 7 è¯­æ³•ç‰¹æ€§&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Jdk æ–°ç‰¹æ€§" scheme="https://www.codingme.net/categories/Jdk-%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
    
      <category term="Java9" scheme="https://www.codingme.net/tags/Java9/"/>
    
  </entry>
  
  <entry>
    <title>è¿˜çœ‹ä¸æ‡‚åŒäº‹ä»£ç ï¼Ÿå¿«æ¥è¡¥ä¸€æ³¢ Java 7 è¯­æ³•ç‰¹æ€§</title>
    <link href="https://www.codingme.net/2020/01/jdk/jdk7-start/"/>
    <id>https://www.codingme.net/2020/01/jdk/jdk7-start/</id>
    <published>2020-01-08T00:01:01.000Z</published>
    <updated>2020-02-18T14:37:28.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Java å¹³å°è‡ªå‡ºç°åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·²ç» 20 å¤šä¸ªå¹´å¤´äº†ï¼Œè¿™ 20 å¤šå¹´é—´ Java ä¹Ÿä¸€ç›´ä½œä¸ºæœ€æµè¡Œçš„ç¨‹åºè®¾è®¡è¯­è¨€ä¹‹ä¸€ï¼Œä¸æ–­é¢ä¸´ç€å…¶ä»–æ–°å…´ç¼–ç¨‹è¯­è¨€çš„æŒ‘æˆ˜ä¸å†²å‡»ã€‚Java è¯­è¨€æ˜¯ä¸€ç§<strong>é™æ€å¼ºç±»å‹</strong>è¯­è¨€ï¼Œè¿™æ ·çš„è¯­è¨€ç‰¹æ€§å¯ä»¥è®© Java ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘é˜¶æ®µ</strong>å‘ç°é”™è¯¯ï¼Œè¿™å¯¹äºæ„å»ºå‡ºä¸€ä¸ª<strong>ç¨³å®šå®‰å…¨ä¸”å¥å£®</strong>çš„åº”ç”¨æ¥è¯´ï¼Œå°¤ä¸ºé‡è¦ã€‚ä½†æ˜¯ä¹Ÿå› ä¸ºè¿™ç§ç‰¹æ€§ï¼Œè®© Java å¼€å‘ä¼¼ä¹å˜å¾—ç¼ºå°‘çµæ´»æ€§ï¼Œå¼€å‘æŸäº›åŠŸèƒ½çš„åº”ç”¨æ—¶ï¼Œä»£ç é‡å¯èƒ½æ˜¯å…¶ä»–è¯­è¨€çš„å‡ å€ã€‚Java å¼€å‘çš„ä¸è¶³ä¹‹å¤„ä¹Ÿä½“ç°è¶Šæ¥è¶Šå¤æ‚çš„ JDK ä¸Šï¼Œè¶Šæ¥è¶Šå¤æ‚çš„ JDK è®©å¼€å‘è€…å®Œå…¨ç†è§£çš„éš¾åº¦å˜çš„éå¸¸å¤§ã€‚ä»¥è‡³äºå¼€å‘è€…æœ‰æ—¶ä¼šé‡å¤å®ç°ä¸€ä¸ª JDK ä¸­å·²ç»æä¾›äº†çš„åŠŸèƒ½ã€‚<br><a id="more"></a><br>ä¸ºäº†è·Ÿä¸Šäº’è”ç½‘åº”ç”¨ç¼–ç¨‹å‘å±•çš„è„šæ­¥ï¼Œ Java ä» 9 ç‰ˆæœ¬å¼€å§‹è°ƒæ•´äº† JDK å‘å¸ƒçš„èŠ‚å¥ï¼ŒJDK çš„æ¯æ¬¡æ›´æ–°éƒ½æ³¨é‡<strong>æé«˜ç”Ÿäº§æ•ˆç‡</strong>ï¼Œæé«˜ <strong>JVM æ€§èƒ½</strong>ï¼Œæ¨è¡Œ<strong>æ¨¡å—åŒ–</strong>ç­‰ï¼Œè®©å¼€å‘è€…å¯ä»¥æ›´å¤šçš„ä¸“æ³¨äºä¸šåŠ¡æœ¬èº«ï¼Œè€Œä¸æ˜¯æµªè´¹è¿‡å¤šçš„æ—¶é—´åœ¨è¯­è¨€ç‰¹æ€§ä¸Šã€‚ Java è¯­è¨€çš„æ›´æ–°è¦åœ¨è¯­è¨€çš„ä¸¥è°¨æ€§å’Œçµæ´»æ€§ä¸Šæ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼Œæ¯•ç«Ÿçµæ´»æ€§å¯ä»¥å‡å°‘ç¼–ç çš„å¤æ‚åº¦ï¼Œè€Œä¸¥è°¨æ€§æ˜¯æ„å»ºå¤æ‚ä¸”å¥å£®åº”ç”¨çš„åŸºçŸ³ã€‚</p><h1 id="Java-7-è¯­è¨€ç‰¹æ€§"><a href="#Java-7-è¯­è¨€ç‰¹æ€§" class="headerlink" title="Java 7 è¯­è¨€ç‰¹æ€§"></a>Java 7 è¯­è¨€ç‰¹æ€§</h1><p>Java é‡è¦çš„æ›´æ–°ç‰ˆæœ¬æ˜¯åœ¨ Java 5 ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬ä¸­å¢åŠ äº†å¦‚æ³›å‹ã€å¢å¼º forã€è‡ªåŠ¨è£…ç®±æ‹†ç®±ã€æšä¸¾ç±»å‹ï¼Œå¯å˜å‚æ•°ã€æ³¨è§£ç­‰ä¸€ç³»åˆ—<strong>é‡è¦åŠŸèƒ½</strong>ï¼Œä½†æ˜¯éšåçš„ Java 6 ä¸­å¹¶æ²¡æœ‰å¢åŠ æ–°çš„é‡è¦çš„è¯­è¨€ç‰¹æ€§ã€‚Java 5 çš„å‘å¸ƒæ˜¯åœ¨ 2004 å¹´ï¼Œå·²ç»å¾ˆä¹…è¿œäº†ï¼Œç½‘ä¸Šå…³äº Java çš„æ•™ç¨‹ä¹Ÿå¤§å¤šæ˜¯åŸºäº Java 6 çš„ï¼Œä¹Ÿå› æ­¤æˆ‘å‡†å¤‡ä» Java 7 å¼€å§‹ä»‹ç»æ¯ä¸ª Java ç‰ˆæœ¬çš„æ–°ç‰¹æ€§ã€‚</p><p>ä¸‹é¢æ‰€æœ‰ä»£ç çš„è¿è¡Œæ¼”ç¤ºéƒ½æ˜¯åŸºäº <strong>Java 7 </strong> ï¼Œæ‰€ä»¥ä½ å¦‚æœå°è¯•ä¸‹é¢çš„ä»£ç ï¼Œéœ€è¦<strong>å®‰è£…å¹¶é…ç½®</strong>  Jdk 1.7 æˆ–è€…å·²ä¸Šç‰ˆæœ¬ã€‚</p><h1 id="1-switch-String"><a href="#1-switch-String" class="headerlink" title="1. switch String"></a>1. switch String</h1><p>åœ¨ Java 7 ä¹‹å‰ï¼Œswitch è¯­æ³•ä¸­åªæ”¯æŒæ•´æ•°ç±»å‹ä»¥åŠè¿™äº›æ•´æ•°ç±»å‹çš„å°è£…ç±»è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨ Java 7 ä¸­ï¼Œæ”¯æŒäº† string å­—ç¬¦ä¸²ç±»å‹çš„åˆ¤æ–­ï¼Œä½¿ç”¨èµ·æ¥éå¸¸çš„ç®€å•ï¼Œä½†æ˜¯å®ç”¨æ€§æ˜¯å¾ˆé«˜çš„ã€‚</p><h2 id="1-1-switch-String-åŸºæœ¬ç”¨æ³•"><a href="#1-1-switch-String-åŸºæœ¬ç”¨æ³•" class="headerlink" title="1.1. switch String åŸºæœ¬ç”¨æ³•"></a>1.1. switch String åŸºæœ¬ç”¨æ³•</h2><p>ç¼–å†™ä¸€ä¸ªç®€å•çš„ switch åˆ¤æ–­å­—ç¬¦ä¸²çš„æµ‹è¯•ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwitchWithString</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String gender = <span class="string">"ç”·"</span>;</span><br><span class="line">        System.out.println(gender.hashCode());</span><br><span class="line">        <span class="keyword">switch</span> (gender) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"ç”·"</span>:</span><br><span class="line">                System.out.println(<span class="string">"å…ˆç”Ÿä½ å¥½"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥³"</span>:</span><br><span class="line">                System.out.println(<span class="string">"å¥³å£«ä½ å¥½"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                System.out.println(<span class="string">"ä½ å¥½"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>switch åˆ¤æ–­å­—ç¬¦ä¸²ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œç»“æœä¹Ÿæ˜¾è€Œæ˜“è§ä¼šå…ˆè¾“å‡º gender å˜é‡çš„ hashCodeï¼Œç„¶åè¾“å‡ºåŒ¹é…ç»“æœâ€œå…ˆç”Ÿä½ å¥½â€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">30007</span></span><br><span class="line">å…ˆç”Ÿä½ å¥½</span><br></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨ switch string æ—¶å€™ï¼Œå¦‚æœç»“åˆ Java 5 çš„<strong>æšä¸¾ç±»</strong>ï¼Œé‚£ä¹ˆæ•ˆæœä¼šæ›´å¥½ï¼ŒJava 7 ä¹‹å‰ä½¿ç”¨ switch ç»“åˆæšä¸¾ç±»è¦ä¸ºæ¯ä¸ªæšä¸¾å€¼ç¼–æ•°å­—ä»£å·ï¼ŒJava 7 ä¹‹åå¯ä»¥æšä¸¾è¿›è¡Œ switchã€‚</p><h2 id="1-2-switch-String-å®ç°åŸç†"><a href="#1-2-switch-String-å®ç°åŸç†" class="headerlink" title="1.2. switch String å®ç°åŸç†"></a>1.2. switch String å®ç°åŸç†</h2><p>ä½†æ˜¯è¿™ä¸ªæ”¯æŒ<strong>åªæ˜¯ç¼–è¯‘å™¨å±‚é¢çš„æ”¯æŒ</strong>ï¼Œ Java è™šæ‹Ÿæœºä¾æ—§æ˜¯ä¸æ”¯æŒçš„ã€‚åœ¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œ switch æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠŠå­—ç¬¦ä¸²<strong>è½¬æ¢æˆæ•´æ•°</strong>ç±»å‹å†è¿›è¡Œåˆ¤æ–­ã€‚ä¸ºäº†éªŒè¯ä¸Šé¢è¯´çš„åªæ˜¯ç¼–è¯‘å™¨å±‚é¢çš„æ”¯æŒï¼Œæˆ‘ä»¬åç¼–è¯‘ï¼ˆå¯ä»¥ä½¿ç”¨ Jad åç¼–è¯‘å·¥å…·ï¼Œä¹Ÿå¯ä»¥åœ¨ Idea ä¸­åŒå‡»ç¼–è¯‘ç”Ÿæˆçš„ class ï¼‰ç”Ÿæˆçš„ class æ–‡ä»¶ï¼Œçœ‹åˆ°ç¼–è¯‘å™¨æŠŠ switch string è½¬æ¢æˆäº†å­—ç¬¦ä¸² hashCode åˆ¤æ–­ï¼Œä¸ºäº†é˜²æ­¢ hashCode å†²çªï¼Œåˆä½¿ç”¨äº† equals å†æ¬¡åˆ¤æ–­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwitchWithString</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SwitchWithString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String gender = <span class="string">"ç”·"</span>;</span><br><span class="line">        System.out.println(gender.hashCode());</span><br><span class="line">        <span class="keyword">byte</span> var3 = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">switch</span>(gender.hashCode()) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">22899</span>:</span><br><span class="line">            <span class="keyword">if</span> (gender.equals(<span class="string">"å¥³"</span>)) &#123;</span><br><span class="line">                var3 = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">30007</span>:</span><br><span class="line">            <span class="keyword">if</span> (gender.equals(<span class="string">"ç”·"</span>)) &#123;</span><br><span class="line">                var3 = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span>(var3) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            System.out.println(<span class="string">"å…ˆç”Ÿä½ å¥½"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            System.out.println(<span class="string">"å¥³å£«ä½ å¥½"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            System.out.println(<span class="string">"ä½ å¥½"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-try-with-resource"><a href="#2-try-with-resource" class="headerlink" title="2. try-with-resource"></a>2. try-with-resource</h1><p>Java ä¸åŒäº C++ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±ç®¡ç†æ¯ä¸€å—å†…å­˜ï¼Œå¤§å¤šæ—¶å€™ Java è™šæ‹Ÿæœºéƒ½å¯ä»¥å¾ˆå¥½çš„å¸®æˆ‘ä»¬è¿›è¡Œèµ„æºç®¡ç†ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ—¶å€™éœ€è¦æ‰‹åŠ¨é‡Šæ”¾ä¸€äº›èµ„æºï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥ã€ç£ç›˜æ–‡ä»¶è¿æ¥ã€ç½‘ç»œè¿æ¥ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦æ˜¯èµ„æºæ•°é‡æœ‰é™çš„ï¼Œéƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨çš„è¿›è¡Œé‡Šæ”¾ã€‚</p><h2 id="2-1-try-catch-finally"><a href="#2-1-try-catch-finally" class="headerlink" title="2.1. try-catch-finally"></a>2.1. try-catch-finally</h2><p>åœ¨æ“ä½œæœ‰é™èµ„æºçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°å„ç§å¼‚å¸¸ï¼Œä¸ç®¡æ˜¯è¯»å–é˜¶æ®µè¿˜æ˜¯åœ¨æœ€åå…³é—­èµ„æºçš„è¿‡ç¨‹ä¸­ï¼Œéƒ½æœ‰å¯èƒ½å‡ºç°é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ <code>try-catch-finally</code> ä¿è¯èµ„æºçš„é‡Šæ”¾ã€‚</p><p>åƒä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é‡Šæ”¾èµ„æº</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TryCatachFinally</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        FileInputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"jdk-feature-7.iml"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (inputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    inputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> e;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹è¿™æ¶å¿ƒçš„ä»£ç ç»“æ„ï¼Œä¸ºäº†æ•è·å¼‚å¸¸ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ª <code>catch</code>ï¼Œä¸ºäº†èƒ½ä¿è¯é‡Šæ”¾èµ„æºï¼Œæˆ‘ä»¬åˆå†™äº† <code>finally</code> è¿›è¡Œèµ„æºé‡Šæ”¾ï¼Œåœ¨èµ„æºé‡Šæ”¾æ—¶ä¸ºäº†æ•æ‰ <code>close</code> æ—¶æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæˆ‘ä»¬åˆå†™äº†ä¸€ä¸ª <code>try-catch</code>ã€‚æœ€åçœ‹ç€è¿™å¤æ‚çš„ä»£ç ï¼Œå¦‚æœæœ‰äººå‘Šè¯‰ä½ è¿™æ®µä»£ç æœ‰ <code>bug</code>ï¼Œé‚£ä½ ä¸€å®šä¸ä¼šç›¸ä¿¡ã€‚ä½†æ˜¯ç¡®å®æ˜¯è¿™æ ·ï¼Œçœ‹èµ·æ¥ä¸¥å¯†çš„ä»£ç é€»è¾‘ï¼Œå½“ <code>try</code> ä¸­çš„ä»£ç é€»è¾‘å’Œ <code>close</code> æ–¹æ³•åŒæ—¶äº§ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œ<code>try</code> ä¸­çš„å¼‚å¸¸ä¿¡æ¯ä¼šä¸¢å¤±ã€‚</p><p>å¯ä»¥çœ‹è¿™é‡Œä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.feature.jdk7;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é‡Šæ”¾èµ„æº</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TryCatachFinallyThrow</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        read();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        FileRead fileRead = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileRead = <span class="keyword">new</span> FileRead();</span><br><span class="line">            fileRead.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (fileRead != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileRead.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> e;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileRead</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IOException(<span class="string">"è¯»å–å¼‚å¸¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"èµ„æºå…³é—­"</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IOException(<span class="string">"å…³é—­å¼‚å¸¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ä»£ç é‡Œ <code>read</code> å’Œ <code>close</code> æ–¹æ³•éƒ½ä¼šäº§ç”Ÿå¼‚å¸¸ï¼Œä½†æ˜¯è¿è¡Œç¨‹åºå‘ç°åªèƒ½æ”¶åˆ° <code>close</code> çš„å¼‚å¸¸ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">èµ„æºå…³é—­</span><br><span class="line">Exception in thread &quot;main&quot; java.io.IOException: å…³é—­å¼‚å¸¸</span><br><span class="line">at net.codingme.feature.jdk7.FileRead.close(TryCatachFinallyThrow.java:51)</span><br><span class="line">at net.codingme.feature.jdk7.TryCatachFinallyThrow.read(TryCatachFinallyThrow.java:33)</span><br><span class="line">at net.codingme.feature.jdk7.TryCatachFinallyThrow.main(TryCatachFinallyThrow.java:20)</span><br></pre></td></tr></table></figure><p><strong>å¼‚å¸¸ä¿¡æ¯ä¸¢å¤±</strong>äº†ï¼Œå¯æ€•çš„æ˜¯ä½ ä»¥ä¸ºåªæ˜¯ <code>close</code> æ—¶å‘ç”Ÿäº†å¼‚å¸¸è€Œå·²ã€‚</p><h2 id="2-2-try-autocloseable"><a href="#2-2-try-autocloseable" class="headerlink" title="2.2. try-autocloseable"></a>2.2. try-autocloseable</h2><p>ä¸Šé¢çš„é—®é¢˜åœ¨ Java 7 ä¸­å…¶å®å·²ç»æä¾›äº†æ–°çš„è§£å†³æ–¹å¼ï¼ŒJava 7 ä¸­å¯¹ <code>try</code> è¿›è¡Œäº†å¢å¼ºï¼Œå¯ä»¥ä¿è¯èµ„æº<strong>æ€»èƒ½è¢«æ­£ç¡®é‡Šæ”¾</strong> ã€‚ä½¿ç”¨å¢å¼º <code>try</code> çš„å‰ææ˜¯ <code>try</code> ä¸­çš„ç±»å®ç°äº† <code>AutoCloseable</code> æ¥å£ï¼Œåœ¨ Java 7 ä¸­å¤§é‡çš„éœ€è¦é‡Šæ”¾èµ„æºçš„æ“ä½œå…¶å®éƒ½å·²ç»å®ç°äº†æ­¤æ¥å£äº†ã€‚</p><p><img src="/assets/jdk7-start/image-20200107084113348.png" alt="AutoCloseable å®ç°ç±»"></p><p>å®ç°äº† <code>AutoCloseable</code> çš„ç±»ï¼Œåœ¨å¢å¼º <code>try</code>ä¸­ä½¿ç”¨æ—¶ï¼Œä¸ç”¨æ‹…å¿ƒèµ„æºçš„å…³é—­ï¼Œåœ¨ä½¿ç”¨å®Œæ¯•ä¼šè‡ªåŠ¨çš„è°ƒç”¨ <code>close</code>æ–¹æ³•ï¼Œå¹¶ä¸”<strong>å¼‚å¸¸ä¸ä¼šä¸¢å¤±</strong>ã€‚</p><p>è®©æˆ‘ä»¬ç¼–å†™çš„æ¨¡æ‹Ÿèµ„æºæ“ä½œçš„ç±»å®ç° <code>AutoCloseable</code>  æ¥å£ï¼Œç„¶åæ—¶å€™å¢å¼º <code>try</code> çœ‹çœ‹æ•ˆæœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.feature.jdk7;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªåŠ¨å…³é—­</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoCloseResource</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (Mysql mysql = <span class="keyword">new</span> Mysql();</span><br><span class="line">             OracleDatabase oracleDatabase = <span class="keyword">new</span> OracleDatabase()) &#123;</span><br><span class="line">            mysql.conn();</span><br><span class="line">            oracleDatabase.conn();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mysql</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"mysql å·²å…³é—­"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">conn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"mysql å·²è¿æ¥"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OracleDatabase</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"OracleDatabase å·²å…³é—­"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">conn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"OracleDatabase å·²è¿æ¥"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç±» Mysql å’Œ  OracleDatabase éƒ½æ˜¯å®ç°äº† AutoCloseableï¼Œè¿è¡ŒæŸ¥çœ‹ç»“æœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql å·²è¿æ¥</span><br><span class="line">OracleDatabase å·²è¿æ¥</span><br><span class="line">OracleDatabase å·²å…³é—­</span><br><span class="line">mysql å·²å…³é—­</span><br></pre></td></tr></table></figure><p>ç¡®è®¤åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶å€™å¼‚å¸¸ä¿¡æ¯ä¸ä¼šä¸¢å¤±ï¼Œå†™ä¸€ä¸ªæœ‰å¼‚å¸¸çš„æ¨¡æ‹Ÿæµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.feature.jdk7;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é‡Šæ”¾èµ„æº</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoCloseThrow</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (FileReadAutoClose fileRead = <span class="keyword">new</span> FileReadAutoClose()) &#123;</span><br><span class="line">            fileRead.read();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileReadAutoClose</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"èµ„æºè¯»å–"</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IOException(<span class="string">"è¯»å–å¼‚å¸¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"èµ„æºå…³é—­"</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IOException(<span class="string">"å…³é—­å¼‚å¸¸"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡ŒæŸ¥çœ‹å¼‚å¸¸ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">èµ„æºè¯»å–</span><br><span class="line">èµ„æºå…³é—­</span><br><span class="line">Exception in thread &quot;main&quot; java.io.IOException: è¯»å–å¼‚å¸¸</span><br><span class="line">at net.codingme.feature.jdk7.FileReadAutoClose.read(AutoCloseThrow.java:23)</span><br><span class="line">at net.codingme.feature.jdk7.AutoCloseThrow.main(AutoCloseThrow.java:14)</span><br><span class="line">Suppressed: java.io.IOException: å…³é—­å¼‚å¸¸</span><br><span class="line">at net.codingme.feature.jdk7.FileReadAutoClose.close(AutoCloseThrow.java:29)</span><br><span class="line">at net.codingme.feature.jdk7.AutoCloseThrow.main(AutoCloseThrow.java:15)</span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨å…³é—­ï¼Œå¼‚å¸¸æ¸…æ™°ï¼Œå…³é—­å¼‚å¸¸å­˜åœ¨äº <code>Suppressed</code> ï¼Œç§°ä¸ºæŠ‘åˆ¶å¼‚å¸¸ï¼Œåç»­æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚</p><h1 id="3-try-catch"><a href="#3-try-catch" class="headerlink" title="3. try-catch"></a>3. try-catch</h1><p>åœ¨ Java 7 ä¹‹å‰ï¼Œä¸€ä¸ª catch åªèƒ½æ•è·ä¸€ä¸ªå¼‚å¸¸ä¿¡æ¯ï¼Œå½“å¼‚å¸¸ç§ç±»éå¸¸å¤šçš„æ—¶å€™å°±å¾ˆéº»çƒ¦ï¼Œä½†æ˜¯åœ¨ Java 7 ä¸­ï¼Œä¸€ä¸ª catch å¯ä»¥æ•è·å¤šä¸ªå¼‚å¸¸ä¿¡æ¯ï¼Œæ¯ä¸ªå¼‚å¸¸æ•è·ä¹‹é—´ä½¿ç”¨ <code>|</code> åˆ†å‰²ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.feature.jdk7;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¤šå¼‚å¸¸æ•è·</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TryCatchMany</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (TxtRead txtRead = <span class="keyword">new</span> TxtRead()) &#123;</span><br><span class="line">            txtRead.reader();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TxtRead</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"èµ„æºé‡Šæ”¾"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reader</span><span class="params">()</span> <span class="keyword">throws</span> IOException, NoSuchFieldException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ•°æ®è¯»å–"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ª catch æ•è·å¤šä¸ªå¼‚å¸¸æ—¶ï¼Œä¸èƒ½å‡ºç°é‡å¤çš„å¼‚å¸¸ç±»å‹ï¼Œä¹Ÿä¸èƒ½å‡ºç°ä¸€ä¸ªå¼‚å¸¸ç±»å‹æ˜¯å¦ä¸€ä¸ªç±»çš„å­ç±»çš„æƒ…å†µã€‚</p><h1 id="4-äºŒè¿›åˆ¶"><a href="#4-äºŒè¿›åˆ¶" class="headerlink" title="4. äºŒè¿›åˆ¶"></a>4. äºŒè¿›åˆ¶</h1><p>Java 7 å¼€å§‹ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šä¸åŒçš„è¿›åˆ¶æ•°å­—ã€‚</p><ol><li>äºŒè¿›åˆ¶æŒ‡å®šæ•°å­—å€¼ï¼Œåªéœ€è¦ä½¿ç”¨ <code>0b</code> æˆ–è€… <code>OB</code> å¼€å¤´ã€‚</li><li>å…«è¿›åˆ¶æŒ‡å®šæ•°å­—å€¼ï¼Œä½¿ç”¨ <code>0</code> å¼€å¤´ã€‚</li><li>åå…­è¿›åˆ¶æŒ‡å®šæ•°å­—å€¼ï¼Œä½¿ç”¨ <code>0x</code> å¼€å¤´ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Binary</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// äºŒè¿›åˆ¶</span></span><br><span class="line">        System.out.println(<span class="string">"------2è¿›åˆ¶-----"</span>);</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">0b001</span>;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">0b010</span>;</span><br><span class="line">        System.out.println(a);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">        <span class="comment">// å…«è¿›åˆ¶</span></span><br><span class="line">        System.out.println(<span class="string">"------8è¿›åˆ¶-----"</span>);</span><br><span class="line">        <span class="keyword">int</span> a1 = <span class="number">010</span>;</span><br><span class="line">        <span class="keyword">int</span> b1 = <span class="number">020</span>;</span><br><span class="line">        System.out.println(a1);</span><br><span class="line">        System.out.println(b1);</span><br><span class="line">        <span class="comment">// åå…­è¿›åˆ¶</span></span><br><span class="line">        System.out.println(<span class="string">"------16è¿›åˆ¶-----"</span>);</span><br><span class="line">        <span class="keyword">int</span> a2 = <span class="number">0x10</span>;</span><br><span class="line">        <span class="keyword">int</span> b2 = <span class="number">0x20</span>;</span><br><span class="line">        System.out.println(a2);</span><br><span class="line">        System.out.println(b2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">------2è¿›åˆ¶-----</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">------8è¿›åˆ¶-----</span><br><span class="line">8</span><br><span class="line">16</span><br><span class="line">------16è¿›åˆ¶-----</span><br><span class="line">16</span><br><span class="line">32</span><br></pre></td></tr></table></figure><h1 id="5-æ•°å­—ä¸‹åˆ’çº¿"><a href="#5-æ•°å­—ä¸‹åˆ’çº¿" class="headerlink" title="5. æ•°å­—ä¸‹åˆ’çº¿"></a>5. æ•°å­—ä¸‹åˆ’çº¿</h1><p>Java 7 å¼€å§‹æ”¯æŒåœ¨æ•°å­—å®šä¹‰æ—¶å€™ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å‰²ï¼Œå¢åŠ äº†æ•°å­—çš„å¯è¯»æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°å­—ä¸‹ç¯çº¿</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumberLine</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">1_000</span>;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">1_0__0_0_0_____00</span>;</span><br><span class="line">        System.out.println(a);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1000</span><br><span class="line">1000000</span><br></pre></td></tr></table></figure><h1 id="6-ç»“æŸè¯­"><a href="#6-ç»“æŸè¯­" class="headerlink" title="6. ç»“æŸè¯­"></a>6. ç»“æŸè¯­</h1><p>è™½ç„¶ Java 7 æ—©åœ¨ 2011 å¹´å°±å·²ç»å‘å¸ƒäº†ï¼Œä½†æ˜¯æ®æˆ‘å‘ç°ï¼Œä½¿ç”¨åˆ° Java 7 å¼€å§‹çš„æ–°ç‰¹æ€§æ–°è¯­æ³•çš„å¹¶ä¸å¤šï¼Œæ‰€ä»¥æˆ‘çš„ JDK æ–°ç‰¹æ€§ç³»åˆ—æ–‡ç« è®¡åˆ’ä» Java 7 å¼€å§‹ï¼Œä¸€ç›´ä»‹ç»åˆ°ç›®å‰å·²ç»å‘å¸ƒçš„  Java 13ï¼Œä»¥å Java æ–°ç‰ˆæœ¬æ›´æ–°çš„åŒæ—¶ï¼Œè¿™ä¸ªæ–°ç‰¹æ€§ç³»åˆ—æ–‡ç« ä¹Ÿä¼šæŒç»­æ›´æ–°ã€‚</p><p>æ­¤å»å±±é«˜æ°´è¿œï¼Œæ„¿èƒ½ä¸€è·¯åšæŒï¼Œæ„¿ä½ æˆ‘ä¸€è·¯åŒè¡Œã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;Java å¹³å°è‡ªå‡ºç°åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·²ç» 20 å¤šä¸ªå¹´å¤´äº†ï¼Œè¿™ 20 å¤šå¹´é—´ Java ä¹Ÿä¸€ç›´ä½œä¸ºæœ€æµè¡Œçš„ç¨‹åºè®¾è®¡è¯­è¨€ä¹‹ä¸€ï¼Œä¸æ–­é¢ä¸´ç€å…¶ä»–æ–°å…´ç¼–ç¨‹è¯­è¨€çš„æŒ‘æˆ˜ä¸å†²å‡»ã€‚Java è¯­è¨€æ˜¯ä¸€ç§&lt;strong&gt;é™æ€å¼ºç±»å‹&lt;/strong&gt;è¯­è¨€ï¼Œè¿™æ ·çš„è¯­è¨€ç‰¹æ€§å¯ä»¥è®© Java ç¼–è¯‘å™¨åœ¨&lt;strong&gt;ç¼–è¯‘é˜¶æ®µ&lt;/strong&gt;å‘ç°é”™è¯¯ï¼Œè¿™å¯¹äºæ„å»ºå‡ºä¸€ä¸ª&lt;strong&gt;ç¨³å®šå®‰å…¨ä¸”å¥å£®&lt;/strong&gt;çš„åº”ç”¨æ¥è¯´ï¼Œå°¤ä¸ºé‡è¦ã€‚ä½†æ˜¯ä¹Ÿå› ä¸ºè¿™ç§ç‰¹æ€§ï¼Œè®© Java å¼€å‘ä¼¼ä¹å˜å¾—ç¼ºå°‘çµæ´»æ€§ï¼Œå¼€å‘æŸäº›åŠŸèƒ½çš„åº”ç”¨æ—¶ï¼Œä»£ç é‡å¯èƒ½æ˜¯å…¶ä»–è¯­è¨€çš„å‡ å€ã€‚Java å¼€å‘çš„ä¸è¶³ä¹‹å¤„ä¹Ÿä½“ç°è¶Šæ¥è¶Šå¤æ‚çš„ JDK ä¸Šï¼Œè¶Šæ¥è¶Šå¤æ‚çš„ JDK è®©å¼€å‘è€…å®Œå…¨ç†è§£çš„éš¾åº¦å˜çš„éå¸¸å¤§ã€‚ä»¥è‡³äºå¼€å‘è€…æœ‰æ—¶ä¼šé‡å¤å®ç°ä¸€ä¸ª JDK ä¸­å·²ç»æä¾›äº†çš„åŠŸèƒ½ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Jdk æ–°ç‰¹æ€§" scheme="https://www.codingme.net/categories/Jdk-%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
    
      <category term="Java7" scheme="https://www.codingme.net/tags/Java7/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåä¸ƒï¼‰è¿…é€Ÿä½¿ç”¨ Spring Boot Admin ç›‘æ§ä½ çš„ Spring Boot ç¨‹åº</title>
    <link href="https://www.codingme.net/2019/12/springboot/springboot-17-admin/"/>
    <id>https://www.codingme.net/2019/12/springboot/springboot-17-admin/</id>
    <published>2019-12-23T00:08:08.000Z</published>
    <updated>2019-12-23T00:25:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-Spring-Boot-Admin-æ˜¯ä»€ä¹ˆ"><a href="#1-Spring-Boot-Admin-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1. Spring Boot Admin æ˜¯ä»€ä¹ˆ"></a>1. Spring Boot Admin æ˜¯ä»€ä¹ˆ</h2><p>Spring Boot Admin æ˜¯ç”± <a href="github.com/codecentric">codecentric</a> ç»„ç»‡å¼€å‘çš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨ Spring Boot Admin å¯ä»¥ç®¡ç†å’Œç›‘æ§ä½ çš„ Spring Boot é¡¹ç›®ã€‚å®ƒåˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸¤éƒ¨åˆ†ï¼Œå®¢æˆ·ç«¯æ·»åŠ åˆ°ä½ çš„ Spring Boot åº”ç”¨å¢åŠ æš´æ¼ç›¸å…³ä¿¡æ¯çš„ HTTP æ¥å£ï¼Œç„¶åæ³¨å†Œåˆ° Spring Boot Admin æœåŠ¡ç«¯ï¼Œè¿™ä¸€æ­¥éª¤å¯ä»¥ç›´æ¥å‘æœåŠ¡ç«¯æ³¨å†Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Eureka æˆ–è€… Consul è¿›è¡Œæ³¨å†Œã€‚è€Œ Spring Boot Admin Server é€šè¿‡ Vue.js ç¨‹åºç›‘æ§ä¿¡æ¯è¿›è¡Œå¯è§†åŒ–å‘ˆç°ã€‚å¹¶ä¸”æ”¯æŒå¤šç§äº‹ä»¶é€šçŸ¥æ“ä½œã€‚<br><a id="more"></a></p><h2 id="2-Spring-Boot-Admin-æœåŠ¡ç«¯"><a href="#2-Spring-Boot-Admin-æœåŠ¡ç«¯" class="headerlink" title="2. Spring Boot Admin æœåŠ¡ç«¯"></a>2. Spring Boot Admin æœåŠ¡ç«¯</h2><p>Spring Boot Admin æœåŠ¡ç«¯æ˜¯åŸºäº Spring Boot é¡¹ç›®çš„ï¼Œå¦‚ä½•åˆ›å»ºä¸€ä¸ª Spring Boot é¡¹ç›®è¿™é‡Œä¸æï¼Œä½ å¯ä»¥å‚è€ƒä¹‹å‰æ–‡ç« æˆ–è€…ä» <a href="https://start.spring.io/" target="_blank" rel="noopener">https://start.spring.io/</a>  ç›´æ¥è·å¾—ä¸€ä¸ª Spring Boot é¡¹ç›®ã€‚</p><h3 id="2-1-æ·»åŠ ä¾èµ–"><a href="#2-1-æ·»åŠ ä¾èµ–" class="headerlink" title="2.1. æ·»åŠ ä¾èµ–"></a>2.1. æ·»åŠ ä¾èµ–</h3><p>åªéœ€è¦æ·»åŠ  web ä¾èµ–å’Œ Spring-boot-admin-starter-server ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-å¯åŠ¨é…ç½®"><a href="#2-2-å¯åŠ¨é…ç½®" class="headerlink" title="2.2. å¯åŠ¨é…ç½®"></a>2.2. å¯åŠ¨é…ç½®</h3><p>ä¸ºäº†å’Œä¸‹é¢çš„å®¢æˆ·ç«¯ç«¯å£ä¸å†²çªï¼Œå…ˆä¿®æ”¹ç«¯å£å·ä¸º 9090ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">9090</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ  <code>@EnableAdminServer</code> æ³¨è§£å¯ç”¨ Spring Boot Admin Server åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAdminServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootAdminServerApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringbootAdminServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯å·²ç»é…ç½®å®Œæˆï¼Œå¯åŠ¨é¡¹ç›®è¿›è¡Œè®¿é—®å°±å¯ä»¥çœ‹åˆ° Spring Boot Admin Server çš„é¡µé¢äº†ã€‚</p><p><img src="/assets/springboot-18-admin/image-20191221204941292.png" alt="Spring Boot Admin Server UI"></p><h2 id="3-Spring-Boot-Admin-å®¢æˆ·ç«¯"><a href="#3-Spring-Boot-Admin-å®¢æˆ·ç«¯" class="headerlink" title="3. Spring Boot Admin å®¢æˆ·ç«¯"></a>3. Spring Boot Admin å®¢æˆ·ç«¯</h2><p>åˆ›å»º Spring Boot é¡¹ç›®ä¾æ—§ä¸æï¼Œè¿™é‡Œåªéœ€è¦æ·»åŠ   Spring Boot Admin å®¢æˆ·ç«¯éœ€è¦çš„ä¾èµ–ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶å°±ä¼šå¢åŠ ç›¸å…³çš„è·å–ä¿¡æ¯çš„ API æ¥å£ã€‚ç„¶ååœ¨ Spring Boot é…ç½®æ–‡ä»¶ä¸­é…ç½® Spring Boot Admin æœåŠ¡ç«¯ï¼Œå°±å¯ä»¥è¿›è¡Œç›‘æ§äº†ã€‚</p><h3 id="3-1-å®¢æˆ·ç«¯ä¾èµ–"><a href="#3-1-å®¢æˆ·ç«¯ä¾èµ–" class="headerlink" title="3.1 å®¢æˆ·ç«¯ä¾èµ–"></a>3.1 å®¢æˆ·ç«¯ä¾èµ–</h3><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Lombok å·¥å…·,ä¸ admin client æ— å…³ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-å®¢æˆ·ç«¯é…ç½®"><a href="#3-2-å®¢æˆ·ç«¯é…ç½®" class="headerlink" title="3.2 å®¢æˆ·ç«¯é…ç½®"></a>3.2 å®¢æˆ·ç«¯é…ç½®</h3><p>å®¢æˆ·ç«¯é…ç½®ä¸»è¦ä¸ºäº†è®©å®¢æˆ·ç«¯å¯ä»¥æˆåŠŸå‘æœåŠ¡ç«¯æ³¨å†Œï¼Œæ‰€ä»¥éœ€è¦é…ç½®å®¢æˆ·ç«¯æ‰€åœ¨åº”ç”¨ç›¸å…³ä¿¡æ¯ä»¥åŠ Spring Boot Admin Server æœåŠ¡ç«¯çš„ urlã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  application:</span></span><br><span class="line">    <span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">sjfx-api-search</span></span><br><span class="line"><span class="attr">  jmx:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  boot:</span></span><br><span class="line"><span class="attr">    admin:</span></span><br><span class="line"><span class="attr">      client:</span></span><br><span class="line">        <span class="comment"># æœåŠ¡ç«¯ url</span></span><br><span class="line"><span class="attr">        url:</span> <span class="attr">http://127.0.0.1:9090</span></span><br><span class="line"><span class="attr">        instance:</span></span><br><span class="line">          <span class="comment"># å®¢æˆ·ç«¯å®ä¾‹ url</span></span><br><span class="line"><span class="attr">          service-url:</span> <span class="attr">http://127.0.0.1:8080</span></span><br><span class="line"><span class="attr">          prefer-ip:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment"># å®¢æˆ·ç«¯å®ä¾‹åç§°</span></span><br><span class="line"><span class="attr">          name:</span> <span class="string">sjfx-api-search</span></span><br><span class="line"></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line"><span class="attr">  endpoints:</span></span><br><span class="line"><span class="attr">    web:</span></span><br><span class="line"><span class="attr">      exposure:</span></span><br><span class="line">      <span class="comment"># æš´æ¼çš„æ¥å£ - æ‰€æœ‰æ¥å£</span></span><br><span class="line"><span class="attr">        include:</span> <span class="string">"*"</span></span><br></pre></td></tr></table></figure><p>é…ç½®ä¸­çš„  <code>include: &quot;*&quot;</code> å…¬å¼€äº†æ‰€æœ‰çš„ç«¯å£ï¼Œå¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œåº”è¯¥è‡ªä¿¡çš„é€‰æ‹©è¦å…¬å¼€çš„æ¥å£ã€‚</p><p>Spring Boot Admin å¯ä»¥è·å–åº”ç”¨ä¸­çš„å®šæ—¶ä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­å¢åŠ ä¸€ä¸ªå®šæ—¶ä»»åŠ¡è®¡åˆ’ï¼Œæ¯ 20 ç§’è¾“å‡ºä¸€æ¬¡å½“å‰æ—¶é—´ï¼Œæ—¥å¿—çº§åˆ«ä¸º <code>INFO</code>ï¼Œç”¨äºä¸‹é¢çš„å®šæ—¶ä»»åŠ¡å’Œæ—¥å¿—ç›‘æ§æµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableScheduling</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootAdminClientApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringbootAdminClientApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled</span>(cron = <span class="string">"0/20 * * * * ?"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run20s</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"å®šæ—¶ä»»åŠ¡:&#123;&#125;"</span>, LocalDateTime.now());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-å®¢æˆ·ç«¯è¿è¡Œ"><a href="#3-3-å®¢æˆ·ç«¯è¿è¡Œ" class="headerlink" title="3.3. å®¢æˆ·ç«¯è¿è¡Œ"></a>3.3. å®¢æˆ·ç«¯è¿è¡Œ</h3><p>å¯åŠ¨å®¢æˆ·ç«¯ä¼šæš´æ¼ç›¸å…³çš„è¿è¡ŒçŠ¶æ€æ¥å£ï¼Œå¹¶ä¸”è‡ªåŠ¨å‘é…ç½®çš„æœåŠ¡ç«¯å‘é€æ³¨å†Œä¿¡æ¯ã€‚</p><p>ä¸‹é¢æ˜¯å®¢æˆ·ç«¯çš„å¯åŠ¨æ—¥å¿—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">2019-12-21 22:45:32.878  INFO 13204 --- [           main] n.c.b.SpringbootAdminClientApplication   : Starting SpringbootAdminClientApplication on DESKTOP-8SCFV4M with PID 13204 (D:\IdeaProjectMy\springboot-git\springboot-admin\springboot-admin-client\target\classes started by 83981 in D:\IdeaProjectMy\springboot-git\springboot-admin)</span><br><span class="line">2019-12-21 22:45:32.881  INFO 13204 --- [           main] n.c.b.SpringbootAdminClientApplication   : No active profile set, falling back to default profiles: default</span><br><span class="line">2019-12-21 22:45:33.627  INFO 13204 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)</span><br><span class="line">2019-12-21 22:45:33.634  INFO 13204 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]</span><br><span class="line">2019-12-21 22:45:33.634  INFO 13204 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.29]</span><br><span class="line">2019-12-21 22:45:33.706  INFO 13204 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext</span><br><span class="line">2019-12-21 22:45:33.706  INFO 13204 --- [           main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 797 ms</span><br><span class="line">2019-12-21 22:45:33.850  INFO 13204 --- [           main] o.s.b.a.e.web.ServletEndpointRegistrar   : Registered &apos;/actuator/jolokia&apos; to jolokia-actuator-endpoint</span><br><span class="line">2019-12-21 22:45:33.954  INFO 13204 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService &apos;applicationTaskExecutor&apos;</span><br><span class="line">2019-12-21 22:45:34.089  INFO 13204 --- [           main] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService</span><br><span class="line">2019-12-21 22:45:34.117  INFO 13204 --- [           main] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService &apos;taskScheduler&apos;</span><br><span class="line">2019-12-21 22:45:34.120  INFO 13204 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path &apos;/actuator&apos;</span><br><span class="line">2019-12-21 22:45:34.162  INFO 13204 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path &apos;&apos;</span><br><span class="line">2019-12-21 22:45:34.163  INFO 13204 --- [           main] n.c.b.SpringbootAdminClientApplication   : Started SpringbootAdminClientApplication in 1.563 seconds (JVM running for 2.131)</span><br><span class="line">2019-12-21 22:45:34.271  INFO 13204 --- [gistrationTask1] d.c.b.a.c.r.ApplicationRegistrator       : Application registered itself as 6bcf19a6bf8c</span><br><span class="line">2019-12-21 22:45:34.293  INFO 13204 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet &apos;dispatcherServlet&apos;</span><br><span class="line">2019-12-21 22:45:34.294  INFO 13204 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet &apos;dispatcherServlet&apos;</span><br><span class="line">2019-12-21 22:45:34.300  INFO 13204 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms</span><br></pre></td></tr></table></figure><p>ä»å¯åŠ¨æ—¥å¿—é‡Œçš„ <code>Exposing 15 endpoint(s) beneath base path &#39;/actuator&#39;</code> è¿™æ®µï¼Œå¯ä»¥çœ‹åˆ°æš´æ¼äº† 15 ä¸ª <code>/actuator</code> çš„ API æ¥å£ï¼Œå¯ä»¥ç›´æ¥è®¿é—®æŸ¥çœ‹å“åº”ç»“æœã€‚</p><p><img src="/assets/springboot-18-admin/image-20191221224351221.png" alt="Spring Boot Admin Client ç›‘æµ‹æ¥å£"></p><p>ä»æ—¥å¿— <code>Application registered itself as 6bcf19a6bf8c</code> å¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯å·²ç»æ³¨å†ŒæˆåŠŸäº†ã€‚å†çœ‹æœåŠ¡ç«¯å¯ä»¥çœ‹åˆ°æ³¨å†Œä¸Šæ¥çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹ã€‚</p><p><img src="/assets/springboot-18-admin/image-20191221225022655.png" alt="Spring Boot Admin Server"></p><h2 id="4-Spring-Boot-Admin-åŠŸèƒ½"><a href="#4-Spring-Boot-Admin-åŠŸèƒ½" class="headerlink" title="4. Spring Boot Admin åŠŸèƒ½"></a>4. Spring Boot Admin åŠŸèƒ½</h2><p>ç‚¹å‡»ç›‘æ§é¡µé¢ä¸Šçš„åœ¨çº¿çš„åº”ç”¨å®ä¾‹ï¼Œå¯ä»¥è·³è½¬åˆ°åº”ç”¨å®ä¾‹è¯¦ç»†çš„ç›‘æ§ç®¡ç†é¡µé¢ï¼Œä¹Ÿå°±æ˜¯ Vue.js å®ç°çš„ web å±•ç¤ºã€‚</p><p><img src="/assets/springboot-18-admin/image-20191222180411114.png" alt="Spring Boot Admin Server ç›‘æ§é¡µé¢"></p><p>Spring Boot Admin Server å¯ä»¥ç›‘æ§çš„åŠŸèƒ½å¾ˆå¤šï¼Œä½¿ç”¨èµ·æ¥æ²¡æœ‰éš¾åº¦ï¼Œä¸‹é¢æè¿°ä¸‹å¯ä»¥ç›‘æµ‹çš„éƒ¨åˆ†å†…å®¹ï¼š</p><ul><li>åº”ç”¨è¿è¡ŒçŠ¶æ€ï¼Œå¦‚æ—¶é—´ã€åƒåœ¾å›æ”¶æ¬¡æ•°ï¼Œçº¿ç¨‹æ•°é‡ï¼Œå†…å­˜ä½¿ç”¨èµ°åŠ¿ã€‚</li><li>åº”ç”¨æ€§èƒ½ç›‘æµ‹ï¼Œé€šè¿‡é€‰æ‹© JVM æˆ–è€… Tomcat å‚æ•°ï¼ŒæŸ¥çœ‹å½“å‰æ•°å€¼ã€‚</li><li>åº”ç”¨ç¯å¢ƒç›‘æµ‹ï¼ŒæŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œåº”ç”¨é…ç½®å‚æ•°ï¼Œè‡ªåŠ¨é…ç½®å‚æ•°ã€‚</li><li>åº”ç”¨ bean ç®¡ç†ï¼ŒæŸ¥çœ‹ Spring Bean ï¼Œå¹¶ä¸”å¯ä»¥æŸ¥çœ‹æ˜¯å¦å•ä¾‹ã€‚</li><li>åº”ç”¨è®¡åˆ’ä»»åŠ¡ï¼ŒæŸ¥çœ‹åº”ç”¨çš„è®¡åˆ’ä»»åŠ¡åˆ—è¡¨ã€‚</li><li>åº”ç”¨æ—¥å¿—ç®¡ç†ï¼ŒåŠ¨æ€æ›´æ”¹æ—¥å¿—çº§åˆ«ï¼ŒæŸ¥çœ‹æ—¥å¿—ã€‚</li><li>åº”ç”¨ JVM ç®¡ç†ï¼ŒæŸ¥çœ‹å½“å‰çº¿ç¨‹è¿è¡Œæƒ…å†µï¼Œdump å†…å­˜å †æ ˆä¿¡æ¯ã€‚</li><li>åº”ç”¨æ˜ å°„ç®¡ç†ï¼ŒæŸ¥çœ‹åº”ç”¨æ¥å£è°ƒç”¨æ–¹æ³•ã€è¿”å›ç±»å‹ã€å¤„ç†ç±»ç­‰ä¿¡æ¯ã€‚</li></ul><p>ä¸Šé¢æåˆ°çš„æ—¥å¿—ç®¡ç†ï¼Œå¯ä»¥åŠ¨æ€çš„æ›´æ”¹æ—¥å¿—çº§åˆ«ï¼Œä»¥åŠæŸ¥çœ‹æ—¥å¿—ã€‚é»˜è®¤é…ç½®ä¸‹æ˜¯åªå¯ä»¥åŠ¨æ€æ›´æ”¹æ—¥å¿—çº§åˆ«çš„ï¼Œå¦‚æœè¦åœ¨çº¿æŸ¥çœ‹æ—¥å¿—ï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ç½®æ—¥å¿—è·¯å¾„äº†ã€‚</p><p>å®¢æˆ·ç«¯ä¸Šå¯ä»¥åƒä¸‹é¢è¿™æ ·é…ç½®æ—¥å¿—è·¯å¾„ä»¥åŠæ—¥å¿—é«˜äº®ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æ–‡ä»¶ï¼šapplication.yml</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  file:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">boot.log</span></span><br><span class="line"><span class="attr">  pattern:</span></span><br><span class="line"><span class="comment">#     æ—¥å¿—é«˜äº®</span></span><br><span class="line"><span class="attr">    file:</span> <span class="string">'%clr(%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;)&#123;faint&#125; %clr(%5p) %clr($&#123;PID&#125;)&#123;magenta&#125; %clr(---)&#123;faint&#125; %clr([%15.15t])&#123;faint&#125; %clr(%-40.40logger&#123;39&#125;)&#123;cyan&#125; %clr(:)&#123;faint&#125; %m%n%wEx'</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯åœ¨ Spring Boot Admin ç›‘æµ‹é¡µé¢ä¸ŠæŸ¥çœ‹çš„å®¢æˆ·ç«¯åº”ç”¨æ—¥å¿—ã€‚</p><p><img src="/assets/springboot-18-admin/image-20191222193212726.png" alt="Spring Boot Admin Server æŸ¥çœ‹æ—¥å¿—"></p><h2 id="5-Spring-Boot-Admin-è¿›é˜¶"><a href="#5-Spring-Boot-Admin-è¿›é˜¶" class="headerlink" title="5. Spring Boot Admin è¿›é˜¶"></a>5. Spring Boot Admin è¿›é˜¶</h2><h3 id="5-1-é‚®ä»¶é€šçŸ¥"><a href="#5-1-é‚®ä»¶é€šçŸ¥" class="headerlink" title="5.1. é‚®ä»¶é€šçŸ¥"></a>5.1. é‚®ä»¶é€šçŸ¥</h3><p>Spring Boot Admin Server  æ”¯æŒå¸¸è§çš„é€šçŸ¥æ–¹å¼ï¼Œæ¯”å¦‚é‚®ä»¶é€šçŸ¥ã€ç”µæŠ¥é€šçŸ¥ã€PagerDuty é€šçŸ¥ç­‰ï¼Œä¸‹é¢å°†ä¼šæ¼”ç¤ºå¸¸è§çš„é€šçŸ¥æ–¹å¼ - é‚®ä»¶é€šçŸ¥ï¼Œæœ€åä¹Ÿä¼šæ¼”ç¤ºå¦‚ä½•é€šè¿‡ç›‘å¬æ—¶é—´è¿›ä¸‹è®¾ç½®è‡ªå®šä¹‰é€šçŸ¥æ–¹å¼ã€‚</p><p>Spring Boot Admin Server çš„é‚®ä»¶é€šçŸ¥é€šè¿‡ Thymeleaf æ¨¡æ¿å‘é€ HTML æ ¼å¼çš„ç”µå­é‚®ä»¶ã€‚å› æ­¤ï¼Œæƒ³è¦ä½¿ç”¨é‚®ä»¶é€šçŸ¥é¦–å…ˆè¦å¼•å…¥ Thymeleaf ä¾èµ–ä»¥åŠ <code>spring-boot-starter-mail</code> ä¾èµ–ï¼Œå¹¶é…ç½®é‚®ä»¶å‘é€è€…ä¿¡æ¯å’Œæ¥å—è€…ä¿¡æ¯ã€‚</p><p> <strong>1. æ·»åŠ ä¾èµ–</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;de.codecentric&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Thymeleaf æ¨¡ç‰ˆï¼Œç”¨äºå‘é€æ¨¡ç‰ˆé‚®ä»¶ --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p><strong>2. é…ç½®é‚®ä»¶</strong></p><p>ä¸»è¦è®¾ç½®å‘é€è€…ä¿¡æ¯å’Œæ¥æ”¶è€…ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  boot:</span><br><span class="line">    admin:</span><br><span class="line">      notify:</span><br><span class="line">        mail:</span><br><span class="line">          # é€—å·åˆ†éš”çš„é‚®ä»¶æ”¶ä»¶äººåˆ—è¡¨</span><br><span class="line">          to: xxxx@126.com</span><br><span class="line">          # å¼€å¯é‚®ç®±é€šçŸ¥</span><br><span class="line">          enabled: true</span><br><span class="line">          # ä¸éœ€è¦å‘é€é€šçŸ¥çš„çŠ¶æ€ï¼šä»çŠ¶æ€A:åˆ°çŠ¶æ€B</span><br><span class="line">          ignore-changes: &#123;&quot;UNKNOWN:UP&quot;&#125;</span><br><span class="line">          # é€—å·åˆ†éš”çš„æŠ„é€æ”¶ä»¶äººåˆ—è¡¨</span><br><span class="line">          cc: xxxx@126.com</span><br><span class="line">          # å‘ä»¶äºº</span><br><span class="line">          from: Spring Boot Admin&lt;xxxx@126.com&gt;</span><br><span class="line">          </span><br><span class="line"># é‚®ä»¶å‘é€è€…ä¿¡æ¯</span><br><span class="line">  mail:</span><br><span class="line">    host: smtp.126.com</span><br><span class="line">    port: 25</span><br><span class="line">    username: xxxx@126.com</span><br><span class="line">    default-encoding: utf-8</span><br><span class="line">    password: xxxx</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³äº†è§£æ›´å¤šå…³äº Spring Boot é‚®ä»¶å‘é€ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ <a href="https://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483764&amp;idx=1&amp;sn=8cee8b1781b8659b3fdc23c0d650db49&amp;chksm=e984e810def3610640e741eea1f94bbf95d4a2a5b1c68946829a036b4a6bc58b0d23e156474a&amp;token=971841717&amp;lang=zh_CN#rd" target="_blank" rel="noopener">Spring Boot ç³»åˆ—æ–‡ç« ç¬¬åä¸‰ç¯‡</a>ã€‚</p><p>é…ç½®å¥½é‚®ä»¶é€šçŸ¥ä¹‹åï¼Œé‡å¯æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œç­‰å®¢æˆ·ç«¯æ³¨å†Œåˆ°æœåŠ¡ç«¯ä¹‹åç›´æ¥ç»ˆæ­¢å®¢æˆ·ç«¯çš„è¿è¡Œï¼Œç¨ç­‰ç‰‡åˆ»å°±å¯ä»¥åœ¨é…ç½®çš„é€šçŸ¥æ¥æ”¶é‚®ç®±é‡Œæ”¶åˆ°å®¢æˆ·ç«¯å®ä¾‹ä¸‹çº¿é€šçŸ¥äº†ã€‚</p><p><img src="/assets/springboot-18-admin/image-20191222215118514.png" alt="Sping Boot Admin Server é‚®ä»¶é€šçŸ¥"></p><p>é‚®ä»¶é€šçŸ¥ä½¿ç”¨çš„æ¨¡æ¿å­˜æ”¾åœ¨ server ä¾èµ–çš„ classpath:/META-INF/spring-boot-admin-server/mail/status-changed.html è·¯å¾„ï¼Œå¦‚æœæƒ³è¦è‡ªå®šä¹‰æ¨¡æ¿å†…å®¹ã€‚å¯ä»¥æ‹·è´è¿™ä¸ªæ–‡ä»¶æ”¾åˆ°è‡ªå·±çš„ templates ç›®å½•ä¸‹ï¼Œä¿®æ”¹æˆè‡ªå·±æƒ³è¦çš„æ•ˆæœï¼Œç„¶ååœ¨é…ç½®ä¸­æŒ‡å®šè‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  boot:</span></span><br><span class="line"><span class="attr">    admin:</span></span><br><span class="line"><span class="attr">      notify:</span></span><br><span class="line"><span class="attr">        mail:</span></span><br><span class="line">          <span class="comment"># è‡ªå®šä¹‰é‚®ä»¶æ¨¡ç‰ˆ</span></span><br><span class="line"><span class="attr">          template:</span> <span class="attr">classpath:/templates/notify.html</span></span><br></pre></td></tr></table></figure><h3 id="5-2-è‡ªå®šä¹‰é€šçŸ¥"><a href="#5-2-è‡ªå®šä¹‰é€šçŸ¥" class="headerlink" title="5.2 è‡ªå®šä¹‰é€šçŸ¥"></a>5.2 è‡ªå®šä¹‰é€šçŸ¥</h3><p>è‡ªå®šä¹‰é€šçŸ¥åªéœ€è¦è‡ªå·±å®ç° Spring Boot Admin Server æä¾›çš„ç›‘å¬é€šçŸ¥ç±»å³å¯ï¼Œä¸‹é¢ä¼šæ¼”ç¤ºå¦‚ä½•åœ¨å®ä¾‹çŠ¶æ€æ”¹å˜æ—¶è¾“å‡ºå®ä¾‹ç›¸å…³ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.domain.entities.Instance;</span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.domain.entities.InstanceRepository;</span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.domain.events.InstanceEvent;</span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.domain.events.InstanceStatusChangedEvent;</span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.notify.AbstractEventNotifier;</span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.notify.LoggingNotifier;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomNotifier</span> <span class="keyword">extends</span> <span class="title">AbstractEventNotifier</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(LoggingNotifier.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomNotifier</span><span class="params">(InstanceRepository repository)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(repository);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Mono&lt;Void&gt; <span class="title">doNotify</span><span class="params">(InstanceEvent event, Instance instance)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.fromRunnable(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (event <span class="keyword">instanceof</span> InstanceStatusChangedEvent) &#123;</span><br><span class="line">                LOGGER.info(<span class="string">"Instance &#123;&#125; (&#123;&#125;) is &#123;&#125;"</span>, instance.getRegistration().getName(), event.getInstance(),</span><br><span class="line">                    ((InstanceStatusChangedEvent)event).getStatusInfo().getStatus());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                LOGGER.info(<span class="string">"Instance &#123;&#125; (&#123;&#125;) &#123;&#125;"</span>, instance.getRegistration().getName(), event.getInstance(),</span><br><span class="line">                    event.getType());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-è®¿é—®é™åˆ¶"><a href="#5-2-è®¿é—®é™åˆ¶" class="headerlink" title="5.2. è®¿é—®é™åˆ¶"></a>5.2. è®¿é—®é™åˆ¶</h3><p>ä¸Šé¢æåˆ°è¿‡ï¼Œå› ä¸ºå®¢æˆ·ç«¯å¢åŠ äº†æš´æ¼è¿è¡Œä¿¡æ¯çš„ç›¸å…³æ¥å£ï¼Œæ‰€ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å­˜åœ¨é£é™©ï¼Œè€ŒæœåŠ¡ç«¯æ²¡æœ‰è®¿é—®é™åˆ¶ï¼Œè°çš„å¯ä»¥è®¿é—®ä¹Ÿæ˜¯ä¸åˆç†çš„ã€‚</p><p>ä¸‹é¢å°†ä¼šä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åˆ†åˆ«å¢åŠ è®¿é—®é™åˆ¶ï¼Œå®¢æˆ·ç«¯ä¸»è¦æ˜¯é™åˆ¶æ•æ„Ÿæ¥å£çš„è®¿é—®æƒé™ï¼ŒæœåŠ¡ç«¯åˆ™æ˜¯å…¨å±€çš„è®¿é—®é™åˆ¶ã€‚è¿™äº›è®¿é—®é™åˆ¶éƒ½é€šè¿‡ spring å®‰å…¨æ¡†æ¶ security æ¥å®ç°ï¼Œæ‰€ä»¥é¦–å…ˆè¦ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¢åŠ  maven ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>1. æœåŠ¡ç«¯</strong></p><p>åœ¨å¼•å…¥å®‰å…¨æ¡†æ¶ä¾èµ–ä¹‹åï¼Œéœ€è¦é…ç½®è®¿é—®æ§åˆ¶ï¼Œæ¯”å¦‚é™æ€èµ„æºä¸éœ€è¦é™åˆ¶ï¼Œç™»å½•ç™»å‡ºé¡µé¢æŒ‡å®šç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.csrf.CookieCsrfTokenRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;</span><br><span class="line"><span class="keyword">import</span> de.codecentric.boot.admin.server.config.AdminServerProperties;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.http.HttpMethod;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecuritySecureConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AdminServerProperties adminServer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SecuritySecureConfig</span><span class="params">(AdminServerProperties adminServer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.adminServer = adminServer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// @formatter:off</span></span><br><span class="line">        SavedRequestAwareAuthenticationSuccessHandler successHandler = <span class="keyword">new</span> SavedRequestAwareAuthenticationSuccessHandler();</span><br><span class="line">        successHandler.setTargetUrlParameter(<span class="string">"redirectTo"</span>);</span><br><span class="line">        successHandler.setDefaultTargetUrl(<span class="keyword">this</span>.adminServer.path(<span class="string">"/"</span>));</span><br><span class="line"></span><br><span class="line">        http.authorizeRequests()</span><br><span class="line">                .antMatchers(<span class="keyword">this</span>.adminServer.path(<span class="string">"/assets/**"</span>)).permitAll()</span><br><span class="line">                .antMatchers(<span class="keyword">this</span>.adminServer.path(<span class="string">"/login"</span>)).permitAll()</span><br><span class="line">                .anyRequest().authenticated()</span><br><span class="line">                .and()</span><br><span class="line">                .formLogin().loginPage(<span class="keyword">this</span>.adminServer.path(<span class="string">"/login"</span>)).successHandler(successHandler).and()</span><br><span class="line">                .logout().logoutUrl(<span class="keyword">this</span>.adminServer.path(<span class="string">"/logout"</span>)).and()</span><br><span class="line">                .httpBasic().and()</span><br><span class="line">                .csrf()</span><br><span class="line">                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())</span><br><span class="line">                .ignoringRequestMatchers(</span><br><span class="line">                        <span class="keyword">new</span> AntPathRequestMatcher(<span class="keyword">this</span>.adminServer.path(<span class="string">"/instances"</span>), HttpMethod.POST.toString()),</span><br><span class="line">                        <span class="keyword">new</span> AntPathRequestMatcher(<span class="keyword">this</span>.adminServer.path(<span class="string">"/instances/*"</span>), HttpMethod.DELETE.toString()),</span><br><span class="line">                        <span class="keyword">new</span> AntPathRequestMatcher(<span class="keyword">this</span>.adminServer.path(<span class="string">"/actuator/**"</span>))</span><br><span class="line">                )</span><br><span class="line">                .and()</span><br><span class="line">                .rememberMe().key(UUID.randomUUID().toString()).tokenValiditySeconds(<span class="number">1209600</span>);</span><br><span class="line">        <span class="comment">// @formatter:on</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»£ç é…ç½®ç”¨æˆ·åå’Œå¯†ç çš„æ–¹å¼</span></span><br><span class="line">    <span class="comment">// Required to provide UserDetailsService for "remember functionality"</span></span><br><span class="line">    <span class="comment">// @Override</span></span><br><span class="line">    <span class="comment">// protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123;</span></span><br><span class="line">    <span class="comment">// auth.inMemoryAuthentication().withUser("user").password("&#123;noop&#125;password").roles("USER");</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ application.yml é…ç½®æ–‡ä»¶ä¸­é…ç½®ç”¨æˆ·åå’Œå¯†ç ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  security:</span></span><br><span class="line"><span class="attr">    user:</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">user</span></span><br><span class="line"><span class="attr">      password:</span> <span class="number">123</span></span><br></pre></td></tr></table></figure><p>é‡å¯æœåŠ¡ç«¯ï¼Œå†æ¬¡è®¿é—®å°±éœ€è¦ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•äº†ã€‚ </p><p><img src="/assets/springboot-18-admin/image-20191222222408380.png" alt="Spring Boot Admin Server ç™»å½•"></p><p><strong>2. å®¢æˆ·ç«¯</strong></p><p>å®¢æˆ·ç«¯åœ¨å¼•å…¥å®‰å…¨æ¡†æ¶ä¹‹åï¼Œä¹Ÿéœ€è¦é…ç½®è®¿é—®æƒé™ï¼Œä¸»è¦æ˜¯é…ç½®å“ªäº›è·¯å¾„å¯ä»¥è®¿é—®ï¼Œå“ªäº›è·¯å¾„è®¿é—®éœ€è¦ç™»å½•é™åˆ¶ï¼Œé»˜è®¤æ‰€æœ‰æ¥å£éƒ½éœ€è¦ç™»å½•é™åˆ¶ã€‚</p><p>åŒæ ·çš„ï¼Œå®¢æˆ·ç«¯åº”ç”¨ä¹Ÿéœ€è¦åœ¨é…ç½®ä¸­é…ç½®å®¢æˆ·ç«¯åº”ç”¨å¯¹äºæ•æ„Ÿæ¥å£çš„ç™»å½•ç”¨æˆ·å’Œå¯†ç ï¼ŒåŒæ—¶éœ€è¦é…ç½® Spring Boot Admin Server çš„è®¿é—®ç”¨æˆ·å’Œå¯†ç ï¼Œè¿˜è¦æŠŠè‡ªèº«çš„ç”¨æˆ·å’Œå¯†ç æ³¨å†Œæ—¶å‘Šè¯‰æœåŠ¡ç«¯ï¼Œä¸ç„¶æœåŠ¡ç«¯ä¸èƒ½è·å–åˆ°ç›‘æµ‹æ•°æ®ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  security:</span></span><br><span class="line"><span class="attr">    user:</span></span><br><span class="line">      <span class="comment"># å®¢æˆ·ç«¯æ•æ„Ÿæ¥å£ç”¨æˆ·å’Œå¯†ç </span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">client</span></span><br><span class="line"><span class="attr">      password:</span> <span class="number">123</span></span><br><span class="line"><span class="attr">  application:</span></span><br><span class="line">    <span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">sjfx-api-search</span></span><br><span class="line"><span class="attr">  jmx:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  boot:</span></span><br><span class="line"><span class="attr">    admin:</span></span><br><span class="line"><span class="attr">      client:</span></span><br><span class="line">        <span class="comment"># æœåŠ¡ç«¯ url</span></span><br><span class="line"><span class="attr">        url:</span> <span class="attr">http://127.0.0.1:9090</span></span><br><span class="line"><span class="attr">        instance:</span></span><br><span class="line">          <span class="comment"># å®¢æˆ·ç«¯å®ä¾‹ url</span></span><br><span class="line"><span class="attr">          service-url:</span> <span class="attr">http://127.0.0.1:8080</span></span><br><span class="line"><span class="attr">          prefer-ip:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment"># å®¢æˆ·ç«¯å®ä¾‹åç§°</span></span><br><span class="line"><span class="attr">          name:</span> <span class="string">sjfx-api-search</span></span><br><span class="line"><span class="attr">          metadata:</span></span><br><span class="line">            <span class="comment"># å®¢æˆ·ç«¯è‡ªèº«çš„ç”¨æˆ·å’Œå¯†ç å‘Šè¯‰æœåŠ¡ç«¯</span></span><br><span class="line">            <span class="string">user.name:</span> <span class="string">client</span></span><br><span class="line">            <span class="string">user.password:</span> <span class="number">123</span></span><br><span class="line">        <span class="comment"># æœåŠ¡ç«¯ç”¨æˆ·åå¯†ç </span></span><br><span class="line"><span class="attr">        username:</span> <span class="string">user</span></span><br><span class="line"><span class="attr">        password:</span> <span class="number">123</span></span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æ•æ„Ÿæ¥å£è®¿é—®æµ‹è¯•ã€‚</p><p><img src="/assets/springboot-18-admin/image-20191222232720674.png" alt="å®¢æˆ·ç«¯åº”ç”¨è®¿é—®"></p><p>åˆ°è¿™é‡Œï¼Œå®¢æˆ·ç«¯çš„æ•æ„Ÿæ¥å£è®¿é—®éœ€è¦ç™»å½•ï¼ŒæœåŠ¡ç«¯çš„ç®¡ç†é¡µé¢ä¹Ÿéœ€è¦ç™»å½•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„è®¿é—®æ§åˆ¶å·²ç»å®Œæˆäº†ã€‚</p><p>æ–‡ä¸­ä»£ç å·²ç»ä¸Šä¼ åˆ°ï¼š<a href="github.com/niumoo/springboot/tree/master/springboot-admin">github.com/niumoo/springboot/tree/master/springboot-admin</a></p><p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p><p><a href="https://github.com/codecentric/spring-boot-admin" target="_blank" rel="noopener">https://github.com/codecentric/spring-boot-admin</a></p><p><a href="https://codecentric.github.io/spring-boot-admin/current/" target="_blank" rel="noopener">https://codecentric.github.io/spring-boot-admin/current/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-Spring-Boot-Admin-æ˜¯ä»€ä¹ˆ&quot;&gt;&lt;a href=&quot;#1-Spring-Boot-Admin-æ˜¯ä»€ä¹ˆ&quot; class=&quot;headerlink&quot; title=&quot;1. Spring Boot Admin æ˜¯ä»€ä¹ˆ&quot;&gt;&lt;/a&gt;1. Spring Boot Admin æ˜¯ä»€ä¹ˆ&lt;/h2&gt;&lt;p&gt;Spring Boot Admin æ˜¯ç”± &lt;a href=&quot;github.com/codecentric&quot;&gt;codecentric&lt;/a&gt; ç»„ç»‡å¼€å‘çš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨ Spring Boot Admin å¯ä»¥ç®¡ç†å’Œç›‘æ§ä½ çš„ Spring Boot é¡¹ç›®ã€‚å®ƒåˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸¤éƒ¨åˆ†ï¼Œå®¢æˆ·ç«¯æ·»åŠ åˆ°ä½ çš„ Spring Boot åº”ç”¨å¢åŠ æš´æ¼ç›¸å…³ä¿¡æ¯çš„ HTTP æ¥å£ï¼Œç„¶åæ³¨å†Œåˆ° Spring Boot Admin æœåŠ¡ç«¯ï¼Œè¿™ä¸€æ­¥éª¤å¯ä»¥ç›´æ¥å‘æœåŠ¡ç«¯æ³¨å†Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Eureka æˆ–è€… Consul è¿›è¡Œæ³¨å†Œã€‚è€Œ Spring Boot Admin Server é€šè¿‡ Vue.js ç¨‹åºç›‘æ§ä¿¡æ¯è¿›è¡Œå¯è§†åŒ–å‘ˆç°ã€‚å¹¶ä¸”æ”¯æŒå¤šç§äº‹ä»¶é€šçŸ¥æ“ä½œã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="å·¥å…·" scheme="https://www.codingme.net/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="ç›‘æ§" scheme="https://www.codingme.net/tags/%E7%9B%91%E6%8E%A7/"/>
    
  </entry>
  
  <entry>
    <title>è¶…å¥½ç”¨çš„è‡ªå¸¦ç«ç„°å›¾çš„ Java æ€§èƒ½åˆ†æå·¥å…· Async-profiler äº†è§£ä¸€ä¸‹</title>
    <link href="https://www.codingme.net/2019/12/async-profiler/"/>
    <id>https://www.codingme.net/2019/12/async-profiler/</id>
    <published>2019-12-09T00:55:08.000Z</published>
    <updated>2019-12-18T05:44:01.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/assets/image-20191209082448987.png" alt="ç«ç„°å›¾"></p><p>å¦‚æœä½ ç»å¸¸é‡åˆ°  Java çº¿ä¸Šæ€§èƒ½é—®é¢˜æŸæ‰‹æ— ç­–ï¼Œçœ‹ç€çº¿ä¸ŠæœåŠ¡ CPU é£™å‡ä¸€ç­¹è«å±•ï¼Œå‘ç°å†…å­˜ä¸æ–­æ³„éœ²æ»¡è„¸èŒ«ç„¶ã€‚åˆ«æ…Œï¼Œè¿™é‡Œæœ‰ä¸€æ¬¾ä½å¼€é”€ã€è‡ªå¸¦<strong>ç«ç„°å›¾</strong>ã€è®©ä½ å¤§å‘¼å¥½ç”¨çš„ Java æ€§èƒ½åˆ†æå·¥å…· - <strong>async-profiler</strong>ã€‚</p><p>æœ€è¿‘ Arthas æ€§èƒ½åˆ†æå·¥å…·ä¸Šçº¿äº†<strong>ç«ç„°å›¾</strong>åˆ†æåŠŸèƒ½ï¼ŒArthas ä½¿ç”¨  <strong>async-profiler</strong> ç”Ÿæˆ CPU/å†…å­˜ç«ç„°å›¾è¿›è¡Œæ€§èƒ½åˆ†æï¼Œå¼¥è¡¥äº†ä¹‹å‰å†…å­˜åˆ†æçš„ä¸è¶³ã€‚åœ¨ Arthas ä¸Šä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œä½¿ç”¨æ–¹å¼å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»  <strong>async-profiler</strong> ç›¸å…³å†…å®¹ã€‚</p><p>Arthas ç«ç„°å›¾å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://alibaba.github.io/arthas/profiler.html" target="_blank" rel="noopener">https://alibaba.github.io/arthas/profiler.html</a></p><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤š Arthas ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰æ–‡ç« ï¼š<a href="http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483907&amp;idx=1&amp;sn=653ecea3697873ad1f5c4f567034a1c3&amp;chksm=e984eb67def362715c0a01bc08e1491f7e8f892e92826406484174da264cb06bbc1c05cf30f6&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">Arthas - Java çº¿ä¸Šé—®é¢˜å®šä½å¤„ç†çš„ç»ˆæåˆ©å™¨</a></p><a id="more"></a><h2 id="async-profiler-ä»‹ç»"><a href="#async-profiler-ä»‹ç»" class="headerlink" title="async-profiler ä»‹ç»"></a>async-profiler ä»‹ç»</h2><p>async-profiler æ˜¯ä¸€æ¬¾å¼€æºçš„ Java <strong>æ€§èƒ½åˆ†æå·¥å…·</strong>ï¼ŒåŸç†æ˜¯åŸºäº HotSpot çš„ APIï¼Œä»¥<strong>å¾®ä¹å…¶å¾®çš„æ€§èƒ½å¼€é”€</strong>æ”¶é›†ç¨‹åºè¿è¡Œä¸­çš„å †æ ˆä¿¡æ¯ã€å†…å­˜åˆ†é…ç­‰ä¿¡æ¯è¿›è¡Œåˆ†æã€‚</p><p>ä½¿ç”¨ async-profiler å¯ä»¥åšä¸‹é¢å‡ ä¸ªæ–¹é¢çš„åˆ†æã€‚</p><ul><li><strong>CPU cycles</strong></li><li>Hardware and Software performance counters like cache misses, branch misses, page faults, context switches etc.</li><li><strong>Allocations in Java Heap</strong></li><li>Contented lock attempts, including both Java object monitors and ReentrantLocks</li></ul><p>æˆ‘ä»¬å¸¸ç”¨çš„æ˜¯ CPU æ€§èƒ½åˆ†æå’Œ Heap å†…å­˜åˆ†é…åˆ†æã€‚åœ¨è¿›è¡Œ CPU æ€§èƒ½åˆ†ææ—¶ï¼Œä»…éœ€è¦<strong>éå¸¸ä½çš„æ€§èƒ½å¼€é”€</strong>å°±å¯ä»¥è¿›è¡Œåˆ†æï¼Œè¿™ä¹Ÿæ˜¯è¿™ä¸ªå·¥å…·çš„ä¼˜ç‚¹ä¹‹ä¸€ã€‚</p><p>åœ¨è¿›è¡Œ Heap åˆ†é…åˆ†ææ—¶ï¼Œasync-profiler å·¥å…·ä¼šæ”¶é›†å†…å­˜åˆ†é…ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å»æ£€æµ‹å ç”¨ CPU çš„ä»£ç ã€‚async-profiler ä¸ä½¿ç”¨ä¾µå…¥æ€§çš„æŠ€æœ¯ï¼Œä¾‹å¦‚å­—èŠ‚ç æ£€æµ‹å·¥å…·æˆ–è€…æ¢é’ˆæ£€æµ‹ç­‰ï¼Œè¿™ä¹Ÿè¯´æ˜ async-profiler çš„å†…å­˜åˆ†é…åˆ†æåƒ CPU æ€§èƒ½åˆ†æä¸€æ ·ï¼Œä¸ä¼šäº§ç”Ÿå¤ªå¤§çš„æ€§èƒ½å¼€é”€ï¼ŒåŒæ—¶ä¹Ÿä¸ç”¨å†™å‡º<strong>åºå¤§çš„å †æ ˆæ–‡ä»¶</strong>å†å»è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ï¼Œã€‚</p><p>async-profile ç›®å‰æ”¯æŒ Linux å’Œ macOS å¹³å°ï¼ˆmacOS ä¸‹åªèƒ½åˆ†æç”¨æˆ·ç©ºé—´çš„ä»£ç ï¼‰ã€‚</p><ul><li><strong>Linux</strong> / x64 / x86 / ARM / AArch64</li><li><strong>macOS</strong> / x64</li></ul><p>async-profiler å·¥å…·åœ¨é‡‡æ ·åå¯ä»¥ç”Ÿæˆé‡‡æ ·ç»“æœçš„æ—¥å¿—æŠ¥å‘Šï¼Œä¹Ÿå¯ä»¥ç”Ÿæˆ SVG æ ¼å¼çš„<strong>ç«ç„°å›¾</strong>ï¼Œåœ¨ä¹‹å‰ç”Ÿæˆ<strong>ç«ç„°å›¾</strong>è¦ä½¿ç”¨ <a href="https://github.com/brendangregg/FlameGraph" target="_blank" rel="noopener">FlameGraph</a> å·¥å…·ã€‚ç°åœ¨å·²ç»ä¸éœ€è¦äº†ï¼Œä» 1.2 ç‰ˆæœ¬å¼€å§‹ï¼Œå°±å·²ç»å†…ç½®äº†å¼€ç®±å³ç”¨çš„ SVG æ–‡ä»¶ç”ŸæˆåŠŸèƒ½ã€‚</p><p>å…¶ä»–ä¿¡æ¯å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://github.com/jvm-profiling-tools/async-profiler" target="_blank" rel="noopener">https://github.com/jvm-profiling-tools/async-profiler</a></p><h2 id="async-profiler-å®‰è£…"><a href="#async-profiler-å®‰è£…" class="headerlink" title="async-profiler å®‰è£…"></a>async-profiler å®‰è£…</h2><p>ä¸‹è½½ async-profiler å·¥å…·å¯ä»¥åœ¨å®˜æ–¹çš„ Github ä¸Šç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„æ–‡ä»¶ï¼Œå¦‚æœä½ å°±æ˜¯æƒ³ä½“éªŒæ‰‹åŠ¨æŒ¡çš„æ„Ÿè§‰ï¼Œä¹Ÿå¯ä»¥å…‹éš†é¡¹ç›®ï¼Œæ‰‹åŠ¨ç¼–è¯‘ä¸€ä¸‹ï¼Œä¸å¾—ä¸è¯´è¿™ä¸ªå·¥å…·ååˆ†çš„æ˜“ç”¨ï¼Œæˆ‘åœ¨æ‰‹åŠ¨ç¼–è¯‘çš„è¿‡ç¨‹ååˆ†é¡ºæ»‘ï¼Œæ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ã€‚</p><p>å¦‚æœä½ æƒ³ä¸‹è½½ç¼–è¯‘å¥½çš„ï¼Œå¯ä»¥åˆ°è¿™é‡Œä¸‹è½½ã€‚</p><p><a href="https://github.com/jvm-profiling-tools/async-profiler/releases" target="_blank" rel="noopener">https://github.com/jvm-profiling-tools/async-profiler/releases</a></p><p>å¦‚æœæƒ³ä½“éªŒæ‰‹åŠ¨æŒ¡çš„æ„Ÿè§‰ï¼Œå¯ä»¥å…‹éš†æ•´ä¸ªé¡¹ç›®ï¼Œè¿›é¡¹é¡¹ç›®ç¼–è¯‘ã€‚</p><p>æ‰‹åŠ¨ç¼–è¯‘çš„ç¯å¢ƒè¦æ±‚ã€‚</p><ul><li>JDK</li><li>GCC</li></ul><p>ä¸‹é¢æ˜¯æ‰‹åŠ¨å®‰è£…çš„æ“ä½œå‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/jvm-profiling-tools/async-profiler</span><br><span class="line">cd async-profiler</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ make å‘½ä»¤ç¼–è¯‘åä¼šåœ¨é¡¹ç›®çš„ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª build æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ç€ç¼–è¯‘çš„ç»“æœã€‚ä¸‹é¢æ˜¯æˆ‘æ‰‹åŠ¨ç¼–è¯‘çš„è¿‡ç¨‹è¾“å‡ºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">âœ  develop git clone https://github.com/jvm-profiling-tools/async-profiler</span><br><span class="line">Cloning into 'async-profiler'...</span><br><span class="line">remote: Enumerating objects: 69, done.</span><br><span class="line">remote: Counting objects: 100% (69/69), done.</span><br><span class="line">remote: Compressing objects: 100% (54/54), done.</span><br><span class="line">remote: Total 1805 (delta 34), reused 32 (delta 15), pack-reused 1736</span><br><span class="line">Receiving objects: 100% (1805/1805), 590.78 KiB | 23.00 KiB/s, done.</span><br><span class="line">Resolving deltas: 100% (1288/1288), done.</span><br><span class="line">âœ  develop cd async-profiler</span><br><span class="line">âœ  async-profiler git:(master) make</span><br><span class="line">mkdir -p build</span><br><span class="line">g++ -O2 -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE -DPROFILER_VERSION=\"1.6\" -I/Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home/include -I/Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home/include/darwin -fPIC -shared -o build/libasyncProfiler.so src/*.cpp -ldl -lpthread</span><br><span class="line">gcc -O2 -DJATTACH_VERSION=\"1.5\" -o build/jattach src/jattach/jattach.c</span><br><span class="line">mkdir -p build/classes</span><br><span class="line">/Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home/bin/javac -source 6 -target 6 -d build/classes src/java/one/profiler/AsyncProfiler.java src/java/one/profiler/AsyncProfilerMXBean.java src/java/one/profiler/Counter.java src/java/one/profiler/Events.java</span><br><span class="line">è­¦å‘Š: [options] æœªä¸ -source 1.6 ä¸€èµ·è®¾ç½®å¼•å¯¼ç±»è·¯å¾„</span><br><span class="line">1 ä¸ªè­¦å‘Š</span><br><span class="line">/Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home/bin/jar cvf build/async-profiler.jar -C build/classes .</span><br><span class="line">å·²æ·»åŠ æ¸…å•</span><br><span class="line">æ­£åœ¨æ·»åŠ : one/(è¾“å…¥ = 0) (è¾“å‡º = 0)(å­˜å‚¨äº† 0%)</span><br><span class="line">æ­£åœ¨æ·»åŠ : one/profiler/(è¾“å…¥ = 0) (è¾“å‡º = 0)(å­˜å‚¨äº† 0%)</span><br><span class="line">æ­£åœ¨æ·»åŠ : one/profiler/AsyncProfiler.class(è¾“å…¥ = 1885) (è¾“å‡º = 908)(å‹ç¼©äº† 51%)</span><br><span class="line">æ­£åœ¨æ·»åŠ : one/profiler/Events.class(è¾“å…¥ = 405) (è¾“å‡º = 286)(å‹ç¼©äº† 29%)</span><br><span class="line">æ­£åœ¨æ·»åŠ : one/profiler/Counter.class(è¾“å…¥ = 845) (è¾“å‡º = 473)(å‹ç¼©äº† 44%)</span><br><span class="line">æ­£åœ¨æ·»åŠ : one/profiler/AsyncProfilerMXBean.class(è¾“å…¥ = 631) (è¾“å‡º = 344)(å‹ç¼©äº† 45%)</span><br><span class="line">rm -rf build/classes</span><br><span class="line">âœ  async-profiler git:(master)</span><br></pre></td></tr></table></figure><h2 id="async-profiler-ä½¿ç”¨"><a href="#async-profiler-ä½¿ç”¨" class="headerlink" title="async-profiler ä½¿ç”¨"></a>async-profiler ä½¿ç”¨</h2><p>è¿è¡Œé¡¹ç›®é‡Œçš„ profiler.sh å¯ä»¥çœ‹åˆ° async-profiler çš„ä½¿ç”¨å¸®åŠ©æ–‡æ¡£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">âœ  async-profiler git:(master) ./profiler.sh</span><br><span class="line">Usage: ./profiler.sh [action] [options] &lt;pid&gt;</span><br><span class="line">Actions:</span><br><span class="line">  start             start profiling and return immediately</span><br><span class="line">  resume            resume profiling without resetting collected data</span><br><span class="line">  stop              stop profiling</span><br><span class="line">  status            print profiling status</span><br><span class="line">  list              list profiling events supported by the target JVM</span><br><span class="line">  collect           collect profile for the specified period of time</span><br><span class="line">                    and then stop (default action)</span><br><span class="line">Options:</span><br><span class="line">  -e event          profiling event: cpu|alloc|lock|cache-misses etc.</span><br><span class="line">  -d duration       run profiling for &lt;duration&gt; seconds</span><br><span class="line">  -f filename       dump output to &lt;filename&gt;</span><br><span class="line">  -i interval       sampling interval in nanoseconds</span><br><span class="line">  -j jstackdepth    maximum Java stack depth</span><br><span class="line">  -b bufsize        frame buffer size</span><br><span class="line">  -t                profile different threads separately</span><br><span class="line">  -s                simple class names instead of FQN</span><br><span class="line">  -g                print method signatures</span><br><span class="line">  -a                annotate Java method names</span><br><span class="line">  -o fmt            output format: summary|traces|flat|collapsed|svg|tree|jfr</span><br><span class="line">  -v, --version     display version string</span><br><span class="line"></span><br><span class="line">  --title string    SVG title</span><br><span class="line">  --width px        SVG width</span><br><span class="line">  --height px       SVG frame height</span><br><span class="line">  --minwidth px     skip frames smaller than px</span><br><span class="line">  --reverse         generate stack-reversed FlameGraph / Call tree</span><br><span class="line"></span><br><span class="line">  --all-kernel      only include kernel-mode events</span><br><span class="line">  --all-user        only include user-mode events</span><br><span class="line">  --sync-walk       use synchronous JVMTI stack walker (dangerous!)</span><br><span class="line"></span><br><span class="line">&lt;pid&gt; is a numeric process ID of the target JVM</span><br><span class="line">      or 'jps' keyword to find running JVM automatically</span><br><span class="line"></span><br><span class="line">Example: ./profiler.sh -d 30 -f profile.svg 3456</span><br><span class="line">         ./profiler.sh start -i 999000 jps</span><br><span class="line">         ./profiler.sh stop -o summary,flat jps</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼šUsage: ./profiler.sh [action] [options] <pid>ï¼Œä¹Ÿå°±æ˜¯ <strong>å‘½ä»¤+æ“ä½œ+å‚æ•°+PID</strong>ã€‚</pid></p><p>å¸¸ç”¨çš„ä½¿ç”¨çš„å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>æŸ¥çœ‹ java è¿›ç¨‹çš„ PIDï¼ˆå¯ä»¥ä½¿ç”¨ jps ï¼‰ã€‚</li><li>ä½¿ç”¨ ./profiler.sh start <pid> å¼€å§‹é‡‡æ ·ã€‚</pid></li><li>ä½¿ç”¨ ./profiler.sh status <pid> æŸ¥çœ‹å·²ç»é‡‡æ ·çš„æ—¶é—´ã€‚</pid></li><li>ä½¿ç”¨ ./profiler.sh stop <pid> åœæ­¢é‡‡æ ·ï¼Œè¾“å‡ºç»“æœã€‚</pid></li></ol><p>è¿™ç§æ–¹å¼ä½¿ç”¨èµ·æ¥å¤šè´¹åŠ²å•Šï¼Œè€Œä¸”æœ€åè¾“å‡ºçš„æ˜¯æ–‡æœ¬ç»“æœï¼Œçœ‹èµ·æ¥æ›´æ˜¯è´¹åŠ²ï¼Œä¸ºäº†ä¸é‚£ä¹ˆè´¹åŠ²ï¼Œå¯ä»¥ä½¿ç”¨å¸®åŠ©é‡Œç»™çš„é‡‡æ ·åç”Ÿæˆ SVG æ–‡ä»¶ä¾‹å­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./profiler.sh -d 30 -f profile.svg 3456</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯ï¼Œå¯¹ PID ä¸º 3456 çš„ java è¿›ç¨‹é‡‡æ · 30 ç§’ï¼Œç„¶åç”Ÿæˆ profile.svg ç»“æœæ–‡ä»¶ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹æ˜¯åˆ†æ CPU æ€§èƒ½ï¼Œå¦‚æœè¦è¿›è¡Œå…¶ä»–åˆ†æï¼Œå¯ä»¥ä½¿ç”¨ -e å‚æ•°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-e event     profiling event: cpu|alloc|lock|cache-misses etc.</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ”¯æŒçš„åˆ†æäº‹ä»¶æœ‰ CPUã€Allocã€Lockã€Cache-misses ã€‚</p><h2 id="async-profiler-æ¡ˆä¾‹"><a href="#async-profiler-æ¡ˆä¾‹" class="headerlink" title="async-profiler æ¡ˆä¾‹"></a>async-profiler æ¡ˆä¾‹</h2><p>ä¸Šé¢è¯´å®Œäº† async-profiler å·¥å…·çš„ä½œç”¨å’Œä½¿ç”¨æ–¹å¼ï¼Œæ—¢ç„¶èƒ½è¿›è¡Œ CPU æ€§èƒ½åˆ†æå’Œ Heap å†…å­˜åˆ†é…åˆ†æï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å†™å‡ ä¸ªä¸ä¸€èˆ¬çš„æ–¹æ³•åˆ†æè¯•è¯•çœ‹ã€‚çœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰åƒä¸Šé¢ä»‹ç»çš„é‚£ä¹ˆå¥½ç”¨ã€‚</p><h3 id="Java-æ¡ˆä¾‹ç¼–ç "><a href="#Java-æ¡ˆä¾‹ç¼–ç " class="headerlink" title="Java æ¡ˆä¾‹ç¼–ç "></a>Java æ¡ˆä¾‹ç¼–ç </h3><p>å¾ˆç®€å•çš„å‡ ä¸ªæ–¹æ³•ï¼Œhotmethod æ–¹æ³•å†™äº†å‡ ä¸ªå¸¸è§æ“ä½œï¼Œä¸‰ä¸ªæ–¹æ³•ä¸­å¾ˆæ˜æ˜¾ hotmethod3 æ–¹æ³•é‡Œçš„ç”Ÿæˆ UUID å’Œ replaceï¼ˆéœ€è¦æ­£åˆ™åŒ¹é…ï¼‰æ“ä½œæ¶ˆè€—çš„ CPU æ€§èƒ½ä¼šè¾ƒå¤šã€‚allocate æ–¹æ³•é‡Œå› ä¸ºè¦ä¸æ–­çš„åˆ›å»ºé•¿åº¦ä¸º 6ä¸‡çš„æ•°ç»„ï¼Œæ¶ˆè€—çš„å†…å­˜ç©ºé—´ä¸€å®šæ˜¯æœ€å¤šçš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ¨¡æ‹Ÿçƒ­ç‚¹ä»£ç </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HotCode</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object array;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            hotmethod1();</span><br><span class="line">            hotmethod2();</span><br><span class="line">            hotmethod3();</span><br><span class="line">            allocate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆ 6ä¸‡é•¿åº¦çš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">allocate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">6</span> * <span class="number">1000</span>];</span><br><span class="line">        array = <span class="keyword">new</span> Integer[<span class="number">6</span> * <span class="number">1000</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆä¸€ä¸ªUUID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">hotmethod3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        UUID uuid = UUID.randomUUID();</span><br><span class="line">        String str = uuid.toString().replace(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">        list.add(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°å­—ç´¯åŠ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">hotmethod2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        value++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆä¸€ä¸ªéšæœºæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">hotmethod1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> anInt = random.nextInt();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CPU-æ€§èƒ½åˆ†æ"><a href="#CPU-æ€§èƒ½åˆ†æ" class="headerlink" title="CPU æ€§èƒ½åˆ†æ"></a>CPU æ€§èƒ½åˆ†æ</h3><p>è¿è¡Œä¸Šé¢çš„ç¨‹åºï¼Œç„¶åä½¿ç”¨ JPS å‘½ä»¤æŸ¥çœ‹ PID ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">âœ  develop jps</span><br><span class="line">2800 Jps</span><br><span class="line">2449 HotCode</span><br><span class="line">2450 Launcher</span><br><span class="line">805 RemoteMavenServer36</span><br><span class="line">470 NutstoreGUI</span><br><span class="line">699</span><br><span class="line">âœ  develop</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿è¡Œçš„ç±»åæ˜¯ HotCodeï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”çš„ PID æ˜¯ 2449ã€‚</p><p>ä½¿ç”¨ <code>./profiler.sh -d 20 -f 2449.svg 2449</code> å‘½ä»¤å¯¹ 2449 å·è¿›ç¨‹é‡‡æ ·20ç§’ï¼Œç„¶åå¾—åˆ°ç”Ÿæˆçš„ 2449.svg æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° CPU çš„ä½¿ç”¨<strong>ç«ç„°å›¾</strong>ã€‚</p><p><img src="/assets/image-20191208225253486.png" alt="CPU ä½¿ç”¨ç«ç„°å›¾"></p><p>å…³äºç«ç„°å›¾æ€ä¹ˆçœ‹ï¼Œä¸€è¨€ä»¥è”½ä¹‹ï¼š<strong>ç«ç„°å›¾é‡Œï¼Œæ¨ªæ¡è¶Šé•¿ï¼Œä»£è¡¨ä½¿ç”¨çš„è¶Šå¤šï¼Œä»ä¸‹åˆ°ä¸Šæ˜¯è°ƒç”¨å †æ ˆä¿¡æ¯</strong>ã€‚åœ¨è¿™ä¸ªå›¾é‡Œå¯ä»¥çœ‹åˆ° main æ–¹æ³•ä¸Šé¢çš„è°ƒç”¨ä¸­ hotmethod3 æ–¹æ³•çš„ CPU ä½¿ç”¨æ˜¯æœ€å¤šçš„ï¼Œç‚¹å‡»è¿™ä¸ªæ–¹æ³•ã€‚è¿˜å¯èƒ½çœ‹åˆ°æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚</p><p><img src="/assets/image-20191208225613748.png" alt="hotmethod3 CPU ç«ç„°å›¾"></p><p>å¯ä»¥çœ‹åˆ° replace æ–¹æ³•å ç”¨çš„ CPU æœ€å¤šï¼Œä¹Ÿæ˜¯ç¨‹åºä¸­æ€§èƒ½é—®é¢˜æ‰€åœ¨ï¼Œæ˜¯éœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p><h3 id="Heap-å†…å­˜åˆ†æ"><a href="#Heap-å†…å­˜åˆ†æ" class="headerlink" title="Heap å†…å­˜åˆ†æ"></a>Heap å†…å­˜åˆ†æ</h3><p>è¿˜æ˜¯ä¸Šé¢è¿è¡Œçš„ç¨‹åºï¼Œè¿›ç¨‹ PID è¿˜æ˜¯ 2449ï¼Œè¿™æ¬¡ä½¿ç”¨ -e å‚æ•°åˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µã€‚</p><p>å‘½ä»¤ï¼š<code>./profiler.sh -d 20 -e alloc -f 2449-alloc.svg 2449</code></p><p>å‘½ä»¤çš„æ„æ€æ˜¯æ”¶é›†è¿›ç¨‹å·æ˜¯ 2449 çš„è¿›ç¨‹çš„å†…å­˜ä¿¡æ¯ 20 ç§’ï¼Œç„¶åè¾“å‡ºä¸º 2449-alloc.svg æ–‡ä»¶ã€‚20ç§’åå¾—åˆ° svg æ–‡ä»¶ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå¯ä»¥çœ‹åˆ°å†…å­˜åˆ†é…æƒ…å†µã€‚</p><p><img src="/assets/image-20191208230100288.png" alt="å†…å­˜åˆ†é…ç«ç„°å›¾"></p><p>ä¾æ—§æ˜¯æ¨ªæ¡è¶Šé•¿ï¼Œä»£è¡¨ä½¿ç”¨çš„è¶Šå¤šï¼Œä»ä¸‹åˆ°ä¸Šæ˜¯è°ƒç”¨å †æ ˆä¿¡æ¯ã€‚ä»å›¾é‡Œå¯ä»¥çœ‹å‡ºæ¥ main æ–¹æ³•è°ƒç”¨çš„ allocate æ–¹æ³•ä½¿ç”¨çš„å†…å­˜æœ€å¤šï¼Œè¿™ä¸ªæ–¹æ³•é‡Œçš„ Integer ç±»å‹æ•°ç»„å ç”¨çš„å†…å­˜åˆæœ€å¤šï¼Œä¸º 71%ã€‚</p><p>æ–‡ä¸­æµ‹è¯•ä»£ç å·²ç»ä¸Šä¼ åˆ° Githubï¼š<a href="https://github.com/niumoo/lab-notes" target="_blank" rel="noopener">https://github.com/niumoo/lab-notes</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/assets/image-20191209082448987.png&quot; alt=&quot;ç«ç„°å›¾&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ç»å¸¸é‡åˆ°  Java çº¿ä¸Šæ€§èƒ½é—®é¢˜æŸæ‰‹æ— ç­–ï¼Œçœ‹ç€çº¿ä¸ŠæœåŠ¡ CPU é£™å‡ä¸€ç­¹è«å±•ï¼Œå‘ç°å†…å­˜ä¸æ–­æ³„éœ²æ»¡è„¸èŒ«ç„¶ã€‚åˆ«æ…Œï¼Œè¿™é‡Œæœ‰ä¸€æ¬¾ä½å¼€é”€ã€è‡ªå¸¦&lt;strong&gt;ç«ç„°å›¾&lt;/strong&gt;ã€è®©ä½ å¤§å‘¼å¥½ç”¨çš„ Java æ€§èƒ½åˆ†æå·¥å…· - &lt;strong&gt;async-profiler&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ Arthas æ€§èƒ½åˆ†æå·¥å…·ä¸Šçº¿äº†&lt;strong&gt;ç«ç„°å›¾&lt;/strong&gt;åˆ†æåŠŸèƒ½ï¼ŒArthas ä½¿ç”¨  &lt;strong&gt;async-profiler&lt;/strong&gt; ç”Ÿæˆ CPU/å†…å­˜ç«ç„°å›¾è¿›è¡Œæ€§èƒ½åˆ†æï¼Œå¼¥è¡¥äº†ä¹‹å‰å†…å­˜åˆ†æçš„ä¸è¶³ã€‚åœ¨ Arthas ä¸Šä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œä½¿ç”¨æ–¹å¼å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»  &lt;strong&gt;async-profiler&lt;/strong&gt; ç›¸å…³å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;Arthas ç«ç„°å›¾å®˜æ–¹æ–‡æ¡£ï¼š&lt;a href=&quot;https://alibaba.github.io/arthas/profiler.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://alibaba.github.io/arthas/profiler.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³äº†è§£æ›´å¤š Arthas ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰æ–‡ç« ï¼š&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;amp;mid=2247483907&amp;amp;idx=1&amp;amp;sn=653ecea3697873ad1f5c4f567034a1c3&amp;amp;chksm=e984eb67def362715c0a01bc08e1491f7e8f892e92826406484174da264cb06bbc1c05cf30f6&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Arthas - Java çº¿ä¸Šé—®é¢˜å®šä½å¤„ç†çš„ç»ˆæåˆ©å™¨&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="ç”Ÿäº§å·¥å…·" scheme="https://www.codingme.net/categories/%E7%94%9F%E4%BA%A7%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="æ€§èƒ½åˆ†æ" scheme="https://www.codingme.net/tags/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåå…­ï¼‰ä½ çœŸçš„äº†è§£ Swagger æ–‡æ¡£å—ï¼Ÿ</title>
    <link href="https://www.codingme.net/2019/11/springboot/springboot-16-web-swagger/"/>
    <id>https://www.codingme.net/2019/11/springboot/springboot-16-web-swagger/</id>
    <published>2019-11-26T00:08:08.000Z</published>
    <updated>2019-11-26T00:47:59.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç›®å‰æ¥è¯´ï¼Œåœ¨ Java é¢†åŸŸä½¿ç”¨ <code>Springboot</code> æ„å»ºå¾®æœåŠ¡æ˜¯æ¯”è¾ƒæµè¡Œçš„ï¼Œåœ¨æ„å»ºå¾®æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬å¤§å¤šæ•°ä¼šé€‰æ‹©æš´æ¼ä¸€ä¸ª <code>REST API</code> ä»¥ä¾›è°ƒç”¨ã€‚åˆæˆ–è€…å…¬å¸é‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œè®©å‰ç«¯å’Œåç«¯çš„å·¥ä½œç”±å®Œå…¨ä¸åŒçš„å·¥ç¨‹å¸ˆè¿›è¡Œå¼€å‘å®Œæˆã€‚ä¸ç®¡æ˜¯å¾®æœåŠ¡è¿˜æ˜¯è¿™ç§å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œç»´æŒä¸€ä»½å®Œæ•´çš„åŠæ—¶æ›´æ–°çš„ <code>REST API</code> æ–‡æ¡£ï¼Œä¼šæå¤§çš„æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚è€Œä¼ ç»Ÿçš„æ–‡æ¡£æ›´æ–°æ–¹å¼ï¼ˆå¦‚æ‰‹åŠ¨ç¼–å†™ï¼‰ï¼Œå¾ˆéš¾ä¿è¯æ–‡æ¡£çš„åŠæ—¶æ€§ï¼Œç»å¸¸ä¼šå¹´ä¹…å¤±ä¿®ï¼Œå¤±å»åº”æœ‰çš„æ„ä¹‰ã€‚å› æ­¤é€‰æ‹©ä¸€ç§æ–°çš„ API æ–‡æ¡£ç»´æŠ¤æ–¹å¼å¾ˆæœ‰å¿…è¦ï¼Œè¿™ä¹Ÿæ˜¯è¿™ç¯‡æ–‡ç« è¦ä»‹ç»çš„å†…å®¹ã€‚<br><a id="more"></a></p><h2 id="1-OpenAPI-è§„èŒƒä»‹ç»"><a href="#1-OpenAPI-è§„èŒƒä»‹ç»" class="headerlink" title="1. OpenAPI  è§„èŒƒä»‹ç»"></a>1. OpenAPI  è§„èŒƒä»‹ç»</h2><p><img src="/assets/oas_original-01.png" alt="Open API"></p><p><code>OpenAPI Specification</code> ç®€ç§° OASï¼Œä¸­æ–‡ä¹Ÿç§°  <code>OpenAPI</code> æè¿°è§„èŒƒï¼Œä½¿ç”¨ <code>OpenAPI</code> æ–‡ä»¶å¯ä»¥æè¿°æ•´ä¸ª APIï¼Œå®ƒåˆ¶å®šäº†ä¸€å¥—çš„é€‚åˆé€šç”¨çš„ä¸è¯­è¨€æ— å…³çš„ <code>REST API</code> æè¿°è§„èŒƒï¼Œå¦‚ API è·¯å¾„è§„èŒƒã€è¯·æ±‚æ–¹æ³•è§„èŒƒã€è¯·æ±‚å‚æ•°è§„èŒƒã€è¿”å›æ ¼å¼è§„èŒƒç­‰å„ç§ç›¸å…³ä¿¡æ¯ï¼Œä½¿äººç±»å’Œè®¡ç®—æœºéƒ½å¯ä»¥ä¸éœ€è¦è®¿é—®æºä»£ç å°±å¯ä»¥ç†è§£å’Œä½¿ç”¨æœåŠ¡çš„åŠŸèƒ½ã€‚</p><p>ä¸‹é¢æ˜¯ <code>OpenAPI</code> è§„èŒƒä¸­å»ºè®®çš„ API è®¾è®¡è§„èŒƒï¼ŒåŸºæœ¬è·¯å¾„è®¾è®¡è§„èŒƒã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://api.example.com/v1/users?role=admin&amp;status=active</span><br><span class="line">\________________________/\____/ \______________________/</span><br><span class="line">         server URL       endpoint    query parameters</span><br><span class="line">                            path</span><br></pre></td></tr></table></figure></p><p>å¯¹äºä¼ å‚çš„è®¾è®¡ä¹Ÿæœ‰è§„èŒƒï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼š</p><ul><li><a href="https://swagger.io/docs/specification/describing-parameters/#path-parameters" target="_blank" rel="noopener">è·¯å¾„å‚æ•°</a>, ä¾‹å¦‚ <code>/users/{id}</code></li><li><a href="https://swagger.io/docs/specification/describing-parameters/#query-parameters" target="_blank" rel="noopener">æŸ¥è¯¢å‚æ•°</a>, ä¾‹å¦‚ <code>/users?role=æœªè¯»ä»£ç </code></li><li><a href="https://swagger.io/docs/specification/describing-parameters/#header-parameters" target="_blank" rel="noopener">header å‚æ•°</a>, ä¾‹å¦‚ <code>X-MyHeader: Value</code></li><li><a href="https://swagger.io/docs/specification/describing-parameters/#cookie-parameters" target="_blank" rel="noopener">cookie å‚æ•°</a>,  ä¾‹å¦‚ <code>Cookie: debug=0; csrftoken=BUSe35dohU3O1MZvDCU</code></li></ul><p><code>OpenAPI</code> è§„èŒƒçš„ä¸œè¥¿è¿œè¿œä¸æ­¢è¿™äº›ï¼Œç›®å‰ <code>OpenAPI</code> è§„èŒƒæœ€æ–°ç‰ˆæœ¬æ˜¯ 3.0.2ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„ <code>OpenAPI</code> è§„èŒƒï¼Œå¯ä»¥è®¿é—®ä¸‹é¢çš„é“¾æ¥ã€‚<br><a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.2.md" target="_blank" rel="noopener">OpenAPI Specification (https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.2.md)</a></p><h2 id="2-Swagger-ä»‹ç»"><a href="#2-Swagger-ä»‹ç»" class="headerlink" title="2. Swagger ä»‹ç»"></a>2. Swagger ä»‹ç»</h2><p><img src="/assets/image-20191125225207292.png" alt="swagger"></p><p>å¾ˆå¤šäººéƒ½ä»¥ä¸º <code>Swagger</code> åªæ˜¯ä¸€ä¸ªæ¥å£æ–‡æ¡£ç”Ÿæˆæ¡†æ¶ï¼Œå…¶å®å¹¶ä¸æ˜¯ã€‚ Swagger  æ˜¯ä¸€ä¸ªå›´ç»•ç€ <code>OpenAPI Specification</code>ï¼ˆOASï¼Œä¸­æ–‡ä¹Ÿç§° OpenAPIè§„èŒƒï¼‰æ„å»ºçš„ä¸€ç»„å¼€æºå·¥å…·ã€‚å¯ä»¥å¸®åŠ©ä½ ä» API çš„è®¾è®¡åˆ° API æ–‡æ¡£çš„è¾“å‡ºå†åˆ°  API çš„æµ‹è¯•ï¼Œç›´è‡³æœ€åçš„ API éƒ¨ç½²ç­‰æ•´ä¸ª API çš„å¼€å‘å‘¨æœŸæä¾›ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œæ˜¯ä¸€ä¸ªåºå¤§çš„é¡¹ç›®ã€‚ Swagger  ä¸ä»…å…è´¹ï¼Œè€Œä¸”å¼€æºï¼Œä¸ç®¡ä½ æ˜¯ä¼ä¸šç”¨æˆ·è¿˜æ˜¯ä¸ªäººç©å®¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ Swagger æä¾›çš„æ–¹æ¡ˆæ„å»ºä»¤äººæƒŠè‰³çš„ <code>REST API</code>ã€‚</p><p>Swagger æœ‰å‡ ä¸ªä¸»è¦çš„äº§å“ã€‚</p><ul><li><a href="http://editor.swagger.io/?_ga=2.112541447.2078165713.1574600445-3923049.1574128700" target="_blank" rel="noopener">Swagger Editor</a> â€“ ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„ Open API è§„èŒƒç¼–è¾‘å™¨ã€‚</li><li><a href="https://swagger.io/swagger-ui/" target="_blank" rel="noopener">Swagger UI</a> â€“ ä¸€ä¸ªå°† OpenAPI è§„èŒƒå‘ˆç°ä¸ºå¯äº¤äº’åœ¨çº¿æ–‡æ¡£çš„å·¥å…·ã€‚</li><li><a href="https://github.com/swagger-api/swagger-codegen" target="_blank" rel="noopener">Swagger Codegen</a> â€“ ä¸€ä¸ªæ ¹æ® OpenAPI ç”Ÿæˆè°ƒç”¨ä»£ç çš„å·¥å…·ã€‚</li></ul><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥è®¿é—® Swagger å®˜æ–¹ç½‘ç«™ <a href="https://swagger.io" target="_blank" rel="noopener">https://swagger.io</a>ã€‚</p><h2 id="3-Springfox-ä»‹ç»"><a href="#3-Springfox-ä»‹ç»" class="headerlink" title="3. Springfox ä»‹ç»"></a>3. Springfox ä»‹ç»</h2><p>æºäº Java ä¸­ Spring æ¡†æ¶çš„æµè¡Œï¼Œè®©ä¸€ä¸ªå«åš  Marrty Pitt çš„è€å¤–æœ‰äº†ä¸º SpringMVC æ·»åŠ æ¥å£æè¿°çš„æƒ³æ³•ï¼Œå› æ­¤ä»–åˆ›å»ºäº†ä¸€ä¸ªéµå®ˆ OpenAPI è§„èŒƒï¼ˆOASï¼‰çš„é¡¹ç›®ï¼Œå–åä¸º <em>swagger-springmvc</em>ï¼Œè¿™ä¸ªé¡¹ç›®å¯ä»¥è®© Spring é¡¹ç›®è‡ªåŠ¨ç”Ÿæˆ JSON æ ¼å¼çš„ OpenAPI æ–‡æ¡£ã€‚è¿™ä¸ªæ¡†æ¶ä¹Ÿä»¿ç…§äº† Spring é¡¹ç›®çš„å¼€å‘ä¹ æƒ¯ï¼Œä½¿ç”¨æ³¨è§£æ¥è¿›è¡Œä¿¡æ¯é…ç½®ã€‚</p><p>åæ¥è¿™ä¸ªé¡¹ç›®å‘å±•æˆä¸º <code>Springfox</code>ï¼Œå†åæ¥æ‰©å±•å‡º <code>springfox-swagger2</code> ï¼Œä¸ºäº†è®© JSON æ ¼å¼çš„ API æ–‡æ¡£æ›´å¥½çš„å‘ˆç°ï¼Œåˆå‡ºç°äº† <code>springfox-swagger-ui</code> ç”¨æ¥å±•ç¤ºå’Œæµ‹è¯•ç”Ÿæˆçš„ OpenAPI ã€‚è¿™é‡Œçš„ springfox-swagger-ui å…¶å®å°±æ˜¯ä¸Šé¢ä»‹ç»çš„ Swagger-uiï¼Œåªæ˜¯å®ƒè¢«é€šè¿‡ webjar çš„æ–¹å¼æ‰“åŒ…åˆ° jar åŒ…å†…ï¼Œå¹¶é€šè¿‡ maven çš„æ–¹å¼å¼•å…¥è¿›æ¥ã€‚ </p><p>ä¸Šé¢æåˆ°äº† Springfox-swagger2 ä¹Ÿæ˜¯é€šè¿‡æ³¨è§£è¿›è¡Œä¿¡æ¯é…ç½®çš„ï¼Œé‚£ä¹ˆæ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿä¸‹é¢åˆ—ä¸¾å¸¸ç”¨çš„ä¸€äº›æ³¨è§£ï¼Œè¿™äº›æ³¨è§£åœ¨ä¸‹é¢çš„ Springboot æ•´åˆ Swagger ä¸­ä¼šç”¨åˆ°ã€‚</p><table><thead><tr><th>æ³¨è§£</th><th>ç¤ºä¾‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>@ApiModel</td><td>@ApiModel(value = â€œç”¨æˆ·å¯¹è±¡â€)</td><td>æè¿°ä¸€ä¸ªå®ä½“å¯¹è±¡</td></tr><tr><td>@ApiModelProperty</td><td>@ApiModelProperty(value = â€œç”¨æˆ·IDâ€, required = true, example = â€œ1000â€)</td><td>æè¿°å±æ€§ä¿¡æ¯ï¼Œæ‰§è¡Œæè¿°ï¼Œæ˜¯å¦å¿…é¡»ï¼Œç»™å‡ºç¤ºä¾‹</td></tr><tr><td>@Api</td><td>@Api(value = â€œç”¨æˆ·æ“ä½œ API(v1)â€, tags = â€œç”¨æˆ·æ“ä½œæ¥å£â€)</td><td>ç”¨åœ¨æ¥å£ç±»ä¸Šï¼Œä¸ºæ¥å£ç±»æ·»åŠ æè¿°</td></tr><tr><td>@ApiOperation</td><td>@ApiOperation(value = â€œæ–°å¢ç”¨æˆ·â€)</td><td>æè¿°ç±»çš„ä¸€ä¸ªæ–¹æ³•æˆ–è€…è¯´ä¸€ä¸ªæ¥å£</td></tr><tr><td>@ApiParam</td><td>@ApiParam(value = â€œç”¨æˆ·åâ€, required = true)</td><td>æè¿°å•ä¸ªå‚æ•°</td><td></td></tr></tbody></table><p>æ›´å¤šçš„ Springfox ä»‹ç»ï¼Œå¯ä»¥è®¿é—® Springfox å®˜æ–¹ç½‘ç«™ã€‚</p><p><a href="http://springfox.github.io/springfox/docs/current/" target="_blank" rel="noopener">Springfox Reference Documentation (http://springfox.github.io)</a></p><h2 id="4-Springboot-æ•´åˆ-Swagger"><a href="#4-Springboot-æ•´åˆ-Swagger" class="headerlink" title="4. Springboot æ•´åˆ Swagger"></a>4. Springboot æ•´åˆ Swagger</h2><p>å°±ç›®å‰æ¥è¯´ ï¼ŒSpringboot æ¡†æ¶æ˜¯éå¸¸æµè¡Œçš„å¾®æœåŠ¡æ¡†æ¶ï¼Œåœ¨å¾®æœåŠ¡æ¡†æ¶ä¸‹ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½æ˜¯ç›´æ¥æä¾› <code>REST API</code> çš„ã€‚REST API å¦‚æœæ²¡æœ‰æ–‡æ¡£çš„è¯ï¼Œä½¿ç”¨è€…å°±å¾ˆå¤´ç–¼äº†ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œä¸Šé¢è¯´äº†æœ‰ä¸€ä½å« Marrty Pitt çš„è€å¤–å·²ç»åˆ›å»ºäº†ä¸€ä¸ªå‘å±•æˆä¸º Springfox çš„é¡¹ç›®ï¼Œå¯ä»¥æ–¹ä¾¿çš„æä¾› JSON æ ¼å¼çš„ OpenAPI è§„èŒƒå’Œæ–‡æ¡£æ”¯æŒã€‚ä¸”æ‰©å±•å‡ºäº† springfox-swagger-ui ç”¨äºé¡µé¢çš„å±•ç¤ºã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ‰€è°“çš„ Swagger å…¶å®å’ŒçœŸæ­£çš„ Swagger å¹¶ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ Springfox æä¾›çš„ Swagger å®ç°ã€‚å®ƒä»¬éƒ½æ˜¯åŸºäº OpenAPI è§„èŒƒè¿›è¡Œ API æ„å»ºã€‚æ‰€ä»¥ä¹Ÿéƒ½å¯ä»¥ Swagger-ui è¿›è¡Œ API çš„é¡µé¢å‘ˆç°ã€‚</p><h3 id="4-1-åˆ›å»ºé¡¹ç›®"><a href="#4-1-åˆ›å»ºé¡¹ç›®" class="headerlink" title="4.1. åˆ›å»ºé¡¹ç›®"></a>4.1. åˆ›å»ºé¡¹ç›®</h3><p>å¦‚ä½•åˆ›å»ºä¸€ä¸ª Springboot é¡¹ç›®è¿™é‡Œä¸æï¼Œä½ å¯ä»¥ç›´æ¥ä» <a href="https://start.spring.io/" target="_blank" rel="noopener">Springboot å®˜æ–¹</a> ä¸‹è½½ä¸€ä¸ªæ ‡å‡†é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ idea å¿«é€Ÿåˆ›å»ºä¸€ä¸ª Springboot é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥é¡ºä¾¿æ‹·è´ä¸€ä¸ª Springboot é¡¹ç›®è¿‡æ¥æµ‹è¯•ï¼Œæ€»ä¹‹ï¼Œæ–¹å¼å¤šç§å¤šæ ·ï¼Œä»»ä½ é€‰æ‹©ã€‚</p><p>ä¸‹é¢æ¼”ç¤ºå¦‚ä½•åœ¨ Springboot é¡¹ç›®ä¸­ä½¿ç”¨ swagger2ã€‚</p><h3 id="4-2-å¼•å…¥ä¾èµ–"><a href="#4-2-å¼•å…¥ä¾èµ–" class="headerlink" title="4.2. å¼•å…¥ä¾èµ–"></a>4.2. å¼•å…¥ä¾èµ–</h3><p>è¿™é‡Œä¸»è¦æ˜¯å¼•å…¥äº† springfox-swagger2ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£ç”Ÿæˆ JSON æ ¼å¼çš„ OpenAPI æ¥å£æ–‡æ¡£ï¼Œç„¶åç”±äº Springfox éœ€è¦ä¾èµ– jacksonï¼Œæ‰€ä»¥å¼•å…¥ä¹‹ã€‚springfox-swagger-ui å¯ä»¥æŠŠç”Ÿæˆçš„ OpenAPI æ¥å£æ–‡æ¡£æ˜¾ç¤ºä¸ºé¡µé¢ã€‚Lombok çš„å¼•å…¥å¯ä»¥é€šè¿‡æ³¨è§£ä¸ºå®ä½“ç±»ç”Ÿæˆ get/set æ–¹æ³•ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥swagger2çš„ä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- jacksonç›¸å…³ä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-3-é…ç½®-Springfox-swagger"><a href="#4-3-é…ç½®-Springfox-swagger" class="headerlink" title="4.3. é…ç½® Springfox-swagger"></a>4.3. é…ç½® Springfox-swagger</h3><p>Springfox-swagger çš„é…ç½®é€šè¿‡ä¸€ä¸ª Docket æ¥åŒ…è£…ï¼ŒDocket é‡Œçš„ apiInfo æ–¹æ³•å¯ä»¥ä¼ å…¥å…³äºæ¥å£æ€»ä½“çš„æè¿°ä¿¡æ¯ã€‚è€Œ apis æ–¹æ³•å¯ä»¥æŒ‡å®šè¦æ‰«æçš„åŒ…çš„å…·ä½“è·¯å¾„ã€‚åœ¨ç±»ä¸Šæ·»åŠ  @Configuration å£°æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œæœ€åä½¿ç”¨ @EnableSwagger2 å¼€å¯ Springfox-swagger2ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Springfox-swagger2 é…ç½®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/11/19 23:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger</span>2</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">createRestApi</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">"net.codingme.boot.controller"</span>))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">"æœªè¯»ä»£ç  API"</span>)</span><br><span class="line">                .description(<span class="string">"å…¬ä¼—å·ï¼šæœªè¯»ä»£ç (weidudaima) springboot-swagger2 åœ¨çº¿å€Ÿå£æ–‡æ¡£"</span>)</span><br><span class="line">                .termsOfServiceUrl(<span class="string">"https://www.codingme.net"</span>)</span><br><span class="line">                .contact(<span class="string">"è¾¾è¥¿å‘€"</span>)</span><br><span class="line">                .version(<span class="string">"1.0"</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-4-ä»£ç ç¼–å†™"><a href="#4-4-ä»£ç ç¼–å†™" class="headerlink" title="4.4. ä»£ç ç¼–å†™"></a>4.4. ä»£ç ç¼–å†™</h3><p>æ–‡ç« ä¸ä¼šæŠŠæ‰€æœ‰ä»£ç ä¸€ä¸€åˆ—å‡ºæ¥ï¼Œè¿™æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œæ‰€ä»¥åªè´´å‡ºä¸»è¦ä»£ç ï¼Œå®Œæ•´ä»£ç ä¼šä¸Šä¼ åˆ° Githubï¼Œå¹¶åœ¨æ–‡ç« åº•éƒ¨é™„ä¸Š Github é“¾æ¥ã€‚</p><p>å‚æ•°å®ä½“ç±» <code>User.java</code>ï¼Œä½¿ç”¨ <code>@ApiModel</code> å’Œ <code>@ApiModelProperty</code> æè¿°å‚æ•°å¯¹è±¡ï¼Œä½¿ç”¨ <code>@NotNull</code> è¿›è¡Œæ•°æ®æ ¡éªŒï¼Œä½¿ç”¨ <code>@Data</code> ä¸ºå‚æ•°å®ä½“ç±»è‡ªåŠ¨ç”Ÿæˆ get/set æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å®ä½“ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/19 17:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@ApiModel</span>(value = <span class="string">"ç”¨æˆ·å¯¹è±¡"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ID</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Id</span> ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@GeneratedValue</span> è‡ªå¢ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ· ID ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·ID"</span>, required = <span class="keyword">true</span>, example = <span class="string">"1000"</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·å"</span>, required = <span class="keyword">true</span>)</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"å¯†ç ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·å¯†ç "</span>, required = <span class="keyword">true</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·å¹´é¾„"</span>, example = <span class="string">"18"</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæ—¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(pattern = <span class="string">"yyyy-MM-dd hh:mm:ss"</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·ç”Ÿæ—¥"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠ€èƒ½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·æŠ€èƒ½"</span>)</span><br><span class="line">    <span class="keyword">private</span> String skills;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™ Controller å±‚ï¼Œä½¿ç”¨ <code>@Api</code> æè¿°æ¥å£ç±»ï¼Œä½¿ç”¨ <code>@ApiOperation</code> æè¿°æ¥å£ï¼Œä½¿ç”¨ <code>@ApiParam</code> æè¿°æ¥å£å‚æ•°ã€‚ä»£ç ä¸­åœ¨æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„ä¸¤ä¸ªæ¥å£ä¸Šéƒ½æ·»åŠ äº† <code>tags = &quot;ç”¨æˆ·æŸ¥è¯¢&quot;</code> æ ‡è®°ï¼Œè¿™æ ·è¿™ä¸¤ä¸ªæ–¹æ³•åœ¨ç”Ÿæˆ Swagger æ¥å£æ–‡æ¡£æ—¶å€™ä¼šåˆ†åˆ°ä¸€ä¸ªå…±åŒçš„æ ‡ç­¾ç»„é‡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiParam;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Response;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.User;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.enums.ResponseEnum;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.utils.ResponseUtill;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.BindingResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Valid;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æ“ä½œ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/11/19 23:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RestController</span>(value = <span class="string">"/v1"</span>)</span><br><span class="line"><span class="meta">@Api</span>(value = <span class="string">"ç”¨æˆ·æ“ä½œ API(v1)"</span>, tags = <span class="string">"ç”¨æˆ·æ“ä½œæ¥å£"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(value = <span class="string">"æ–°å¢ç”¨æˆ·"</span>)</span><br><span class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/user"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">create</span><span class="params">(@Valid User user, BindingResult bindingResult)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (bindingResult.hasErrors()) &#123;</span><br><span class="line">            String message = bindingResult.getFieldError().getDefaultMessage();</span><br><span class="line">            log.info(message);</span><br><span class="line">            <span class="keyword">return</span> ResponseUtill.error(ResponseEnum.ERROR.getCode(), message);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ–°å¢ç”¨æˆ·ä¿¡æ¯ do something</span></span><br><span class="line">            <span class="keyword">return</span> ResponseUtill.success(<span class="string">"ç”¨æˆ·["</span> + user.getUsername() + <span class="string">"]ä¿¡æ¯å·²æ–°å¢"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(value = <span class="string">"åˆ é™¤ç”¨æˆ·"</span>)</span><br><span class="line">    <span class="meta">@DeleteMapping</span>(value = <span class="string">"/user/&#123;username&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">delete</span><span class="params">(@PathVariable(<span class="string">"username"</span>)</span></span></span><br><span class="line"><span class="function">                           @<span class="title">ApiParam</span><span class="params">(value = <span class="string">"ç”¨æˆ·å"</span>, required = <span class="keyword">true</span>)</span> String name) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ é™¤ç”¨æˆ·ä¿¡æ¯ do something</span></span><br><span class="line">        <span class="keyword">return</span> ResponseUtill.success(<span class="string">"ç”¨æˆ·["</span> + name + <span class="string">"]ä¿¡æ¯å·²åˆ é™¤"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(value = <span class="string">"ä¿®æ”¹ç”¨æˆ·"</span>)</span><br><span class="line">    <span class="meta">@PutMapping</span>(value = <span class="string">"/user"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">update</span><span class="params">(@Valid User user, BindingResult bindingResult)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (bindingResult.hasErrors()) &#123;</span><br><span class="line">            String message = bindingResult.getFieldError().getDefaultMessage();</span><br><span class="line">            log.info(message);</span><br><span class="line">            <span class="keyword">return</span> ResponseUtill.error(ResponseEnum.ERROR.getCode(), message);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            String username = user.getUsername();</span><br><span class="line">            <span class="keyword">return</span> ResponseUtill.success(<span class="string">"ç”¨æˆ·["</span> + username + <span class="string">"]ä¿¡æ¯å·²ä¿®æ”¹"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(value = <span class="string">"è·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯"</span>, tags = <span class="string">"ç”¨æˆ·æŸ¥è¯¢"</span>)</span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/user/&#123;username&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">get</span><span class="params">(@PathVariable(<span class="string">"username"</span>)</span></span></span><br><span class="line"><span class="function">                        @<span class="title">NotNull</span><span class="params">(message = <span class="string">"ç”¨æˆ·åç§°ä¸èƒ½ä¸ºç©º"</span>)</span></span></span><br><span class="line"><span class="function">                        @<span class="title">ApiParam</span><span class="params">(value = <span class="string">"ç”¨æˆ·å"</span>, required = <span class="keyword">true</span>)</span> String username) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ do something</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setId(<span class="number">10000</span>);</span><br><span class="line">        user.setUsername(username);</span><br><span class="line">        user.setAge(<span class="number">99</span>);</span><br><span class="line">        user.setSkills(<span class="string">"cnp"</span>);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtill.success(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(value = <span class="string">"è·å–ç”¨æˆ·åˆ—è¡¨"</span>, tags = <span class="string">"ç”¨æˆ·æŸ¥è¯¢"</span>)</span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/user"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">selectAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯åˆ—è¡¨ do something</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setId(<span class="number">10000</span>);</span><br><span class="line">        user.setUsername(<span class="string">"æœªè¯»ä»£ç "</span>);</span><br><span class="line">        user.setAge(<span class="number">99</span>);</span><br><span class="line">        user.setSkills(<span class="string">"cnp"</span>);</span><br><span class="line">        List&lt;User&gt; userList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        userList.add(user);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtill.success(userList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œä¸ºäº†è®©ä»£ç å˜å¾—æ›´åŠ ç¬¦åˆè§„èŒƒå’Œå¥½ç”¨ï¼Œä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ç±»è¿›è¡Œæ¥å£å“åº”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@ApiModel</span>(value = <span class="string">"å“åº”ä¿¡æ¯"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Response</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“åº”ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"å“åº”ç "</span>)</span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“åº”ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"å“åº”ä¿¡æ¯"</span>)</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“åº”æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"å“åº”æ•°æ®"</span>)</span><br><span class="line">    <span class="keyword">private</span> Collection content;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-5-è¿è¡Œè®¿é—®"><a href="#4-5-è¿è¡Œè®¿é—®" class="headerlink" title="4.5. è¿è¡Œè®¿é—®"></a>4.5. è¿è¡Œè®¿é—®</h3><p>ç›´æ¥å¯åŠ¨ Springboog é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºæ‰«æåˆ°çš„å„ä¸ªæ¥å£çš„è®¿é—®è·¯å¾„ï¼Œå…¶ä¸­å°±æœ‰ <code>/2/api-docs</code>ã€‚</p><p><img src="/assets/image-20191126000341030.png" alt="Springboot å¯åŠ¨"></p><p>è¿™ä¸ªä¹Ÿå°±æ˜¯ç”Ÿæˆçš„ OpenAPI è§„èŒƒçš„æè¿° JSON è®¿é—®è·¯å¾„ï¼Œè®¿é—®å¯ä»¥çœ‹åˆ°ã€‚</p><p><img src="/assets/image-20191126000613238.png" alt="OpenAPI - JSON"></p><p>å› ä¸ºä¸Šé¢æˆ‘ä»¬åœ¨å¼•å…¥ä¾èµ–æ—¶ï¼Œä¹Ÿå¼•å…¥äº† springfox-swagger-ui åŒ…ï¼Œæ‰€ä»¥è¿˜å¯ä»¥è®¿é—® API çš„é¡µé¢æ–‡æ¡£ã€‚è®¿é—®è·¯å¾„æ˜¯ /swagger-ui.htmlï¼Œè®¿é—®çœ‹åˆ°çš„æ•ˆæœå¯ä»¥çœ‹ä¸‹å›¾ã€‚</p><p><img src="/assets/image-20191126000808167.png" alt="swagger è®¿é—®"></p><p>ä¹Ÿå¯ä»¥çœ‹åˆ°ç”¨æˆ·æŸ¥è¯¢çš„ä¸¤ä¸ªæ–¹æ³•ä¼šå½’åˆ°äº†ä¸€èµ·ï¼ŒåŸå› å°±æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•çš„æ³¨è§£ä¸Šä½¿ç”¨ç›¸åŒçš„ tag å±æ€§ã€‚</p><h3 id="4-7-è°ƒç”¨æµ‹è¯•"><a href="#4-7-è°ƒç”¨æµ‹è¯•" class="headerlink" title="4.7. è°ƒç”¨æµ‹è¯•"></a>4.7. è°ƒç”¨æµ‹è¯•</h3><p>springfox-swagger-ui ä¸ä»…æ˜¯ç”Ÿæˆäº† API æ–‡æ¡£ï¼Œè¿˜æä¾›äº†è°ƒç”¨æµ‹è¯•åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯åœ¨é¡µé¢ä¸Šæµ‹è¯•è·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯çš„è¿‡ç¨‹ã€‚</p><ol><li>ç‚¹å‡»æ¥å£ [/user/{username}] è·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯ã€‚</li><li>ç‚¹å‡» <code>**Try it out**</code> è¿›å…¥æµ‹è¯•ä¼ å‚é¡µé¢ã€‚</li><li>è¾“å…¥å‚æ•°ï¼Œç‚¹å‡» <strong>Execute</strong> è“è‰²æŒ‰é’®æ‰§è¡Œè°ƒç”¨ã€‚</li><li>æŸ¥çœ‹è¿”å›ä¿¡æ¯ã€‚</li></ol><p>ä¸‹é¢æ˜¯æµ‹è¯•æ—¶çš„å“åº”æˆªå›¾ã€‚</p><p><img src="/assets/image-20191126001337387.png" alt="swagger æµ‹è¯•"></p><h2 id="5-å¸¸è§æŠ¥é”™"><a href="#5-å¸¸è§æŠ¥é”™" class="headerlink" title="5. å¸¸è§æŠ¥é”™"></a>5. å¸¸è§æŠ¥é”™</h2><p>å¦‚æœä½ åœ¨ç¨‹åºè¿è¡Œä¸­ç»å¸¸å‘ç°åƒä¸‹é¢è¿™æ ·çš„æŠ¥é”™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">java.lang.NumberFormatException: For input string: &quot;&quot;</span><br><span class="line">at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65) ~[na:1.8.0_111]</span><br><span class="line">at java.lang.Long.parseLong(Long.java:601) ~[na:1.8.0_111]</span><br><span class="line">at java.lang.Long.valueOf(Long.java:803) ~[na:1.8.0_111]</span><br><span class="line">at io.swagger.models.parameters.AbstractSerializableParameter.getExample(AbstractSerializableParameter.java:412) ~[swagger-models-1.5.20.jar:1.5.20]</span><br><span class="line">at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_111]</span><br><span class="line">at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_111]</span><br><span class="line">at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_111]</span><br><span class="line">at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_111]</span><br><span class="line">at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:536) [jackson-databind-2.5.4.jar:2.5.4]</span><br><span class="line">at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:666) [jackson-databind-2.5.4.jar:2.5.4]</span><br><span class="line">at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:156) [jackson-databind-2.5.4.jar:2.5.4]</span><br><span class="line">at com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:113) [jackson-databind-2.5.4.jar:2.5.4]</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆä½ éœ€è¦æ£€æŸ¥ä½¿ç”¨äº† <code>@ApiModelProperty</code> æ³¨è§£ä¸”å­—æ®µç±»å‹ä¸ºæ•°å­—ç±»å‹çš„å±æ€§ä¸Šï¼Œ<code>@ApiModelProperty</code> æ³¨è§£æ˜¯å¦è®¾ç½®äº† example å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£å°±éœ€è¦è®¾ç½®ä¸€ä¸‹ï¼Œåƒä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ· ID ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line"><span class="meta">@ApiModelProperty</span>(value = <span class="string">"ç”¨æˆ·ID"</span>, required = <span class="keyword">true</span>, example = <span class="string">"1000"</span>)</span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br></pre></td></tr></table></figure><p>æ–‡ä¸­ä»£ç éƒ½å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/niumoo/springboot" target="_blank" rel="noopener"> https://github.com/niumoo/springboot </a></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md" target="_blank" rel="noopener">OpenAPI Specification</a></li><li><a href="https://swagger.io/docs/specification/about/" target="_blank" rel="noopener">Swagger Documentation</a></li><li><a href="http://springfox.github.io/springfox/docs/current/" target="_blank" rel="noopener">Springfox Reference Documentation</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç›®å‰æ¥è¯´ï¼Œåœ¨ Java é¢†åŸŸä½¿ç”¨ &lt;code&gt;Springboot&lt;/code&gt; æ„å»ºå¾®æœåŠ¡æ˜¯æ¯”è¾ƒæµè¡Œçš„ï¼Œåœ¨æ„å»ºå¾®æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬å¤§å¤šæ•°ä¼šé€‰æ‹©æš´æ¼ä¸€ä¸ª &lt;code&gt;REST API&lt;/code&gt; ä»¥ä¾›è°ƒç”¨ã€‚åˆæˆ–è€…å…¬å¸é‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œè®©å‰ç«¯å’Œåç«¯çš„å·¥ä½œç”±å®Œå…¨ä¸åŒçš„å·¥ç¨‹å¸ˆè¿›è¡Œå¼€å‘å®Œæˆã€‚ä¸ç®¡æ˜¯å¾®æœåŠ¡è¿˜æ˜¯è¿™ç§å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œç»´æŒä¸€ä»½å®Œæ•´çš„åŠæ—¶æ›´æ–°çš„ &lt;code&gt;REST API&lt;/code&gt; æ–‡æ¡£ï¼Œä¼šæå¤§çš„æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚è€Œä¼ ç»Ÿçš„æ–‡æ¡£æ›´æ–°æ–¹å¼ï¼ˆå¦‚æ‰‹åŠ¨ç¼–å†™ï¼‰ï¼Œå¾ˆéš¾ä¿è¯æ–‡æ¡£çš„åŠæ—¶æ€§ï¼Œç»å¸¸ä¼šå¹´ä¹…å¤±ä¿®ï¼Œå¤±å»åº”æœ‰çš„æ„ä¹‰ã€‚å› æ­¤é€‰æ‹©ä¸€ç§æ–°çš„ API æ–‡æ¡£ç»´æŠ¤æ–¹å¼å¾ˆæœ‰å¿…è¦ï¼Œè¿™ä¹Ÿæ˜¯è¿™ç¯‡æ–‡ç« è¦ä»‹ç»çš„å†…å®¹ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="swagger" scheme="https://www.codingme.net/tags/swagger/"/>
    
  </entry>
  
  <entry>
    <title>è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼Ÿè¶…å¼ºçš„ Stream æµæ“ä½œå§¿åŠ¿è¿˜ä¸å­¦ä¹ ä¸€ä¸‹</title>
    <link href="https://www.codingme.net/2019/11/jdk/jdk8-stream/"/>
    <id>https://www.codingme.net/2019/11/jdk/jdk8-stream/</id>
    <published>2019-11-18T01:00:00.000Z</published>
    <updated>2020-02-18T14:36:54.266Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/assets/jdk8-stream/java-streams.png" alt="java-streams"></p><p>Java 8 æ–°ç‰¹æ€§ç³»åˆ—æ–‡ç« ç´¢å¼•ã€‚</p><ol><li><a href="http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483879&amp;idx=1&amp;sn=1eb37f5a97fda31ebb9d80d6e96cfb88&amp;chksm=e984e883def361957df3a954b0f28775404b5f0a278958e91c65b3f3175a37f5384b0988c564&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">Jdk14éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ</a> </li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483801&amp;idx=1&amp;sn=eea69b039feb1ae86187ade222e6bfd8&amp;chksm=e984e8fddef361ebd4acc58e11f3ccdeea9b06b6514957a5c203d52046c551f3ea3203d187e9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk8 çš„æ—¶é—´å¤„ç†å§¿åŠ¿è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ</a> </li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483923&amp;idx=1&amp;sn=57c720a9ba7dbd79e84a069e0d6fa84f&amp;chksm=e984eb77def36261de6f0b9edd8aaa9ef34f74f90c08e6d395880545b6bf1a7b054ecdbff483#rd" target="_blank" rel="noopener">è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹</a> </li></ol><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ <code>Lambda</code> å’Œ Stream æ˜¯ Java 8 çš„ä¸¤å¤§äº®ç‚¹åŠŸèƒ½ï¼Œåœ¨å‰é¢çš„æ–‡ç« é‡Œå·²ç»ä»‹ç»è¿‡ <code>Lambda</code> ç›¸å…³çŸ¥è¯†ï¼Œè¿™æ¬¡ä»‹ç»ä¸‹ Java 8 çš„ Stream æµæ“ä½œã€‚å®ƒå®Œå…¨ä¸åŒäº java.io åŒ…çš„ Input/Output Stream ï¼Œä¹Ÿä¸æ˜¯å¤§æ•°æ®å®æ—¶å¤„ç†çš„ Stream æµã€‚è¿™ä¸ª Stream æµæ“ä½œæ˜¯ Java 8 å¯¹é›†åˆæ“ä½œåŠŸèƒ½çš„å¢å¼ºï¼Œä¸“æ³¨äºå¯¹é›†åˆçš„å„ç§é«˜æ•ˆã€ä¾¿åˆ©ã€ä¼˜é›…çš„<strong>èšåˆæ“ä½œ</strong>ã€‚å€ŸåŠ©äº <code>Lambda</code> è¡¨è¾¾å¼ï¼Œæ˜¾è‘—çš„æé«˜<strong>ç¼–ç¨‹æ•ˆç‡</strong>å’Œ<strong>å¯è¯»æ€§</strong>ã€‚ä¸” Stream æä¾›äº†<strong>å¹¶è¡Œè®¡ç®—</strong>æ¨¡å¼ï¼Œå¯ä»¥ç®€æ´çš„ç¼–å†™å‡ºå¹¶è¡Œä»£ç ï¼Œèƒ½å……åˆ†å‘æŒ¥å¦‚ä»Šè®¡ç®—æœºçš„å¤šæ ¸å¤„ç†ä¼˜åŠ¿ã€‚</p><a id="more"></a><p>åœ¨ä½¿ç”¨ Stream æµæ“ä½œä¹‹å‰ä½ åº”è¯¥å…ˆäº†è§£ <code>Lambda</code> ç›¸å…³çŸ¥è¯†ï¼Œå¦‚æœè¿˜ä¸äº†è§£ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰æ–‡ç« ï¼š<a href="http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483923&amp;idx=1&amp;sn=57c720a9ba7dbd79e84a069e0d6fa84f&amp;chksm=e984eb77def36261de6f0b9edd8aaa9ef34f74f90c08e6d395880545b6bf1a7b054ecdbff483#rd" target="_blank" rel="noopener">è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹</a> ã€‚</p><h2 id="1-Stream-æµä»‹ç»"><a href="#1-Stream-æµä»‹ç»" class="headerlink" title="1. Stream æµä»‹ç»"></a>1. Stream æµä»‹ç»</h2><p>Stream ä¸åŒäºå…¶ä»–é›†åˆæ¡†æ¶ï¼Œå®ƒä¹Ÿä¸æ˜¯æŸç§æ•°æ®ç»“æ„ï¼Œä¹Ÿä¸ä¼šä¿å­˜æ•°æ®ï¼Œä½†æ˜¯å®ƒè´Ÿè´£ç›¸å…³è®¡ç®—ï¼Œä½¿ç”¨èµ·æ¥æ›´åƒä¸€ä¸ªé«˜çº§çš„è¿­ä»£å™¨ã€‚åœ¨ä¹‹å‰çš„è¿­ä»£å™¨ä¸­ï¼Œæˆ‘ä»¬åªèƒ½å…ˆéå†ç„¶ååœ¨æ‰§è¡Œä¸šåŠ¡æ“ä½œï¼Œè€Œç°åœ¨åªéœ€è¦æŒ‡å®šæ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œ Stream å°±ä¼šéšå¼çš„éå†ç„¶ååšå‡ºæƒ³è¦çš„æ“ä½œã€‚å¦å¤– Stream å’Œè¿­ä»£å™¨ä¸€æ ·çš„åªèƒ½å•å‘å¤„ç†ï¼Œå¦‚åŒå¥”è…¾é•¿æ±Ÿä¹‹æ°´ä¸€å»è€Œä¸å¤è¿”ã€‚ </p><p>ç”±äº Stream æµæä¾›äº†<strong>æƒ°æ€§è®¡ç®—</strong>å’Œ<strong>å¹¶è¡Œå¤„ç†</strong>çš„èƒ½åŠ›ï¼Œåœ¨ä½¿ç”¨å¹¶è¡Œè®¡ç®—æ–¹å¼æ—¶æ•°æ®ä¼šè¢«è‡ªåŠ¨åˆ†è§£æˆå¤šæ®µç„¶åå¹¶è¡Œå¤„ç†ï¼Œæœ€åå°†ç»“æœæ±‡æ€»ã€‚æ‰€ä»¥ Stream æ“ä½œå¯ä»¥è®©ç¨‹åºè¿è¡Œå˜å¾—æ›´åŠ é«˜æ•ˆã€‚</p><h2 id="2-Stream-æµæ¦‚å¿µ"><a href="#2-Stream-æµæ¦‚å¿µ" class="headerlink" title="2. Stream æµæ¦‚å¿µ"></a>2. Stream æµæ¦‚å¿µ</h2><p>Stream æµçš„ä½¿ç”¨æ€»æ˜¯æŒ‰ç…§ä¸€å®šçš„æ­¥éª¤è¿›è¡Œï¼Œå¯ä»¥æŠ½è±¡å‡ºä¸‹é¢çš„ä½¿ç”¨æµç¨‹ã€‚</p><blockquote><p>æ•°æ®æºï¼ˆsourceï¼‰ -&gt; æ•°æ®å¤„ç†/è½¬æ¢ï¼ˆintermediaï¼‰ -&gt; ç»“æœå¤„ç†ï¼ˆterminal ï¼‰</p></blockquote><h3 id="2-1-æ•°æ®æº"><a href="#2-1-æ•°æ®æº" class="headerlink" title="2.1. æ•°æ®æº"></a>2.1. æ•°æ®æº</h3><p><code>æ•°æ®æºï¼ˆsourceï¼‰</code>ä¹Ÿå°±æ˜¯æ•°æ®çš„æ¥æºï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼è·å¾— Stream æ•°æ®æºï¼Œä¸‹é¢åˆ—ä¸¾å‡ ç§å¸¸è§çš„è·å–æ–¹å¼ã€‚</p><ul><li>Collection.stream();  ä»é›†åˆè·å–æµã€‚</li><li>Collection.parallelStream();  ä»é›†åˆè·å–<strong>å¹¶è¡Œæµã€‚</strong></li><li>Arrays.stream(T array) or Stream.of(); ä»æ•°ç»„è·å–æµã€‚</li><li>BufferedReader.lines(); ä»è¾“å…¥æµä¸­è·å–æµã€‚</li><li>IntStream.of() ; ä»é™æ€æ–¹æ³•ä¸­è·å–æµã€‚</li><li>Stream.generate(); è‡ªå·±ç”Ÿæˆæµ</li></ul><h3 id="2-2-æ•°æ®å¤„ç†"><a href="#2-2-æ•°æ®å¤„ç†" class="headerlink" title="2.2. æ•°æ®å¤„ç†"></a>2.2. æ•°æ®å¤„ç†</h3><p><code>æ•°æ®å¤„ç†/è½¬æ¢ï¼ˆintermediaï¼‰</code>æ­¥éª¤å¯ä»¥æœ‰å¤šä¸ªæ“ä½œï¼Œè¿™æ­¥ä¹Ÿè¢«ç§°ä¸º<code>intermedia</code>ï¼ˆä¸­é—´æ“ä½œï¼‰ã€‚åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ä¸ç®¡æ€æ ·æ“ä½œï¼Œå®ƒè¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªæ–°çš„æµå¯¹è±¡ï¼ŒåŸå§‹æ•°æ®ä¸ä¼šå‘ç”Ÿä»»ä½•æ”¹å˜ï¼Œè€Œä¸”è¿™ä¸ªæ­¥éª¤æ˜¯<code>æƒ°æ€§è®¡ç®—</code>å¤„ç†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªè°ƒç”¨æ–¹æ³•å¹¶ä¸ä¼šå¼€å§‹å¤„ç†ï¼Œåªæœ‰åœ¨çœŸæ­£çš„å¼€å§‹æ”¶é›†ç»“æœæ—¶ï¼Œä¸­é—´æ“ä½œæ‰ä¼šç”Ÿæ•ˆï¼Œè€Œä¸”å¦‚æœéå†æ²¡æœ‰å®Œæˆï¼Œæƒ³è¦çš„ç»“æœå·²ç»è·å–åˆ°äº†ï¼ˆæ¯”å¦‚è·å–ç¬¬ä¸€ä¸ªå€¼ï¼‰ï¼Œä¼šåœæ­¢éå†ï¼Œç„¶åè¿”å›ç»“æœã€‚<code>æƒ°æ€§è®¡ç®—</code>å¯ä»¥æ˜¾è‘—æé«˜è¿è¡Œæ•ˆç‡ã€‚</p><p>æ•°æ®å¤„ç†æ¼”ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">streamDemo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;String&gt; nameList = Arrays.asList(<span class="string">"Darcy"</span>, <span class="string">"Chris"</span>, <span class="string">"Linda"</span>, <span class="string">"Sid"</span>, <span class="string">"Kim"</span>, <span class="string">"Jack"</span>, <span class="string">"Poul"</span>, <span class="string">"Peter"</span>);</span><br><span class="line">    <span class="comment">// 1. ç­›é€‰å‡ºåå­—é•¿åº¦ä¸º4çš„</span></span><br><span class="line">    <span class="comment">// 2. åå­—å‰é¢æ‹¼æ¥ This is</span></span><br><span class="line">    <span class="comment">// 3. éå†è¾“å‡º</span></span><br><span class="line">    nameList.stream()</span><br><span class="line">            .filter(name -&gt; name.length() == <span class="number">4</span>)</span><br><span class="line">            .map(name -&gt; <span class="string">"This is "</span>+name)</span><br><span class="line">            .forEach(name -&gt; System.out.println(name));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// This is Jack</span></span><br><span class="line"><span class="comment">// This is Poul</span></span><br></pre></td></tr></table></figure><p><code>æ•°æ®å¤„ç†/è½¬æ¢</code>æ“ä½œè‡ªç„¶ä¸æ­¢æ˜¯ä¸Šé¢æ¼”ç¤ºçš„è¿‡æ»¤ <code>filter</code> å’Œ <code>map</code>æ˜ å°„ä¸¤ç§ï¼Œå¦å¤–è¿˜æœ‰ map (mapToInt, flatMap ç­‰)ã€ filterã€ distinctã€ sortedã€ peekã€ limitã€ skipã€ parallelã€ sequentialã€ unordered ç­‰ã€‚</p><h3 id="2-3-æ”¶é›†ç»“æœ"><a href="#2-3-æ”¶é›†ç»“æœ" class="headerlink" title="2.3. æ”¶é›†ç»“æœ"></a>2.3. æ”¶é›†ç»“æœ</h3><p><code>ç»“æœå¤„ç†ï¼ˆterminal ï¼‰</code>æ˜¯æµå¤„ç†çš„æœ€åä¸€æ­¥ï¼Œæ‰§è¡Œå®Œè¿™ä¸€æ­¥ä¹‹åæµä¼šè¢«å½»åº•ç”¨å°½ï¼Œæµä¹Ÿä¸èƒ½ç»§ç»­æ“ä½œäº†ã€‚ä¹Ÿåªæœ‰åˆ°äº†è¿™ä¸ªæ“ä½œçš„æ—¶å€™ï¼Œæµçš„<code>æ•°æ®å¤„ç†/è½¬æ¢</code>ç­‰ä¸­é—´è¿‡ç¨‹æ‰ä¼šå¼€å§‹è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ‰€è¯´çš„<code>æƒ°æ€§è®¡ç®—</code>ã€‚<code>ç»“æœå¤„ç†</code>ä¹Ÿå¿…å®šæ˜¯æµæ“ä½œçš„æœ€åä¸€æ­¥ã€‚</p><p>å¸¸è§çš„<code>ç»“æœå¤„ç†</code>æ“ä½œæœ‰ forEachã€ forEachOrderedã€ toArrayã€ reduceã€ collectã€ minã€ maxã€ countã€ anyMatchã€ allMatchã€ noneMatchã€ findFirstã€ findAnyã€ iterator ç­‰ã€‚</p><p>ä¸‹é¢æ¼”ç¤ºäº†ç®€å•çš„<code>ç»“æœå¤„ç†</code>çš„ä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è½¬æ¢æˆä¸ºå¤§å†™ç„¶åæ”¶é›†ç»“æœï¼Œéå†è¾“å‡º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toUpperCaseDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; nameList = Arrays.asList(<span class="string">"Darcy"</span>, <span class="string">"Chris"</span>, <span class="string">"Linda"</span>, <span class="string">"Sid"</span>, <span class="string">"Kim"</span>, <span class="string">"Jack"</span>, <span class="string">"Poul"</span>, <span class="string">"Peter"</span>);</span><br><span class="line">    List&lt;String&gt; upperCaseNameList = nameList.stream()</span><br><span class="line">            .map(String::toUpperCase)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    upperCaseNameList.forEach(name -&gt; System.out.println(name + <span class="string">","</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// DARCY,CHRIS,LINDA,SID,KIM,JACK,POUL,PETER,</span></span><br></pre></td></tr></table></figure><h3 id="2-4-short-circuiting"><a href="#2-4-short-circuiting" class="headerlink" title="2.4. short-circuiting"></a>2.4. short-circuiting</h3><p>æœ‰ä¸€ç§ Stream æ“ä½œè¢«ç§°ä½œ <code>short-circuiting</code> ï¼Œå®ƒæ˜¯æŒ‡å½“ Stream æµ<strong>æ— é™å¤§</strong>ä½†æ˜¯éœ€è¦è¿”å›çš„ Stream æµæ˜¯<strong>æœ‰é™</strong>çš„æ—¶å€™ï¼Œè€Œåˆå¸Œæœ›å®ƒèƒ½åœ¨<strong>æœ‰é™çš„æ—¶é—´</strong>å†…è®¡ç®—å‡ºç»“æœï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œå°±è¢«ç§°ä¸º<code>short-circuiting</code>ã€‚ä¾‹å¦‚ã€€<code>findFirst</code>æ“ä½œã€‚</p><h2 id="3-Stream-æµä½¿ç”¨"><a href="#3-Stream-æµä½¿ç”¨" class="headerlink" title="3. Stream æµä½¿ç”¨"></a>3. Stream æµä½¿ç”¨</h2><p>Stream æµåœ¨ä½¿ç”¨æ—¶å€™æ€»æ˜¯å€ŸåŠ©äº <code>Lambda</code> è¡¨è¾¾å¼è¿›è¡Œæ“ä½œï¼ŒStream æµçš„æ“ä½œä¹Ÿæœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œä¸‹é¢åˆ—ä¸¾çš„æ˜¯å¸¸ç”¨çš„ 11 ç§æ“ä½œã€‚</p><h3 id="3-1-Stream-æµè·å–"><a href="#3-1-Stream-æµè·å–" class="headerlink" title="3.1. Stream æµè·å–"></a>3.1. Stream æµè·å–</h3><p>è·å– Stream çš„å‡ ç§æ–¹å¼åœ¨ä¸Šé¢çš„ Stream æ•°æ®æºé‡Œå·²ç»ä»‹ç»è¿‡äº†ï¼Œä¸‹é¢æ˜¯é’ˆå¯¹ä¸Šé¢ä»‹ç»çš„å‡ ç§è·å– Stream æµçš„ä½¿ç”¨ç¤ºä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createStream</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">    List&lt;String&gt; nameList = Arrays.asList(<span class="string">"Darcy"</span>, <span class="string">"Chris"</span>, <span class="string">"Linda"</span>, <span class="string">"Sid"</span>, <span class="string">"Kim"</span>, <span class="string">"Jack"</span>, <span class="string">"Poul"</span>, <span class="string">"Peter"</span>);</span><br><span class="line">    String[] nameArr = &#123;<span class="string">"Darcy"</span>, <span class="string">"Chris"</span>, <span class="string">"Linda"</span>, <span class="string">"Sid"</span>, <span class="string">"Kim"</span>, <span class="string">"Jack"</span>, <span class="string">"Poul"</span>, <span class="string">"Peter"</span>&#125;;</span><br><span class="line">    <span class="comment">// é›†åˆè·å– Stream æµ</span></span><br><span class="line">    Stream&lt;String&gt; nameListStream = nameList.stream();</span><br><span class="line">    <span class="comment">// é›†åˆè·å–å¹¶è¡Œ Stream æµ</span></span><br><span class="line">    Stream&lt;String&gt; nameListStream2 = nameList.parallelStream();</span><br><span class="line">    <span class="comment">// æ•°ç»„è·å– Stream æµ</span></span><br><span class="line">    Stream&lt;String&gt; nameArrStream = Stream.of(nameArr);</span><br><span class="line">    <span class="comment">// æ•°ç»„è·å– Stream æµ</span></span><br><span class="line">    Stream&lt;String&gt; nameArrStream1 = Arrays.stream(nameArr);</span><br><span class="line">    <span class="comment">// æ–‡ä»¶æµè·å– Stream æµ</span></span><br><span class="line">    BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"README.md"</span>));</span><br><span class="line">    Stream&lt;String&gt; linesStream = bufferedReader.lines();</span><br><span class="line">    <span class="comment">// ä»é™æ€æ–¹æ³•è·å–æµæ“ä½œ</span></span><br><span class="line">    IntStream rangeStream = IntStream.range(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">    rangeStream.limit(<span class="number">10</span>).forEach(num -&gt; System.out.print(num+<span class="string">","</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line">    IntStream intStream = IntStream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    intStream.forEach(num -&gt; System.out.print(num+<span class="string">","</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-forEach"><a href="#3-2-forEach" class="headerlink" title="3.2. forEach"></a>3.2. forEach</h3><p><code>forEach</code> æ˜¯ <code>Stream</code> æµä¸­çš„ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼Œç”¨äºéå† <code>Stream</code> æµï¼Œå®ƒæ”¯æŒä¼ å…¥ä¸€ä¸ªæ ‡å‡†çš„ <code>Lambda</code> è¡¨è¾¾å¼ã€‚ä½†æ˜¯å®ƒçš„éå†ä¸èƒ½é€šè¿‡ return/break è¿›è¡Œç»ˆæ­¢ã€‚åŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ª <code>terminal</code> æ“ä½œï¼Œæ‰§è¡Œä¹‹å <code>Stream</code> æµä¸­çš„æ•°æ®ä¼šè¢«æ¶ˆè´¹æ‰ã€‚</p><p>å¦‚è¾“å‡ºå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numberList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>);</span><br><span class="line">numberList.stream().forEach(number -&gt; System.out.println(number+<span class="string">","</span>));</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 1,2,3,4,5,6,7,8,9,</span></span><br></pre></td></tr></table></figure><h3 id="3-3-map-flatMap"><a href="#3-3-map-flatMap" class="headerlink" title="3.3. map / flatMap"></a>3.3. map / flatMap</h3><p>ä½¿ç”¨ <code>map</code> æŠŠå¯¹è±¡ä¸€å¯¹ä¸€æ˜ å°„æˆå¦ä¸€ç§å¯¹è±¡æˆ–è€…å½¢å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠŠæ•°å­—å€¼ä¹˜ä»¥2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mapTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; numberList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>);</span><br><span class="line">    <span class="comment">// æ˜ å°„æˆ 2å€æ•°å­—</span></span><br><span class="line">    List&lt;Integer&gt; collect = numberList.stream()</span><br><span class="line">            .map(number -&gt; number * <span class="number">2</span>)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    collect.forEach(number -&gt; System.out.print(number + <span class="string">","</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">    numberList.stream()</span><br><span class="line">            .map(number -&gt; <span class="string">"æ•°å­— "</span> + number + <span class="string">","</span>)</span><br><span class="line">            .forEach(number -&gt; System.out.println(number));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 2,4,6,8,10,12,14,16,18,</span></span><br><span class="line"><span class="comment">// æ•°å­— 1,æ•°å­— 2,æ•°å­— 3,æ•°å­— 4,æ•°å­— 5,æ•°å­— 6,æ•°å­— 7,æ•°å­— 8,æ•°å­— 9,</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ <code>map</code> å¯ä»¥æŠŠæ•°æ®è¿›è¡Œä¸€å¯¹ä¸€çš„æ˜ å°„ï¼Œè€Œæœ‰äº›æ—¶å€™å…³ç³»å¯èƒ½ä¸æ­¢ 1å¯¹ 1é‚£ä¹ˆç®€å•ï¼Œå¯èƒ½ä¼šæœ‰1å¯¹å¤šã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨ <code>flatMapã€‚ä¸‹é¢æ¼”ç¤º</code>ä½¿ç”¨ <code>flatMap</code>æŠŠå¯¹è±¡æ‰å¹³åŒ–å±•å¼€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * flatmapæŠŠå¯¹è±¡æ‰å¹³åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flatMapTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Stream&lt;List&lt;Integer&gt;&gt; inputStream = Stream.of(</span><br><span class="line">            Arrays.asList(<span class="number">1</span>),</span><br><span class="line">            Arrays.asList(<span class="number">2</span>, <span class="number">3</span>),</span><br><span class="line">            Arrays.asList(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">    );</span><br><span class="line">    List&lt;Integer&gt; collect = inputStream</span><br><span class="line">            .flatMap((childList) -&gt; childList.stream())</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    collect.forEach(number -&gt; System.out.print(number + <span class="string">","</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 1,2,3,4,5,6,</span></span><br></pre></td></tr></table></figure><h3 id="3-4-filter"><a href="#3-4-filter" class="headerlink" title="3.4. filter"></a>3.4. filter</h3><p>ä½¿ç”¨ <code>filter</code> è¿›è¡Œæ•°æ®ç­›é€‰ï¼ŒæŒ‘é€‰å‡ºæƒ³è¦çš„å…ƒç´ ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºæ€ä¹ˆæŒ‘é€‰å‡ºå¶æ•°æ•°å­—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * filter æ•°æ®ç­›é€‰</span></span><br><span class="line"><span class="comment"> * ç­›é€‰å‡ºå¶æ•°æ•°å­—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">filterTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; numberList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>);</span><br><span class="line">    List&lt;Integer&gt; collect = numberList.stream()</span><br><span class="line">            .filter(number -&gt; number % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    collect.forEach(number -&gt; System.out.print(number + <span class="string">","</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2,4,6,8,</span><br></pre></td></tr></table></figure><h3 id="3-5-findFirst"><a href="#3-5-findFirst" class="headerlink" title="3.5. findFirst"></a>3.5. findFirst</h3><p><code>findFirst</code> å¯ä»¥æŸ¥æ‰¾å‡º <code>Stream</code> æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ª Optional ç±»å‹ï¼Œå¦‚æœè¿˜ä¸çŸ¥é“ Optional ç±»çš„ç”¨å¤„ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰æ–‡ç«  <a href="http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483879&amp;idx=1&amp;sn=1eb37f5a97fda31ebb9d80d6e96cfb88&amp;chksm=e984e883def361957df3a954b0f28775404b5f0a278958e91c65b3f3175a37f5384b0988c564&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">Jdk14éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ</a> ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ•°æ®</span></span><br><span class="line"><span class="comment"> * è¿”å›çš„æ˜¯ä¸€ä¸ª Optional å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findFirstTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;Integer&gt; numberList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>);</span><br><span class="line">    Optional&lt;Integer&gt; firstNumber = numberList.stream()</span><br><span class="line">            .findFirst();</span><br><span class="line">    System.out.println(firstNumber.orElse(-<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p><code>findFirst</code> æ–¹æ³•åœ¨æŸ¥æ‰¾åˆ°éœ€è¦çš„æ•°æ®ä¹‹åå°±ä¼šè¿”å›<strong>ä¸å†éå†</strong>æ•°æ®äº†ï¼Œä¹Ÿå› æ­¤ <code>findFirst</code> æ–¹æ³•å¯ä»¥å¯¹æœ‰æ— é™æ•°æ®çš„  <code>Stream</code> æµè¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥è¯´ <code>findFirst</code> æ˜¯ä¸€ä¸ª <code>short-circuiting</code> æ“ä½œã€‚</p><h3 id="3-6-collect-toArray"><a href="#3-6-collect-toArray" class="headerlink" title="3.6. collect / toArray"></a>3.6. collect / toArray</h3><p><code>Stream</code> æµå¯ä»¥è½»æ¾çš„è½¬æ¢ä¸ºå…¶ä»–ç»“æ„ï¼Œä¸‹é¢æ˜¯å‡ ç§å¸¸è§çš„ç¤ºä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Stream è½¬æ¢ä¸ºå…¶ä»–æ•°æ®ç»“æ„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">collectTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; numberList = Arrays.asList(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">    <span class="comment">// to array</span></span><br><span class="line">    Integer[] toArray = numberList.stream()</span><br><span class="line">            .toArray(Integer[]::<span class="keyword">new</span>);</span><br><span class="line">    <span class="comment">// to List</span></span><br><span class="line">    List&lt;Integer&gt; integerList = numberList.stream()</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    <span class="comment">// to set</span></span><br><span class="line">    Set&lt;Integer&gt; integerSet = numberList.stream()</span><br><span class="line">            .collect(Collectors.toSet());</span><br><span class="line">    System.out.println(integerSet);</span><br><span class="line">    <span class="comment">// to string</span></span><br><span class="line">    String toString = numberList.stream()</span><br><span class="line">            .map(number -&gt; String.valueOf(number))</span><br><span class="line">            .collect(Collectors.joining()).toString();</span><br><span class="line">    System.out.println(toString);</span><br><span class="line">    <span class="comment">// to string split by ,</span></span><br><span class="line">    String toStringbJoin = numberList.stream()</span><br><span class="line">            .map(number -&gt; String.valueOf(number))</span><br><span class="line">            .collect(Collectors.joining(<span class="string">","</span>)).toString();</span><br><span class="line">    System.out.println(toStringbJoin);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 112233445</span></span><br><span class="line"><span class="comment">// 1,1,2,2,3,3,4,4,5</span></span><br></pre></td></tr></table></figure><h3 id="3-7-limit-skip"><a href="#3-7-limit-skip" class="headerlink" title="3.7. limit / skip"></a>3.7. limit / skip</h3><p>è·å–æˆ–è€…æ‰”æ‰å‰ n ä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å– / æ‰”æ‰å‰ n ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">limitOrSkipTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè‡ªå·±çš„éšæœºæ•°æµ</span></span><br><span class="line">    List&lt;Integer&gt; ageList = Arrays.asList(<span class="number">11</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">26</span>);</span><br><span class="line">    ageList.stream()</span><br><span class="line">            .limit(<span class="number">3</span>)</span><br><span class="line">            .forEach(age -&gt; System.out.print(age+<span class="string">","</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line">    </span><br><span class="line">    ageList.stream()</span><br><span class="line">            .skip(<span class="number">3</span>)</span><br><span class="line">            .forEach(age -&gt; System.out.print(age+<span class="string">","</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 11,22,13,</span></span><br><span class="line"><span class="comment">// 14,25,26,</span></span><br></pre></td></tr></table></figure><h3 id="3-8-Statistics"><a href="#3-8-Statistics" class="headerlink" title="3.8. Statistics"></a>3.8. Statistics</h3><p>æ•°å­¦ç»Ÿè®¡åŠŸèƒ½ï¼Œæ±‚ä¸€ç»„æ•°ç»„çš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€ä¸ªæ•°ã€æ•°æ®å’Œã€å¹³å‡æ•°ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°å­¦è®¡ç®—æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mathTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">    IntSummaryStatistics stats = list.stream().mapToInt(x -&gt; x).summaryStatistics();</span><br><span class="line">    System.out.println(<span class="string">"æœ€å°å€¼ï¼š"</span> + stats.getMin());</span><br><span class="line">    System.out.println(<span class="string">"æœ€å¤§å€¼ï¼š"</span> + stats.getMax());</span><br><span class="line">    System.out.println(<span class="string">"ä¸ªæ•°ï¼š"</span> + stats.getCount());</span><br><span class="line">    System.out.println(<span class="string">"å’Œï¼š"</span> + stats.getSum());</span><br><span class="line">    System.out.println(<span class="string">"å¹³å‡æ•°ï¼š"</span> + stats.getAverage());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// æœ€å°å€¼ï¼š1</span></span><br><span class="line"><span class="comment">// æœ€å¤§å€¼ï¼š6</span></span><br><span class="line"><span class="comment">// ä¸ªæ•°ï¼š6</span></span><br><span class="line"><span class="comment">// å’Œï¼š21</span></span><br><span class="line"><span class="comment">// å¹³å‡æ•°ï¼š3.5</span></span><br></pre></td></tr></table></figure><h3 id="3-9-groupingBy"><a href="#3-9-groupingBy" class="headerlink" title="3.9. groupingBy"></a>3.9. groupingBy</h3><p>åˆ†ç»„èšåˆåŠŸèƒ½ï¼Œå’Œæ•°æ®åº“çš„ Group by çš„åŠŸèƒ½ä¸€è‡´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * groupingBy</span></span><br><span class="line"><span class="comment"> * æŒ‰å¹´é¾„åˆ†ç»„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">groupByTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; ageList = Arrays.asList(<span class="number">11</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">26</span>);</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; ageGrouyByMap = ageList.stream()            </span><br><span class="line">        .collect(Collectors.groupingBy(age -&gt; String.valueOf(age / <span class="number">10</span>)));</span><br><span class="line">    ageGrouyByMap.forEach((k, v) -&gt; &#123;</span><br><span class="line">        System.out.println(<span class="string">"å¹´é¾„"</span> + k + <span class="string">"0å¤šå²çš„æœ‰ï¼š"</span> + v);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// å¹´é¾„10å¤šå²çš„æœ‰ï¼š[11, 13, 14]</span></span><br><span class="line"><span class="comment">// å¹´é¾„20å¤šå²çš„æœ‰ï¼š[22, 25, 26]</span></span><br></pre></td></tr></table></figure><h3 id="3-10-partitioningBy"><a href="#3-10-partitioningBy" class="headerlink" title="3.10. partitioningBy"></a>3.10. partitioningBy</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * partitioningBy</span></span><br><span class="line"><span class="comment"> * æŒ‰æŸä¸ªæ¡ä»¶åˆ†ç»„</span></span><br><span class="line"><span class="comment"> * ç»™ä¸€ç»„å¹´é¾„ï¼Œåˆ†å‡ºæˆå¹´äººå’Œæœªæˆå¹´äºº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">partitioningByTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; ageList = Arrays.asList(<span class="number">11</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">26</span>);</span><br><span class="line">    Map&lt;Boolean, List&lt;Integer&gt;&gt; ageMap = ageList.stream()</span><br><span class="line">            .collect(Collectors.partitioningBy(age -&gt; age &gt; <span class="number">18</span>));</span><br><span class="line">    System.out.println(<span class="string">"æœªæˆå¹´äººï¼š"</span> + ageMap.get(<span class="keyword">false</span>));</span><br><span class="line">    System.out.println(<span class="string">"æˆå¹´äººï¼š"</span> + ageMap.get(<span class="keyword">true</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// æœªæˆå¹´äººï¼š[11, 13, 14]</span></span><br><span class="line"><span class="comment">// æˆå¹´äººï¼š[22, 25, 26]</span></span><br></pre></td></tr></table></figure><h3 id="3-11-è¿›é˜¶-è‡ªå·±ç”Ÿæˆ-Stream-æµ"><a href="#3-11-è¿›é˜¶-è‡ªå·±ç”Ÿæˆ-Stream-æµ" class="headerlink" title="3.11. è¿›é˜¶ - è‡ªå·±ç”Ÿæˆ Stream æµ"></a>3.11. è¿›é˜¶ - è‡ªå·±ç”Ÿæˆ Stream æµ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”Ÿæˆè‡ªå·±çš„ Stream æµ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generateTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè‡ªå·±çš„éšæœºæ•°æµ</span></span><br><span class="line">    Random random = <span class="keyword">new</span> Random();</span><br><span class="line">    Stream&lt;Integer&gt; generateRandom = Stream.generate(random::nextInt);</span><br><span class="line">    generateRandom.limit(<span class="number">5</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè‡ªå·±çš„ UUID æµ</span></span><br><span class="line">    Stream&lt;UUID&gt; generate = Stream.generate(UUID::randomUUID);</span><br><span class="line">    generate.limit(<span class="number">5</span>).forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 793776932</span></span><br><span class="line"><span class="comment">// -2051545609</span></span><br><span class="line"><span class="comment">// -917435897</span></span><br><span class="line"><span class="comment">// 298077102</span></span><br><span class="line"><span class="comment">// -1626306315</span></span><br><span class="line"><span class="comment">// 31277974-841a-4ad0-a809-80ae105228bd</span></span><br><span class="line"><span class="comment">// f14918aa-2f94-4774-afcf-fba08250674c</span></span><br><span class="line"><span class="comment">// d86ccefe-1cd2-4eb4-bb0c-74858f2a7864</span></span><br><span class="line"><span class="comment">// 4905724b-1df5-48f4-9948-fa9c64c7e1c9</span></span><br><span class="line"><span class="comment">// 3af2a07f-0855-455f-a339-6e890e533ab3</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­ä¸­ <code>Stream</code> æµæ˜¯æ— é™çš„ï¼Œä½†æ˜¯è·å–åˆ°çš„ç»“æœæ˜¯æœ‰é™çš„ï¼Œä½¿ç”¨äº† <code>Limit</code> é™åˆ¶è·å–çš„æ•°é‡ï¼Œæ‰€ä»¥è¿™ä¸ªæ“ä½œä¹Ÿæ˜¯ <code>short-circuiting</code> æ“ä½œã€‚</p><h2 id="4-Stream-æµä¼˜ç‚¹"><a href="#4-Stream-æµä¼˜ç‚¹" class="headerlink" title="4. Stream æµä¼˜ç‚¹"></a>4. Stream æµä¼˜ç‚¹</h2><h3 id="4-1-ç®€æ´ä¼˜é›…"><a href="#4-1-ç®€æ´ä¼˜é›…" class="headerlink" title="4.1. ç®€æ´ä¼˜é›…"></a>4.1. ç®€æ´ä¼˜é›…</h3><p>æ­£ç¡®ä½¿ç”¨å¹¶ä¸”<strong>æ­£ç¡®æ ¼å¼åŒ–</strong>çš„ <code>Stream</code> æµæ“ä½œä»£ç ä¸ä»…<strong>ç®€æ´ä¼˜é›…</strong>ï¼Œæ›´è®©äººèµå¿ƒæ‚¦ç›®ã€‚ä¸‹é¢å¯¹æ¯”ä¸‹åœ¨ä½¿ç”¨ <code>Stream</code> æµå’Œä¸ä½¿ç”¨ <code>Stream</code> æµæ—¶ç›¸åŒæ“ä½œçš„ç¼–ç é£æ ¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨æµæ“ä½œå’Œä¸ä½¿ç”¨æµæ“ä½œçš„ç¼–ç é£æ ¼å¯¹æ¯”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">diffTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¸ä½¿ç”¨æµæ“ä½œ</span></span><br><span class="line">    List&lt;String&gt; names = Arrays.asList(<span class="string">"Jack"</span>, <span class="string">"Jill"</span>, <span class="string">"Nate"</span>, <span class="string">"Kara"</span>, <span class="string">"Kim"</span>, <span class="string">"Jullie"</span>, <span class="string">"Paul"</span>, <span class="string">"Peter"</span>);</span><br><span class="line">    <span class="comment">// ç­›é€‰å‡ºé•¿åº¦ä¸º4çš„åå­—</span></span><br><span class="line">    List&lt;String&gt; subList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (String name : names) &#123;</span><br><span class="line">        <span class="keyword">if</span> (name.length() == <span class="number">4</span>) &#123;</span><br><span class="line">            subList.add(name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŠŠå€¼ç”¨é€—å·åˆ†éš”</span></span><br><span class="line">    StringBuilder sbNames = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; subList.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        sbNames.append(subList.get(i));</span><br><span class="line">        sbNames.append(<span class="string">", "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å»æ‰æœ€åä¸€ä¸ªé€—å·</span></span><br><span class="line">    <span class="keyword">if</span> (subList.size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        sbNames.append(subList.get(subList.size() - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(sbNames);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// Jack, Jill, Nate, Kara, Paul</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ä½¿ç”¨ <code>Stream</code> æµæ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ Stream æµæ“ä½œ</span></span><br><span class="line">String nameString = names.stream()</span><br><span class="line">       .filter(num -&gt; num.length() == <span class="number">4</span>)</span><br><span class="line">       .collect(Collectors.joining(<span class="string">", "</span>));</span><br><span class="line">System.out.println(nameString);</span><br></pre></td></tr></table></figure><h3 id="4-2-æƒ°æ€§è®¡ç®—"><a href="#4-2-æƒ°æ€§è®¡ç®—" class="headerlink" title="4.2. æƒ°æ€§è®¡ç®—"></a>4.2. æƒ°æ€§è®¡ç®—</h3><p>ä¸Šé¢æœ‰æåˆ°ï¼Œ<code>æ•°æ®å¤„ç†/è½¬æ¢ï¼ˆintermediaï¼‰</code> æ“ä½œ map (mapToInt, flatMap ç­‰)ã€ filterã€ distinctã€ sortedã€ peekã€ limitã€ skipã€ parallelã€ sequentialã€ unordered ç­‰è¿™äº›æ“ä½œï¼Œåœ¨è°ƒç”¨æ–¹æ³•æ—¶å¹¶ä¸ä¼šç«‹å³è°ƒç”¨ï¼Œè€Œæ˜¯åœ¨çœŸæ­£ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆï¼Œè¿™æ ·å¯ä»¥è®©æ“ä½œå»¶è¿Ÿåˆ°çœŸæ­£éœ€è¦ä½¿ç”¨çš„æ—¶åˆ»ã€‚</p><p>ä¸‹é¢ä¼šä¸¾ä¸ªä¾‹å­æ¼”ç¤ºè¿™ä¸€ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰¾å‡ºå¶æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lazyTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè‡ªå·±çš„éšæœºæ•°æµ</span></span><br><span class="line">    List&lt;Integer&gt; numberLIst = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">    <span class="comment">// æ‰¾å‡ºå¶æ•°</span></span><br><span class="line">    Stream&lt;Integer&gt; integerStream = numberLIst.stream()</span><br><span class="line">            .filter(number -&gt; &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = number % <span class="number">2</span>;</span><br><span class="line">     <span class="keyword">if</span> (temp == <span class="number">0</span> )&#123;</span><br><span class="line">                    System.out.println(number);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> temp == <span class="number">0</span>;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"åˆ†å‰²çº¿"</span>);</span><br><span class="line">    List&lt;Integer&gt; collect = integerStream.collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ <code>æƒ°æ€§è®¡ç®—</code>ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾ä¼šå…ˆè¾“å‡ºå¶æ•°ï¼Œç„¶åè¾“å‡º <code>åˆ†å‰²çº¿</code>ã€‚è€Œå®é™…çš„æ•ˆæœæ˜¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åˆ†å‰²çº¿</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br></pre></td></tr></table></figure><p>å¯è§ <code>æƒ°æ€§è®¡ç®—</code> æŠŠè®¡ç®—å»¶è¿Ÿåˆ°äº†çœŸæ­£éœ€è¦çš„æ—¶å€™ã€‚</p><h3 id="4-3-å¹¶è¡Œè®¡ç®—"><a href="#4-3-å¹¶è¡Œè®¡ç®—" class="headerlink" title="4.3. å¹¶è¡Œè®¡ç®—"></a>4.3. å¹¶è¡Œè®¡ç®—</h3><p>è·å– <code>Stream</code> æµæ—¶å¯ä»¥ä½¿ç”¨ <code>parallelStream</code> æ–¹æ³•ä»£æ›¿ <code>stream</code> æ–¹æ³•ä»¥è·å–å¹¶è¡Œå¤„ç†æµï¼Œå¹¶è¡Œå¤„ç†å¯ä»¥å……åˆ†çš„å‘æŒ¥å¤šæ ¸ä¼˜åŠ¿ï¼Œè€Œä¸”ä¸å¢åŠ ç¼–ç çš„å¤æ‚æ€§ã€‚</p><p>ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†ç”Ÿæˆä¸€åƒä¸‡ä¸ªéšæœºæ•°åï¼ŒæŠŠæ¯ä¸ªéšæœºæ•°ä¹˜ä»¥2ç„¶åæ±‚å’Œæ—¶ï¼Œä¸²è¡Œè®¡ç®—å’Œå¹¶è¡Œè®¡ç®—çš„è€—æ—¶å·®å¼‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¹¶è¡Œè®¡ç®—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè‡ªå·±çš„éšæœºæ•°æµï¼Œå–ä¸€åƒä¸‡ä¸ªéšæœºæ•°</span></span><br><span class="line">    Random random = <span class="keyword">new</span> Random();</span><br><span class="line">    Stream&lt;Integer&gt; generateRandom = Stream.generate(random::nextInt);</span><br><span class="line">    List&lt;Integer&gt; numberList = generateRandom.limit(<span class="number">10000000</span>).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸²è¡Œ - æŠŠä¸€åƒä¸‡ä¸ªéšæœºæ•°ï¼Œæ¯ä¸ªéšæœºæ•° * 2 ï¼Œç„¶åæ±‚å’Œ</span></span><br><span class="line">    <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">int</span> sum = numberList.stream()</span><br><span class="line">        .map(number -&gt; number * <span class="number">2</span>)</span><br><span class="line">        .mapToInt(x -&gt; x)</span><br><span class="line">        .sum();</span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"ä¸²è¡Œè€—æ—¶ï¼š"</span>+(end - start)+<span class="string">"msï¼Œå’Œæ˜¯:"</span>+sum);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¹¶è¡Œ - æŠŠä¸€åƒä¸‡ä¸ªéšæœºæ•°ï¼Œæ¯ä¸ªéšæœºæ•° * 2 ï¼Œç„¶åæ±‚å’Œ</span></span><br><span class="line">    start = System.currentTimeMillis();</span><br><span class="line">    sum = numberList.parallelStream()</span><br><span class="line">        .map(number -&gt; number * <span class="number">2</span>)</span><br><span class="line">        .mapToInt(x -&gt; x)</span><br><span class="line">        .sum();</span><br><span class="line">    end = System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"å¹¶è¡Œè€—æ—¶ï¼š"</span>+(end - start)+<span class="string">"msï¼Œå’Œæ˜¯:"</span>+sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹è¾“å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¸²è¡Œè€—æ—¶ï¼š<span class="number">1005</span>msï¼Œå’Œæ˜¯:<span class="number">481385106</span></span><br><span class="line">å¹¶è¡Œè€—æ—¶ï¼š<span class="number">47</span>msï¼Œå’Œæ˜¯:<span class="number">481385106</span></span><br></pre></td></tr></table></figure><p>æ•ˆæœæ˜¾è€Œæ˜“è§ï¼Œä»£ç ç®€æ´ä¼˜é›…ã€‚</p><h2 id="5-Stream-æµå»ºè®®"><a href="#5-Stream-æµå»ºè®®" class="headerlink" title="5. Stream æµå»ºè®®"></a>5. Stream æµå»ºè®®</h2><h3 id="5-1-ä¿è¯æ­£ç¡®æ’ç‰ˆ"><a href="#5-1-ä¿è¯æ­£ç¡®æ’ç‰ˆ" class="headerlink" title="5.1 ä¿è¯æ­£ç¡®æ’ç‰ˆ"></a>5.1 ä¿è¯æ­£ç¡®æ’ç‰ˆ</h3><p>ä»ä¸Šé¢çš„ä½¿ç”¨æ¡ˆä¾‹ä¸­ï¼Œå¯ä»¥å‘ç°ä½¿ç”¨ <code>Stream</code> æµæ“ä½œçš„ä»£ç éå¸¸ç®€æ´ï¼Œè€Œä¸”å¯è¯»æ€§æ›´é«˜ã€‚ä½†æ˜¯å¦‚æœä¸æ­£ç¡®çš„æ’ç‰ˆï¼Œé‚£ä¹ˆçœ‹èµ·æ¥å°†ä¼šå¾ˆç³Ÿç³•ï¼Œæ¯”å¦‚ä¸‹é¢çš„åŒæ ·åŠŸèƒ½çš„ä»£ç ä¾‹å­ï¼Œå¤šå‡ å±‚æ“ä½œå‘¢ï¼Œæ˜¯ä¸æ˜¯æœ‰äº›è®©äººå¤´å¤§ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸æ’ç‰ˆ</span></span><br><span class="line">String string = names.stream().filter(num -&gt; num.length() == <span class="number">4</span>).map(name -&gt; name.toUpperCase()).collect(Collectors.joining(<span class="string">","</span>));</span><br><span class="line"><span class="comment">// æ’ç‰ˆ</span></span><br><span class="line">String string = names.stream()</span><br><span class="line">        .filter(num -&gt; num.length() == <span class="number">4</span>)</span><br><span class="line">        .map(name -&gt; name.toUpperCase())</span><br><span class="line">        .collect(Collectors.joining(<span class="string">","</span>));</span><br></pre></td></tr></table></figure><h3 id="5-2-ä¿è¯å‡½æ•°çº¯åº¦"><a href="#5-2-ä¿è¯å‡½æ•°çº¯åº¦" class="headerlink" title="5.2 ä¿è¯å‡½æ•°çº¯åº¦"></a>5.2 ä¿è¯å‡½æ•°çº¯åº¦</h3><p>å¦‚æœæƒ³è¦ä½ çš„ <code>Stream</code> æµå¯¹äºæ¯æ¬¡çš„ç›¸åŒæ“ä½œçš„ç»“æœéƒ½æ˜¯ç›¸åŒçš„è¯ï¼Œé‚£ä¹ˆä½ å¿…é¡»ä¿è¯ <code>Lambda</code> è¡¨è¾¾å¼çš„çº¯åº¦ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢ä¸¤ç‚¹ã€‚</p><ul><li>Lambda ä¸­ä¸ä¼šæ›´æ”¹ä»»ä½•å…ƒç´ ã€‚</li><li>Lambda ä¸­ä¸ä¾èµ–äºä»»ä½•å¯èƒ½æ›´æ”¹çš„å…ƒç´ ã€‚</li></ul><p>è¿™ä¸¤ç‚¹å¯¹äºä¿è¯å‡½æ•°çš„å¹‚ç­‰éå¸¸é‡è¦ï¼Œä¸ç„¶ä½ ç¨‹åºæ‰§è¡Œç»“æœå¯èƒ½ä¼šå˜å¾—éš¾ä»¥é¢„æµ‹ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">int</span>[] factor = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="number">2</span> &#125;;</span><br><span class="line">    Stream&lt;Integer&gt; stream = numbers.stream()</span><br><span class="line">            .map(e -&gt; e * factor[<span class="number">0</span>]);</span><br><span class="line">    factor[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    stream.forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 0</span></span><br></pre></td></tr></table></figure><p>æ–‡ä¸­ä»£ç éƒ½å·²ç»ä¸Šä¼ åˆ° </p><p><a href="https://github.com/niumoo/jdk-feature/blob/master/src/main/java/net/codingme/feature/jdk8/Jdk8Stream.java" target="_blank" rel="noopener"> https://github.com/niumoo/jdk-feature/blob/master/src/main/java/net/codingme/feature/jdk8/Jdk8Stream.java </a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/assets/jdk8-stream/java-streams.png&quot; alt=&quot;java-streams&quot;&gt;&lt;/p&gt;
&lt;p&gt;Java 8 æ–°ç‰¹æ€§ç³»åˆ—æ–‡ç« ç´¢å¼•ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;amp;mid=2247483879&amp;amp;idx=1&amp;amp;sn=1eb37f5a97fda31ebb9d80d6e96cfb88&amp;amp;chksm=e984e883def361957df3a954b0f28775404b5f0a278958e91c65b3f3175a37f5384b0988c564&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Jdk14éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;amp;mid=2247483801&amp;amp;idx=1&amp;amp;sn=eea69b039feb1ae86187ade222e6bfd8&amp;amp;chksm=e984e8fddef361ebd4acc58e11f3ccdeea9b06b6514957a5c203d52046c551f3ea3203d187e9&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk8 çš„æ—¶é—´å¤„ç†å§¿åŠ¿è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;amp;mid=2247483923&amp;amp;idx=1&amp;amp;sn=57c720a9ba7dbd79e84a069e0d6fa84f&amp;amp;chksm=e984eb77def36261de6f0b9edd8aaa9ef34f74f90c08e6d395880545b6bf1a7b054ecdbff483#rd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹&lt;/a&gt; &lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ &lt;code&gt;Lambda&lt;/code&gt; å’Œ Stream æ˜¯ Java 8 çš„ä¸¤å¤§äº®ç‚¹åŠŸèƒ½ï¼Œåœ¨å‰é¢çš„æ–‡ç« é‡Œå·²ç»ä»‹ç»è¿‡ &lt;code&gt;Lambda&lt;/code&gt; ç›¸å…³çŸ¥è¯†ï¼Œè¿™æ¬¡ä»‹ç»ä¸‹ Java 8 çš„ Stream æµæ“ä½œã€‚å®ƒå®Œå…¨ä¸åŒäº java.io åŒ…çš„ Input/Output Stream ï¼Œä¹Ÿä¸æ˜¯å¤§æ•°æ®å®æ—¶å¤„ç†çš„ Stream æµã€‚è¿™ä¸ª Stream æµæ“ä½œæ˜¯ Java 8 å¯¹é›†åˆæ“ä½œåŠŸèƒ½çš„å¢å¼ºï¼Œä¸“æ³¨äºå¯¹é›†åˆçš„å„ç§é«˜æ•ˆã€ä¾¿åˆ©ã€ä¼˜é›…çš„&lt;strong&gt;èšåˆæ“ä½œ&lt;/strong&gt;ã€‚å€ŸåŠ©äº &lt;code&gt;Lambda&lt;/code&gt; è¡¨è¾¾å¼ï¼Œæ˜¾è‘—çš„æé«˜&lt;strong&gt;ç¼–ç¨‹æ•ˆç‡&lt;/strong&gt;å’Œ&lt;strong&gt;å¯è¯»æ€§&lt;/strong&gt;ã€‚ä¸” Stream æä¾›äº†&lt;strong&gt;å¹¶è¡Œè®¡ç®—&lt;/strong&gt;æ¨¡å¼ï¼Œå¯ä»¥ç®€æ´çš„ç¼–å†™å‡ºå¹¶è¡Œä»£ç ï¼Œèƒ½å……åˆ†å‘æŒ¥å¦‚ä»Šè®¡ç®—æœºçš„å¤šæ ¸å¤„ç†ä¼˜åŠ¿ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Jdk æ–°ç‰¹æ€§" scheme="https://www.codingme.net/categories/Jdk-%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
    
      <category term="Java8" scheme="https://www.codingme.net/tags/Java8/"/>
    
      <category term="Stream" scheme="https://www.codingme.net/tags/Stream/"/>
    
  </entry>
  
  <entry>
    <title>è¿˜çœ‹ä¸æ‡‚åŒäº‹çš„ä»£ç ï¼ŸLambda è¡¨è¾¾å¼ã€å‡½æ•°æ¥å£äº†è§£ä¸€ä¸‹</title>
    <link href="https://www.codingme.net/2019/11/jdk/jdk8-lambda/"/>
    <id>https://www.codingme.net/2019/11/jdk/jdk8-lambda/</id>
    <published>2019-11-11T00:01:01.000Z</published>
    <updated>2020-02-18T14:37:35.724Z</updated>
    
    <content type="html"><![CDATA[<p>å½“å‰æ—¶é—´ï¼š2019å¹´ 11æœˆ 11æ—¥ï¼Œè·ç¦» JDK 14 å‘å¸ƒæ—¶é—´ï¼ˆ2020å¹´3æœˆ17æ—¥ï¼‰è¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ</span></span><br><span class="line">LocalDate jdk14 = LocalDate.of(<span class="number">2020</span>, <span class="number">3</span>, <span class="number">17</span>);</span><br><span class="line">LocalDate nowDate = LocalDate.now();</span><br><span class="line">System.out.println(<span class="string">"è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰ï¼š"</span>+nowDate.until(jdk14,ChronoUnit.DAYS)+<span class="string">"å¤©"</span>);</span><br></pre></td></tr></table></figure><a id="more"></a><h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1. å‰è¨€"></a>1. å‰è¨€</h1><p><code>Java 8</code> æ—©å·²ç»åœ¨2014 å¹´ 3æœˆ 18æ—¥å‘å¸ƒï¼Œæ¯«æ— ç–‘é—® <code>Java 8</code> å¯¹ Java æ¥è¯´ç»å¯¹ç®—å¾—ä¸Šæ˜¯ä¸€æ¬¡é‡å¤§ç‰ˆæœ¬æ›´æ–°ï¼Œå®ƒåŒ…å«äº†åå¤šé¡¹è¯­è¨€ã€åº“ã€å·¥å…·ã€JVM ç­‰æ–¹é¢çš„åå¤šé¡¹æ–°ç‰¹æ€§ã€‚æ¯”å¦‚æä¾›äº†è¯­è¨€çº§çš„åŒ¿åå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¢«å®˜æ–¹ç§°ä¸º <code>Lambda</code> çš„è¡¨è¾¾å¼è¯­æ³•ï¼ˆå¤–ç•Œä¹Ÿç§°ä¸ºé—­åŒ…ï¼Œ<code>Lambda</code> çš„å¼•å…¥ä¹Ÿè®©æµå¼æ“ä½œæˆä¸ºå¯èƒ½ï¼Œå‡å°‘äº†ä»£ç ç¼–å†™çš„å¤æ‚æ€§ï¼‰ï¼Œæ¯”å¦‚å‡½æ•°å¼æ¥å£ï¼Œæ–¹æ³•å¼•ç”¨ï¼Œé‡å¤æ³¨è§£ã€‚å†æ¯”å¦‚ <code>Optional</code> é¢„é˜²ç©ºæŒ‡é’ˆï¼Œ<code>Stearm</code> æµå¼æ“ä½œï¼Œ<code>LocalDateTime</code> æ—¶é—´æ“ä½œç­‰ã€‚</p><p>åœ¨å‰é¢çš„æ–‡ç« é‡Œå·²ç»ä»‹ç»äº† <code>Java 8</code> çš„éƒ¨åˆ†æ–°ç‰¹æ€§ã€‚</p><ol><li><p><a href="https://www.codingme.net/2019/10/jdk/jdk8-time/">Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk8 çš„æ—¶é—´å¤„ç†å§¿åŠ¿è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ</a></p></li><li><p><a href="https://www.codingme.net/2019/11/jdk/jdk8-optional/">Jdk14éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ</a></p></li></ol><p>è¿™ä¸€æ¬¡ä¸»è¦ä»‹ç»ä¸€ä¸‹ Lambda çš„ç›¸å…³æƒ…å†µã€‚</p><h1 id="2-Lambda-ä»‹ç»"><a href="#2-Lambda-ä»‹ç»" class="headerlink" title="2. Lambda ä»‹ç»"></a>2. Lambda ä»‹ç»</h1><p><code>Lambda</code> åå­—æ¥æºäºå¸Œè…Šå­—æ¯è¡¨ä¸­æ’åºç¬¬åä¸€ä½çš„å­—æ¯ Î»ï¼Œå¤§å†™ä¸ºÎ›ï¼Œè‹±è¯­åç§°ä¸º <code>Lambda</code>ã€‚åœ¨ Java ä¸­ <code>Lambda</code> è¡¨è¾¾å¼ï¼ˆlambda expressionï¼‰æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œåœ¨ç¼–å†™ Java ä¸­çš„ <code>Lambda</code> çš„æ—¶å€™ï¼Œä½ ä¹Ÿä¼šå‘ç° <code>Lambda</code> ä¸ä»…æ²¡æœ‰å‡½æ•°åç§°ï¼Œæœ‰æ—¶å€™ç”šè‡³è¿å…¥å‚å’Œè¿”å›éƒ½å¯ä»¥çœç•¥ï¼Œè¿™ä¹Ÿè®©ä»£ç å˜å¾—æ›´åŠ ç´§å‡‘ã€‚</p><h1 id="3-å‡½æ•°æ¥å£ä»‹ç»"><a href="#3-å‡½æ•°æ¥å£ä»‹ç»" class="headerlink" title="3. å‡½æ•°æ¥å£ä»‹ç»"></a>3. å‡½æ•°æ¥å£ä»‹ç»</h1><p>ä¸Šé¢è¯´äº†è¿™æ¬¡æ˜¯ä»‹ç» <code>Lambda</code> è¡¨è¾¾å¼ï¼Œä¸ºä»€ä¹ˆè¦ä»‹ç»å‡½æ•°æ¥å£å‘¢ï¼Ÿå…¶å® Java ä¸­çš„å‡½æ•°æ¥å£åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥éšå¼çš„è½¬æ¢æˆ <code>Lambda</code> è¡¨è¾¾å¼ï¼Œåœ¨ <code>Java 8</code>ä¸­å·²ç»æœ‰å¾ˆå¤šæ¥å£å·²ç»å£°æ˜ä¸ºå‡½æ•°æ¥å£ï¼Œå¦‚ Runnableã€Callableã€Comparator ç­‰ã€‚</p><p>å‡½æ•°æ¥å£çš„ä¾‹å­å¯ä»¥çœ‹ä¸‹ <code>Java 8</code> ä¸­çš„ <code>Runnable</code> æºç ï¼ˆå»æ‰äº†æ³¨é‡Šï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.lang;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆä»€ä¹ˆæ ·å­çš„æ¥å£æ‰æ˜¯å‡½æ•°æ¥å£å‘¢ï¼Ÿæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯åªæœ‰<code>ä¸€ä¸ªæŠ½è±¡å‡½æ•°</code>çš„æ¥å£ï¼Œå‡½æ•°æ¥å£ä½¿ç”¨æ³¨è§£ <code>@FunctionalInterface</code> è¿›è¡Œå£°æ˜ï¼ˆæ³¨è§£å£°æ˜ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœæ²¡æœ‰æ³¨è§£ï¼Œä¹Ÿæ˜¯åªæœ‰ä¸€ä¸ªæŠ½è±¡å‡½æ•°ï¼Œä¾æ—§ä¼šè¢«è®¤ä¸ºæ˜¯å‡½æ•°æ¥å£ï¼‰ã€‚å¤šä¸€ä¸ªæˆ–è€…å°‘ä¸€ä¸ªæŠ½è±¡å‡½æ•°éƒ½ä¸èƒ½å®šä¹‰ä¸ºå‡½æ•°æ¥å£ï¼Œå¦‚æœä½¿ç”¨äº†å‡½æ•°æ¥å£æ³¨è§£åˆä¸æ­¢ä¸€ä¸ªæŠ½è±¡å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šæ‹’ç»ç¼–è¯‘ã€‚å‡½æ•°æ¥å£åœ¨ä½¿ç”¨æ—¶å€™å¯ä»¥éšå¼çš„è½¬æ¢æˆ Lambda è¡¨è¾¾å¼ã€‚</p><p><code>Java 8</code> ä¸­å¾ˆå¤šæœ‰å¾ˆå¤šä¸åŒåŠŸèƒ½çš„å‡½æ•°æ¥å£å®šä¹‰ï¼Œéƒ½æ”¾åœ¨äº† <code>Java 8</code> æ–°å¢çš„ <code>java.util.function</code>åŒ…å†…ã€‚ä¸‹é¢æ˜¯ä¸€äº›å…³äº <code>Java 8</code> ä¸­å‡½æ•°æ¥å£åŠŸèƒ½çš„æè¿°ã€‚</p><table><thead><tr><th style="text-align:left">åºå·</th><th>æ¥å£ &amp; æè¿°</th></tr></thead><tbody><tr><td style="text-align:left"><strong>BiConsumer</strong></td><td>ä»£è¡¨äº†ä¸€ä¸ªæ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°çš„æ“ä½œï¼Œå¹¶ä¸”ä¸è¿”å›ä»»ä½•ç»“æœ</td></tr><tr><td style="text-align:left"><strong>BiFunction</strong></td><td>ä»£è¡¨äº†ä¸€ä¸ªæ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªç»“æœ</td></tr><tr><td style="text-align:left"><strong>BinaryOperator</strong></td><td>ä»£è¡¨äº†ä¸€ä¸ªä½œç”¨äºäºä¸¤ä¸ªåŒç±»å‹æ“ä½œç¬¦çš„æ“ä½œï¼Œå¹¶ä¸”è¿”å›äº†æ“ä½œç¬¦åŒç±»å‹çš„ç»“æœ</td></tr><tr><td style="text-align:left"><strong>BiPredicate</strong></td><td>ä»£è¡¨äº†ä¸€ä¸ªä¸¤ä¸ªå‚æ•°çš„booleanå€¼æ–¹æ³•</td></tr><tr><td style="text-align:left"><strong>BooleanSupplier</strong></td><td>ä»£è¡¨äº†booleanå€¼ç»“æœçš„æä¾›æ–¹</td></tr><tr><td style="text-align:left"><strong>Consumer</strong></td><td>ä»£è¡¨äº†æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°å¹¶ä¸”æ— è¿”å›çš„æ“ä½œ</td></tr><tr><td style="text-align:left"><strong>DoubleBinaryOperator</strong></td><td>ä»£è¡¨äº†ä½œç”¨äºä¸¤ä¸ªdoubleå€¼æ“ä½œç¬¦çš„æ“ä½œï¼Œå¹¶ä¸”è¿”å›äº†ä¸€ä¸ªdoubleå€¼çš„ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>DoubleConsumer</strong></td><td>ä»£è¡¨ä¸€ä¸ªæ¥å—doubleå€¼å‚æ•°çš„æ“ä½œï¼Œå¹¶ä¸”ä¸è¿”å›ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>DoubleFunction</strong></td><td>ä»£è¡¨æ¥å—ä¸€ä¸ªdoubleå€¼å‚æ•°çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›ç»“æœ</td></tr><tr><td style="text-align:left"><strong>DoublePredicate</strong></td><td>ä»£è¡¨ä¸€ä¸ªæ‹¥æœ‰doubleå€¼å‚æ•°çš„booleanå€¼æ–¹æ³•</td></tr><tr><td style="text-align:left"><strong>DoubleSupplier</strong></td><td>ä»£è¡¨ä¸€ä¸ªdoubleå€¼ç»“æ„çš„æä¾›æ–¹</td></tr><tr><td style="text-align:left"><strong>DoubleToIntFunction</strong></td><td>æ¥å—ä¸€ä¸ªdoubleç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>DoubleToLongFunction</strong></td><td>æ¥å—ä¸€ä¸ªdoubleç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœ</td></tr><tr><td style="text-align:left"><strong>DoubleUnaryOperator</strong></td><td>æ¥å—ä¸€ä¸ªå‚æ•°åŒä¸ºç±»å‹double,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºdouble ã€‚</td></tr><tr><td style="text-align:left"><strong>Function</strong></td><td>æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>IntBinaryOperator</strong></td><td>æ¥å—ä¸¤ä¸ªå‚æ•°åŒä¸ºç±»å‹int,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºint ã€‚</td></tr><tr><td style="text-align:left"><strong>IntConsumer</strong></td><td>æ¥å—ä¸€ä¸ªintç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ ã€‚</td></tr><tr><td style="text-align:left"><strong>IntFunction</strong></td><td>æ¥å—ä¸€ä¸ªintç±»å‹è¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœ ã€‚</td></tr><tr><td style="text-align:left"><strong>IntPredicate</strong></td><td>æ¥å—ä¸€ä¸ªintè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>IntSupplier</strong></td><td>æ— å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>IntToDoubleFunction</strong></td><td>æ¥å—ä¸€ä¸ªintç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ ã€‚</td></tr><tr><td style="text-align:left"><strong>IntToLongFunction</strong></td><td>æ¥å—ä¸€ä¸ªintç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>IntUnaryOperator</strong></td><td>æ¥å—ä¸€ä¸ªå‚æ•°åŒä¸ºç±»å‹int,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºint ã€‚</td></tr><tr><td style="text-align:left"><strong>LongBinaryOperator</strong></td><td>æ¥å—ä¸¤ä¸ªå‚æ•°åŒä¸ºç±»å‹long,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºlongã€‚</td></tr><tr><td style="text-align:left"><strong>LongConsumer</strong></td><td>æ¥å—ä¸€ä¸ªlongç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ã€‚</td></tr><tr><td style="text-align:left"><strong>LongFunction</strong></td><td>æ¥å—ä¸€ä¸ªlongç±»å‹è¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>LongPredicate</strong></td><td>æ¥å—ä¸€ä¸ªlongè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>LongSupplier</strong></td><td>æ— å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœlongç±»å‹çš„å€¼ã€‚</td></tr><tr><td style="text-align:left"><strong>LongToDoubleFunction</strong></td><td>æ¥å—ä¸€ä¸ªlongç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>LongToIntFunction</strong></td><td>æ¥å—ä¸€ä¸ªlongç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>LongUnaryOperator</strong></td><td>æ¥å—ä¸€ä¸ªå‚æ•°åŒä¸ºç±»å‹long,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºlongã€‚</td></tr><tr><td style="text-align:left"><strong>ObjDoubleConsumer</strong></td><td>æ¥å—ä¸€ä¸ªobjectç±»å‹å’Œä¸€ä¸ªdoubleç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ã€‚</td></tr><tr><td style="text-align:left"><strong>ObjIntConsumer</strong></td><td>æ¥å—ä¸€ä¸ªobjectç±»å‹å’Œä¸€ä¸ªintç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ã€‚</td></tr><tr><td style="text-align:left"><strong>ObjLongConsumer</strong></td><td>æ¥å—ä¸€ä¸ªobjectç±»å‹å’Œä¸€ä¸ªlongç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ã€‚</td></tr><tr><td style="text-align:left"><strong>Predicate</strong></td><td>æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>Supplier</strong></td><td>æ— å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>ToDoubleBiFunction</strong></td><td>æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ</td></tr><tr><td style="text-align:left"><strong>ToDoubleFunction</strong></td><td>æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ</td></tr><tr><td style="text-align:left"><strong>ToIntBiFunction</strong></td><td>æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>ToIntFunction</strong></td><td>æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>ToLongBiFunction</strong></td><td>æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>ToLongFunction</strong></td><td>æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœã€‚</td></tr><tr><td style="text-align:left"><strong>UnaryOperator</strong></td><td>æ¥å—ä¸€ä¸ªå‚æ•°ä¸ºç±»å‹T,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºTã€‚</td></tr></tbody></table><p>ï¼ˆä¸Šé¢è¡¨æ ¼æ¥æºäºèœé¸Ÿæ•™ç¨‹ï¼‰</p><h1 id="3-Lambda-è¯­æ³•"><a href="#3-Lambda-è¯­æ³•" class="headerlink" title="3. Lambda è¯­æ³•"></a>3. Lambda è¯­æ³•</h1><p>Lambda çš„è¯­æ³•ä¸»è¦æ˜¯ä¸‹é¢å‡ ç§ã€‚</p><ol><li><p>(params) -&gt; expression</p></li><li><p>(params) -&gt; {statements;}</p></li></ol><p>Lambda çš„è¯­æ³•ç‰¹æ€§ã€‚</p><ol><li>ä½¿ç”¨ <code>-&gt;</code> åˆ†å‰² Lambda å‚æ•°å’Œå¤„ç†è¯­å¥ã€‚</li><li>ç±»å‹å¯é€‰ï¼Œå¯ä»¥ä¸æŒ‡å®šå‚æ•°ç±»å‹ï¼Œç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨åˆ¤æ–­ã€‚</li><li>åœ†æ‹¬å·å¯é€‰ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥ä¸éœ€è¦åœ†æ‹¬å·ï¼Œå¤šä¸ªå‚æ•°å¿…é¡»è¦åœ†æ‹¬å·ã€‚</li><li>èŠ±æ‹¬å·å¯é€‰ï¼Œä¸€ä¸ªè¯­å¥å¯ä»¥ä¸ç”¨èŠ±æ‹¬å·ï¼Œå¤šä¸ªå‚æ•°åˆ™èŠ±æ‹¬å·å¿…é¡»ã€‚</li><li>è¿”å›å€¼å¯é€‰ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¯ä»¥è‡ªåŠ¨è¿”å›ï¼Œä¸éœ€è¦ return è¯­å¥ï¼›èŠ±æ‹¬å·ä¸­éœ€è¦ return è¯­æ³•ã€‚<ol start="6"><li>Lambda ä¸­å¼•ç”¨çš„å¤–éƒ¨å˜é‡å¿…é¡»ä¸º final ç±»å‹ï¼Œå†…éƒ¨å£°æ˜çš„å˜é‡ä¸å¯ä¿®æ”¹ï¼Œå†…éƒ¨å£°æ˜çš„å˜é‡åç§°ä¸èƒ½ä¸å¤–éƒ¨å˜é‡åç›¸åŒã€‚</li></ol></li></ol><p>ä¸¾å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œ params åœ¨åªæœ‰ä¸€ä¸ªå‚æ•°æˆ–è€…æ²¡æœ‰å‚æ•°çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥çœç•¥ä¸å†™ï¼Œåƒè¿™æ ·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.ä¸éœ€è¦å‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œè¾“å‡º hello</span></span><br><span class="line">()-&gt;System.out.pritnln(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.ä¸éœ€è¦å‚æ•°ï¼Œè¿”å› hello</span></span><br><span class="line">()-&gt;<span class="string">"hello"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ¥å—2ä¸ªå‚æ•°(æ•°å­—),è¿”å›ä¸¤æ•°ä¹‹å’Œ </span></span><br><span class="line">(x, y) -&gt; x + y  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// 4. æ¥å—2ä¸ªæ•°å­—å‚æ•°,è¿”å›ä¸¤æ•°ä¹‹å’Œ </span></span><br><span class="line">(<span class="keyword">int</span> x, <span class="keyword">int</span> y) -&gt; x + y  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// 5. ä¸¤ä¸ªæ•°å­—å‚æ•°ï¼Œå¦‚æœéƒ½å¤§äº10ï¼Œè¿”å›å’Œï¼Œå¦‚æœéƒ½å°äº10ï¼Œè¿”å›å·®</span></span><br><span class="line">(<span class="keyword">int</span> x,<span class="keyword">int</span> y) -&gt;&#123;</span><br><span class="line">  <span class="keyword">if</span>( x &gt; <span class="number">10</span> &amp;&amp; y &gt; <span class="number">10</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>( x &lt; <span class="number">10</span> &amp;&amp; y &lt; <span class="number">10</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> Math.abs(x-y);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„å‡ ç§æƒ…å†µï¼Œå·²ç»å¯ä»¥å¤§è‡´äº†è§£ Lambda çš„è¯­æ³•ç»“æ„äº†ã€‚</p><h1 id="4-Lambda-ä½¿ç”¨"><a href="#4-Lambda-ä½¿ç”¨" class="headerlink" title="4. Lambda ä½¿ç”¨"></a>4. Lambda ä½¿ç”¨</h1><h2 id="4-1-å¯¹äºå‡½æ•°æ¥å£"><a href="#4-1-å¯¹äºå‡½æ•°æ¥å£" class="headerlink" title="4.1 å¯¹äºå‡½æ•°æ¥å£"></a>4.1 å¯¹äºå‡½æ•°æ¥å£</h2><p>ä»ä¸Šé¢çš„ä»‹ç»ä¸­å·²ç»çŸ¥é“äº† Runnable æ¥å£å·²ç»æ˜¯å‡½æ•°æ¥å£äº†ï¼Œå®ƒå¯ä»¥éšå¼çš„è½¬æ¢ä¸º Lambda è¡¨è¾¾å¼è¿›è¡Œä½¿ç”¨ï¼Œé€šè¿‡ä¸‹é¢çš„åˆ›å»ºçº¿ç¨‹å¹¶è¿è¡Œçš„ä¾‹å­çœ‹ä¸‹ <code>Java 8</code> ä¸­ Lambda è¡¨è¾¾å¼çš„å…·ä½“ä½¿ç”¨æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Lambda çš„ä½¿ç”¨ï¼Œä½¿ç”¨ Runnable ä¾‹å­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createLambda</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lambda ä¹‹å‰</span></span><br><span class="line">    Runnable runnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"JDK8 ä¹‹å‰çš„çº¿ç¨‹åˆ›å»º"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">   <span class="keyword">new</span> Thread(runnable).start();</span><br><span class="line">   <span class="comment">// ä½¿ç”¨ Lambda ä¹‹å</span></span><br><span class="line">   Runnable runnable1Jdk8 = () -&gt; System.out.println(<span class="string">"JDK8 ä¹‹åçš„çº¿ç¨‹åˆ›å»º"</span>);</span><br><span class="line">   <span class="keyword">new</span> Thread(runnable1Jdk8).start();</span><br><span class="line">   <span class="comment">// æ›´åŠ ç´§å‡‘çš„æ–¹å¼</span></span><br><span class="line">   <span class="keyword">new</span> Thread(() -&gt; System.out.println(<span class="string">"JDK8 ä¹‹åçš„çº¿ç¨‹åˆ›å»º"</span>)).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç° <code>Java 8</code> ä¸­çš„ <code>Lambda</code> ç¢°åˆ°äº†å‡½æ•°æ¥å£ Runnableï¼Œè‡ªåŠ¨æ¨æ–­äº†è¦è¿è¡Œçš„ run æ–¹æ³•ï¼Œä¸ä»…çœå»äº† run æ–¹æ³•çš„ç¼–å†™ï¼Œä¹Ÿä»£ç å˜å¾—æ›´åŠ ç´§å‡‘ã€‚</p><p>è¿è¡Œå¾—åˆ°ç»“æœå¦‚ä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JDK8 ä¹‹å‰çš„çº¿ç¨‹åˆ›å»º</span><br><span class="line">JDK8 ä¹‹åçš„çº¿ç¨‹åˆ›å»º</span><br><span class="line">JDK8 ä¹‹åçš„çº¿ç¨‹åˆ›å»º</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ Runnable å‡½æ•°æ¥å£é‡Œçš„ run æ–¹æ³•æ˜¯æ²¡æœ‰å‚æ•°çš„æƒ…å†µï¼Œå¦‚æœæ˜¯æœ‰å‚æ•°çš„ï¼Œé‚£ä¹ˆæ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥å£ï¼Œå†™ä¸€ä¸ª <code>say</code> æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰å‡½æ•°æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FunctionInterfaceDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">say</span><span class="params">(String name, <span class="keyword">int</span> age)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ªæµ‹è¯•ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‡½æ•°æ¥å£ï¼ŒLambda æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">functionLambdaTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FunctionInterfaceDemo demo = (name, age) -&gt; System.out.println(<span class="string">"æˆ‘å«"</span> + name + <span class="string">"ï¼Œæˆ‘ä»Šå¹´"</span> + age + <span class="string">"å²äº†"</span>);</span><br><span class="line">    demo.say(<span class="string">"é‡‘åº¸"</span>, <span class="number">99</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘å«é‡‘åº¸ï¼Œæˆ‘ä»Šå¹´<span class="number">99</span>å²äº†ã€‚</span><br></pre></td></tr></table></figure><h2 id="4-2-å¯¹äºæ–¹æ³•å¼•ç”¨"><a href="#4-2-å¯¹äºæ–¹æ³•å¼•ç”¨" class="headerlink" title="4.2 å¯¹äºæ–¹æ³•å¼•ç”¨"></a>4.2 å¯¹äºæ–¹æ³•å¼•ç”¨</h2><p>æ–¹æ³•å¼•ç”¨è¿™ä¸ªæ¦‚å¿µå‰é¢è¿˜æ²¡æœ‰ä»‹ç»è¿‡ï¼Œæ–¹æ³•å¼•ç”¨å¯ä»¥è®©æˆ‘ä»¬ç›´æ¥è®¿é—®ç±»çš„å®ä¾‹æˆ–è€…æ–¹æ³•ï¼Œåœ¨ Lambda åªæ˜¯æ‰§è¡Œä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä¸ç”¨ <code>Lambda</code> çš„ç¼–å†™æ–¹å¼ï¼Œè€Œç”¨æ–¹æ³•å¼•ç”¨çš„æ–¹å¼ï¼š<code>å®ä¾‹/ç±»::æ–¹æ³•</code>ã€‚è¿™æ ·ä¸ä»…ä»£ç æ›´åŠ çš„ç´§å‡‘ï¼Œè€Œä¸”å¯ä»¥å¢åŠ ä»£ç çš„å¯è¯»æ€§ã€‚</p><p>é€šè¿‡ä¸€ä¸ªä¾‹å­æŸ¥çœ‹æ–¹æ³•å¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;User&gt; userList = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    userList.add(<span class="keyword">new</span> User(<span class="string">"A"</span>, <span class="number">26</span>));</span><br><span class="line">    userList.add(<span class="keyword">new</span> User(<span class="string">"B"</span>, <span class="number">18</span>));</span><br><span class="line">    userList.add(<span class="keyword">new</span> User(<span class="string">"C"</span>, <span class="number">23</span>));</span><br><span class="line">    userList.add(<span class="keyword">new</span> User(<span class="string">"D"</span>, <span class="number">19</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•æ–¹æ³•å¼•ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodRef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User[] userArr = <span class="keyword">new</span> User[userList.size()];</span><br><span class="line">    userList.toArray(userArr);</span><br><span class="line">    <span class="comment">// User::getAge è°ƒç”¨ getAge æ–¹æ³•</span></span><br><span class="line">    Arrays.sort(userArr, Comparator.comparing(User::getAge));</span><br><span class="line">    <span class="keyword">for</span> (User user : userArr) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¾“å‡ºç»“æœã€‚</p><p>Jdk8Lambda.User(name=B, age=18)<br>Jdk8Lambda.User(name=D, age=19)<br>Jdk8Lambda.User(name=C, age=23)<br>Jdk8Lambda.User(name=A, age=26)</p><h2 id="4-3-å¯¹äºéå†æ–¹å¼"><a href="#4-3-å¯¹äºéå†æ–¹å¼" class="headerlink" title="4.3 å¯¹äºéå†æ–¹å¼"></a>4.3 å¯¹äºéå†æ–¹å¼</h2><p>Lambda å¸¦æ¥äº†æ–°çš„éå†æ–¹å¼ï¼Œ<code>Java 8</code> ä¸ºé›†åˆå¢åŠ äº† <code>foreach</code> æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ¥å—å‡½æ•°æ¥å£è¿›è¡Œæ“ä½œã€‚ä¸‹é¢çœ‹ä¸€ä¸‹ <code>Lambda</code> çš„é›†åˆéå†æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–°çš„éå†æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foreachTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; skills = Arrays.asList(<span class="string">"java"</span>, <span class="string">"golang"</span>, <span class="string">"c++"</span>, <span class="string">"c"</span>, <span class="string">"python"</span>);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lambda ä¹‹å‰</span></span><br><span class="line">    <span class="keyword">for</span> (String skill : skills) &#123;</span><br><span class="line">        System.out.print(skill+<span class="string">","</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lambda ä¹‹å</span></span><br><span class="line">    <span class="comment">// æ–¹å¼1,forEach+lambda</span></span><br><span class="line">    skills.forEach((skill) -&gt; System.out.print(skill+<span class="string">","</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// æ–¹å¼2ï¼ŒforEach+æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    skills.forEach(System.out::print);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°è¾“å‡ºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java,golang,c++,c,python,</span><br><span class="line">java,golang,c++,c,python,</span><br><span class="line">javagolangc++cpython</span><br></pre></td></tr></table></figure><h2 id="4-4-å¯¹äºæµå¼æ“ä½œ"><a href="#4-4-å¯¹äºæµå¼æ“ä½œ" class="headerlink" title="4.4 å¯¹äºæµå¼æ“ä½œ"></a>4.4 å¯¹äºæµå¼æ“ä½œ</h2><p>å¾—ç›Šäº <code>Lambda</code> çš„å¼•å…¥ï¼Œè®© <code>Java 8</code> ä¸­çš„æµå¼æ“ä½œæˆä¸ºå¯èƒ½ï¼Œ<code>Java 8</code> æä¾›äº† stream ç±»ç”¨äºè·å–æ•°æ®æµï¼Œå®ƒä¸“æ³¨å¯¹æ•°æ®é›†åˆè¿›è¡Œå„ç§é«˜æ•ˆä¾¿åˆ©æ“ä½œï¼Œæé«˜äº†ç¼–ç¨‹æ•ˆç‡ï¼Œä¸”åŒæ—¶æ”¯æŒä¸²è¡Œå’Œå¹¶è¡Œçš„ä¸¤ç§æ¨¡å¼æ±‡èšè®¡ç®—ã€‚èƒ½å……åˆ†çš„åˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ã€‚</p><p>æµå¼æ“ä½œå¦‚æ­¤å¼ºå¤§ï¼Œ <code>Lambda</code> åœ¨æµå¼æ“ä½œä¸­æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿä¸‹é¢æ¥æ„Ÿå—æµæ“ä½œå¸¦æ¥çš„æ–¹ä¾¿ä¸é«˜æ•ˆã€‚</p><p>æµå¼æ“ä½œä¸€åˆ‡ä»è¿™é‡Œå¼€å§‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ºé›†åˆåˆ›å»ºä¸²è¡Œæµ</span></span><br><span class="line">stream()</span><br><span class="line"><span class="comment">// ä¸ºé›†åˆåˆ›å»ºå¹¶è¡Œæµ</span></span><br><span class="line">parallelStream()</span><br></pre></td></tr></table></figure><p>æµå¼æ“ä½œçš„å»é‡ <code>distinct</code>å’Œè¿‡æ»¤ <code>filter</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">streamTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; skills = Arrays.asList(<span class="string">"java"</span>, <span class="string">"golang"</span>, <span class="string">"c++"</span>, <span class="string">"c"</span>, <span class="string">"python"</span>, <span class="string">"java"</span>);</span><br><span class="line">    <span class="comment">// Jdk8 ä¹‹å‰</span></span><br><span class="line">    <span class="keyword">for</span> (String skill : skills) &#123;</span><br><span class="line">        System.out.print(skill + <span class="string">","</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// Jdk8 ä¹‹å-å»é‡éå†</span></span><br><span class="line">    skills.stream().distinct().forEach(skill -&gt; System.out.print(skill + <span class="string">","</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// Jdk8 ä¹‹å-å»é‡éå†</span></span><br><span class="line">    skills.stream().distinct().forEach(System.out::print);</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// Jdk8 ä¹‹å-å»é‡ï¼Œè¿‡æ»¤æ‰ ptyhon å†éå†</span></span><br><span class="line">    skills.stream().distinct().filter(skill -&gt; skill != <span class="string">"python"</span>).forEach(skill -&gt; System.out.print(skill + <span class="string">","</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line">    <span class="comment">// Jdk8 ä¹‹åè½¬å­—ç¬¦ä¸²</span></span><br><span class="line">    String skillString = String.join(<span class="string">","</span>, skills);</span><br><span class="line">    System.out.println(skillString);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java,golang,c++,c,python,java,</span><br><span class="line">java,golang,c++,c,python,</span><br><span class="line">javagolangc++cpython</span><br><span class="line">java,golang,c++,c,</span><br><span class="line">java,golang,c++,c,python,java</span><br></pre></td></tr></table></figure><p>æµå¼æ“ä½œçš„æ•°æ®è½¬æ¢ï¼ˆä¹Ÿç§°æ˜ å°„ï¼‰<code>map</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°æ®è½¬æ¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mapTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; numList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">    <span class="comment">// æ•°æ®è½¬æ¢</span></span><br><span class="line">    numList.stream().map(num -&gt; num * num).forEach(num -&gt; System.out.print(num + <span class="string">","</span>));</span><br><span class="line"></span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•°æ®æ”¶é›†</span></span><br><span class="line">    Set&lt;Integer&gt; numSet = numList.stream().map(num -&gt; num * num).collect(Collectors.toSet());</span><br><span class="line">    numSet.forEach(num -&gt; System.out.print(num + <span class="string">","</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1,4,9,16,25,</span><br><span class="line">16,1,4,9,25,</span><br></pre></td></tr></table></figure><p>æµå¼æ“ä½œçš„æ•°å­¦è®¡ç®—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°å­¦è®¡ç®—æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mapMathTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">    IntSummaryStatistics stats = list.stream().mapToInt(x -&gt; x).summaryStatistics();</span><br><span class="line">    System.out.println(<span class="string">"æœ€å°å€¼ï¼š"</span> + stats.getMin());</span><br><span class="line">    System.out.println(<span class="string">"æœ€å¤§å€¼ï¼š"</span> + stats.getMax());</span><br><span class="line">    System.out.println(<span class="string">"ä¸ªæ•°ï¼š"</span> + stats.getCount());</span><br><span class="line">    System.out.println(<span class="string">"å’Œï¼š"</span> + stats.getSum());</span><br><span class="line">    System.out.println(<span class="string">"å¹³å‡æ•°ï¼š"</span> + stats.getAverage());</span><br><span class="line">    <span class="comment">// æ±‚å’Œçš„å¦ä¸€ç§æ–¹å¼</span></span><br><span class="line">    Integer integer = list.stream().reduce((sum, cost) -&gt; sum + cost).get();</span><br><span class="line">    System.out.println(integer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å¾—åˆ°è¾“å‡º</span><br><span class="line">æœ€å°å€¼ï¼š1</span><br><span class="line">æœ€å¤§å€¼ï¼š5</span><br><span class="line">ä¸ªæ•°ï¼š5</span><br><span class="line">å’Œï¼š15</span><br><span class="line">å¹³å‡æ•°ï¼š3.0</span><br><span class="line">15</span><br></pre></td></tr></table></figure><h1 id="5-Lambda-æ€»ç»“"><a href="#5-Lambda-æ€»ç»“" class="headerlink" title="5. Lambda æ€»ç»“"></a>5. Lambda æ€»ç»“</h1><p><code>Lamdba</code> ç»“åˆå‡½æ•°æ¥å£ï¼Œæ–¹æ³•å¼•ç”¨ï¼Œç±»å‹æ¨å¯¼ä»¥åŠæµå¼æ“ä½œï¼Œå¯ä»¥è®©ä»£ç å˜å¾—æ›´åŠ ç®€æ´ç´§å‡‘ï¼Œä¹Ÿå¯ä»¥å€Ÿæ­¤å¼€å‘å‡ºæ›´åŠ å¼ºå¤§ä¸”æ”¯æŒå¹¶è¡Œè®¡ç®—çš„ç¨‹åºï¼Œå‡½æ•°ç¼–ç¨‹ä¹Ÿä¸º Java å¸¦æ¥äº†æ–°çš„ç¨‹åºè®¾è®¡æ–¹å¼ã€‚ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåœ¨å®é™…çš„ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‘ç°è°ƒå¼å›°éš¾ï¼Œæµ‹è¯•è¡¨ç¤º <code>Lamdba</code> çš„éå†æ€§èƒ½å¹¶ä¸å¦‚ for çš„æ€§èƒ½é«˜ï¼ŒåŒäº‹å¯èƒ½æ²¡æœ‰å­¦ä¹ å¯¼è‡´çœ‹ä¸æ‡‚ <code>Lamdba</code> ç­‰ï¼ˆå¯ä»¥æ¨èæ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼‰ã€‚</p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/niumoo/jdk-feature" target="_blank" rel="noopener">https://github.com/niumoo/jdk-feature)</a> ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å½“å‰æ—¶é—´ï¼š2019å¹´ 11æœˆ 11æ—¥ï¼Œè·ç¦» JDK 14 å‘å¸ƒæ—¶é—´ï¼ˆ2020å¹´3æœˆ17æ—¥ï¼‰è¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LocalDate jdk14 = LocalDate.of(&lt;span class=&quot;number&quot;&gt;2020&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LocalDate nowDate = LocalDate.now();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰ï¼š&quot;&lt;/span&gt;+nowDate.until(jdk14,ChronoUnit.DAYS)+&lt;span class=&quot;string&quot;&gt;&quot;å¤©&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Jdk æ–°ç‰¹æ€§" scheme="https://www.codingme.net/categories/Jdk-%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
    
      <category term="Java8" scheme="https://www.codingme.net/tags/Java8/"/>
    
      <category term="Lambda" scheme="https://www.codingme.net/tags/Lambda/"/>
    
  </entry>
  
  <entry>
    <title>Arthas - Java çº¿ä¸Šé—®é¢˜å®šä½å¤„ç†çš„ç»ˆæåˆ©å™¨</title>
    <link href="https://www.codingme.net/2019/11/arthas/"/>
    <id>https://www.codingme.net/2019/11/arthas/</id>
    <published>2019-11-05T18:15:08.000Z</published>
    <updated>2019-11-13T02:56:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/assets/arthas/arthas-1572972116473.png" alt="Arthas logo"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨ä½¿ç”¨ <strong>Arthas</strong> ä¹‹å‰ï¼Œå½“é‡åˆ° Java çº¿ä¸Šé—®é¢˜æ—¶ï¼Œå¦‚ CPU é£™å‡ã€è´Ÿè½½çªé«˜ã€å†…å­˜æº¢å‡ºç­‰é—®é¢˜ï¼Œä½ éœ€è¦æŸ¥å‘½ä»¤ï¼ŒæŸ¥ç½‘ç»œï¼Œç„¶å jpsã€jstackã€jmapã€jhatã€jstatã€hprof ç­‰ä¸€é€šæ“ä½œã€‚æœ€ç»ˆç„¦å¤´çƒ‚é¢ï¼Œè¿˜ä¸ä¸€å®šèƒ½æŸ¥å‡ºé—®é¢˜æ‰€åœ¨ã€‚è€Œç°åœ¨ï¼Œå¤§å¤šæ•°çš„å¸¸è§é—®é¢˜ä½ éƒ½å¯ä»¥ä½¿ç”¨ <strong>Arthas</strong> è½»æ¾å®šä½ï¼Œè¿…é€Ÿè§£å†³ï¼ŒåŠæ—¶æ­¢æŸï¼Œå‡†æ—¶ä¸‹ç­ã€‚</p><h1 id="1ã€Arthas-ä»‹ç»"><a href="#1ã€Arthas-ä»‹ç»" class="headerlink" title="1ã€Arthas  ä»‹ç»"></a>1ã€Arthas  ä»‹ç»</h1><p><strong>Arthas</strong> æ˜¯ <code>Alibaba</code> åœ¨ 2018 å¹´ 9 æœˆå¼€æºçš„ <strong>Java è¯Šæ–­</strong>å·¥å…·ã€‚æ”¯æŒ <code>JDK6+</code>ï¼Œ é‡‡ç”¨å‘½ä»¤è¡Œäº¤äº’æ¨¡å¼ï¼Œæä¾› <code>Tab</code> è‡ªåŠ¨ä¸å…¨ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®šä½å’Œè¯Šæ–­çº¿ä¸Šç¨‹åºè¿è¡Œé—®é¢˜ã€‚æˆªè‡³æœ¬ç¯‡æ–‡ç« ç¼–å†™æ—¶ï¼Œå·²ç»æ”¶è· <code>Star</code> 17000+ã€‚</p><p><strong>Arthas</strong> å®˜æ–¹æ–‡æ¡£ååˆ†è¯¦ç»†ï¼Œæœ¬æ–‡ä¹Ÿå‚è€ƒäº†å®˜æ–¹æ–‡æ¡£å†…å®¹ï¼ŒåŒæ—¶åœ¨å¼€æºåœ¨çš„ <code>Github</code> çš„é¡¹ç›®é‡Œçš„ <code>Issues</code> é‡Œä¸ä»…æœ‰é—®é¢˜åé¦ˆï¼Œæ›´æœ‰å¤§é‡çš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå­¦ä¹ å‚è€ƒã€‚</p><p>å¼€æºåœ°å€ï¼š<em><a href="https://github.com/alibaba/arthas" target="_blank" rel="noopener">https://github.com/alibaba/arthas</a></em></p><p>å®˜æ–¹æ–‡æ¡£ï¼š<em><a href="https://alibaba.github.io/arthas" target="_blank" rel="noopener">https://alibaba.github.io/arthas</a></em></p><a id="more"></a><h1 id="2ã€Arthas-ä½¿ç”¨åœºæ™¯"><a href="#2ã€Arthas-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2ã€Arthas  ä½¿ç”¨åœºæ™¯"></a>2ã€Arthas  ä½¿ç”¨åœºæ™¯</h1><p>å¾—ç›Šäº <strong>Arthas</strong> å¼ºå¤§ä¸”ä¸°å¯Œçš„åŠŸèƒ½ï¼Œè®© <strong>Arthas</strong> èƒ½åšçš„äº‹æƒ…è¶…ä¹æƒ³è±¡ã€‚ä¸‹é¢ä»…ä»…åˆ—ä¸¾å‡ é¡¹å¸¸è§çš„ä½¿ç”¨æƒ…å†µï¼Œæ›´å¤šçš„ä½¿ç”¨åœºæ™¯å¯ä»¥åœ¨ç†Ÿæ‚‰äº† <strong>Arthas</strong> ä¹‹åè‡ªè¡Œæ¢ç´¢ã€‚</p><ol><li>æ˜¯å¦æœ‰ä¸€ä¸ªå…¨å±€è§†è§’æ¥æŸ¥çœ‹ç³»ç»Ÿçš„è¿è¡ŒçŠ¶å†µï¼Ÿ</li><li>ä¸ºä»€ä¹ˆ CPU åˆå‡é«˜äº†ï¼Œåˆ°åº•æ˜¯å“ªé‡Œå ç”¨äº† CPU ï¼Ÿ</li><li>è¿è¡Œçš„å¤šçº¿ç¨‹æœ‰æ­»é”å—ï¼Ÿæœ‰é˜»å¡å—ï¼Ÿ</li><li>ç¨‹åºè¿è¡Œè€—æ—¶å¾ˆé•¿ï¼Œæ˜¯å“ªé‡Œè€—æ—¶æ¯”è¾ƒé•¿å‘¢ï¼Ÿå¦‚ä½•ç›‘æµ‹å‘¢ï¼Ÿ</li><li>è¿™ä¸ªç±»ä»å“ªä¸ª jar åŒ…åŠ è½½çš„ï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥å„ç§ç±»ç›¸å…³çš„ Exceptionï¼Ÿ</li><li>æˆ‘æ”¹çš„ä»£ç ä¸ºä»€ä¹ˆæ²¡æœ‰æ‰§è¡Œåˆ°ï¼Ÿéš¾é“æ˜¯æˆ‘æ²¡ commitï¼Ÿåˆ†æ”¯æé”™äº†ï¼Ÿ</li><li>é‡åˆ°é—®é¢˜æ— æ³•åœ¨çº¿ä¸Š debugï¼Œéš¾é“åªèƒ½é€šè¿‡åŠ æ—¥å¿—å†é‡æ–°å‘å¸ƒå—ï¼Ÿ</li><li>æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ç›‘æ§åˆ° JVM çš„å®æ—¶è¿è¡ŒçŠ¶æ€ï¼Ÿ</li></ol><h1 id="3ã€Arthas-æ€ä¹ˆç”¨"><a href="#3ã€Arthas-æ€ä¹ˆç”¨" class="headerlink" title="3ã€Arthas  æ€ä¹ˆç”¨"></a>3ã€Arthas  æ€ä¹ˆç”¨</h1><p>å‰æ–‡å·²ç»æåˆ°ï¼Œ<strong>Arthas</strong> æ˜¯ä¸€æ¬¾å‘½ä»¤è¡Œäº¤äº’æ¨¡å¼çš„ Java è¯Šæ–­å·¥å…·ï¼Œç”±äºæ˜¯ Java ç¼–å†™ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸‹è½½ç›¸åº” çš„ jar åŒ…è¿è¡Œã€‚</p><h2 id="3-1-å®‰è£…"><a href="#3-1-å®‰è£…" class="headerlink" title="3.1 å®‰è£…"></a>3.1 å®‰è£…</h2><p>å¯ä»¥åœ¨å®˜æ–¹ Github ä¸Šè¿›è¡Œä¸‹è½½ï¼Œå¦‚æœé€Ÿåº¦è¾ƒæ…¢ï¼Œå¯ä»¥å°è¯•å›½å†…çš„ç äº‘ Gitee ä¸‹è½½ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> githubä¸‹è½½</span><br><span class="line">wget https://alibaba.github.io/arthas/arthas-boot.jar</span><br><span class="line"><span class="meta">#</span> æˆ–è€… Gitee ä¸‹è½½</span><br><span class="line">wget https://arthas.gitee.io/arthas-boot.jar</span><br><span class="line"><span class="meta">#</span> æ‰“å°å¸®åŠ©ä¿¡æ¯</span><br><span class="line">java -jar arthas-boot.jar -h</span><br></pre></td></tr></table></figure><h2 id="3-2-è¿è¡Œ"><a href="#3-2-è¿è¡Œ" class="headerlink" title="3.2 è¿è¡Œ"></a>3.2 è¿è¡Œ</h2><p><strong>Arthas</strong> åªæ˜¯ä¸€ä¸ª java ç¨‹åºï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨ <code>java -jar</code> è¿è¡Œã€‚è¿è¡Œæ—¶æˆ–è€…è¿è¡Œä¹‹åè¦é€‰æ‹©è¦ç›‘æµ‹çš„ Java è¿›ç¨‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> è¿è¡Œæ–¹å¼1ï¼Œå…ˆè¿è¡Œï¼Œåœ¨é€‰æ‹© Java è¿›ç¨‹ PID</span><br><span class="line">java -jar arthas-boot.jar</span><br><span class="line"><span class="meta">#</span> é€‰æ‹©è¿›ç¨‹(è¾“å…¥[]å†…ç¼–å·(ä¸æ˜¯PID)å›è½¦)</span><br><span class="line">[INFO] arthas-boot version: 3.1.4</span><br><span class="line">[INFO] Found existing java process, please choose one and hit RETURN.</span><br><span class="line">* [1]: 11616 com.Arthas</span><br><span class="line">  [2]: 8676</span><br><span class="line">  [3]: 16200 org.jetbrains.jps.cmdline.Launcher</span><br><span class="line">  [4]: 21032 org.jetbrains.idea.maven.server.RemoteMavenServer</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> è¿è¡Œæ–¹å¼2ï¼Œè¿è¡Œæ—¶é€‰æ‹© Java è¿›ç¨‹ PID</span><br><span class="line">java -jar arthas-boot.jar [PID]</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ PID çš„æ–¹å¼å¯ä»¥é€šè¿‡ <code>ps</code> å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ JDK æä¾›çš„ <code>jps</code>å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> æŸ¥çœ‹è¿è¡Œçš„ java è¿›ç¨‹ä¿¡æ¯</span><br><span class="line"><span class="meta">$</span> jps -mlvV </span><br><span class="line"><span class="meta">#</span> ç­›é€‰ java è¿›ç¨‹ä¿¡æ¯</span><br><span class="line"><span class="meta">$</span> jps -mlvV | grep [xxx]</span><br></pre></td></tr></table></figure><p><code>jps</code> ç­›é€‰æƒ³è¦çš„è¿›ç¨‹æ–¹å¼ã€‚</p><p><img src="/assets/arthas/1570979767404.png" alt="jps ç­›é€‰è¿›ç¨‹"></p><p>åœ¨å‡ºç° <strong>Arthas</strong> Logo ä¹‹åå°±å¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œé—®é¢˜è¯Šæ–­äº†ã€‚ä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»ã€‚</p><p><img src="/assets/arthas/image-20191106003512451.png" alt="Arthas å¯åŠ¨"></p><p>æ›´å¤šçš„å¯åŠ¨æ–¹å¼å¯ä»¥å‚è€ƒ help å¸®åŠ©å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> å…¶ä»–ç”¨æ³•</span><br><span class="line">EXAMPLES:</span><br><span class="line">  java -jar arthas-boot.jar &lt;pid&gt;</span><br><span class="line">  java -jar arthas-boot.jar --target-ip 0.0.0.0</span><br><span class="line">  java -jar arthas-boot.jar --telnet-port 9999 --http-port -1</span><br><span class="line">  java -jar arthas-boot.jar --tunnel-server 'ws://192.168.10.11:7777/ws'</span><br><span class="line">  java -jar arthas-boot.jar --tunnel-server 'ws://192.168.10.11:7777/ws'</span><br><span class="line">--agent-id bvDOe8XbTM2pQWjF4cfw</span><br><span class="line">  java -jar arthas-boot.jar --stat-url 'http://192.168.10.11:8080/api/stat'</span><br><span class="line">  java -jar arthas-boot.jar -c 'sysprop; thread' &lt;pid&gt;</span><br><span class="line">  java -jar arthas-boot.jar -f batch.as &lt;pid&gt;</span><br><span class="line">  java -jar arthas-boot.jar --use-version 3.1.4</span><br><span class="line">  java -jar arthas-boot.jar --versions</span><br><span class="line">  java -jar arthas-boot.jar --session-timeout 3600</span><br><span class="line">  java -jar arthas-boot.jar --attach-only</span><br><span class="line">  java -jar arthas-boot.jar --repo-mirror aliyun --use-http</span><br></pre></td></tr></table></figure><h2 id="3-3-web-console"><a href="#3-3-web-console" class="headerlink" title="3.3 web console"></a>3.3 web console</h2><p><strong>Arthas</strong> ç›®å‰æ”¯æŒ <code>Web Console</code>ï¼Œåœ¨æˆåŠŸå¯åŠ¨è¿æ¥è¿›ç¨‹ä¹‹åå°±å·²ç»è‡ªåŠ¨å¯åŠ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—® <a href="http://127.0.0.1:8563/" target="_blank" rel="noopener">http://127.0.0.1:8563/</a> è®¿é—®ï¼Œé¡µé¢ä¸Šçš„æ“ä½œæ¨¡å¼å’Œæ§åˆ¶å°å®Œå…¨ä¸€æ ·ã€‚  </p><p><img src="/assets/arthas/1570979937637.png" alt="1570979937637"></p><h2 id="3-4-å¸¸ç”¨å‘½ä»¤"><a href="#3-4-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="3.4 å¸¸ç”¨å‘½ä»¤"></a>3.4 å¸¸ç”¨å‘½ä»¤</h2><p>ä¸‹é¢åˆ—ä¸¾ä¸€äº› <a href="https://www.codingme.net/2019/11/arthas/"><strong>Arthas</strong></a> çš„å¸¸ç”¨å‘½ä»¤ï¼Œçœ‹åˆ°è¿™é‡Œä½ å¯èƒ½è¿˜ä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨ï¼Œåˆ«æ€¥ï¼Œåé¢ä¼šä¸€ä¸€ä»‹ç»ã€‚</p><table><thead><tr><th>å‘½ä»¤</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td><a href="https://alibaba.github.io/arthas/dashboard.html" target="_blank" rel="noopener">dashboard</a></td><td>å½“å‰ç³»ç»Ÿçš„å®æ—¶æ•°æ®é¢æ¿</td></tr><tr><td><a href="https://alibaba.github.io/arthas/thread.html" target="_blank" rel="noopener"><strong>thread</strong></a></td><td>æŸ¥çœ‹å½“å‰ JVM çš„çº¿ç¨‹å †æ ˆä¿¡æ¯</td></tr><tr><td><a href="https://alibaba.github.io/arthas/watch.html" target="_blank" rel="noopener"><strong>watch</strong></a></td><td>æ–¹æ³•æ‰§è¡Œæ•°æ®è§‚æµ‹</td></tr><tr><td><strong><a href="https://alibaba.github.io/arthas/trace.html" target="_blank" rel="noopener">trace</a></strong></td><td>æ–¹æ³•å†…éƒ¨è°ƒç”¨è·¯å¾„ï¼Œå¹¶è¾“å‡ºæ–¹æ³•è·¯å¾„ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šè€—æ—¶</td></tr><tr><td><a href="https://alibaba.github.io/arthas/stack.html" target="_blank" rel="noopener"><strong>stack</strong></a></td><td>è¾“å‡ºå½“å‰æ–¹æ³•è¢«è°ƒç”¨çš„è°ƒç”¨è·¯å¾„</td></tr><tr><td><a href="https://alibaba.github.io/arthas/tt.html" target="_blank" rel="noopener"><strong>tt</strong></a></td><td>æ–¹æ³•æ‰§è¡Œæ•°æ®çš„æ—¶ç©ºéš§é“ï¼Œè®°å½•ä¸‹æŒ‡å®šæ–¹æ³•æ¯æ¬¡è°ƒç”¨çš„å…¥å‚å’Œè¿”å›ä¿¡æ¯ï¼Œå¹¶èƒ½å¯¹è¿™äº›ä¸åŒçš„æ—¶é—´ä¸‹è°ƒç”¨è¿›è¡Œè§‚æµ‹</td></tr><tr><td><a href="https://alibaba.github.io/arthas/monitor.html" target="_blank" rel="noopener">monitor</a></td><td>æ–¹æ³•æ‰§è¡Œç›‘æ§</td></tr><tr><td><a href="https://alibaba.github.io/arthas/jvm.html" target="_blank" rel="noopener">jvm</a></td><td>æŸ¥çœ‹å½“å‰ JVM ä¿¡æ¯</td></tr><tr><td><a href="https://alibaba.github.io/arthas/vmoption.html" target="_blank" rel="noopener">vmoption</a></td><td>æŸ¥çœ‹ï¼Œæ›´æ–° JVM è¯Šæ–­ç›¸å…³çš„å‚æ•°</td></tr><tr><td><a href="https://alibaba.github.io/arthas/sc.html" target="_blank" rel="noopener">sc</a></td><td>æŸ¥çœ‹ JVM å·²åŠ è½½çš„ç±»ä¿¡æ¯</td></tr><tr><td><a href="https://alibaba.github.io/arthas/sm.html" target="_blank" rel="noopener">sm</a></td><td>æŸ¥çœ‹å·²åŠ è½½ç±»çš„æ–¹æ³•ä¿¡æ¯</td></tr><tr><td><a href="https://alibaba.github.io/arthas/jad.html" target="_blank" rel="noopener">jad</a></td><td>åç¼–è¯‘æŒ‡å®šå·²åŠ è½½ç±»çš„æºç </td></tr><tr><td><a href="https://alibaba.github.io/arthas/classloader.html" target="_blank" rel="noopener">classloader</a></td><td>æŸ¥çœ‹ classloader çš„ç»§æ‰¿æ ‘ï¼Œurlsï¼Œç±»åŠ è½½ä¿¡æ¯</td></tr><tr><td><a href="https://alibaba.github.io/arthas/heapdump.html" target="_blank" rel="noopener">heapdump</a></td><td>ç±»ä¼¼ jmap å‘½ä»¤çš„ heap dump åŠŸèƒ½</td></tr></tbody></table><h2 id="3-5-é€€å‡º"><a href="#3-5-é€€å‡º" class="headerlink" title="3.5 é€€å‡º"></a>3.5 é€€å‡º</h2><p>ä½¿ç”¨ shutdown é€€å‡ºæ—¶ <strong>Arthas</strong> åŒæ—¶è‡ªåŠ¨é‡ç½®æ‰€æœ‰å¢å¼ºè¿‡çš„ç±» ã€‚</p><h1 id="4ã€Arthas-å¸¸ç”¨æ“ä½œ"><a href="#4ã€Arthas-å¸¸ç”¨æ“ä½œ" class="headerlink" title="4ã€Arthas å¸¸ç”¨æ“ä½œ"></a>4ã€Arthas å¸¸ç”¨æ“ä½œ</h1><p>ä¸Šé¢å·²ç»äº†è§£äº†ä»€ä¹ˆæ˜¯  <strong>Arthas</strong>ï¼Œä»¥åŠ  <strong>Arthas</strong> çš„å¯åŠ¨æ–¹å¼ï¼Œä¸‹é¢ä¼šä¾æ®ä¸€äº›æƒ…å†µï¼Œè¯¦ç»†è¯´ä¸€è¯´ <strong>Arthas</strong> çš„ä½¿ç”¨æ–¹å¼ã€‚åœ¨ä½¿ç”¨å‘½ä»¤çš„è¿‡ç¨‹ä¸­å¦‚æœæœ‰é—®é¢˜ï¼Œæ¯ä¸ªå‘½ä»¤éƒ½å¯ä»¥æ˜¯ <code>-h</code> æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ã€‚</p><p>é¦–å…ˆç¼–å†™ä¸€ä¸ªæœ‰å„ç§æƒ…å†µçš„æµ‹è¯•ç±»è¿è¡Œèµ·æ¥ï¼Œå†ä½¿ç”¨ <strong>Arthas</strong> è¿›è¡Œé—®é¢˜å®šä½ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Arthas Demo</span></span><br><span class="line"><span class="comment"> * å…¬ä¼—å·ï¼šæœªè¯»ä»£ç </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Arthas</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashSet hashSet = <span class="keyword">new</span> HashSet();</span><br><span class="line">    <span class="comment">/** çº¿ç¨‹æ± ï¼Œå¤§å°1*/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿ CPU è¿‡é«˜ï¼Œè¿™é‡Œæ³¨é‡Šæ‰äº†ï¼Œæµ‹è¯•æ—¶å¯ä»¥æ‰“å¼€</span></span><br><span class="line">        <span class="comment">// cpu();</span></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿçº¿ç¨‹é˜»å¡</span></span><br><span class="line">        thread();</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿçº¿ç¨‹æ­»é”</span></span><br><span class="line">        deadThread();</span><br><span class="line">        <span class="comment">// ä¸æ–­çš„å‘ hashSet é›†åˆå¢åŠ æ•°æ®</span></span><br><span class="line">        addHashSetThread();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸æ–­çš„å‘ hashSet é›†åˆæ·»åŠ æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addHashSetThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–å¸¸é‡</span></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    hashSet.add(<span class="string">"count"</span> + count);</span><br><span class="line">                    Thread.sleep(<span class="number">10000</span>);</span><br><span class="line">                    count++;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cpu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cpuHigh();</span><br><span class="line">        cpuNormal();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æåº¦æ¶ˆè€—CPUçš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cpuHigh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                log.info(<span class="string">"cpu start 100"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// æ·»åŠ åˆ°çº¿ç¨‹</span></span><br><span class="line">        executorService.submit(thread);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šæ¶ˆè€—CPUçš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cpuNormal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                    log.info(<span class="string">"cpu start"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¨¡æ‹Ÿçº¿ç¨‹é˜»å¡,å‘å·²ç»æ»¡äº†çš„çº¿ç¨‹æ± æäº¤çº¿ç¨‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">thread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                log.debug(<span class="string">"thread start"</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// æ·»åŠ åˆ°çº¿ç¨‹</span></span><br><span class="line">        executorService.submit(thread);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ­»é”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deadThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/** åˆ›å»ºèµ„æº */</span></span><br><span class="line">        Object resourceA = <span class="keyword">new</span> Object();</span><br><span class="line">        Object resourceB = <span class="keyword">new</span> Object();</span><br><span class="line">        <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">        Thread threadA = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (resourceA) &#123;</span><br><span class="line">                log.info(Thread.currentThread() + <span class="string">" get ResourceA"</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                log.info(Thread.currentThread() + <span class="string">"waiting get resourceB"</span>);</span><br><span class="line">                <span class="keyword">synchronized</span> (resourceB) &#123;</span><br><span class="line">                    log.info(Thread.currentThread() + <span class="string">" get resourceB"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        Thread threadB = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (resourceB) &#123;</span><br><span class="line">                log.info(Thread.currentThread() + <span class="string">" get ResourceB"</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                log.info(Thread.currentThread() + <span class="string">"waiting get resourceA"</span>);</span><br><span class="line">                <span class="keyword">synchronized</span> (resourceA) &#123;</span><br><span class="line">                    log.info(Thread.currentThread() + <span class="string">" get resourceA"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        threadA.start();</span><br><span class="line">        threadB.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-1-å…¨å±€ç›‘æ§"><a href="#4-1-å…¨å±€ç›‘æ§" class="headerlink" title="4.1 å…¨å±€ç›‘æ§"></a>4.1 å…¨å±€ç›‘æ§</h2><p>ä½¿ç”¨ <strong>dashboard</strong> å‘½ä»¤å¯ä»¥æ¦‚è§ˆç¨‹åºçš„ çº¿ç¨‹ã€å†…å­˜ã€GCã€è¿è¡Œç¯å¢ƒä¿¡æ¯ã€‚</p><p><img src="/assets/arthas/1571212470373.png" alt="dashboard"></p><h2 id="4-2-CPU-ä¸ºä»€ä¹ˆèµ·é£äº†"><a href="#4-2-CPU-ä¸ºä»€ä¹ˆèµ·é£äº†" class="headerlink" title="4.2 CPU ä¸ºä»€ä¹ˆèµ·é£äº†"></a>4.2 CPU ä¸ºä»€ä¹ˆèµ·é£äº†</h2><p>ä¸Šé¢çš„ä»£ç ä¾‹å­æœ‰ä¸€ä¸ª <code>CPU</code> ç©ºè½¬çš„æ­»å¾ªç¯ï¼Œéå¸¸çš„æ¶ˆè€— <code>CPUæ€§èƒ½</code>ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰¾å‡ºæ¥å‘¢ï¼Ÿ</p><p>ä½¿ç”¨ <strong>thread</strong>æŸ¥çœ‹<strong>æ‰€æœ‰</strong>çº¿ç¨‹ä¿¡æ¯ï¼ŒåŒæ—¶ä¼šåˆ—å‡ºæ¯ä¸ªçº¿ç¨‹çš„ <code>CPU</code> ä½¿ç”¨ç‡ï¼Œå¯ä»¥çœ‹åˆ°å›¾é‡Œ ID ä¸º12 çš„çº¿ç¨‹ CPU ä½¿ç”¨100%ã€‚<br><img src="/assets/arthas/1570983440457.png" alt=""></p><p>ä½¿ç”¨å‘½ä»¤ <strong>thread 12</strong> æŸ¥çœ‹ CPU æ¶ˆè€—è¾ƒé«˜çš„ 12 å·çº¿ç¨‹ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ° CPU ä½¿ç”¨è¾ƒé«˜çš„æ–¹æ³•å’Œè¡Œæ•°ï¼ˆè¿™é‡Œçš„è¡Œæ•°å¯èƒ½å’Œä¸Šé¢ä»£ç é‡Œçš„è¡Œæ•°æœ‰åŒºåˆ«ï¼Œå› ä¸ºä¸Šé¢çš„ä»£ç åœ¨æˆ‘å†™æ–‡ç« æ—¶å€™é‡æ–°æ’è¿‡ç‰ˆäº†ï¼‰ã€‚</p><p><img src="/assets/arthas/1570983401254.png" alt=""></p><p>ä¸Šé¢æ˜¯å…ˆé€šè¿‡è§‚å¯Ÿæ€»ä½“çš„çº¿ç¨‹ä¿¡æ¯ï¼Œç„¶åæŸ¥çœ‹å…·ä½“çš„çº¿ç¨‹è¿è¡Œæƒ…å†µã€‚å¦‚æœåªæ˜¯ä¸ºäº†å¯»æ‰¾ CPU ä½¿ç”¨è¾ƒé«˜çš„çº¿ç¨‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤ <strong>thread -n [æ˜¾ç¤ºçš„çº¿ç¨‹ä¸ªæ•°]</strong> ï¼Œå°±å¯ä»¥æ’åˆ—å‡º CPU ä½¿ç”¨ç‡ <strong>Top N</strong> çš„çº¿ç¨‹ã€‚</p><p><img src="/assets/arthas/1570983061047.png" alt=""></p><p>å®šä½åˆ°çš„ CPU ä½¿ç”¨æœ€é«˜çš„æ–¹æ³•ã€‚</p><p><img src="/assets/arthas/1571016675083.png" alt=""></p><h2 id="4-3-çº¿ç¨‹æ± çº¿ç¨‹çŠ¶æ€"><a href="#4-3-çº¿ç¨‹æ± çº¿ç¨‹çŠ¶æ€" class="headerlink" title="4.3 çº¿ç¨‹æ± çº¿ç¨‹çŠ¶æ€"></a>4.3 çº¿ç¨‹æ± çº¿ç¨‹çŠ¶æ€</h2><p>å®šä½çº¿ç¨‹é—®é¢˜ä¹‹å‰ï¼Œå…ˆå›é¡¾ä¸€ä¸‹çº¿ç¨‹çš„å‡ ç§å¸¸è§çŠ¶æ€ï¼š</p><ul><li><strong>RUNNABLE</strong> è¿è¡Œä¸­</li><li><strong>TIMED_WAITIN</strong> è°ƒç”¨äº†ä»¥ä¸‹æ–¹æ³•çš„çº¿ç¨‹ä¼šè¿›å…¥<strong>TIMED_WAITING</strong>ï¼š<ol><li>Thread#sleep()</li><li>Object#wait() å¹¶åŠ äº†è¶…æ—¶å‚æ•°</li><li>Thread#join() å¹¶åŠ äº†è¶…æ—¶å‚æ•°</li><li>LockSupport#parkNanos()</li><li>LockSupport#parkUntil()</li></ol></li><li><strong>WAITING</strong> å½“çº¿ç¨‹è°ƒç”¨ä»¥ä¸‹æ–¹æ³•æ—¶ä¼šè¿›å…¥WAITINGçŠ¶æ€ï¼š<ol><li>Object#wait() è€Œä¸”ä¸åŠ è¶…æ—¶å‚æ•°</li><li>Thread#join() è€Œä¸”ä¸åŠ è¶…æ—¶å‚æ•°</li><li>LockSupport#park()</li></ol></li><li><strong>BLOCKED</strong> é˜»å¡ï¼Œç­‰å¾…é”</li></ul><p>ä¸Šé¢çš„æ¨¡æ‹Ÿä»£ç é‡Œï¼Œå®šä¹‰äº†çº¿ç¨‹æ± å¤§å°ä¸º1 çš„çº¿ç¨‹æ± ï¼Œç„¶ååœ¨ <code>cpuHigh</code> æ–¹æ³•é‡Œæäº¤äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨ <code>thread</code>æ–¹æ³•å†æ¬¡æäº¤äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œåé¢çš„è¿™ä¸ªçº¿ç¨‹å› ä¸ºçº¿ç¨‹æ± å·²æ»¡ï¼Œä¼šé˜»å¡ä¸‹æ¥ã€‚</p><p>ä½¿ç”¨ <strong>thread | grep pool</strong> å‘½ä»¤æŸ¥çœ‹çº¿ç¨‹æ± é‡Œçº¿ç¨‹ä¿¡æ¯ã€‚</p><p><img src="/assets/arthas/1571020871537.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°çº¿ç¨‹æ± æœ‰ <strong>WAITING</strong> çš„çº¿ç¨‹ã€‚</p><p><img src="/assets/arthas/1571021838323.png" alt=""></p><h2 id="4-4-çº¿ç¨‹æ­»é”"><a href="#4-4-çº¿ç¨‹æ­»é”" class="headerlink" title="4.4 çº¿ç¨‹æ­»é”"></a>4.4 çº¿ç¨‹æ­»é”</h2><p>ä¸Šé¢çš„æ¨¡æ‹Ÿä»£ç é‡Œ <code>deadThread</code>æ–¹æ³•å®ç°äº†ä¸€ä¸ªæ­»é”ï¼Œä½¿ç”¨ <strong>thread -b</strong> å‘½ä»¤æŸ¥çœ‹ç›´æ¥å®šä½åˆ°æ­»é”ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ­»é”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deadThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** åˆ›å»ºèµ„æº */</span></span><br><span class="line">    Object resourceA = <span class="keyword">new</span> Object();</span><br><span class="line">    Object resourceB = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">    Thread threadA = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (resourceA) &#123;</span><br><span class="line">            log.info(Thread.currentThread() + <span class="string">" get ResourceA"</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            log.info(Thread.currentThread() + <span class="string">"waiting get resourceB"</span>);</span><br><span class="line">            <span class="keyword">synchronized</span> (resourceB) &#123;</span><br><span class="line">                log.info(Thread.currentThread() + <span class="string">" get resourceB"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    Thread threadB = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (resourceB) &#123;</span><br><span class="line">            log.info(Thread.currentThread() + <span class="string">" get ResourceB"</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            log.info(Thread.currentThread() + <span class="string">"waiting get resourceA"</span>);</span><br><span class="line">            <span class="keyword">synchronized</span> (resourceA) &#123;</span><br><span class="line">                log.info(Thread.currentThread() + <span class="string">" get resourceA"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    threadA.start();</span><br><span class="line">    threadB.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥åˆ°çš„æ­»é”ä¿¡æ¯ã€‚</p><p><img src="/assets/arthas/1571206638142.png" alt=""></p><h2 id="4-5-åç¼–è¯‘"><a href="#4-5-åç¼–è¯‘" class="headerlink" title="4.5 åç¼–è¯‘"></a>4.5 åç¼–è¯‘</h2><p>ä¸Šé¢çš„ä»£ç æ”¾åˆ°äº†åŒ… <code>com</code>ä¸‹ï¼Œå‡è®¾è¿™æ˜¯ä¸€ä¸ªçº¿ç¨‹ç¯å¢ƒï¼Œå½“æ€€ç–‘å½“å‰è¿è¡Œçš„ä»£ç ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ä»£ç æ—¶ï¼Œå¯ä»¥ç›´æ¥åç¼–è¯‘å‡ºä»£ç ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ€§çš„æŸ¥çœ‹ç±»çš„å­—æ®µæˆ–æ–¹æ³•ä¿¡æ¯ã€‚</p><p>å¦‚æœæ€€ç–‘ä¸æ˜¯è‡ªå·±çš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ <strong>jad</strong> å‘½ä»¤ç›´æ¥åç¼–è¯‘ classã€‚</p><p><img src="/assets/arthas/image-20191106012005747.png" alt="jad"></p><p><code>jad</code> å‘½ä»¤è¿˜æä¾›äº†ä¸€äº›å…¶ä»–å‚æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> åç¼–è¯‘åªæ˜¾ç¤ºæºç </span><br><span class="line">jad --source-only com.Arthas</span><br><span class="line"><span class="meta">#</span> åç¼–è¯‘æŸä¸ªç±»çš„æŸä¸ªæ–¹æ³•</span><br><span class="line">jad --source-only com.Arthas mysql</span><br></pre></td></tr></table></figure><h2 id="4-6-æŸ¥çœ‹å­—æ®µä¿¡æ¯"><a href="#4-6-æŸ¥çœ‹å­—æ®µä¿¡æ¯" class="headerlink" title="4.6 æŸ¥çœ‹å­—æ®µä¿¡æ¯"></a>4.6 æŸ¥çœ‹å­—æ®µä¿¡æ¯</h2><p>ä½¿ç”¨  <strong>sc -d -f </strong> å‘½ä»¤æŸ¥çœ‹ç±»çš„å­—æ®µä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@20252]$</span> sc -d -f com.Arthas</span><br><span class="line">sc -d -f com.Arthas</span><br><span class="line"> class-info        com.Arthas</span><br><span class="line"> code-source       /C:/Users/Niu/Desktop/arthas/target/classes/</span><br><span class="line"> name              com.Arthas</span><br><span class="line"> isInterface       false</span><br><span class="line"> isAnnotation      false</span><br><span class="line"> isEnum            false</span><br><span class="line"> isAnonymousClass  false</span><br><span class="line"> isArray           false</span><br><span class="line"> isLocalClass      false</span><br><span class="line"> isMemberClass     false</span><br><span class="line"> isPrimitive       false</span><br><span class="line"> isSynthetic       false</span><br><span class="line"> simple-name       Arthas</span><br><span class="line"> modifier          public</span><br><span class="line"> annotation</span><br><span class="line"> interfaces</span><br><span class="line"> super-class       +-java.lang.Object</span><br><span class="line"> class-loader      +-sun.misc.Launcher$AppClassLoader@18b4aac2</span><br><span class="line">                     +-sun.misc.Launcher$ExtClassLoader@2ef1e4fa</span><br><span class="line"> classLoaderHash   18b4aac2</span><br><span class="line"> fields            modifierfinal,private,static</span><br><span class="line">                   type    org.slf4j.Logger</span><br><span class="line">                   name    log</span><br><span class="line">                   value   Logger[com.Arthas]</span><br><span class="line"></span><br><span class="line">                   modifierprivate,static</span><br><span class="line">                   type    java.util.HashSet</span><br><span class="line">                   name    hashSet</span><br><span class="line">                   value   [count1, count2]</span><br><span class="line"></span><br><span class="line">                   modifierprivate,static</span><br><span class="line">                   type    java.util.concurrent.ExecutorService</span><br><span class="line">                   name    executorService</span><br><span class="line">                   value   java.util.concurrent.ThreadPoolExecutor@71c03156[Ru</span><br><span class="line">                           nning, pool size = 1, active threads = 1, queued ta</span><br><span class="line">                           sks = 0, completed tasks = 0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Affect(row-cnt:1) cost in 9 ms.</span><br></pre></td></tr></table></figure><h2 id="4-7-æŸ¥çœ‹æ–¹æ³•ä¿¡æ¯"><a href="#4-7-æŸ¥çœ‹æ–¹æ³•ä¿¡æ¯" class="headerlink" title="4.7 æŸ¥çœ‹æ–¹æ³•ä¿¡æ¯"></a>4.7 æŸ¥çœ‹æ–¹æ³•ä¿¡æ¯</h2><p>ä½¿ç”¨ <strong>sm</strong> å‘½ä»¤æŸ¥çœ‹ç±»çš„æ–¹æ³•ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@22180]$</span> sm com.Arthas</span><br><span class="line">com.Arthas &lt;init&gt;()V</span><br><span class="line">com.Arthas start()V</span><br><span class="line">com.Arthas thread()V</span><br><span class="line">com.Arthas deadThread()V</span><br><span class="line">com.Arthas lambda$cpuHigh$1()V</span><br><span class="line">com.Arthas cpuHigh()V</span><br><span class="line">com.Arthas lambda$thread$3()V</span><br><span class="line">com.Arthas addHashSetThread()V</span><br><span class="line">com.Arthas cpuNormal()V</span><br><span class="line">com.Arthas cpu()V</span><br><span class="line">com.Arthas lambda$addHashSetThread$0()V</span><br><span class="line">com.Arthas lambda$deadThread$4(Ljava/lang/Object;Ljava/lang/Object;)V</span><br><span class="line">com.Arthas lambda$deadThread$5(Ljava/lang/Object;Ljava/lang/Object;)V</span><br><span class="line">com.Arthas lambda$cpuNormal$2()V</span><br><span class="line">Affect(row-cnt:16) cost in 6 ms.</span><br></pre></td></tr></table></figure><h2 id="4-8-å¯¹å˜é‡çš„å€¼å¾ˆæ˜¯å¥½å¥‡"><a href="#4-8-å¯¹å˜é‡çš„å€¼å¾ˆæ˜¯å¥½å¥‡" class="headerlink" title="4.8 å¯¹å˜é‡çš„å€¼å¾ˆæ˜¯å¥½å¥‡"></a>4.8 å¯¹å˜é‡çš„å€¼å¾ˆæ˜¯å¥½å¥‡</h2><p>ä½¿ç”¨ <strong>ognl</strong> å‘½ä»¤ï¼Œognl è¡¨è¾¾å¼å¯ä»¥è½»æ¾æ“ä½œæƒ³è¦çš„ä¿¡æ¯ã€‚</p><p>ä»£ç è¿˜æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬æŸ¥çœ‹å˜é‡ <code>hashSet</code> ä¸­çš„æ•°æ®ï¼š</p><p><img src="/assets/arthas/1571196786678.png" alt=""></p><p>æŸ¥çœ‹é™æ€å˜é‡ <code>hashSet</code> ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@19856]$</span> ognl '@com.Arthas@hashSet'</span><br><span class="line">@HashSet[</span><br><span class="line">    @String[count1],</span><br><span class="line">    @String[count2],</span><br><span class="line">    @String[count29],</span><br><span class="line">    @String[count28],</span><br><span class="line">    @String[count0],</span><br><span class="line">    @String[count27],</span><br><span class="line">    @String[count5],</span><br><span class="line">    @String[count26],</span><br><span class="line">    @String[count6],</span><br><span class="line">    @String[count25],</span><br><span class="line">    @String[count3],</span><br><span class="line">    @String[count24],</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹é™æ€å˜é‡ hashSet å¤§å°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@19856]$</span> ognl '@com.Arthas@hashSet.size()'</span><br><span class="line">@Integer[57]</span><br></pre></td></tr></table></figure><p>ç”šè‡³å¯ä»¥è¿›è¡Œæ“ä½œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@19856]$</span> ognl  '@com.Arthas@hashSet.add("test")'</span><br><span class="line">@Boolean[true]</span><br><span class="line"><span class="meta">[arthas@19856]$</span></span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹æ·»åŠ çš„å­—ç¬¦</span><br><span class="line"><span class="meta">[arthas@19856]$</span> ognl  '@com.Arthas@hashSet' | grep test</span><br><span class="line">    @String[test],</span><br><span class="line"><span class="meta">[arthas@19856]$</span></span><br></pre></td></tr></table></figure><p><code>ognl</code> å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/alibaba/arthas/issues/71" target="_blank" rel="noopener">ognl è¡¨è¾¾å¼ç‰¹æ®Šç”¨æ³•( https://github.com/alibaba/arthas/issues/71 )</a>ã€‚</p><h2 id="4-9-ç¨‹åºæœ‰æ²¡æœ‰é—®é¢˜"><a href="#4-9-ç¨‹åºæœ‰æ²¡æœ‰é—®é¢˜" class="headerlink" title="4.9 ç¨‹åºæœ‰æ²¡æœ‰é—®é¢˜"></a>4.9 ç¨‹åºæœ‰æ²¡æœ‰é—®é¢˜</h2><h3 id="4-9-1-è¿è¡Œè¾ƒæ…¢ã€è€—æ—¶è¾ƒé•¿"><a href="#4-9-1-è¿è¡Œè¾ƒæ…¢ã€è€—æ—¶è¾ƒé•¿" class="headerlink" title="4.9.1 è¿è¡Œè¾ƒæ…¢ã€è€—æ—¶è¾ƒé•¿"></a>4.9.1 è¿è¡Œè¾ƒæ…¢ã€è€—æ—¶è¾ƒé•¿</h3><p>ä½¿ç”¨ <strong>trace</strong> å‘½ä»¤å¯ä»¥è·Ÿè¸ªç»Ÿè®¡æ–¹æ³•è€—æ—¶</p><p>è¿™æ¬¡æ¢ä¸€ä¸ªæ¨¡æ‹Ÿä»£ç ã€‚ä¸€ä¸ªæœ€åŸºç¡€çš„ Springboot é¡¹ç›®ï¼ˆå½“ç„¶ï¼Œä¸æƒ³ Springboot çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ UserController é‡Œ main æ–¹æ³•å¯åŠ¨ï¼‰æ§åˆ¶å±‚ <code>getUser</code> æ–¹æ³•è°ƒç”¨äº† <code>userService.get(uid);</code>ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­åˆ†åˆ«è¿›è¡Œ<code>check</code>ã€<code>service</code>ã€<code>redis</code>ã€<code>mysql</code>æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserServiceImpl userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/user"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> HashMap&lt;String, Object&gt; <span class="title">getUser</span><span class="params">(Integer uid)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿç”¨æˆ·æŸ¥è¯¢</span></span><br><span class="line">        userService.get(uid);</span><br><span class="line">        HashMap&lt;String, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">"uid"</span>, uid);</span><br><span class="line">        hashMap.put(<span class="string">"name"</span>, <span class="string">"name"</span> + uid);</span><br><span class="line">        <span class="keyword">return</span> hashMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿä»£ç  Service:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">(Integer uid)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        check(uid);</span><br><span class="line">        service(uid);</span><br><span class="line">        redis(uid);</span><br><span class="line">        mysql(uid);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(Integer uid)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            count += i;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"service  end &#123;&#125;"</span>, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">redis</span><span class="params">(Integer uid)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            count += i;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"redis  end &#123;&#125;"</span>, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mysql</span><span class="params">(Integer uid)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000000</span>; i++) &#123;</span><br><span class="line">            count += i;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"mysql end &#123;&#125;"</span>, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(Integer uid)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (uid == <span class="keyword">null</span> || uid &lt; <span class="number">0</span>) &#123;</span><br><span class="line">             log.error(<span class="string">"uidä¸æ­£ç¡®ï¼Œuid:&#123;&#125;"</span>, uid);</span><br><span class="line">             <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"uidä¸æ­£ç¡®"</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ Springboot ä¹‹åï¼Œä½¿ç”¨ <strong>trace== </strong> å‘½ä»¤å¼€å§‹æ£€æµ‹è€—æ—¶æƒ…å†µã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@6592]$</span> trace com.UserController getUser</span><br></pre></td></tr></table></figure><p>è®¿é—®æ¥å£ <code>/getUser</code> ï¼Œå¯ä»¥çœ‹åˆ°è€—æ—¶ä¿¡æ¯ï¼Œçœ‹åˆ° <code>com.UserServiceImpl:get()</code>æ–¹æ³•è€—æ—¶è¾ƒé«˜ã€‚<br><img src="/assets/arthas/1571208153793.png" alt=""></p><p>ç»§ç»­è·Ÿè¸ªè€—æ—¶é«˜çš„æ–¹æ³•ï¼Œç„¶åå†æ¬¡è®¿é—®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[arthas@6592]$</span> trace com.UserServiceImpl get</span><br></pre></td></tr></table></figure><p><img src="/assets/arthas/1571208245597.png" alt=""></p><p>å¾ˆæ¸…æ¥šçš„çœ‹åˆ°æ˜¯ <code>com.UserServiceImpl</code>çš„  <code>mysql</code>æ–¹æ³•è€—æ—¶æ˜¯æœ€é«˜çš„ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Affect(class-cnt:1 , method-cnt:1) cost in 31 ms.</span><br><span class="line">`---ts=<span class="number">2019</span>-<span class="number">10</span>-<span class="number">16</span> <span class="number">14</span>:<span class="number">40</span>:<span class="number">10</span>;thread_name=http-nio-<span class="number">8080</span>-exec-<span class="number">8</span>;id=<span class="number">1f</span>;is_daemon=<span class="keyword">true</span>;priority=<span class="number">5</span>;TCCL=org.springframework.boot.web.embedded.tomcat.TomcatEmbeddedWebappClassLoader@<span class="number">23</span>a918c7</span><br><span class="line">    `---[<span class="number">6.792201</span>ms] com.UserServiceImpl:get()</span><br><span class="line">        +---[0.008ms] com.UserServiceImpl:check() #17</span><br><span class="line">        +---[0.076ms] com.UserServiceImpl:service() #18</span><br><span class="line">        +---[0.1089ms] com.UserServiceImpl:redis() #19</span><br><span class="line">        `---[6.528899ms] com.UserServiceImpl:mysql() #20</span><br></pre></td></tr></table></figure><h3 id="4-9-2-ç»Ÿè®¡æ–¹æ³•è€—æ—¶"><a href="#4-9-2-ç»Ÿè®¡æ–¹æ³•è€—æ—¶" class="headerlink" title="4.9.2 ç»Ÿè®¡æ–¹æ³•è€—æ—¶"></a>4.9.2 ç»Ÿè®¡æ–¹æ³•è€—æ—¶</h3><p>ä½¿ç”¨ <strong>monitor</strong> å‘½ä»¤ç›‘æ§ç»Ÿè®¡æ–¹æ³•çš„æ‰§è¡Œæƒ…å†µã€‚</p><p>æ¯5ç§’ç»Ÿè®¡ä¸€æ¬¡ <code>com.UserServiceImpl</code> ç±»çš„ <code>get</code> æ–¹æ³•æ‰§è¡Œæƒ…å†µã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">monitor -c 5 com.UserServiceImpl get</span><br></pre></td></tr></table></figure><p><img src="/assets/arthas/1571210158018.png" alt=""></p><h2 id="4-10-æƒ³è§‚å¯Ÿæ–¹æ³•ä¿¡æ¯"><a href="#4-10-æƒ³è§‚å¯Ÿæ–¹æ³•ä¿¡æ¯" class="headerlink" title="4.10 æƒ³è§‚å¯Ÿæ–¹æ³•ä¿¡æ¯"></a>4.10 æƒ³è§‚å¯Ÿæ–¹æ³•ä¿¡æ¯</h2><p>ä¸‹é¢çš„ç¤ºä¾‹ç”¨åˆ°äº†æ–‡ç« çš„å‰ä¸¤ä¸ªæ¨¡æ‹Ÿä»£ç ã€‚</p><h3 id="4-10-1-è§‚å¯Ÿæ–¹æ³•çš„å…¥å‚å‡ºå‚ä¿¡æ¯"><a href="#4-10-1-è§‚å¯Ÿæ–¹æ³•çš„å…¥å‚å‡ºå‚ä¿¡æ¯" class="headerlink" title="4.10.1 è§‚å¯Ÿæ–¹æ³•çš„å…¥å‚å‡ºå‚ä¿¡æ¯"></a>4.10.1 è§‚å¯Ÿæ–¹æ³•çš„å…¥å‚å‡ºå‚ä¿¡æ¯</h3><p>ä½¿ç”¨ <strong>watch</strong> å‘½ä»¤è½»æ¾æŸ¥çœ‹è¾“å…¥è¾“å‡ºå‚æ•°ä»¥åŠå¼‚å¸¸ç­‰ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">USAGE:</span><br><span class="line">  watch [-b] [-e] [-x &lt;value&gt;] [-f] [-h] [-n &lt;value&gt;] [-E] [-M &lt;value&gt;] [-s] class-pattern method-pattern express [condition-express]</span><br><span class="line"></span><br><span class="line">SUMMARY:</span><br><span class="line">  Display the input/output parameter, return object, and thrown exception of specified method invocation</span><br><span class="line">  The express may be one of the following expression (evaluated dynamically):</span><br><span class="line">          target : the object</span><br><span class="line">           clazz : the object's class</span><br><span class="line">          method : the constructor or method</span><br><span class="line">          params : the parameters array of method</span><br><span class="line">    params[0..n] : the element of parameters array</span><br><span class="line">       returnObj : the returned object of method</span><br><span class="line">        throwExp : the throw exception of method</span><br><span class="line">        isReturn : the method ended by return</span><br><span class="line">         isThrow : the method ended by throwing exception</span><br><span class="line">           #cost : the execution time in ms of method invocation</span><br><span class="line">Examples:</span><br><span class="line">  watch -b org.apache.commons.lang.StringUtils isBlank params</span><br><span class="line">  watch -f org.apache.commons.lang.StringUtils isBlank returnObj</span><br><span class="line">  watch org.apache.commons.lang.StringUtils isBlank '&#123;params, target, returnObj&#125;' -x 2</span><br><span class="line">  watch -bf *StringUtils isBlank params</span><br><span class="line">  watch *StringUtils isBlank params[0]</span><br><span class="line">  watch *StringUtils isBlank params[0] params[0].length==1</span><br><span class="line">  watch *StringUtils isBlank params '#cost&gt;100'</span><br><span class="line">  watch -E -b org\.apache\.commons\.lang\.StringUtils isBlank params[0]</span><br><span class="line"></span><br><span class="line">WIKI:</span><br><span class="line">  https://alibaba.github.io/arthas/watch</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> æŸ¥çœ‹å…¥å‚å’Œå‡ºå‚</span><br><span class="line"><span class="meta">$</span> watch com.Arthas addHashSet '&#123;params[0],returnObj&#125;'</span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹å…¥å‚å’Œå‡ºå‚å¤§å°</span><br><span class="line"><span class="meta">$</span> watch com.Arthas addHashSet '&#123;params[0],returnObj.size&#125;'</span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹å…¥å‚å’Œå‡ºå‚ä¸­æ˜¯å¦åŒ…å« 'count10'</span><br><span class="line"><span class="meta">$</span> watch com.Arthas addHashSet '&#123;params[0],returnObj.contains("count10")&#125;'</span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹å…¥å‚å’Œå‡ºå‚ï¼Œå‡ºå‚ toString</span><br><span class="line"><span class="meta">$</span> watch com.Arthas addHashSet '&#123;params[0],returnObj.toString()&#125;'</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å…¥å‚å‡ºå‚ã€‚</p><p><img src="/assets/arthas/1571196483469.png" alt=""></p><p>æŸ¥çœ‹è¿”å›çš„å¼‚å¸¸ä¿¡æ¯ã€‚</p><h3 id="4-10-2-è§‚å¯Ÿæ–¹æ³•çš„è°ƒç”¨è·¯å¾„"><a href="#4-10-2-è§‚å¯Ÿæ–¹æ³•çš„è°ƒç”¨è·¯å¾„" class="headerlink" title="4.10.2 è§‚å¯Ÿæ–¹æ³•çš„è°ƒç”¨è·¯å¾„"></a>4.10.2 è§‚å¯Ÿæ–¹æ³•çš„è°ƒç”¨è·¯å¾„</h3><p>ä½¿ç”¨ <strong>stack</strong>å‘½ä»¤æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> è§‚å¯Ÿ ç±»com.UserServiceImplçš„ mysql æ–¹æ³•è°ƒç”¨è·¯å¾„</span><br><span class="line">stack com.UserServiceImpl mysql</span><br></pre></td></tr></table></figure><p><img src="/assets/arthas/1571210706602.png" alt=""></p><h3 id="4-10-3-æ–¹æ³•è°ƒç”¨æ—¶ç©ºéš§é“"><a href="#4-10-3-æ–¹æ³•è°ƒç”¨æ—¶ç©ºéš§é“" class="headerlink" title="4.10.3 æ–¹æ³•è°ƒç”¨æ—¶ç©ºéš§é“"></a>4.10.3 æ–¹æ³•è°ƒç”¨æ—¶ç©ºéš§é“</h3><p>ä½¿ç”¨ <strong>tt</strong> å‘½ä»¤è®°å½•æ–¹æ³•æ‰§è¡Œçš„è¯¦ç»†æƒ…å†µã€‚</p><blockquote><p><strong>tt</strong> å‘½ä»¤æ–¹æ³•æ‰§è¡Œæ•°æ®çš„æ—¶ç©ºéš§é“ï¼Œè®°å½•ä¸‹æŒ‡å®šæ–¹æ³•æ¯æ¬¡è°ƒç”¨çš„å…¥å‚å’Œè¿”å›ä¿¡æ¯ï¼Œå¹¶èƒ½å¯¹è¿™äº›ä¸åŒçš„æ—¶é—´ä¸‹è°ƒç”¨è¿›è¡Œè§‚æµ‹ ã€‚</p></blockquote><p>å¸¸ç”¨æ“ä½œï¼š</p><p>å¼€å§‹è®°å½•æ–¹æ³•è°ƒç”¨ä¿¡æ¯ï¼štt -t com.UserServiceImpl check</p><p><img src="/assets/arthas/1571212007249.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°è®°å½•ä¸­ INDEX=1001 çš„è®°å½•çš„ IS-EXP = true ï¼Œè¯´æ˜è¿™æ¬¡è°ƒç”¨å‡ºç°å¼‚å¸¸ã€‚ </p><p>æŸ¥çœ‹è®°å½•çš„æ–¹æ³•è°ƒç”¨ä¿¡æ¯ï¼š tt -l</p><p><img src="/assets/arthas/1571212080071.png" alt=""></p><p>æŸ¥çœ‹è°ƒç”¨è®°å½•çš„è¯¦ç»†ä¿¡æ¯ï¼ˆ-i æŒ‡å®š INDEXï¼‰ï¼š tt -i 1001</p><p><img src="/assets/arthas/1571212151064.png" alt=""></p><p>å¯ä»¥çœ‹åˆ° INDEX=1001 çš„è®°å½•çš„å¼‚å¸¸ä¿¡æ¯ã€‚</p><p> é‡æ–°å‘èµ·è°ƒç”¨ï¼Œä½¿ç”¨æŒ‡å®šè®°å½•ï¼Œä½¿ç”¨ -p é‡æ–°è°ƒç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt -i <span class="number">1001</span> -p</span><br></pre></td></tr></table></figure><p><img src="/assets/arthas/1571212227058.png" alt=""></p><p>æ–‡ä¸­ä»£ç å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/niumoo/lab-notes/tree/master/src/main/java/net/codingme/arthas" target="_blank" rel="noopener">Github</a>ã€‚</p><p><a href="https://github.com/niumoo/lab-notes/tree/master/src/main/java/net/codingme/arthas" target="_blank" rel="noopener">https://github.com/niumoo/lab-notes/tree/master/src/main/java/net/codingme/arthas</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/assets/arthas/arthas-1572972116473.png&quot; alt=&quot;Arthas logo&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;åœ¨ä½¿ç”¨ &lt;strong&gt;Arthas&lt;/strong&gt; ä¹‹å‰ï¼Œå½“é‡åˆ° Java çº¿ä¸Šé—®é¢˜æ—¶ï¼Œå¦‚ CPU é£™å‡ã€è´Ÿè½½çªé«˜ã€å†…å­˜æº¢å‡ºç­‰é—®é¢˜ï¼Œä½ éœ€è¦æŸ¥å‘½ä»¤ï¼ŒæŸ¥ç½‘ç»œï¼Œç„¶å jpsã€jstackã€jmapã€jhatã€jstatã€hprof ç­‰ä¸€é€šæ“ä½œã€‚æœ€ç»ˆç„¦å¤´çƒ‚é¢ï¼Œè¿˜ä¸ä¸€å®šèƒ½æŸ¥å‡ºé—®é¢˜æ‰€åœ¨ã€‚è€Œç°åœ¨ï¼Œå¤§å¤šæ•°çš„å¸¸è§é—®é¢˜ä½ éƒ½å¯ä»¥ä½¿ç”¨ &lt;strong&gt;Arthas&lt;/strong&gt; è½»æ¾å®šä½ï¼Œè¿…é€Ÿè§£å†³ï¼ŒåŠæ—¶æ­¢æŸï¼Œå‡†æ—¶ä¸‹ç­ã€‚&lt;/p&gt;
&lt;h1 id=&quot;1ã€Arthas-ä»‹ç»&quot;&gt;&lt;a href=&quot;#1ã€Arthas-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1ã€Arthas  ä»‹ç»&quot;&gt;&lt;/a&gt;1ã€Arthas  ä»‹ç»&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Arthas&lt;/strong&gt; æ˜¯ &lt;code&gt;Alibaba&lt;/code&gt; åœ¨ 2018 å¹´ 9 æœˆå¼€æºçš„ &lt;strong&gt;Java è¯Šæ–­&lt;/strong&gt;å·¥å…·ã€‚æ”¯æŒ &lt;code&gt;JDK6+&lt;/code&gt;ï¼Œ é‡‡ç”¨å‘½ä»¤è¡Œäº¤äº’æ¨¡å¼ï¼Œæä¾› &lt;code&gt;Tab&lt;/code&gt; è‡ªåŠ¨ä¸å…¨ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®šä½å’Œè¯Šæ–­çº¿ä¸Šç¨‹åºè¿è¡Œé—®é¢˜ã€‚æˆªè‡³æœ¬ç¯‡æ–‡ç« ç¼–å†™æ—¶ï¼Œå·²ç»æ”¶è· &lt;code&gt;Star&lt;/code&gt; 17000+ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Arthas&lt;/strong&gt; å®˜æ–¹æ–‡æ¡£ååˆ†è¯¦ç»†ï¼Œæœ¬æ–‡ä¹Ÿå‚è€ƒäº†å®˜æ–¹æ–‡æ¡£å†…å®¹ï¼ŒåŒæ—¶åœ¨å¼€æºåœ¨çš„ &lt;code&gt;Github&lt;/code&gt; çš„é¡¹ç›®é‡Œçš„ &lt;code&gt;Issues&lt;/code&gt; é‡Œä¸ä»…æœ‰é—®é¢˜åé¦ˆï¼Œæ›´æœ‰å¤§é‡çš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå­¦ä¹ å‚è€ƒã€‚&lt;/p&gt;
&lt;p&gt;å¼€æºåœ°å€ï¼š&lt;em&gt;&lt;a href=&quot;https://github.com/alibaba/arthas&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/alibaba/arthas&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æ–‡æ¡£ï¼š&lt;em&gt;&lt;a href=&quot;https://alibaba.github.io/arthas&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://alibaba.github.io/arthas&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="ç”Ÿäº§å·¥å…·" scheme="https://www.codingme.net/categories/%E7%94%9F%E4%BA%A7%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="é—®é¢˜å¤„ç†" scheme="https://www.codingme.net/tags/%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Jdk14éƒ½è¦å‡ºäº†ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨ Optionalä¼˜é›…çš„å¤„ç†ç©ºæŒ‡é’ˆï¼Ÿ</title>
    <link href="https://www.codingme.net/2019/11/jdk/jdk8-optional/"/>
    <id>https://www.codingme.net/2019/11/jdk/jdk8-optional/</id>
    <published>2019-11-04T00:01:01.000Z</published>
    <updated>2020-02-18T14:37:47.838Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1. å‰è¨€"></a>1. å‰è¨€</h1><blockquote><p>å¦‚æœä½ æ²¡æœ‰å¤„ç†è¿‡ç©ºæŒ‡é’ˆï¼Œé‚£ä¹ˆä½ ä¸æ˜¯ä¸€ä½çœŸæ­£çš„ Java ç¨‹åºå‘˜ã€‚</p></blockquote><p>ç©ºæŒ‡é’ˆç¡®å®ä¼šäº§ç”Ÿå¾ˆå¤šé—®é¢˜ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ç©ºçš„å¼•ç”¨ï¼Œç„¶ååˆæƒ³ä»è¿™ä¸ªç©ºçš„å¼•ç”¨ä¸Šå»è·å–å…¶ä»–çš„å€¼ï¼Œæ¥ç€ç†æ‰€å½“ç„¶çš„ç¢°åˆ°äº† <code>NullPointException</code>ã€‚è¿™æ˜¯ä½ å¯èƒ½ä¼šæƒ³ï¼Œè¿™æŠ¥é”™å¾ˆå¥½å¤„ç†ï¼Œç„¶åä½ çœ‹äº†çœ¼æŠ¥é”™è¡Œæ•°ï¼Œå¯¹æ¯”äº†ä¸‹ä»£ç ã€‚è„‘æµ·é‡Œç¬é—´é—ªè¿‡ â€å¯¹å¯¹å¯¹ï¼Œè¿™é‡Œæœ‰å¯èƒ½ä¸ºç©ºâ€œï¼Œç„¶ååŠ ä¸Š <code>null check</code>è½»æ¾å¤„ç†ã€‚ç„¶è€Œä½ ä¸çŸ¥é“è¿™å·²ç»æ˜¯ä½ å¤„ç†çš„ç¬¬å¤šå°‘ä¸ªç©ºæŒ‡é’ˆå¼‚å¸¸äº†ã€‚<br><a id="more"></a><br>ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œåœ¨ Java SE8 ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°ç±» <code>java.util.Optional</code>ï¼Œè¿™ä¸ªç±»å¯ä»¥<strong>ç¼“è§£</strong>ä¸Šé¢çš„é—®é¢˜ã€‚</p><p>ä½ å¯èƒ½å·²ç»å‘ç°äº†ï¼Œä¸Šé¢æˆ‘ç”¨çš„æ˜¯<strong>ç¼“è§£</strong>è€Œä¸æ˜¯<strong>è§£å†³</strong>ã€‚è¿™ä¹Ÿæ˜¯å¾ˆå¤šäººç†è§£ä¸å¤ªå¯¹çš„åœ°æ–¹ï¼Œä»¥ä¸º Java SE8 ä¸­çš„ <code>Optional</code> ç±»å¯ä»¥è§£å†³ç©ºæŒ‡é’ˆé—®é¢˜ã€‚å…¶å® Optional ç±»çš„çš„ä½¿ç”¨åªæ˜¯<strong>æç¤º</strong>ä½ è¿™é‡Œå¯èƒ½å­˜åœ¨ç©ºå€¼ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œå¹¶æä¾›äº†ä¸€äº›ç‰¹æ®Šå¤„ç†çš„æ–¹æ³•ã€‚å¦‚æœä½ æŠŠ <code>Optional</code> ç±»å½“ä½œç©ºæŒ‡é’ˆçš„æ•‘å‘½ç¨»è‰è€Œä¸åŠ æ€è€ƒçš„ä½¿ç”¨ï¼Œé‚£ä¹ˆä¾æ—§ä¼šç¢°åˆ°é”™è¯¯ã€‚</p><p>å› ä¸º <code>Optional</code> æ˜¯çš„ Java SE8 ä¸­å¼•å…¥çš„ï¼Œå› æ­¤æœ¬æ–‡ä¸­éš¾å…ä¼šæœ‰ä¸€äº› JDK8 ä¸­çš„è¯­æ³•ï¼Œå¦‚ <strong>Lambda</strong> è¡¨è¾¾å¼ï¼Œæµå¤„ç†ç­‰ï¼Œä½†æ˜¯éƒ½æ˜¯åŸºæœ¬å½¢å¼ï¼Œä¸ä¼šæœ‰è¿‡äºå¤æ‚çš„æ¡ˆä¾‹ã€‚</p><h1 id="2-Optional-åˆ›å»º"><a href="#2-Optional-åˆ›å»º" class="headerlink" title="2. Optional åˆ›å»º"></a>2. Optional åˆ›å»º</h1><p>Optional çš„åˆ›å»ºä¸€å…±æœ‰ä¸‰ç§æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºä¸€ä¸ª Optional</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createOptionalTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Optional æ„é€ æ–¹å¼1 - of ä¼ å…¥çš„å€¼ä¸èƒ½ä¸º null</span></span><br><span class="line">    Optional&lt;String&gt; helloOption = Optional.of(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Optional æ„é€ æ–¹å¼2 - empty ä¸€ä¸ªç©º optional</span></span><br><span class="line">    Optional&lt;String&gt; emptyOptional = Optional.empty();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Optional æ„é€ æ–¹å¼3 - ofNullable æ”¯æŒä¼ å…¥ null å€¼çš„ optional</span></span><br><span class="line">    Optional&lt;String&gt; nullOptional = Optional.ofNullable(<span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ„é€ æ–¹å¼1ä¸­ <code>of</code> æ–¹æ³•ï¼Œå¦‚æœä¼ å…¥çš„å€¼ä¼šç©ºï¼Œä¼šæŠ¥å‡º <code>NullPointerException</code> å¼‚å¸¸ã€‚</p><h1 id="3-Optional-åˆ¤æ–­"><a href="#3-Optional-åˆ¤æ–­" class="headerlink" title="3. Optional åˆ¤æ–­"></a>3. Optional åˆ¤æ–­</h1><p>Optional åªæ˜¯ä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼Œæƒ³è¦åˆ¤æ–­é‡Œé¢æœ‰æ²¡æœ‰å€¼å¯ä»¥ä½¿ç”¨ <code>isPresent</code>  æ–¹æ³•æ£€æŸ¥å…¶ä¸­æ˜¯å¦æœ‰å€¼ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ£€æŸ¥æ˜¯å¦æœ‰å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkOptionalTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Optional&lt;String&gt; helloOptional = Optional.of(<span class="string">"Hello"</span>);</span><br><span class="line">    System.out.println(helloOptional.isPresent());</span><br><span class="line"></span><br><span class="line">    Optional&lt;Object&gt; emptyOptional = Optional.empty();</span><br><span class="line">    System.out.println(emptyOptional.isPresent());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„è¾“å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br></pre></td></tr></table></figure><p>ä» JDK11 å¼€å§‹ï¼Œæä¾›äº† <code>isEmpty</code>æ–¹æ³•ç”¨æ¥æ£€æŸ¥ç›¸åçš„ç»“æœï¼šæ˜¯å¦ä¸ºç©ºã€‚</p><p>å¦‚æœæƒ³è¦åœ¨æœ‰å€¼çš„æ—¶å€™è¿›è¡Œä¸€ä¸‹æ“ä½œã€‚å¯ä»¥ä½¿ç”¨ <code>ifPresent</code>æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¦‚æœæœ‰å€¼ï¼Œè¾“å‡ºé•¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenIsPresent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰å€¼ï¼Œè·å–é»˜è®¤å€¼</span></span><br><span class="line">    Optional&lt;String&gt; helloOptional = Optional.of(<span class="string">"Hello"</span>);</span><br><span class="line">    Optional&lt;String&gt; emptyOptional = Optional.empty();</span><br><span class="line">    helloOptional.ifPresent(s -&gt; System.out.println(s.length()));</span><br><span class="line">    emptyOptional.ifPresent(s -&gt; System.out.println(s.length()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure><h1 id="4-Optional-è·å–å€¼"><a href="#4-Optional-è·å–å€¼" class="headerlink" title="4. Optional è·å–å€¼"></a>4. Optional è·å–å€¼</h1><p>ä½¿ç”¨ <code>get</code>æ–¹æ³•å¯ä»¥è·å–å€¼ï¼Œä½†æ˜¯å¦‚æœå€¼ä¸å­˜åœ¨ï¼Œä¼šæŠ›å‡º <code>NoSuchElementException</code> å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¦‚æœæ²¡æœ‰å€¼ï¼Œä¼šæŠ›å¼‚å¸¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Optional&lt;String&gt; stringOptional = Optional.of(<span class="string">"hello"</span>);</span><br><span class="line">    System.out.println(stringOptional.get());</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰å€¼ï¼Œä¼šæŠ›å¼‚å¸¸</span></span><br><span class="line">    Optional&lt;String&gt; emptyOptional = Optional.empty();</span><br><span class="line">    System.out.println(emptyOptional.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hello</span><br><span class="line"></span><br><span class="line">java.util.NoSuchElementException: No value present</span><br><span class="line">at java.util.Optional.get(Optional.java:<span class="number">135</span>)</span><br><span class="line">at net.codingme.feature.jdk8.Jdk8Optional.getTest(Jdk8Optional.java:<span class="number">91</span>)</span><br></pre></td></tr></table></figure><h1 id="5-Optional-é»˜è®¤å€¼"><a href="#5-Optional-é»˜è®¤å€¼" class="headerlink" title="5. Optional é»˜è®¤å€¼"></a>5. Optional é»˜è®¤å€¼</h1><p>ä½¿ç”¨ <code>orElse</code>, <code>orElseGet</code> æ–¹æ³•å¯ä»¥åœ¨æ²¡æœ‰å€¼çš„æƒ…å†µä¸‹è·å–ç»™å®šçš„é»˜è®¤å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¦‚æœæ²¡æœ‰å€¼ï¼Œè·å–é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenIsNullGetTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰å€¼ï¼Œè·å–é»˜è®¤å€¼</span></span><br><span class="line">    Optional&lt;String&gt; emptyOptional = Optional.empty();</span><br><span class="line">    String orElse = emptyOptional.orElse(<span class="string">"orElse default"</span>);</span><br><span class="line">    String orElseGet = emptyOptional.orElseGet(() -&gt; <span class="string">"orElseGet default"</span>);</span><br><span class="line">    System.out.println(orElse);</span><br><span class="line">    System.out.println(orElseGet);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">orElse default</span><br><span class="line">orElseGet default</span><br></pre></td></tr></table></figure></p><p>çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šæœ‰äº›ç–‘æƒ‘äº†ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çœ‹èµ·æ¥æ•ˆæœæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œä¸ºä»€ä¹ˆä¼šæä¾›ä¸¤ä¸ªå‘¢ï¼Ÿä¸‹é¢å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œä½ ä¼šå‘ç°ä¸¤è€…çš„åŒºåˆ«ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * orElse å’Œ orElseGet çš„åŒºåˆ«</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orElseAndOrElseGetTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰å€¼ï¼Œé»˜è®¤å€¼</span></span><br><span class="line">    Optional&lt;String&gt; emptyOptional = Optional.empty();</span><br><span class="line">    System.out.println(<span class="string">"ç©ºOptional.orElse"</span>);</span><br><span class="line">    String orElse = emptyOptional.orElse(getDefault());</span><br><span class="line">    System.out.println(<span class="string">"ç©ºOptional.orElseGet"</span>);</span><br><span class="line">    String orElseGet = emptyOptional.orElseGet(() -&gt; getDefault());</span><br><span class="line">    System.out.println(<span class="string">"ç©ºOptional.orElseç»“æœï¼š"</span>+orElse);</span><br><span class="line">    System.out.println(<span class="string">"ç©ºOptional.orElseGetç»“æœï¼š"</span>+orElseGet);</span><br><span class="line">    System.out.println(<span class="string">"--------------------------------"</span>);</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰å€¼ï¼Œé»˜è®¤å€¼</span></span><br><span class="line">    Optional&lt;String&gt; stringOptional = Optional.of(<span class="string">"hello"</span>);</span><br><span class="line">    System.out.println(<span class="string">"æœ‰å€¼Optional.orElse"</span>);</span><br><span class="line">    orElse = stringOptional.orElse(getDefault());</span><br><span class="line">    System.out.println(<span class="string">"æœ‰å€¼Optional.orElseGet"</span>);</span><br><span class="line">    orElseGet = stringOptional.orElseGet(() -&gt; getDefault());</span><br><span class="line">    System.out.println(<span class="string">"æœ‰å€¼Optional.orElseç»“æœï¼š"</span>+orElse);</span><br><span class="line">    System.out.println(<span class="string">"æœ‰å€¼Optional.orElseGetç»“æœï¼š"</span>+orElseGet);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getDefault</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"   è·å–é»˜è®¤å€¼ä¸­..run getDeafult method"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¾—åˆ°çš„è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ç©ºOptional.orElse</span><br><span class="line">   è·å–é»˜è®¤å€¼ä¸­..run getDeafult method</span><br><span class="line">ç©ºOptional.orElseGet</span><br><span class="line">   è·å–é»˜è®¤å€¼ä¸­..run getDeafult method</span><br><span class="line">ç©ºOptional.orElseç»“æœï¼šhello</span><br><span class="line">ç©ºOptional.orElseGetç»“æœï¼šhello</span><br><span class="line">--------------------------------</span><br><span class="line">æœ‰å€¼Optional.orElse</span><br><span class="line">   è·å–é»˜è®¤å€¼ä¸­..run getDeafult method</span><br><span class="line">æœ‰å€¼Optional.orElseGet</span><br><span class="line">æœ‰å€¼Optional.orElseç»“æœï¼šhello</span><br><span class="line">æœ‰å€¼Optional.orElseGetç»“æœï¼šhello</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¼šå‘ç° <code>orElseGet</code> ä¼ å…¥çš„æ–¹æ³•åœ¨æœ‰å€¼çš„æƒ…å†µä¸‹å¹¶ä¸ä¼šè¿è¡Œã€‚è€Œ <code>orElse</code>å´éƒ½ä¼šè¿è¡Œã€‚</p><h1 id="6-Optional-å¼‚å¸¸"><a href="#6-Optional-å¼‚å¸¸" class="headerlink" title="6. Optional å¼‚å¸¸"></a>6. Optional å¼‚å¸¸</h1><p>ä½¿ç”¨ <code>orElseThrow</code> åœ¨æ²¡æœ‰å€¼çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¦‚æœæ²¡æœ‰å€¼ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenIsNullThrowExceTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰å€¼ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    Optional&lt;String&gt; emptyOptional = Optional.empty();</span><br><span class="line">    String value = emptyOptional.orElseThrow(() -&gt; <span class="keyword">new</span> Exception(<span class="string">"å‘ç°ç©ºå€¼"</span>));</span><br><span class="line">    System.out.println(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Exception: å‘ç°ç©ºå€¼</span><br><span class="line">at net.codingme.feature.jdk8.Jdk8Optional.lambda$whenIsNullThrowExceTest$<span class="number">7</span>(Jdk8Optional.java:<span class="number">118</span>)</span><br><span class="line">at java.util.Optional.orElseThrow(Optional.java:<span class="number">290</span>)</span><br><span class="line">at net.codingme.feature.jdk8.Jdk8Optional.whenIsNullThrowExceTest(Jdk8Optional.java:<span class="number">118</span>)</span><br></pre></td></tr></table></figure><h1 id="7-Optional-å‡½æ•°æ¥å£"><a href="#7-Optional-å‡½æ•°æ¥å£" class="headerlink" title="7. Optional å‡½æ•°æ¥å£"></a>7. Optional å‡½æ•°æ¥å£</h1><p><code>Optional</code> éš JDK8 ä¸€åŒå‡ºç°ï¼Œå¿…ç„¶ä¼šæœ‰ä¸€äº› JDK8 ä¸­çš„æ–°ç‰¹æ€§ï¼Œæ¯”å¦‚å‡½æ•°æ¥å£ã€‚<code>Optional</code> ä¸­ä¸»è¦æœ‰ä¸‰ä¸ªä¼ å…¥å‡½æ•°æ¥å£çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯<code>filter</code>ï¼Œ<code>map</code>ï¼Œ<code>flatMap</code>ã€‚è¿™é‡Œé¢çš„å®ç°å…¶å®æ˜¯ JDK8 çš„å¦ä¸€ä¸ªæ–°ç‰¹æ€§äº†ï¼Œå› æ­¤è¿™é‡Œåªæ˜¯ç®€å•æ¼”ç¤ºï¼Œä¸åšè§£é‡Šã€‚åé¢æ”¾åˆ°å…¶ä»– JDK8 æ–°ç‰¹æ€§æ–‡ç« é‡Œä»‹ç»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">functionTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// filter è¿‡æ»¤</span></span><br><span class="line">    Optional&lt;Integer&gt; optional123 = Optional.of(<span class="number">123</span>);</span><br><span class="line">    optional123.filter(num -&gt; num == <span class="number">123</span>).ifPresent(num -&gt; System.out.println(num));</span><br><span class="line"></span><br><span class="line">    Optional&lt;Integer&gt; optional456 = Optional.of(<span class="number">456</span>);</span><br><span class="line">    optional456.filter(num -&gt; num == <span class="number">123</span>).ifPresent(num -&gt; System.out.println(num));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// map è½¬æ¢</span></span><br><span class="line">    Optional&lt;Integer&gt; optional789 = Optional.of(<span class="number">789</span>);</span><br><span class="line">    optional789.map(String::valueOf).map(String::length).ifPresent(length -&gt; System.out.println(length));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure><h1 id="8-Optional-æ¡ˆä¾‹"><a href="#8-Optional-æ¡ˆä¾‹" class="headerlink" title="8. Optional æ¡ˆä¾‹"></a>8. Optional æ¡ˆä¾‹</h1><p>å‡è®¾æœ‰è®¡ç®—æœºã€å£°å¡ã€usb ä¸‰ç§ç¡¬ä»¶ï¼ˆä¸‹é¢çš„ä»£ç ä¸­ä½¿ç”¨äº† <code>Lombok</code> çš„ <code>@Data</code> æ³¨è§£ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¡ç®—æœº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Optional&lt;SoundCard&gt; soundCard;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å£°å¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SoundCard</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Optional&lt;Usb&gt; usb;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * USB</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Usb</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String version;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¡ç®—æœºå¯èƒ½ä¼šæœ‰å£°å¡ï¼Œå£°å¡å¯èƒ½ä¼šæœ‰ usbã€‚é‚£ä¹ˆæ€ä¹ˆå–å¾— usb ç‰ˆæœ¬å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”µè„‘é‡Œã€æœ‰å¯èƒ½ã€‘æœ‰å£°å¡</span></span><br><span class="line"><span class="comment"> * å£°å¡ã€æœ‰å¯èƒ½ã€‘æœ‰USBæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">optionalTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ²¡æœ‰å£°å¡ï¼Œæ²¡æœ‰ Usb çš„ç”µè„‘</span></span><br><span class="line">    Computer computerNoUsb = <span class="keyword">new</span> Computer();</span><br><span class="line">    computerNoUsb.setSoundCard(Optional.empty());</span><br><span class="line">    <span class="comment">// è·å– usb ç‰ˆæœ¬</span></span><br><span class="line">    Optional&lt;Computer&gt; computerOptional = Optional.ofNullable(computerNoUsb);</span><br><span class="line">    String version = computerOptional.flatMap(Computer::getSoundCard).flatMap(SoundCard::getUsb)</span><br><span class="line">        .map(Usb::getVersion).orElse(<span class="string">"UNKNOWN"</span>);</span><br><span class="line">    System.out.println(version);</span><br><span class="line">    System.out.println(<span class="string">"-----------------"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰å€¼ï¼Œåˆ™è¾“å‡º</span></span><br><span class="line">    SoundCard soundCard = <span class="keyword">new</span> SoundCard();</span><br><span class="line">    Usb usb = <span class="keyword">new</span> Usb();</span><br><span class="line">    usb.setVersion(<span class="string">"2.0"</span>);</span><br><span class="line">    soundCard.setUsb(Optional.ofNullable(usb));</span><br><span class="line">    Optional&lt;SoundCard&gt; optionalSoundCard = Optional.ofNullable(soundCard);</span><br><span class="line">    optionalSoundCard.ifPresent(System.out::println);</span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰å€¼ï¼Œåˆ™è¾“å‡º</span></span><br><span class="line">    <span class="keyword">if</span> (optionalSoundCard.isPresent()) &#123;</span><br><span class="line">        System.out.println(optionalSoundCard.get());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºæ²¡æœ‰å€¼ï¼Œåˆ™æ²¡æœ‰è¾“å‡º</span></span><br><span class="line">    Optional&lt;SoundCard&gt; optionalSoundCardEmpty = Optional.ofNullable(<span class="keyword">null</span>);</span><br><span class="line">    optionalSoundCardEmpty.ifPresent(System.out::println);</span><br><span class="line">    System.out.println(<span class="string">"-----------------"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­›é€‰ Usb2.0</span></span><br><span class="line">    optionalSoundCard.map(SoundCard::getUsb)</span><br><span class="line">            .filter(usb1 -&gt; <span class="string">"3.0"</span>.equals(usb1.map(Usb::getVersion)</span><br><span class="line">            .orElse(<span class="string">"UBKNOW"</span>)))</span><br><span class="line">            .ifPresent(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">UNKNOWN</span><br><span class="line">-----------------</span><br><span class="line">SoundCard(usb=Optional[Usb(version=<span class="number">2.0</span>)])</span><br><span class="line">SoundCard(usb=Optional[Usb(version=<span class="number">2.0</span>)])</span><br><span class="line">-----------------</span><br></pre></td></tr></table></figure><h1 id="9-Optional-æ€»ç»“"><a href="#9-Optional-æ€»ç»“" class="headerlink" title="9. Optional æ€»ç»“"></a>9. Optional æ€»ç»“</h1><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨ Java SE8 çš„ <code>java.util.Optional</code> ç±»ã€‚<code>Optional</code> ç±»çš„ç›®çš„ä¸æ˜¯ä¸ºäº†æ›¿æ¢ä»£ç ä¸­çš„æ¯ä¸ªç©ºå¼•ç”¨ï¼Œè€Œæ˜¯ä¸ºäº†å¸®åŠ©æ›´å¥½çš„è®¾è®¡ç¨‹åºï¼Œè®©ä½¿ç”¨è€…å¯ä»¥ä»…é€šè¿‡è§‚å¯Ÿå±æ€§ç±»å‹å°±å¯ä»¥çŸ¥é“ä¼šä¸ä¼šæœ‰ç©ºå€¼ã€‚å¦å¤–ï¼Œ<code>Optional</code>ä¸æä¾›ç›´æ¥è·å–å€¼çš„æ–¹æ³•ï¼Œä½¿ç”¨æ—¶ä¼šå¼ºè¿«ä½ å¤„ç†ä¸å­˜åœ¨çš„æƒ…å†µã€‚é—´æ¥çš„è®©ä½ çš„ç¨‹åºå…å—ç©ºæŒ‡é’ˆçš„å½±å“ã€‚</p><p>æ–‡ä¸­ä»£ç å·²ç»ä¸Šä¼  <a href="https://github.com/niumoo/jdk-feature" target="_blank" rel="noopener">Github</a>ã€‚</p><p><a href="https://github.com/niumoo/jdk-feature" target="_blank" rel="noopener">https://github.com/niumoo/jdk-feature</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-å‰è¨€&quot;&gt;&lt;a href=&quot;#1-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;1. å‰è¨€&quot;&gt;&lt;/a&gt;1. å‰è¨€&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä½ æ²¡æœ‰å¤„ç†è¿‡ç©ºæŒ‡é’ˆï¼Œé‚£ä¹ˆä½ ä¸æ˜¯ä¸€ä½çœŸæ­£çš„ Java ç¨‹åºå‘˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç©ºæŒ‡é’ˆç¡®å®ä¼šäº§ç”Ÿå¾ˆå¤šé—®é¢˜ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ç©ºçš„å¼•ç”¨ï¼Œç„¶ååˆæƒ³ä»è¿™ä¸ªç©ºçš„å¼•ç”¨ä¸Šå»è·å–å…¶ä»–çš„å€¼ï¼Œæ¥ç€ç†æ‰€å½“ç„¶çš„ç¢°åˆ°äº† &lt;code&gt;NullPointException&lt;/code&gt;ã€‚è¿™æ˜¯ä½ å¯èƒ½ä¼šæƒ³ï¼Œè¿™æŠ¥é”™å¾ˆå¥½å¤„ç†ï¼Œç„¶åä½ çœ‹äº†çœ¼æŠ¥é”™è¡Œæ•°ï¼Œå¯¹æ¯”äº†ä¸‹ä»£ç ã€‚è„‘æµ·é‡Œç¬é—´é—ªè¿‡ â€å¯¹å¯¹å¯¹ï¼Œè¿™é‡Œæœ‰å¯èƒ½ä¸ºç©ºâ€œï¼Œç„¶ååŠ ä¸Š &lt;code&gt;null check&lt;/code&gt;è½»æ¾å¤„ç†ã€‚ç„¶è€Œä½ ä¸çŸ¥é“è¿™å·²ç»æ˜¯ä½ å¤„ç†çš„ç¬¬å¤šå°‘ä¸ªç©ºæŒ‡é’ˆå¼‚å¸¸äº†ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Jdk æ–°ç‰¹æ€§" scheme="https://www.codingme.net/categories/Jdk-%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
    
      <category term="Java8" scheme="https://www.codingme.net/tags/Java8/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåäº”ï¼‰å¦‚ä½•ç¼–å†™è‡ªå·±çš„ Springboot starter</title>
    <link href="https://www.codingme.net/2019/11/springboot/springboot-15-my-starter/"/>
    <id>https://www.codingme.net/2019/11/springboot/springboot-15-my-starter/</id>
    <published>2019-11-01T00:08:08.000Z</published>
    <updated>2019-11-01T00:42:48.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/assets/springboot-15-my-starter/1572539675483.png" alt="1572539675483"></p><h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1. å‰è¨€"></a>1. å‰è¨€</h1><p><code>Springboot</code> ä¸­çš„è‡ªåŠ¨é…ç½®ç¡®å®æ–¹ä¾¿ï¼Œå‡å°‘äº†æˆ‘ä»¬å¼€å‘ä¸Šçš„å¤æ‚æ€§ï¼Œé‚£ä¹ˆè‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡äº†ä¸€ç¯‡æ–‡ç« è¿›è¡Œäº†åˆ†æã€‚<br><a href="https://www.codingme.net/2019/01/springboot/springboot03-auto-config/">Springboot ç³»åˆ—ï¼ˆä¸‰ï¼‰Spring Boot è‡ªåŠ¨é…ç½®</a>ã€‚<br><a id="more"></a><br>ç”±äºè‡ªåŠ¨é…ç½®ç”¨åˆ°äº†é…ç½®æ–‡ä»¶çš„ç»‘å®šï¼Œå¦‚æœä½ è¿˜ä¸çŸ¥é“å¸¸è§çš„é…ç½®æ–‡ä»¶çš„ç”¨æ³•ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚<br><a href="https://www.codingme.net/2019/01/springboot/springboot03-auto-config/">Springboot ç³»åˆ—ï¼ˆäºŒï¼‰Spring Boot é…ç½®æ–‡ä»¶</a>ã€‚</p><p>åœ¨è¿™ä¸€æ¬¡ï¼Œé€šè¿‡å­¦ä¹  <code>Springboot</code> è‡ªåŠ¨é…ç½®æ¨¡å¼ï¼Œç¼–å†™ä¸€ä¸ªè‡ªå·±çš„ <code>starter</code>ï¼Œç”¨æ¥åŠ æ·±å¯¹è‡ªåŠ¨é…ç½®çš„ç†è§£ã€‚</p><p>ç†Ÿæ‚‰æ¨¡å¼ï¼Œæœ‰åŠ©äºæå‡ç¼–å†™çš„ <code>starter</code> çš„è§„èŒƒæ€§ï¼Œç¼–å†™è‡ªå·±çš„ <code>starter</code> ä¹‹å‰å…ˆæ¥å­¦ä¹  <code>Springboot</code> å®˜æ–¹ <code>starter</code> ä»¥åŠå¸¸è§æ¡†æ¶çš„æ•´åˆ <code>starter</code> çš„ç¼–å†™æ–¹å¼ ï¼Œå¯ä»¥é¢†ç•¥åˆ°å…¶ä¸­çš„å¥¥ç§˜ã€‚</p><h1 id="2-Springboot-å®˜æ–¹æ¨¡å¼"><a href="#2-Springboot-å®˜æ–¹æ¨¡å¼" class="headerlink" title="2. Springboot å®˜æ–¹æ¨¡å¼"></a>2. Springboot å®˜æ–¹æ¨¡å¼</h1><p>é€‰æ‹©ä¸€ä¸ªå®˜æ–¹çš„è‡ªåŠ¨é…ç½®è¿›è¡Œåˆ†æï¼Œè¿™é‡Œå°±é€‰æ‹©å¸¸è§çš„é…ç½®ç«¯å£å·é…ç½®ã€‚</p><h2 id="2-1-å¼•å…¥ä¾èµ–"><a href="#2-1-å¼•å…¥ä¾èµ–" class="headerlink" title="2.1. å¼•å…¥ä¾èµ–"></a>2.1. å¼•å…¥ä¾èµ–</h2><p>ä½¿ç”¨ç«¯å£å·ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆå¼•å…¥ web ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è§‚å¯Ÿ <code>starter</code> å¤šçš„è¯ï¼Œä¹Ÿè®¸ä½ å‘å·²ç»å‘ç°äº†ä¸€ä¸ª<strong>æ¨¡å¼</strong>ï¼Œ<code>Springboot</code> å®˜æ–¹çš„ <code>starter</code>çš„åå­—éƒ½æ˜¯  <code>spring-boot-starter-xxxx</code>å‘½åçš„ã€‚</p><p>æŸ¥çœ‹ <code>spring-boot-starter-web</code> ä¼šå‘ç°ï¼Œå…¶å®è¿™ä¸ªä¾èµ–åªæ˜¯ä¸€ä¸ªç©ºç›’å­ï¼Œé™¤äº†ä¾èµ–å…¶ä»– <code>pom</code> ä¹‹å¤–ï¼Œæ²¡æœ‰ä¸€è¡Œä»£ç ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572480685107.png" alt="spring-boot-starter-web"></p><p>è¿™æ—¶ï¼Œå‘ç°äº†å¦å¤–ä¸€ä¸ª<strong>æ¨¡å¼</strong>ï¼š<code>starter</code> åªä¾èµ–å…¶ä»– <code>pom</code>ï¼Œä¸åšä»£ç å®ç°ã€‚</p><p>é‚£ä¹ˆ <code>spring-boot-starter-web</code> åˆ°åº•ä¾èµ–äº†å“ªäº›å†…å®¹ï¼Ÿ</p><p><img src="/assets/springboot-15-my-starter/1572481136481.png" alt="spring-boot-starter-web çš„ä¾èµ–"></p><p>è§‚å¯Ÿè¿™ä¸ªä¾èµ–ä¿¡æ¯ï¼Œç„¶åå†å‚ç…§å…¶ä»–çš„å®˜æ–¹ <code>starter</code> ï¼Œå¯ä»¥æ‰¾åˆ°å‡ ä¸ªå›ºå®šçš„å¼•å…¥ï¼Œå¯ä»¥è¢«ç§°ä¹‹ä¸º<strong>æ¨¡å¼</strong>çš„ä¾èµ–å¼•å…¥ã€‚</p><ol><li>ä¾èµ– <code>spring-boot-starter</code>ã€‚</li><li>ä¾èµ– <code>spring-boot-autoconfigure</code>ã€‚</li></ol><h2 id="2-2-è‡ªåŠ¨é…ç½®"><a href="#2-2-è‡ªåŠ¨é…ç½®" class="headerlink" title="2.2. è‡ªåŠ¨é…ç½®"></a>2.2. è‡ªåŠ¨é…ç½®</h2><p>å¼•å…¥ä¾èµ–åªæœ‰é…ç½®ç«¯å£å·ï¼Œåƒè¿™æ ·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port=8090</span><br></pre></td></tr></table></figure><p>IDEA ä¸­å¯ä»¥é€šè¿‡ç‚¹å‡» <code>server.port</code> æ‰¾åˆ°è¿™ä¸ªé…ç½®ç»‘å®šçš„ç±»æ–‡ä»¶ã€‚å¯ä»¥çœ‹åˆ°é…ç½®æœ€ç»ˆä¼šæ³¨å…¥åˆ°ç±»<code>ServerProperties</code> ç±»çš„ <code>port</code> å±æ€§ä¸Šã€‚</p><p><img src="/assets/springboot-15-my-starter/1572478509712.png" alt="Server å±æ€§é…ç½®"></p><p>é‚£ä¹ˆè¿™ä¸ª <code>ServerProperties</code> åˆ°åº•æ˜¯å“ªé‡Œä½¿ç”¨çš„å‘¢ï¼Ÿç»§ç»­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ä¸€ä¸ªå’Œ <code>Servlet</code> çš„æœ‰å…³çš„è°ƒç”¨ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572478794011.png" alt="getPort çš„è°ƒç”¨"></p><p>å‘ç°æ˜¯è¢« <code>ServletWebServerFactoryCustomizer</code>ç±»è¿›è¡Œäº†è°ƒç”¨ï¼Œè¿™ä¸ªç±»é‡Œé¢å®šä¹‰äº† </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ServerProperties serverProperties;</span><br></pre></td></tr></table></figure><p>ç”¨æ¥ä½¿ç”¨é…ç½®çš„å±æ€§ã€‚<br>ç»§ç»­æŸ¥çœ‹è¿™ä¸ªç±»çš„è°ƒç”¨ï¼Œå‘ç°åªæœ‰ä¸€ä¸ªç±»ä½¿ç”¨è¿™ä¸ªç±»ï¼Œè¿™ä¸ªç±»æ˜¯<code>ServletWebServerFactoryAutoConfiguration</code>ã€‚  </p><p><img src="/assets/springboot-15-my-starter/1572479738431.png" alt="ServletWebServerFactoryAutoConfiguration ç±»"></p><p>æ ¹æ®æˆ‘ä»¬å¯¹æ³¨è§£çš„ç†è§£ï¼Œè¿™ä¸ªç±»å°±æ˜¯è‡ªåŠ¨é…ç½®ä¸»è¦ç±»äº†ã€‚åŒæ—¶è‡ªåŠ¨é…ç½®ç±»éƒ½æ˜¯ä»¥ <code>AutoConfiguration</code> ç»“å°¾ã€‚</p><p>çœ‹è¿™ä¸ªç±»çš„å‡ ä¸ªæ³¨è§£çš„æ„æ€ã€‚  </p><ol><li>ä¼˜å…ˆçº§åˆ«è¾ƒé«˜ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AutoConfigureOrder</span>(Ordered.HIGHEST_PRECEDENCE)</span><br></pre></td></tr></table></figure><ol start="2"><li>åªæœ‰åœ¨ <code>ServletRequest</code> ç±»å­˜åœ¨å’Œæ˜¯ Web åº”ç”¨æ—¶ç”Ÿæ•ˆã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnClass</span>(ServletRequest.class)</span><br><span class="line"><span class="meta">@ConditionalOnWebApplication</span>(type = Type.SERVLET)</span><br></pre></td></tr></table></figure><ol start="3"><li>å¼€å¯äº† <code>ServerProperties</code> çš„é…ç½®ç»‘å®šã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableConfigurationProperties</span>(ServerProperties.class)</span><br></pre></td></tr></table></figure><ol start="4"><li>å¯¼å…¥äº†å‡ ä¸ªç±»ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import</span>(&#123; ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class,</span><br><span class="line">ServletWebServerFactoryConfiguration.EmbeddedTomcat.class,</span><br><span class="line">ServletWebServerFactoryConfiguration.EmbeddedJetty.class,</span><br><span class="line">ServletWebServerFactoryConfiguration.EmbeddedUndertow.class &#125;)</span><br></pre></td></tr></table></figure><p>åŒæ—¶æ³¨å…¥é…ç½®åˆ° Bean å·¥å‚ä»¥ä¾›å…¶ä»–åœ°æ–¹è°ƒç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ServletWebServerFactoryCustomizer <span class="title">servletWebServerFactoryCustomizer</span><span class="params">(ServerProperties serverProperties)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ServletWebServerFactoryCustomizer(serverProperties);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨é…ç½®ä»…ä»…æ˜¯è¿™äº›ä¸œè¥¿å—ï¼Ÿæ ¹æ®ä¹‹å‰æ–‡ç« é‡Œçš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“ä¸æ­¢ä»£ç ï¼Œè‡³å°‘è¿˜æœ‰ä¸€ä¸ªæŒ‡å®šè‡ªåŠ¨é…ç½®ç±»çš„é…ç½®æ–‡ä»¶éœ€è¦è¯»å–ã€‚ä¹Ÿå°±æ˜¯ <code>spring.factories</code> æ–‡ä»¶ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572480162756.png" alt="spring.factories"></p><p>å¦‚æœä½ ä¸çŸ¥é“ï¼Œå¯ä»¥å…ˆçœ‹è¿™ç¯‡æ–‡ç« ã€‚<a href="https://www.codingme.net/2019/01/springboot/springboot03-auto-config/">Springboot ç³»åˆ—ï¼ˆä¸‰ï¼‰Spring Boot è‡ªåŠ¨é…ç½®</a> ã€‚<br>äº‹å®ç¡®å®å¦‚æ­¤ï¼Œå¯ä»¥åœ¨ <code>spring.factories</code> ä¸­æ‰¾åˆ°ä¸Šé¢è·Ÿè¸ªåˆ°çš„ç±»ã€‚<br>ä¹Ÿå°±æ˜¯ <code>ServletWebServerFactoryAutoConfiguration</code>.</p><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥å‘ç° <code>Springboot</code> å®˜æ–¹ <code>starter</code> çš„å‡ ä¸ª<strong>æ¨¡å¼</strong>ã€‚  </p><ol><li>ä½¿ç”¨ <code>XXXProperties</code> è‡ªåŠ¨ç»‘å®š <code>XXX</code> å¼€å¤´çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚ï¼š<code>ServerProperties</code>ã€‚</li><li>æŠŠ <code>XXXProperties</code> å®šä¹‰åˆ°è¦ä½¿ç”¨çš„ç±»ä¸­ï¼Œå¦‚ï¼š<code>ServletWebServerFactoryCustomizer</code>ã€‚</li><li>ç¼–å†™ä¸€ä¸ª <code>XXXAutoConfiguration</code> ï¼Œå¼€å¯  <code>XXXProperties</code> çš„è‡ªåŠ¨é…ç½®ï¼Œé™å®šç”Ÿæ•ˆåœºæ™¯ï¼Œåˆ›å»ºéœ€è¦çš„ç±»åˆ° <code>Bean</code> å·¥å‚ã€‚å¦‚ï¼š<code>ServletWebServerFactoryAutoConfiguration</code>ã€‚</li></ol><h1 id="3-ç¬¬ä¸‰æ–¹é›†æˆæ¨¡å¼"><a href="#3-ç¬¬ä¸‰æ–¹é›†æˆæ¨¡å¼" class="headerlink" title="3. ç¬¬ä¸‰æ–¹é›†æˆæ¨¡å¼"></a>3. ç¬¬ä¸‰æ–¹é›†æˆæ¨¡å¼</h1><p><code>Springboot</code> å®˜æ–¹å¦‚æœæŠŠæ‰€æœ‰çš„æ¡†æ¶éƒ½ç¼–å†™æˆ <code>starter</code>ï¼Œæ˜¯ä¸ç°å®çš„ã€‚å› æ­¤å¾ˆå¤šç¬¬ä¸‰æ–¹æ¡†æ¶éœ€è¦ä¸»åŠ¨é›†æˆåˆ° <code>springboot</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªå¸¸ç”¨çš„æ¡†æ¶åˆ†æå®ƒçš„ <code>starter</code> å®ç°ã€‚å› ä¸ºå·²ç»çœ‹è¿‡äº† <code>springboot</code> å®˜æ–¹ <code>starter</code> æ˜¯å¦‚ä½•é…ç½®çš„ï¼Œ ç¬¬ä¸‰æ–¹æ¡†æ¶ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œæ‰€ä»¥åœ¨ä¸‹é¢è§‚å¯Ÿçš„è¿‡ç¨‹ä¸­ä¼šç›´æ¥æŒ‡å‡ºç›¸åŒç‚¹ï¼Œè€Œä¸å†åšå¯¹æ¯”è¯¦ç»†å¯¹æ¯”ã€‚</p><p>è¿™é‡Œé€‰æ‹© <code>mybatis-spring-boot-starter</code> è¿›è¡Œå­¦ä¹ åˆ†æã€‚</p><h2 id="3-1-å¼•å…¥ä¾èµ–"><a href="#3-1-å¼•å…¥ä¾èµ–" class="headerlink" title="3.1 å¼•å…¥ä¾èµ–"></a>3.1 å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œ <code>mybatis</code> æ¡†æ¶çš„ <code>starter</code> ä¾èµ–ç¬¦åˆä¸€å®šçš„<strong>è§„åˆ™</strong>ï¼Œå³ <strong>xxx-spring-boot-starter</strong>.</p><p>è§‚å¯Ÿè¿™ä¸ª <code>starter</code>ï¼Œå‘ç°å®ƒä¹Ÿæ²¡æœ‰åšä»»ä½•çš„ä»£ç å®ç°ï¼Œè¿™ä¸€ç‚¹å’Œ <code>springboot</code> å®˜æ–¹ä¸€è‡´ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572532932799.png" alt="mybatis-spring-boot-starter"></p><p>æŸ¥çœ‹ <code>mybatis-spring-boot-starter</code> çš„ä¾èµ–é¡¹ï¼Œæœ‰å¾ˆå¤šï¼Œå…¶ä¸­å’Œè‡ªåŠ¨é…ç½®æœ‰å…³çš„ä¸»è¦æ˜¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-2-è‡ªåŠ¨é…ç½®"><a href="#3-2-è‡ªåŠ¨é…ç½®" class="headerlink" title="3.2 è‡ªåŠ¨é…ç½®"></a>3.2 è‡ªåŠ¨é…ç½®</h2><p>æŸ¥çœ‹ <code>mybatis-spring-boot-autoconfigure</code> çš„å†…å®¹å‘ç°å’Œ <code>springboot</code> å®˜æ–¹çš„ <code>autoconfigure</code>ç»“æ„ä¸Šæ˜¯å·®ä¸å¤šçš„ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572533517315.png" alt="mybatis-spring-boot-autoconfigure"></p><p><code>mybatis</code> çš„è‡ªåŠ¨é…ç½®ä¹Ÿæ˜¯é€šè¿‡ <code>spring.factories</code> æ¥æŒ‡æ˜è‡ªåŠ¨é…ç½®ï¼Œç„¶åé€šè¿‡ <code>XxxAutoConfiguration</code> ç»‘å®š <code>XxxProperties</code> æ¥è¿›è¡Œè‡ªåŠ¨é…ç½®.</p><p><img src="/assets/springboot-15-my-starter/1572533809395.png" alt="MybatisAutoConfiguration"></p><p>åœ¨åŸç†ä¸Šï¼Œå’Œä¸Šé¢ <code>springboot</code> å®˜æ–¹çš„ <code>starter</code>æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ä¸åšè¿‡å¤šçš„ä»‹ç»äº†ã€‚</p><h1 id="4-ç¼–å†™è‡ªå·±çš„-starter"><a href="#4-ç¼–å†™è‡ªå·±çš„-starter" class="headerlink" title="4. ç¼–å†™è‡ªå·±çš„ starter"></a>4. ç¼–å†™è‡ªå·±çš„ starter</h1><p>è¯´äº†é‚£ä¹ˆå¤šï¼Œç»ˆäºåˆ°äº†å®æ“ç¯èŠ‚ï¼Œé€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´å¾—å‡ºç¼–å†™è‡ªå·±çš„ <code>starter</code>æ­¥éª¤ã€‚</p><ol><li>åˆ›å»ºåå­—ä¸º <code>xxx-spring-boot-starter</code> çš„å¯åŠ¨å™¨é¡¹ç›®ã€‚</li><li>åˆ›å»ºåå­—ä¸º <code>xxx-spring-boot-autoconfigure</code>çš„é¡¹ç›®ã€‚<ul><li>ç¼–å†™å±æ€§ç»‘å®šç±» <code>xxxProperties</code>.</li><li>ç¼–å†™æœåŠ¡ç±»ï¼Œå¼•å…¥ <code>xxxProperties</code>.</li><li>ç¼–å†™è‡ªåŠ¨é…ç½®ç±»<code>XXXAutoConfiguration</code>æ³¨å…¥é…ç½®ã€‚</li><li>åˆ›å»º <code>spring.factories</code> æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®šè¦è‡ªåŠ¨é…ç½®çš„ç±»ã€‚</li></ul></li><li>å¯åŠ¨å™¨é¡¹ç›®ä¸ºç©ºé¡¹ç›®ï¼Œç”¨æ¥å¼•å…¥ <code>xxx-spring-boot-autoconfigure</code>ç­‰å…¶ä»–ä¾èµ–ã€‚</li><li>é¡¹ç›®å¼•å…¥ <code>starter</code>ï¼Œé…ç½®éœ€è¦é…ç½®çš„ä¿¡æ¯ã€‚</li></ol><h2 id="4-1-åˆ›å»ºå¯åŠ¨å™¨é¡¹ç›®"><a href="#4-1-åˆ›å»ºå¯åŠ¨å™¨é¡¹ç›®" class="headerlink" title="4.1 åˆ›å»ºå¯åŠ¨å™¨é¡¹ç›®"></a>4.1 åˆ›å»ºå¯åŠ¨å™¨é¡¹ç›®</h2><p>ç”±äºå¯åŠ¨å™¨ä¸éœ€è¦ä»£ç å®ç°ï¼Œåªéœ€è¦ä¾èµ–å…¶ä»–é¡¹ç›®ï¼Œæ‰€ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„ maven é¡¹ç›®ã€‚ä½†æ˜¯åå­—è¦è§„èŒƒã€‚<br>è¿™é‡Œåˆ›å»ºçš„ <code>starter</code> æ˜¯ <code>myapp-spring-boot-starter</code>ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572534904150.png" alt="myapp-spring-boot-starter"></p><p>pom æ–‡ä»¶éå¸¸ç®€å•ï¼Œåªéœ€è¦å¼•å…¥æ¥ä¸‹æ¥è¦åˆ›å»ºçš„ <code>myapp-spring-boot-autoconfigure</code>.</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.codingme.starter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>myapp-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯åŠ¨å™¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  å¼•å…¥è‡ªåŠ¨é…ç½®é¡¹ç›® --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.codingme.starter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>myapp-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-2-åˆ›å»ºè‡ªåŠ¨é…ç½®é¡¹ç›®"><a href="#4-2-åˆ›å»ºè‡ªåŠ¨é…ç½®é¡¹ç›®" class="headerlink" title="4.2 åˆ›å»ºè‡ªåŠ¨é…ç½®é¡¹ç›®"></a>4.2 åˆ›å»ºè‡ªåŠ¨é…ç½®é¡¹ç›®</h2><p>ç»“åˆä¸Šé¢å¯¹ <code>starter</code> çš„åˆ†æï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªåå­—ä¸º <code>myapp-spring-boot-autoconfigure</code> çš„é¡¹ç›®ã€‚é¡¹ç›®ä¸­åªå¼•å…¥ <code>springboot</code> çˆ¶é¡¹ç›®ä»¥åŠ <code>spring-boot-starter</code>ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.codingme.starter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>myapp-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>myapp-spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é¡¹ç›®çš„æ€»ä½“ç»“æ„çœ‹å›¾ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572536336072.png" alt="myapp-spring-boot-starter-autoconfigure"></p><p>åœ¨ <code>HelloProperties</code>ä¸­é€šè¿‡æ³¨è§£ <code>@ConfigurationProperties(prefix = &quot;myapp.hello&quot;)</code>è®©ç±»ä¸­çš„å±æ€§ä¸ <code>myapp.hello</code>å¼€å¤´çš„é…ç½®è¿›è¡Œç»‘å®šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/29 23:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"myapp.hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String suffix;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSuffix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> suffix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSuffix</span><span class="params">(String suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>HelloService</code>ä¸­çš„ <code>sayHello</code>æ–¹æ³•ä½¿ç”¨ <code>HelloProperties</code> ä¸­è‡ªåŠ¨ç»‘å®šçš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloService</span> </span>&#123;</span><br><span class="line">    HelloProperties helloProperties;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + name + <span class="string">"ï¼Œ"</span> + helloProperties.getSuffix();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloProperties <span class="title">getHelloProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helloProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHelloProperties</span><span class="params">(HelloProperties helloProperties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.helloProperties = helloProperties;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è®© <code>HelloService</code> å¯ä»¥è‡ªåŠ¨æ³¨å…¥ä¸”èƒ½æ­£å¸¸ä½¿ç”¨ <code>HelloProperties</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨<br><code>HelloServiceAutoConfiguration</code> ç±»ä¸­æŠŠ <code>HelloProperties.class</code> å¼•å…¥ï¼Œç„¶åæŠŠ <code>HelloService</code> æ³¨å…¥åˆ° <code>Bean</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * webåº”ç”¨æ‰ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®©å±æ€§æ–‡ä»¶ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(HelloProperties.class)</span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * å£°æ˜æ˜¯ä¸€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServiceAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HelloProperties helloProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloService <span class="title">helloService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        HelloService helloService = <span class="keyword">new</span> HelloService();</span><br><span class="line">        helloService.setHelloProperties(helloProperties);</span><br><span class="line">        <span class="keyword">return</span> helloService;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨ <code>spring.factories</code>ä¸­åªéœ€è¦æŒ‡å®šè¦è‡ªåŠ¨é…ç½®çš„ç±»å³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Auto Configure</span><br><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">net.codingme.starter.HelloServiceAutoConfiguration</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œè‡ªåŠ¨é…ç½®é¡¹ç›®å°±å®Œæˆäº†ã€‚å¯ä»¥åœ¨ <code>myapp-spring-boot-autoconfigure</code>é¡¹ç›®æ‰§è¡Œ <code>mvn install</code> æŠŠè‡ªåŠ¨é…ç½®é¡¹ç›®æ‰“åŒ…åˆ°æœ¬åœ°ä»“åº“ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„å‘½ä»¤æŠŠ <code>myapp-spring-boot-starter</code> å®‰è£…åˆ°ä»“åº“ã€‚å› ä¸ºåè€…ä¾èµ–äºå‰è€…é¡¹ç›®ï¼Œæ‰€ä»¥è¿™é‡Œå‰è€…éœ€è¦å…ˆè¿› <code>mvn install</code>ã€‚</p><h2 id="4-3-ä½¿ç”¨è‡ªå®šä¹‰çš„å¯åŠ¨å™¨"><a href="#4-3-ä½¿ç”¨è‡ªå®šä¹‰çš„å¯åŠ¨å™¨" class="headerlink" title="4.3 ä½¿ç”¨è‡ªå®šä¹‰çš„å¯åŠ¨å™¨"></a>4.3 ä½¿ç”¨è‡ªå®šä¹‰çš„å¯åŠ¨å™¨</h2><p>åˆ›å»ºä¸€ä¸ª <code>springboot</code>é¡¹ç›®<code>myapp-spring-boot-starter-test</code>ã€‚</p><p><img src="/assets/springboot-15-my-starter/1572537470601.png" alt="myapp-spring-boot-starter-test"></p><p>å¼•å…¥ <code>web</code> ä¾èµ–ï¼Œå¼•å…¥è‡ªå·±ç¼–å†™çš„ <code>myapp-spring-boot-starter</code>.</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¼•å…¥è‡ªå·±çš„ starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.codingme.starter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>myapp-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª <code>HelloController</code> æ³¨å…¥è‡ªåŠ¨é…ç½®é‡Œçš„ <code>HelloService</code>ç”¨äºæµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    HelloService helloService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helloService.sayHello(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº <code>autoConfigure</code>  é¡¹ç›®ä¸­å®šä¹‰äº† <code>sayHello</code>  æ–¹æ³•ä¼šè¾“å‡ºâ€œHelloâ€+ä¼ å…¥çš„ name + é…ç½®çš„ <code>hello.suffix</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ <code>springboot</code> é…ç½®æ–‡ä»¶ä¸­é…ç½®è¿™ä¸ªå±æ€§ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myapp.hello.suffix=æ—©ä¸Šå¥½</span><br></pre></td></tr></table></figure><p>è¿è¡Œæµ‹è¯•é¡¹ç›®ï¼Œè®¿é—® /hello è·¯å¾„ä¼ å…¥ä¸€ä¸ª name çœ‹çœ‹è‡ªåŠ¨é…ç½®æœ‰æ²¡æœ‰ç”Ÿæ•ˆã€‚</p><p><img src="/assets/springboot-15-my-starter/1572537886411.png" alt="è®¿é—®æµ‹è¯•"></p><p>ä»æµ‹è¯•ç»“æœå¯ä»¥çœ‹åˆ°è‡ªåŠ¨é…ç½®çš„æ—©ä¸Šå¥½å·²ç»ç”Ÿæ•ˆäº†ã€‚åˆ°è¿™é‡Œè‡ªå·±ç¼–å†™çš„ <code>starter</code>ä¹Ÿå·²ç»å®Œå·¥ã€‚</p><p>é¡¹ç›®å·²ç»ä¼ åˆ° <a href="https://github.com/niumoo/springboot/tree/master/springboot-starter" target="_blank" rel="noopener">Github</a>.<br> <a href="https://github.com/niumoo/springboot/tree/master/springboot-starter" target="_blank" rel="noopener">https://github.com/niumoo/springboot/tree/master/springboot-starter</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/assets/springboot-15-my-starter/1572539675483.png&quot; alt=&quot;1572539675483&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;1-å‰è¨€&quot;&gt;&lt;a href=&quot;#1-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;1. å‰è¨€&quot;&gt;&lt;/a&gt;1. å‰è¨€&lt;/h1&gt;&lt;p&gt;&lt;code&gt;Springboot&lt;/code&gt; ä¸­çš„è‡ªåŠ¨é…ç½®ç¡®å®æ–¹ä¾¿ï¼Œå‡å°‘äº†æˆ‘ä»¬å¼€å‘ä¸Šçš„å¤æ‚æ€§ï¼Œé‚£ä¹ˆè‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡äº†ä¸€ç¯‡æ–‡ç« è¿›è¡Œäº†åˆ†æã€‚&lt;br&gt;&lt;a href=&quot;https://www.codingme.net/2019/01/springboot/springboot03-auto-config/&quot;&gt;Springboot ç³»åˆ—ï¼ˆä¸‰ï¼‰Spring Boot è‡ªåŠ¨é…ç½®&lt;/a&gt;ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="starter" scheme="https://www.codingme.net/tags/starter/"/>
    
  </entry>
  
  <entry>
    <title>åŸæ¥çƒ­åŠ è½½å¦‚æ­¤ç®€å•ï¼Œæ‰‹åŠ¨å†™ä¸€ä¸ª Java çƒ­åŠ è½½å§</title>
    <link href="https://www.codingme.net/2019/10/jvm/java-hotput/"/>
    <id>https://www.codingme.net/2019/10/jvm/java-hotput/</id>
    <published>2019-10-28T00:35:00.000Z</published>
    <updated>2019-10-31T08:59:17.000Z</updated>
    
    <content type="html"><![CDATA[<p> <img src="/assets/java-hotput/640.webp" alt="çƒ­åŠ è½½"> </p><h1 id="1-ä»€ä¹ˆæ˜¯çƒ­åŠ è½½"><a href="#1-ä»€ä¹ˆæ˜¯çƒ­åŠ è½½" class="headerlink" title="1. ä»€ä¹ˆæ˜¯çƒ­åŠ è½½"></a>1. ä»€ä¹ˆæ˜¯çƒ­åŠ è½½</h1><p><strong>çƒ­åŠ è½½</strong>æ˜¯æŒ‡å¯ä»¥åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹è®©æ›´æ”¹çš„ä»£ç ç”Ÿæ•ˆï¼Œ<strong>çƒ­åŠ è½½</strong>å¯ä»¥æ˜¾è‘—çš„æå‡å¼€å‘ä»¥åŠè°ƒè¯•çš„æ•ˆç‡ï¼Œå®ƒæ˜¯åŸºäº Java çš„ç±»åŠ è½½å™¨å®ç°çš„ï¼Œä½†æ˜¯ç”±äºçƒ­åŠ è½½çš„ä¸å®‰å…¨æ€§ï¼Œä¸€èˆ¬ä¸ä¼šç”¨äºæ­£å¼çš„ç”Ÿäº§ç¯å¢ƒã€‚<br><a id="more"></a></p><h1 id="2-çƒ­åŠ è½½ä¸çƒ­éƒ¨ç½²çš„åŒºåˆ«"><a href="#2-çƒ­åŠ è½½ä¸çƒ­éƒ¨ç½²çš„åŒºåˆ«" class="headerlink" title="2. çƒ­åŠ è½½ä¸çƒ­éƒ¨ç½²çš„åŒºåˆ«"></a>2. çƒ­åŠ è½½ä¸çƒ­éƒ¨ç½²çš„åŒºåˆ«</h1><p>é¦–å…ˆï¼Œä¸ç®¡æ˜¯<strong>çƒ­åŠ è½½</strong>è¿˜æ˜¯çƒ­éƒ¨ç½²ï¼Œéƒ½å¯ä»¥åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹ç¼–è¯‘/éƒ¨ç½²é¡¹ç›®ï¼Œéƒ½æ˜¯åŸºäº Java çš„ç±»åŠ è½½å™¨å®ç°çš„ã€‚</p><p>é‚£ä¹ˆä¸¤è€…åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>åœ¨éƒ¨ç½²æ–¹å¼ä¸Šï¼š</p><ul><li>çƒ­éƒ¨ç½²æ˜¯åœ¨æœåŠ¡å™¨è¿è¡Œæ—¶<strong>é‡æ–°éƒ¨ç½²</strong>é¡¹ç›®ã€‚</li><li>çƒ­åŠ è½½æ˜¯åœ¨è¿è¡Œæ—¶<strong>é‡æ–°åŠ è½½ class</strong>ã€‚</li></ul><p>åœ¨å®ç°åŸç†ä¸Šï¼š</p><ul><li>çƒ­éƒ¨ç½²æ˜¯ç›´æ¥é‡æ–°<strong>åŠ è½½æ•´ä¸ªåº”ç”¨</strong>ï¼Œè€—æ—¶ç›¸å¯¹è¾ƒé«˜ã€‚</li><li>çƒ­åŠ è½½æ˜¯åœ¨è¿è¡Œæ—¶<strong>é‡æ–°åŠ è½½ class</strong>ï¼Œåå°ä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¸æ–­æ£€æµ‹ä½ çš„ç±»æ˜¯å¦æ”¹å˜ã€‚</li></ul><p>åœ¨ä½¿ç”¨åœºæ™¯ä¸Šï¼š</p><ul><li>çƒ­éƒ¨ç½²æ›´å¤šçš„æ˜¯åœ¨<strong>ç”Ÿäº§ç¯å¢ƒ</strong>ä½¿ç”¨ã€‚</li><li>çƒ­åŠ è½½åˆ™æ›´å¤šçš„æ˜¯åœ¨<strong>å¼€å‘ç¯å¢ƒ</strong>ä¸Šä½¿ç”¨ã€‚çº¿ä¸Šç”±äºå®‰å…¨æ€§é—®é¢˜ä¸ä¼šä½¿ç”¨ï¼Œéš¾ä»¥ç›‘æ§ã€‚</li></ul><h1 id="3-ç±»åŠ è½½äº”ä¸ªé˜¶æ®µ"><a href="#3-ç±»åŠ è½½äº”ä¸ªé˜¶æ®µ" class="headerlink" title="3. ç±»åŠ è½½äº”ä¸ªé˜¶æ®µ"></a>3. ç±»åŠ è½½äº”ä¸ªé˜¶æ®µ</h1><p><img src="/assets/java-hotput/1572188635986.png" alt="ç±»çš„ç”Ÿå‘½å‘¨æœŸ"></p><p>å¯èƒ½ä½ å·²ç»å‘ç°äº†ï¼Œå›¾ä¸­ä¸€å…±æ˜¯7ä¸ªé˜¶æ®µï¼Œè€Œä¸æ˜¯5ä¸ªã€‚æ˜¯å› ä¸ºå›¾æ˜¯ç±»çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœè¦è¯´åªæ˜¯ç±»åŠ è½½é˜¶æ®µçš„è¯ï¼Œå›¾é‡Œæœ€åçš„ä½¿ç”¨ï¼ˆUsingï¼‰å’Œå¸è½½ï¼ˆUnloadingï¼‰å¹¶ä¸ç®—åœ¨å†…ã€‚</p><p>ç®€å•æè¿°ä¸€ä¸‹ç±»åŠ è½½çš„äº”ä¸ªé˜¶æ®µï¼š</p><ol><li><p>åŠ è½½é˜¶æ®µï¼šæ‰¾åˆ°ç±»çš„é™æ€å­˜å‚¨ç»“æ„ï¼ŒåŠ è½½åˆ°è™šæ‹Ÿæœºï¼Œå®šä¹‰æ•°æ®ç»“æ„ã€‚ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ã€‚</p></li><li><p>éªŒè¯é˜¶æ®µï¼šç¡®ä¿å­—èŠ‚ç æ˜¯å®‰å…¨çš„ï¼Œç¡®ä¿ä¸ä¼šå¯¹è™šæ‹Ÿæœºçš„å®‰å…¨é€ æˆå±å®³ã€‚</p></li><li><p>å‡†å¤‡é˜¶æ®µï¼šç¡®å®šå†…å­˜å¸ƒå±€ï¼Œç¡®å®šå†…å­˜éå†ï¼Œèµ‹<strong>åˆå§‹å€¼</strong>ï¼ˆæ³¨æ„ï¼šæ˜¯åˆå§‹å€¼ï¼Œä¹Ÿæœ‰ç‰¹æ®Šæƒ…å†µï¼‰ã€‚</p></li><li><p>è§£æé˜¶æ®µï¼š å°†ç¬¦å·å˜æˆç›´æ¥å¼•ç”¨ã€‚</p></li><li><p>åˆå§‹åŒ–é˜¶æ®µï¼šè°ƒç”¨ç¨‹åºè‡ªå®šä¹‰çš„ä»£ç ã€‚è§„å®šæœ‰ä¸”ä»…æœ‰5ç§æƒ…å†µå¿…é¡»è¿›è¡Œåˆå§‹åŒ–ã€‚</p><ol><li>newï¼ˆå®ä¾‹åŒ–å¯¹è±¡ï¼‰ã€getstaticï¼ˆè·å–ç±»å˜é‡çš„å€¼ï¼Œè¢«finalä¿®é¥°çš„é™¤å¤–ï¼Œä»–çš„å€¼åœ¨ç¼–è¯‘å™¨æ—¶æ”¾åˆ°äº†å¸¸é‡æ± ï¼‰ã€putstaticï¼ˆç»™ç±»å˜é‡èµ‹å€¼ï¼‰ã€invokestaticï¼ˆè°ƒç”¨é™æ€æ–¹æ³•ï¼‰ æ—¶ä¼šåˆå§‹åŒ–</li><li>è°ƒç”¨å­ç±»çš„æ—¶å€™ï¼Œå‘ç°çˆ¶ç±»è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™çˆ¶ç±»éœ€è¦ç«‹å³åˆå§‹åŒ–ã€‚</li><li>è™šæ‹Ÿæœºå¯åŠ¨ï¼Œç”¨æˆ·è¦æ‰§è¡Œçš„ä¸»ç±»ï¼Œä¸»ç±»éœ€è¦ç«‹å³åˆå§‹åŒ–ï¼Œå¦‚ main æ–¹æ³•ã€‚</li><li>ä½¿ç”¨ java.lang.reflectåŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨æ–¹æ³• æ˜¯ä¼šåˆå§‹åŒ–ã€‚</li><li>å½“ä½¿ç”¨JDK 1.7çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œ å¦‚æœä¸€ä¸ªjava.lang.invoke.MethodHandleå®ä¾‹æœ€å<br>çš„è§£æç»“æœREF_getStaticã€ REF_putStaticã€ REF_invokeStaticçš„æ–¹æ³•å¥æŸ„ï¼Œ å¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„<br>æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œ åˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚  </li></ol></li></ol><p>è¦è¯´æ˜çš„æ˜¯ï¼Œç±»åŠ è½½çš„ 5 ä¸ªé˜¶æ®µä¸­ï¼Œåªæœ‰åŠ è½½é˜¶æ®µæ˜¯ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰å¤„ç†çš„ï¼Œè€ŒéªŒè¯é˜¶æ®µã€å‡†å¤‡é˜¶æ®µã€è§£æé˜¶æ®µã€åˆå§‹åŒ–é˜¶æ®µéƒ½æ˜¯ç”¨ JVM æ¥å¤„ç†çš„ã€‚</p><h1 id="4-å®ç°ç±»çš„çƒ­åŠ è½½"><a href="#4-å®ç°ç±»çš„çƒ­åŠ è½½" class="headerlink" title="4. å®ç°ç±»çš„çƒ­åŠ è½½"></a>4. å®ç°ç±»çš„çƒ­åŠ è½½</h1><h2 id="4-1-å®ç°æ€è·¯"><a href="#4-1-å®ç°æ€è·¯" class="headerlink" title="4.1 å®ç°æ€è·¯"></a>4.1 å®ç°æ€è·¯</h2><p>æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½æ‰‹åŠ¨å†™ä¸€ä¸ªç±»çš„çƒ­åŠ è½½å‘¢ï¼Ÿæ ¹æ®ä¸Šé¢çš„åˆ†æï¼ŒJava ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæŠŠ class ç±»æ–‡ä»¶åŠ è½½åˆ° JVM ä¸­ï¼Œè€Œç±»çš„åŠ è½½è¿‡ç¨‹åˆæœ‰äº”ä¸ªé˜¶æ®µï¼Œäº”ä¸ªé˜¶æ®µä¸­åªæœ‰<strong>åŠ è½½é˜¶æ®µ</strong>ç”¨æˆ·å¯ä»¥è¿›è¡Œè‡ªå®šä¹‰å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœèƒ½åœ¨ç¨‹åºä»£ç æ›´æ”¹ä¸”é‡æ–°ç¼–è¯‘åï¼Œè®©è¿è¡Œçš„è¿›ç¨‹å¯ä»¥å®æ—¶è·å–åˆ°æ–°ç¼–è¯‘åçš„ class æ–‡ä»¶ï¼Œç„¶åé‡æ–°è¿›è¡ŒåŠ è½½çš„è¯ï¼Œé‚£ä¹ˆç†è®ºä¸Šå°±å¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„ <strong>Java çƒ­åŠ è½½</strong>ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºå®ç°æ€è·¯ï¼š</p><ol><li>å®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨ã€‚</li><li>ä»è‡ªå·±çš„ç±»åŠ è½½å™¨ä¸­åŠ è½½è¦çƒ­åŠ è½½çš„ç±»ã€‚</li><li>ä¸æ–­è½®è®­è¦çƒ­åŠ è½½çš„ç±» class æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ–°ã€‚</li><li>å¦‚æœæœ‰æ›´æ–°ï¼Œé‡æ–°åŠ è½½ã€‚</li></ol><h2 id="4-2-è‡ªå®šä¹‰ç±»åŠ è½½å™¨"><a href="#4-2-è‡ªå®šä¹‰ç±»åŠ è½½å™¨" class="headerlink" title="4.2 è‡ªå®šä¹‰ç±»åŠ è½½å™¨"></a>4.2 è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h2><p>è®¾è®¡ Java è™šæ‹Ÿæœºçš„å›¢é˜ŸæŠŠç±»çš„åŠ è½½é˜¶æ®µæ”¾åˆ°çš„ JVM çš„å¤–éƒ¨å®ç°ï¼ˆ  é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ  ï¼‰ã€‚è¿™æ ·å°±å¯ä»¥è®©ç¨‹åºè‡ªå·±å†³å®šå¦‚æœè·å–åˆ°ç±»ä¿¡æ¯ã€‚è€Œå®ç°è¿™ä¸ªåŠ è½½åŠ¨ä½œçš„ä»£ç æ¨¡å—ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸º â€œç±»åŠ è½½å™¨â€ã€‚</p><p>åœ¨ Java ä¸­ï¼Œç±»åŠ è½½å™¨ä¹Ÿå°±æ˜¯  <code>java.lang.ClassLoader</code>. æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦è‡ªå·±å®ç°ä¸€ä¸ªç±»åŠ è½½å™¨ï¼Œå°±éœ€è¦ç»§æ‰¿ <code>ClassLoader</code> ç„¶åé‡å†™é‡Œé¢ <code>findClass</code>çš„æ–¹æ³•ï¼ŒåŒæ—¶å› ä¸ºç±»åŠ è½½å™¨æ˜¯ <code>åŒäº²å§”æ´¾æ¨¡å‹</code>å®ç°ï¼ˆä¹Ÿå°±è¯´ã€‚é™¤äº†ä¸€ä¸ªæœ€é¡¶å±‚çš„ç±»åŠ è½½å™¨ä¹‹å¤–ï¼Œæ¯ä¸ªç±»åŠ è½½å™¨éƒ½è¦æœ‰çˆ¶åŠ è½½å™¨ï¼Œè€ŒåŠ è½½æ—¶ï¼Œä¼šå…ˆè¯¢é—®çˆ¶åŠ è½½å™¨èƒ½å¦åŠ è½½ï¼Œå¦‚æœçˆ¶åŠ è½½å™¨ä¸èƒ½åŠ è½½ï¼Œåˆ™ä¼šè‡ªå·±å°è¯•åŠ è½½ï¼‰æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šçˆ¶åŠ è½½å™¨ã€‚</p><p>æœ€åæ ¹æ®ä¼ å…¥çš„ç±»è·¯å¾„ï¼ŒåŠ è½½ç±»çš„ä»£ç çœ‹ä¸‹é¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰ Javaç±»åŠ è½½å™¨æ¥å®ç°Java ç±»çš„çƒ­åŠ è½½</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/24 23:22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClasslLoader</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è¦åŠ è½½çš„ Java ç±»çš„ classpath è·¯å¾„ */</span></span><br><span class="line">    <span class="keyword">private</span> String classpath;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyClasslLoader</span><span class="params">(String classpath)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šçˆ¶åŠ è½½å™¨</span></span><br><span class="line">        <span class="keyword">super</span>(ClassLoader.getSystemClassLoader());</span><br><span class="line">        <span class="keyword">this</span>.classpath = classpath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">this</span>.loadClassData(name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.defineClass(name, data, <span class="number">0</span>, data.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½ class æ–‡ä»¶ä¸­çš„å†…å®¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] loadClassData(String name) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// ä¼ è¿›æ¥æ˜¯å¸¦åŒ…åçš„</span></span><br><span class="line">            name = name.replace(<span class="string">"."</span>, <span class="string">"//"</span>);</span><br><span class="line">            FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(classpath + name + <span class="string">".class"</span>));</span><br><span class="line">            <span class="comment">// å®šä¹‰å­—èŠ‚æ•°ç»„è¾“å‡ºæµ</span></span><br><span class="line">            ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            <span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((b = inputStream.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                baos.write(b);</span><br><span class="line">            &#125;</span><br><span class="line">            inputStream.close();</span><br><span class="line">            <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3-å®šä¹‰è¦çƒ­åŠ è½½çš„ç±»"><a href="#4-3-å®šä¹‰è¦çƒ­åŠ è½½çš„ç±»" class="headerlink" title="4.3 å®šä¹‰è¦çƒ­åŠ è½½çš„ç±»"></a>4.3 å®šä¹‰è¦çƒ­åŠ è½½çš„ç±»</h2><p>æˆ‘ä»¬å‡è®¾æŸä¸ªæ¥å£ï¼ˆBaseManager.javaï¼‰ä¸‹çš„æŸä¸ªæ–¹æ³•ï¼ˆlogicï¼‰è¦è¿›è¡Œçƒ­åŠ è½½å¤„ç†ã€‚</p><p>é¦–å…ˆå®šä¹‰æ¥å£ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * å®ç°è¿™ä¸ªæ¥å£çš„å­ç±»ï¼Œéœ€è¦åŠ¨æ€æ›´æ–°ã€‚ä¹Ÿå°±æ˜¯çƒ­åŠ è½½</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/24 23:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logic</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™ä¸€ä¸ªè¿™ä¸ªæ¥å£çš„å®ç°ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * BaseManager è¿™ä¸ªæ¥å£çš„å­ç±»è¦å®ç°ç±»çš„çƒ­åŠ è½½åŠŸèƒ½ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/24 23:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyManager</span> <span class="keyword">implements</span> <span class="title">BaseManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(LocalTime.now() + <span class="string">": Javaç±»çš„çƒ­åŠ è½½"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åé¢æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®©è¿™ä¸ªç±»å¯ä»¥é€šè¿‡æˆ‘ä»¬çš„ MyClassLoader è¿›è¡Œè‡ªå®šä¹‰åŠ è½½ã€‚ç±»çš„<strong>çƒ­åŠ è½½</strong>åº”å½“åªæœ‰åœ¨ç±»çš„ä¿¡æ¯è¢«æ›´æ”¹ç„¶åé‡æ–°ç¼–è¯‘ä¹‹åè¿›è¡Œé‡æ–°åŠ è½½ã€‚æ‰€ä»¥ä¸ºäº†ä¸æ„ä¹‰çš„é‡å¤åŠ è½½ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ class æ˜¯å¦è¿›è¡Œäº†æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®°å½• class ç±»çš„ä¿®æ”¹æ—¶é—´ï¼Œä»¥åŠå¯¹åº”çš„ç±»ä¿¡æ¯ã€‚</p><p>æ‰€ä»¥ç¼–è¯‘ä¸€ä¸ªç±»ç”¨æ¥è®°å½•æŸä¸ªç±»å¯¹åº”çš„æŸä¸ªç±»åŠ è½½å™¨ä»¥åŠä¸Šæ¬¡åŠ è½½çš„ class çš„ä¿®æ”¹æ—¶é—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * å°è£…åŠ è½½ç±»çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/24 23:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoadInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ */</span></span><br><span class="line">    <span class="keyword">private</span> MyClasslLoader myClasslLoader;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è®°å½•è¦åŠ è½½çš„ç±»çš„æ—¶é—´æˆ³--&gt;åŠ è½½çš„æ—¶é—´ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> loadTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** éœ€è¦è¢«çƒ­åŠ è½½çš„ç±» */</span></span><br><span class="line">    <span class="keyword">private</span> BaseManager manager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoadInfo</span><span class="params">(MyClasslLoader myClasslLoader, <span class="keyword">long</span> loadTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myClasslLoader = myClasslLoader;</span><br><span class="line">        <span class="keyword">this</span>.loadTime = loadTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyClasslLoader <span class="title">getMyClasslLoader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> myClasslLoader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyClasslLoader</span><span class="params">(MyClasslLoader myClasslLoader)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myClasslLoader = myClasslLoader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getLoadTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> loadTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLoadTime</span><span class="params">(<span class="keyword">long</span> loadTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.loadTime = loadTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BaseManager <span class="title">getManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> manager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setManager</span><span class="params">(BaseManager manager)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.manager = manager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4-çƒ­åŠ è½½è·å–ç±»ä¿¡æ¯"><a href="#4-4-çƒ­åŠ è½½è·å–ç±»ä¿¡æ¯" class="headerlink" title="4.4 çƒ­åŠ è½½è·å–ç±»ä¿¡æ¯"></a>4.4 çƒ­åŠ è½½è·å–ç±»ä¿¡æ¯</h2><p>åœ¨å®ç°æ€è·¯é‡Œï¼Œæˆ‘ä»¬çŸ¥é“è½®è®­æ£€æŸ¥ class æ–‡ä»¶æ˜¯ä¸æ˜¯è¢«æ›´æ–°è¿‡ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨è¦çƒ­åŠ è½½çš„ç±»æ—¶ï¼Œæˆ‘ä»¬éƒ½è¦è¿›è¡Œæ£€æŸ¥ç±»æ˜¯å¦è¢«æ›´æ–°ç„¶åå†³å®šè¦ä¸è¦é‡æ–°åŠ è½½ã€‚ä¸ºäº†æ–¹ä¾¿è¿™æ­¥çš„è·å–æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å·¥å‚æ¨¡å¼è¿›è¡Œå°è£…ã€‚</p><p>è¦æ³¨æ„æ˜¯åŠ è½½ class æ–‡ä»¶éœ€è¦æŒ‡å®šå®Œæ•´çš„è·¯å¾„ï¼Œæ‰€ä»¥ç±»ä¸­å®šä¹‰äº† CLASS_PATH å¸¸é‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * åŠ è½½ manager çš„å·¥å‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/24 23:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ManagerFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è®°å½•çƒ­åŠ è½½ç±»çš„åŠ è½½ä¿¡æ¯ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, LoadInfo&gt; loadTimeMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è¦åŠ è½½çš„ç±»çš„ classpath */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CLASS_PATH = <span class="string">"D:\\IdeaProjectMy\\lab-notes\\target\\classes\\"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å®ç°çƒ­åŠ è½½çš„ç±»çš„å…¨åç§°(åŒ…å+ç±»å ) */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MY_MANAGER = <span class="string">"net.codingme.box.classloader.MyManager"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BaseManager <span class="title">getManager</span><span class="params">(String className)</span> </span>&#123;</span><br><span class="line">        File loadFile = <span class="keyword">new</span> File(CLASS_PATH + className.replaceAll(<span class="string">"\\."</span>, <span class="string">"/"</span>) + <span class="string">".class"</span>);</span><br><span class="line">        <span class="comment">// è·å–æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´</span></span><br><span class="line">        <span class="keyword">long</span> lastModified = loadFile.lastModified();</span><br><span class="line">        System.out.println(<span class="string">"å½“å‰çš„ç±»æ—¶é—´ï¼š"</span> + lastModified);</span><br><span class="line">        <span class="comment">// loadTimeMap ä¸åŒ…å« ClassName ä¸º key çš„ä¿¡æ¯ï¼Œè¯æ˜è¿™ä¸ªç±»æ²¡æœ‰è¢«åŠ è½½ï¼Œè¦åŠ è½½åˆ° JVM</span></span><br><span class="line">        <span class="keyword">if</span> (loadTimeMap.get(className) == <span class="keyword">null</span>) &#123;</span><br><span class="line">            load(className, lastModified);</span><br><span class="line">        &#125; <span class="comment">// åŠ è½½ç±»çš„æ—¶é—´æˆ³å˜åŒ–äº†ï¼Œæˆ‘ä»¬åŒæ ·è¦é‡æ–°åŠ è½½è¿™ä¸ªç±»åˆ° JVMã€‚</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (loadTimeMap.get(className).getLoadTime() != lastModified) &#123;</span><br><span class="line">            load(className, lastModified);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> loadTimeMap.get(className).getManager();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½ class ï¼Œç¼“å­˜åˆ° loadTimeMap</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> className</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lastModified</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(String className, <span class="keyword">long</span> lastModified)</span> </span>&#123;</span><br><span class="line">        MyClasslLoader myClasslLoader = <span class="keyword">new</span> MyClasslLoader(className);</span><br><span class="line">        Class loadClass = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// åŠ è½½</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            loadClass = myClasslLoader.loadClass(className);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BaseManager manager = newInstance(loadClass);</span><br><span class="line">        LoadInfo loadInfo = <span class="keyword">new</span> LoadInfo(myClasslLoader, lastModified);</span><br><span class="line">        loadInfo.setManager(manager);</span><br><span class="line">        loadTimeMap.put(className, loadInfo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»¥åå°„çš„æ–¹å¼åˆ›å»º BaseManager çš„å­ç±»å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loadClass</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> BaseManager <span class="title">newInstance</span><span class="params">(Class loadClass)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (BaseManager)loadClass.getConstructor(<span class="keyword">new</span> Class[] &#123;&#125;).newInstance(<span class="keyword">new</span> Object[] &#123;&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-5-çƒ­åŠ è½½æµ‹è¯•"><a href="#4-5-çƒ­åŠ è½½æµ‹è¯•" class="headerlink" title="4.5  çƒ­åŠ è½½æµ‹è¯•"></a>4.5  çƒ­åŠ è½½æµ‹è¯•</h2><p>ç›´æ¥å†™ä¸€ä¸ªçº¿ç¨‹ä¸æ–­çš„æ£€æµ‹è¦çƒ­åŠ è½½çš„ç±»æ˜¯ä¸æ˜¯å·²ç»æ›´æ”¹éœ€è¦é‡æ–°åŠ è½½ï¼Œç„¶åè¿è¡Œæµ‹è¯•å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * åå°å¯åŠ¨ä¸€æ¡çº¿ç¨‹ï¼Œä¸æ–­æ£€æµ‹æ˜¯å¦è¦åˆ·æ–°é‡æ–°åŠ è½½ï¼Œå®ç°äº†çƒ­åŠ è½½çš„ç±»</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/10/24 23:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MsgHandle</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            BaseManager manager = ManagerFactory.getManager(ManagerFactory.MY_MANAGER);</span><br><span class="line">            manager.logic();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»çº¿ç¨‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.box.classloader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassLoadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> MsgHandle()).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç å·²ç»å…¨éƒ¨å‡†å¤‡å¥½äº†ï¼Œæœ€åä¸€æ­¥ï¼Œå¯ä»¥å¯åŠ¨æµ‹è¯•äº†ã€‚å¦‚æœä½ æ˜¯ç”¨çš„æ˜¯ Eclipse ï¼Œç›´æ¥å¯åŠ¨å°±è¡Œäº†ï¼›å¦‚æœæ˜¯ IDEA ï¼Œé‚£ä¹ˆä½ éœ€è¦ DEBUG æ¨¡å¼å¯åŠ¨ï¼ˆIDEA å¯¹çƒ­åŠ è½½æœ‰ä¸€å®šçš„é™åˆ¶ï¼‰ã€‚</p><p>å¯åŠ¨åçœ‹åˆ°æ§åˆ¶å°ä¸æ–­çš„è¾“å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">00:08:13.018: Javaç±»çš„çƒ­åŠ è½½</span><br><span class="line">00:08:15.018: Javaç±»çš„çƒ­åŠ è½½</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬éšä¾¿æ›´æ”¹ä¸‹ MyManager ç±»çš„ logic æ–¹æ³•çš„è¾“å‡ºå†…å®¹ç„¶åä¿å­˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     System.out.println(LocalTime.now() + <span class="string">": Javaç±»çš„çƒ­åŠ è½½ Oh~~~~"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ§åˆ¶å°çš„è¾“å‡ºå·²ç»è‡ªåŠ¨æ›´æ”¹äº†ï¼ˆIDEA åœ¨æ›´æ”¹åéœ€è¦æŒ‰ CTRL + F9ï¼‰ã€‚</p><p><img src="/assets/java-hotput/1572192565262.png" alt="ç±»çš„çƒ­åŠ è½½"></p><p>ä»£ç å·²ç»æ”¾åˆ°Github: <a href="https://github.com/niumoo/lab-notes/" target="_blank" rel="noopener">https://github.com/niumoo/lab-notes/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt; &lt;img src=&quot;/assets/java-hotput/640.webp&quot; alt=&quot;çƒ­åŠ è½½&quot;&gt; &lt;/p&gt;
&lt;h1 id=&quot;1-ä»€ä¹ˆæ˜¯çƒ­åŠ è½½&quot;&gt;&lt;a href=&quot;#1-ä»€ä¹ˆæ˜¯çƒ­åŠ è½½&quot; class=&quot;headerlink&quot; title=&quot;1. ä»€ä¹ˆæ˜¯çƒ­åŠ è½½&quot;&gt;&lt;/a&gt;1. ä»€ä¹ˆæ˜¯çƒ­åŠ è½½&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;çƒ­åŠ è½½&lt;/strong&gt;æ˜¯æŒ‡å¯ä»¥åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹è®©æ›´æ”¹çš„ä»£ç ç”Ÿæ•ˆï¼Œ&lt;strong&gt;çƒ­åŠ è½½&lt;/strong&gt;å¯ä»¥æ˜¾è‘—çš„æå‡å¼€å‘ä»¥åŠè°ƒè¯•çš„æ•ˆç‡ï¼Œå®ƒæ˜¯åŸºäº Java çš„ç±»åŠ è½½å™¨å®ç°çš„ï¼Œä½†æ˜¯ç”±äºçƒ­åŠ è½½çš„ä¸å®‰å…¨æ€§ï¼Œä¸€èˆ¬ä¸ä¼šç”¨äºæ­£å¼çš„ç”Ÿäº§ç¯å¢ƒã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Java è™šæ‹Ÿæœº" scheme="https://www.codingme.net/categories/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    
      <category term="jvm" scheme="https://www.codingme.net/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>Jdk14 éƒ½è¦å‡ºäº†ï¼ŒJdk8 çš„æ—¶é—´å¤„ç†å§¿åŠ¿è¿˜ä¸äº†è§£ä¸€ä¸‹ï¼Ÿ</title>
    <link href="https://www.codingme.net/2019/10/jdk/jdk8-time/"/>
    <id>https://www.codingme.net/2019/10/jdk/jdk8-time/</id>
    <published>2019-10-24T00:01:01.000Z</published>
    <updated>2019-10-24T00:28:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>å½“å‰æ—¶é—´ï¼š2019å¹´10æœˆ24æ—¥ã€‚è·ç¦» JDK 14 å‘å¸ƒæ—¶é—´ï¼ˆ2020å¹´3æœˆ17æ—¥ï¼‰è¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ</span></span><br><span class="line">LocalDate jdk14 = LocalDate.of(<span class="number">2020</span>, <span class="number">3</span>, <span class="number">17</span>);</span><br><span class="line">LocalDate nowDate = LocalDate.now();</span><br><span class="line">System.out.println(<span class="string">"è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰ï¼š"</span>+nowDate.until(jdk14,ChronoUnit.DAYS)+<span class="string">"å¤©"</span>);</span><br></pre></td></tr></table></figure><a id="more"></a><p>JDK 8 å·²ç»åœ¨ 2014å¹´ 3æœˆ 18æ—¥æ­£å¼å¯ç”¨ ï¼Œè·ç¦»ç°åœ¨å·²ç» 5å¹´å¤šæ—¶é—´è¿‡å»äº†ã€‚5å¹´æ—¶é—´é‡Œå¾ˆå¤šä¼ä¸šä¹Ÿéƒ½æ¢ä¸Šäº† JDK 8ï¼Œæ˜å¹´ 3æœˆä»½ Jdk14 ä¹Ÿè¦æ¥äº†ï¼Œé‚£ä¹ˆ Jdk 8 çš„æ–°ç‰¹æ€§ä½ çœŸçš„ç”¨èµ·æ¥äº†å—ï¼Ÿæˆ‘å‡†å¤‡å†™ä¸€ä¸ª Jdk 8å¼€å§‹çš„æ–°ç‰¹æ€§ä»‹ç»ä»¥åŠä½¿ç”¨çš„ç³»åˆ—æ–‡ç« ï¼Œåç»­ Jdk ä¹Ÿä¼šç»§ç»­æ›´æ–°ï¼Œä½ å¦‚æœéœ€è¦çš„è¯ä¸å¦¨å…³æ³¨ä¸‹åšå®¢æˆ–è€…å…¬ä¼—å·ã€‚</p><h2 id="1-æ—¶é—´å¤„ç†ç±»"><a href="#1-æ—¶é—´å¤„ç†ç±»" class="headerlink" title="1. æ—¶é—´å¤„ç†ç±»"></a>1. æ—¶é—´å¤„ç†ç±»</h2><p>Jdk8 å¸¦æ¥äº†å…¨æ–°çš„æ—¶é—´å¤„ç†å·¥å…·ç±»ï¼Œç”¨äºä»£æ›¿ä¹‹å‰å­˜åœ¨ç¼ºé™·çš„æ—¶é—´å¤„ç†ã€‚æ–°çš„æ—¶é—´å¤„ç†ç›¸æ¯”ä¹‹å‰æ›´åŠ ç®€å•å¥½ç”¨ã€‚</p><p><img src="/assets/jdk8-time/1571847428464-1571848139345.png" alt="Jdk8 æ—¶é—´å¤„ç†ç±»"></p><p>å¸¸ç”¨çš„ç±»æœ‰ä»¥ä¸‹å‡ ä¸ªç±»ã€‚</p><table><thead><tr><th>æ—¶é—´ç›¸å…³ç±»</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>LocalDateTime</td><td>æ—¶é—´å¤„ç†ç±»ï¼Œæœ€é«˜ç²¾ç¡®åˆ°çº³ç§’</td></tr><tr><td>LocalDate</td><td>æ—¶é—´å¤„ç†ç±»ï¼Œæœ€é«˜ç²¾ç¡®åˆ°å¤©</td></tr><tr><td>DateTimeFormatter</td><td>æ—¶é—´æ ¼å¼åŒ–</td></tr><tr><td>ZoneId</td><td>æ—¶åŒºè®¾ç½®ç±»</td></tr></tbody></table><h2 id="2-æ—¶é—´è·å–"><a href="#2-æ—¶é—´è·å–" class="headerlink" title="2. æ—¶é—´è·å–"></a>2. æ—¶é—´è·å–</h2><p>ä½¿ç”¨ä¸åŒçš„ç±»å¯ä»¥è·å–ä¸åŒç²¾åº¦çš„æ—¶é—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¶é—´è·å–</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">nowTimeTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å½“å‰ç²¾ç¡®æ—¶é—´</span></span><br><span class="line">    LocalDateTime now = LocalDateTime.now();</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰ç²¾ç¡®æ—¶é—´ï¼š"</span> + now);</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰ç²¾ç¡®æ—¶é—´ï¼š"</span> + now.getYear() + <span class="string">"-"</span> + now.getMonthValue() + <span class="string">"-"</span> + now.getDayOfMonth() + <span class="string">" "</span> + now.getHour() + <span class="string">"-"</span> + now.getMinute() + <span class="string">"-"</span> + now.getSecond());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å‰æ—¥æœŸ</span></span><br><span class="line">    LocalDate localDate = LocalDate.now();</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¥æœŸï¼š"</span> + localDate);</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¥æœŸï¼š"</span> + localDate.getYear() + <span class="string">"-"</span> + localDate.getMonthValue() + <span class="string">"-"</span> + localDate.getDayOfMonth());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å¤©æ—¶é—´</span></span><br><span class="line">    LocalTime localTime = LocalTime.now();</span><br><span class="line">    System.out.println(<span class="string">"å½“å¤©æ—¶é—´ï¼š"</span> + localTime);</span><br><span class="line">    System.out.println(<span class="string">"å½“å¤©æ—¶é—´ï¼š"</span> + localTime.getHour() + <span class="string">":"</span> + localTime.getMinute() + <span class="string">":"</span> + localTime.getSecond());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æœ‰æ—¶åŒºçš„å½“å‰ç²¾ç¡®æ—¶é—´</span></span><br><span class="line">    ZonedDateTime nowZone = LocalDateTime.now().atZone(ZoneId.systemDefault());</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰ç²¾ç¡®æ—¶é—´ï¼ˆæœ‰æ—¶åŒºï¼‰ï¼š"</span> + nowZone);</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰ç²¾ç¡®æ—¶é—´ï¼ˆæœ‰æ—¶åŒºï¼‰ï¼š"</span> + nowZone.getYear() + <span class="string">"-"</span> + nowZone.getMonthValue() + <span class="string">"-"</span> + nowZone.getDayOfMonth() + <span class="string">" "</span> + nowZone.getHour() + <span class="string">"-"</span> + nowZone.getMinute() + <span class="string">"-"</span> + nowZone.getSecond());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–åˆ°çš„æ—¶é—´ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰ç²¾ç¡®æ—¶é—´ï¼š2019-10-24T00:26:41.724</span><br><span class="line">å½“å‰ç²¾ç¡®æ—¶é—´ï¼š2019-10-24 0-26-41</span><br><span class="line">å½“å‰æ—¥æœŸï¼š2019-10-24</span><br><span class="line">å½“å‰æ—¥æœŸï¼š2019-10-24</span><br><span class="line">å½“å‰ç²¾ç¡®æ—¶é—´ï¼ˆæœ‰æ—¶åŒºï¼‰ï¼š2019-10-24T00:26:41.725+08:00[GMT+08:00]</span><br><span class="line">å½“å‰ç²¾ç¡®æ—¶é—´ï¼ˆæœ‰æ—¶åŒºï¼‰ï¼š2019-10-24 0-26-41</span><br><span class="line">å½“å¤©æ—¶é—´ï¼š00:26:41.725</span><br><span class="line">å½“å¤©æ—¶é—´ï¼š0:26:41</span><br></pre></td></tr></table></figure><h2 id="3-æ—¶é—´åˆ›å»º"><a href="#3-æ—¶é—´åˆ›å»º" class="headerlink" title="3. æ—¶é—´åˆ›å»º"></a>3. æ—¶é—´åˆ›å»º</h2><p>å¯ä»¥æŒ‡å®šå¹´æœˆæ—¥æ—¶åˆ†ç§’åˆ›å»ºä¸€ä¸ªæ—¶é—´ç±»ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ç›´æ¥è½¬æ¢æˆæ—¶é—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¶é—´åˆ›å»º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocalDateTime ofTime = LocalDateTime.of(<span class="number">2019</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>);</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰ç²¾ç¡®æ—¶é—´ï¼š"</span> + ofTime);</span><br><span class="line"></span><br><span class="line">    LocalDate localDate = LocalDate.of(<span class="number">2019</span>, <span class="number">10</span>, <span class="number">01</span>);</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¥æœŸï¼š"</span> + localDate);</span><br><span class="line"></span><br><span class="line">    LocalTime localTime = LocalTime.of(<span class="number">12</span>, <span class="number">01</span>, <span class="number">01</span>);</span><br><span class="line">    System.out.println(<span class="string">"å½“å¤©æ—¶é—´ï¼š"</span> + localTime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºçš„æ—¶é—´ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰ç²¾ç¡®æ—¶é—´ï¼š2019-10-01T08:08:08</span><br><span class="line">å½“å‰æ—¥æœŸï¼š2019-10-01</span><br><span class="line">å½“å¤©æ—¶é—´ï¼š12:01:01</span><br></pre></td></tr></table></figure><h2 id="4-æ—¶é—´è½¬æ¢"><a href="#4-æ—¶é—´è½¬æ¢" class="headerlink" title="4. æ—¶é—´è½¬æ¢"></a>4. æ—¶é—´è½¬æ¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ—¥æœŸè½¬æ¢</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">convertTimeTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocalDateTime parseTime = LocalDateTime.parse(<span class="string">"2019-10-01T22:22:22.222"</span>);</span><br><span class="line">    System.out.println(<span class="string">"å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢ï¼š"</span> + parseTime);</span><br><span class="line"></span><br><span class="line">    LocalDate formatted = LocalDate.parse(<span class="string">"20190101"</span>, DateTimeFormatter.BASIC_ISO_DATE);</span><br><span class="line">    System.out.println(<span class="string">"å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢-æŒ‡å®šæ ¼å¼ï¼š"</span> + formatted);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Date è½¬æ¢æˆ LocalDateTime</span></span><br><span class="line">    Date date = <span class="keyword">new</span> Date();</span><br><span class="line">    ZoneId zoneId = ZoneId.systemDefault();</span><br><span class="line">    System.out.println(<span class="string">"Date è½¬æ¢æˆ LocalDateTimeï¼š"</span> + LocalDateTime.ofInstant(date.toInstant(), zoneId));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// LocalDateTime è½¬æ¢æˆ Date</span></span><br><span class="line">    LocalDateTime localDateTime = LocalDateTime.now();</span><br><span class="line">    Date toDate = Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());</span><br><span class="line">    System.out.println(<span class="string">"LocalDateTime è½¬æ¢æˆ Dateï¼š"</span> + toDate);\</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// å½“å‰æ—¶é—´è½¬æ—¶é—´æˆ³</span></span><br><span class="line">    <span class="keyword">long</span> epochMilli = LocalDateTime.now().toInstant(ZoneOffset.of(<span class="string">"+8"</span>)).toEpochMilli();</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¶é—´è½¬æ—¶é—´æˆ³ï¼š"</span> + epochMilli);</span><br><span class="line">    <span class="comment">// æ—¶é—´æˆ³è½¬æ¢æˆæ—¶é—´</span></span><br><span class="line">    LocalDateTime epochMilliTime = LocalDateTime.ofInstant(Instant.ofEpochMilli(epochMilli), ZoneId.systemDefault());</span><br><span class="line">    System.out.println(<span class="string">"æ—¶é—´æˆ³è½¬æ¢æˆæ—¶é—´ï¼š"</span> + epochMilliTime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è½¬æ¢ç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢ï¼š2019-10-01T22:22:22.222</span><br><span class="line">å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢-æŒ‡å®šæ ¼å¼ï¼š2019-01-01</span><br><span class="line">Date è½¬æ¢æˆ LocalDateTimeï¼š2019-10-24T00:46:41.251</span><br><span class="line">LocalDateTime è½¬æ¢æˆ Dateï¼šThu Oct 24 00:46:41 GMT+08:00 2019</span><br><span class="line">å½“å‰æ—¶é—´è½¬æ—¶é—´æˆ³ï¼š1571849201258</span><br><span class="line">æ—¶é—´æˆ³è½¬æ¢æˆæ—¶é—´ï¼š2019-10-24T00:46:41.258</span><br></pre></td></tr></table></figure><h2 id="5-æ—¶é—´æ ¼å¼åŒ–"><a href="#5-æ—¶é—´æ ¼å¼åŒ–" class="headerlink" title="5. æ—¶é—´æ ¼å¼åŒ–"></a>5. æ—¶é—´æ ¼å¼åŒ–</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¥æœŸæ ¼å¼åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">formatTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocalDateTime now = LocalDateTime.now();</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¶é—´ï¼š"</span> + now);</span><br><span class="line">    System.out.println(<span class="string">"æ ¼å¼åŒ–åï¼š"</span> + now.format(DateTimeFormatter.ISO_LOCAL_DATE_TIME));</span><br><span class="line">    System.out.println(<span class="string">"æ ¼å¼åŒ–åï¼š"</span> + now.format(DateTimeFormatter.ISO_LOCAL_DATE));</span><br><span class="line">    System.out.println(<span class="string">"æ ¼å¼åŒ–åï¼š"</span> + now.format(DateTimeFormatter.ISO_LOCAL_TIME));</span><br><span class="line">    System.out.println(<span class="string">"æ ¼å¼åŒ–åï¼š"</span> + now.format(DateTimeFormatter.ofPattern(<span class="string">"YYYY-MM-dd hh:mm:ss"</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¼å¼åŒ–åï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰æ—¶é—´ï¼š2019-10-24T00:37:44.867</span><br><span class="line">æ ¼å¼åŒ–åï¼š2019-10-24T00:37:44.867</span><br><span class="line">æ ¼å¼åŒ–åï¼š2019-10-24</span><br><span class="line">æ ¼å¼åŒ–åï¼š00:37:44.867</span><br><span class="line">æ ¼å¼åŒ–åï¼š2019-10-24 12:37:44</span><br></pre></td></tr></table></figure><h2 id="6-æ—¶é—´æ¯”è¾ƒ"><a href="#6-æ—¶é—´æ¯”è¾ƒ" class="headerlink" title="6. æ—¶é—´æ¯”è¾ƒ"></a>6. æ—¶é—´æ¯”è¾ƒ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¶é—´æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">diffTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocalDateTime now = LocalDateTime.now();</span><br><span class="line">    LocalDateTime yestory = now.minusDays(<span class="number">1</span>);</span><br><span class="line">    System.out.println(now + <span class="string">"åœ¨"</span> + yestory + <span class="string">"ä¹‹åå—?"</span> + now.isAfter(yestory));</span><br><span class="line">    System.out.println(now + <span class="string">"åœ¨"</span> + yestory + <span class="string">"ä¹‹å‰å—?"</span> + now.isBefore(yestory));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ—¶é—´å·®</span></span><br><span class="line">    <span class="keyword">long</span> day = yestory.until(now, ChronoUnit.DAYS);</span><br><span class="line">    <span class="keyword">long</span> month = yestory.until(now, ChronoUnit.MONTHS);</span><br><span class="line">    <span class="keyword">long</span> hours = yestory.until(now, ChronoUnit.HOURS);</span><br><span class="line">    <span class="keyword">long</span> minutes = yestory.until(now, ChronoUnit.MINUTES);</span><br><span class="line">    System.out.println(<span class="string">"ç›¸å·®æœˆä»½"</span> + month);</span><br><span class="line">    System.out.println(<span class="string">"ç›¸å·®å¤©æ•°"</span> + day);</span><br><span class="line">    System.out.println(<span class="string">"ç›¸å·®å°æ—¶"</span> + hours);</span><br><span class="line">    System.out.println(<span class="string">"ç›¸å·®åˆ†é’Ÿ"</span> + minutes);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ</span></span><br><span class="line">    LocalDate jdk14 = LocalDate.of(<span class="number">2020</span>, <span class="number">3</span>, <span class="number">17</span>);</span><br><span class="line">    LocalDate nowDate = LocalDate.now();</span><br><span class="line">    System.out.println(<span class="string">"è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰ï¼š"</span> + nowDate.until(jdk14, ChronoUnit.DAYS) + <span class="string">"å¤©"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2019-10-24T00:39:01.589åœ¨2019-10-23T00:39:01.589ä¹‹åå—?true</span><br><span class="line">2019-10-24T00:39:01.589åœ¨2019-10-23T00:39:01.589ä¹‹å‰å—?false</span><br><span class="line">ç›¸å·®æœˆä»½0</span><br><span class="line">ç›¸å·®å¤©æ•°1</span><br><span class="line">ç›¸å·®å°æ—¶24</span><br><span class="line">ç›¸å·®åˆ†é’Ÿ1440</span><br><span class="line">è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰ï¼š145å¤©</span><br></pre></td></tr></table></figure><h2 id="7-æ—¶é—´åŠ å‡"><a href="#7-æ—¶é—´åŠ å‡" class="headerlink" title="7. æ—¶é—´åŠ å‡"></a>7. æ—¶é—´åŠ å‡</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¥æœŸåŠ å‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">calcTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocalDateTime now = LocalDateTime.now();</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¶é—´ï¼š"</span>+now);</span><br><span class="line">    LocalDateTime plusTime = now.plusMonths(<span class="number">1</span>).plusDays(<span class="number">1</span>).plusHours(<span class="number">1</span>).plusMinutes(<span class="number">1</span>).plusSeconds(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">"å¢åŠ 1æœˆ1å¤©1å°æ—¶1åˆ†é’Ÿ1ç§’æ—¶é—´åï¼š"</span> + plusTime);</span><br><span class="line">    LocalDateTime minusTime = now.minusMonths(<span class="number">2</span>);</span><br><span class="line">    System.out.println(<span class="string">"å‡å°‘2ä¸ªæœˆæ—¶é—´åï¼š"</span> + minusTime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ“ä½œç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰æ—¶é—´ï¼š2019-10-24T00:41:08.877</span><br><span class="line">å¢åŠ 1æœˆ1å¤©1å°æ—¶1åˆ†é’Ÿ1ç§’æ—¶é—´åï¼š2019-11-25T01:42:09.877</span><br><span class="line">å‡å°‘2ä¸ªæœˆæ—¶é—´åï¼š2019-08-24T00:41:08.877</span><br></pre></td></tr></table></figure><h2 id="8-æ—¶é—´æ‰©å±•æ–¹æ³•"><a href="#8-æ—¶é—´æ‰©å±•æ–¹æ³•" class="headerlink" title="8. æ—¶é—´æ‰©å±•æ–¹æ³•"></a>8. æ—¶é—´æ‰©å±•æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¶é—´æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeFunctionTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocalDateTime now = LocalDateTime.now();</span><br><span class="line">    System.out.println(<span class="string">"å½“å‰æ—¶é—´ï¼š"</span> + now);</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€å¤©</span></span><br><span class="line">    LocalDateTime firstDay = now.withDayOfMonth(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">"æœ¬æœˆç¬¬ä¸€å¤©ï¼š"</span> + firstDay);</span><br><span class="line">    <span class="comment">// å½“å¤©æœ€åä¸€ç§’</span></span><br><span class="line">    LocalDateTime lastSecondOfDay = now.withHour(<span class="number">23</span>).withMinute(<span class="number">59</span>).withSecond(<span class="number">59</span>);</span><br><span class="line">    System.out.println(<span class="string">"å½“å¤©æœ€åä¸€ç§’ï¼š"</span> + lastSecondOfDay);</span><br><span class="line">    <span class="comment">// æœ€åä¸€å¤©</span></span><br><span class="line">    LocalDateTime lastDay = now.with(TemporalAdjusters.lastDayOfMonth());</span><br><span class="line">    System.out.println(<span class="string">"æœ¬æœˆæœ€åä¸€å¤©:"</span> + lastDay);</span><br><span class="line">    <span class="comment">// æ˜¯å¦é—°å¹´</span></span><br><span class="line">    System.out.println(<span class="string">"ä»Šå¹´æ˜¯å¦é—°å¹´ï¼š"</span> + Year.isLeap(now.getYear()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰æ—¶é—´ï¼š<span class="number">2019</span>-<span class="number">10</span>-<span class="number">24</span>T00:<span class="number">43</span>:<span class="number">28.296</span></span><br><span class="line">æœ¬æœˆç¬¬ä¸€å¤©ï¼š<span class="number">2019</span>-<span class="number">10</span>-<span class="number">01</span>T00:<span class="number">43</span>:<span class="number">28.296</span></span><br><span class="line">å½“å¤©æœ€åä¸€ç§’ï¼š<span class="number">2019</span>-<span class="number">10</span>-<span class="number">24</span>T23:<span class="number">59</span>:<span class="number">59.296</span></span><br><span class="line">æœ¬æœˆæœ€åä¸€å¤©:<span class="number">2019</span>-<span class="number">10</span>-<span class="number">31</span>T00:<span class="number">43</span>:<span class="number">28.296</span></span><br><span class="line">ä»Šå¹´æ˜¯å¦é—°å¹´ï¼š<span class="keyword">false</span></span><br></pre></td></tr></table></figure><p>Jdk 8 æ–°çš„æ—¶é—´ç±»ä½¿ç”¨èµ·æ¥ç›¸æ¯”ä¹‹å‰æ˜¾å¾—æ›´åŠ æ–¹ä¾¿ç®€å•ã€‚</p><p><img src="/assets/jdk8-time/1571850210772.png" alt="JDK8 ä¹‹å‰æ—¶é—´å¤„ç†"></p><p>Jdk 8 ä¹ŸæŠŠæ—¶é—´å¤„ç†æˆç‹¬ç«‹æˆä¸€ä¸ªåŒ…ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åŒçš„ç±»ååŠ ä»¥åŒºåˆ†ã€‚è€Œä¸æ˜¯åƒä¹‹å‰ç›¸åŒçš„ç±»åä¸åŒçš„åŒ…ã€‚è¿™æ ·çš„æ–¹å¼ä½¿ç”¨èµ·æ¥ä¹Ÿæ›´åŠ æ¸…æ™°ã€‚</p><p>ğŸš€ ä»£ç å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/niumoo/jdk-feature" target="_blank" rel="noopener">Github(https://github.com/niumoo/jdk-feature)</a> ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å½“å‰æ—¶é—´ï¼š2019å¹´10æœˆ24æ—¥ã€‚è·ç¦» JDK 14 å‘å¸ƒæ—¶é—´ï¼ˆ2020å¹´3æœˆ17æ—¥ï¼‰è¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰å¤šå°‘å¤©ï¼Ÿ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LocalDate jdk14 = LocalDate.of(&lt;span class=&quot;number&quot;&gt;2020&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LocalDate nowDate = LocalDate.now();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;è·ç¦»JDK 14 å‘å¸ƒè¿˜æœ‰ï¼š&quot;&lt;/span&gt;+nowDate.until(jdk14,ChronoUnit.DAYS)+&lt;span class=&quot;string&quot;&gt;&quot;å¤©&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Jdk æ–°ç‰¹æ€§" scheme="https://www.codingme.net/categories/Jdk-%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
    
      <category term="jdk8" scheme="https://www.codingme.net/tags/jdk8/"/>
    
      <category term="æ—¶é—´" scheme="https://www.codingme.net/tags/%E6%97%B6%E9%97%B4/"/>
    
  </entry>
  
  <entry>
    <title>æŠ›å¼ƒEclipseï¼ŒæŠ•å…¥IDEA çš„ç‹¬å­¤æ±‚è´¥æ±Ÿæ¹–</title>
    <link href="https://www.codingme.net/2019/10/develop/idea-skill/"/>
    <id>https://www.codingme.net/2019/10/develop/idea-skill/</id>
    <published>2019-10-22T17:01:01.000Z</published>
    <updated>2019-10-23T12:36:53.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€<br>å‡ºå¤„ï¼šå­”å­ã€Šè®ºè¯­ã€‹</p></blockquote><p>ä¸¤å¹´äº†ï¼Œè¿™æ˜¯æˆ‘çš„ IDEA <strong>å®ç”¨æŠ€å·§</strong>æ€»ç»“ï¼Œä»å‰æˆ‘æ˜¯ä¸€ä¸ª Eclipse å¿ å®ç”¨æˆ·ï¼Œç›´åˆ°æŸå¤©æˆ‘ç”¨ä¸Šäº†  <strong>IntelliJ IDEA</strong> ï¼ŒEclipse å¼€å§‹åœ¨ç¡¬ç›˜èººå°¸â€¦â€¦.</p><p><img src="/assets/idea-skill/1571750577728.png" alt="IDEA å¯åŠ¨"></p><p><strong>IDEA</strong> æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å·¥å…·ï¼Œå®ƒçš„è¯­æ³•ååˆ†æ™ºèƒ½ï¼Œå½“ä½ å†™äº†ä¸€æ®µä¸æ€ä¹ˆèªæ˜ï¼ˆå¾ˆå‚»ï¼‰çš„ä»£ç æ—¶å€™ï¼Œå®ƒä¼šå‘Šè¯‰ä½ æœ‰æ›´ä¼˜çš„å†™æ³•ï¼›å½“ä½ æŒæ¡äº†å¸¸ç”¨çš„å¿«æ·é”®åï¼Œå¼€å‘æ•ˆç‡æå‡ N å€ï¼›å½“ä½ ç†Ÿç»ƒä½¿ç”¨æ—¶å€™ï¼Œç¼–ç é€Ÿåº¦ä¸ç¼–ç è´¨é‡éƒ½æœ‰è´¨çš„é£è·ƒã€‚<br><a id="more"></a><br>é‚£ä¹ˆè¯´äº†é‚£ä¹ˆå¤šï¼Œåˆ°åº•åœ¨å“ªé‡Œæ‰èƒ½ä¹°åˆ°å‘¢ï¼Ÿå“¦ä¸ï¼Œåˆ°åº•æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ</p><h2 id="1-çª—å£åˆ‡æ¢-å‡Œæ³¢å¾®æ­¥"><a href="#1-çª—å£åˆ‡æ¢-å‡Œæ³¢å¾®æ­¥" class="headerlink" title="1.   çª—å£åˆ‡æ¢ - å‡Œæ³¢å¾®æ­¥"></a>1.   çª—å£åˆ‡æ¢ - å‡Œæ³¢å¾®æ­¥</h2><blockquote><p>ã€Œå‡Œæ³¢å¾®æ­¥ã€ä¹ƒæ˜¯ä¸€é—¨æä¸Šä¹˜çš„è½»åŠŸèº«æ³•ï¼Œæ‰€ä»¥åˆ—äºå·è½´ä¹‹æœ«ï¼Œä»¥æ˜“ç»å…«å…«å…­åå››å¦ä¸ºåŸºç¡€ï¼Œä½¿ç”¨è€…æŒ‰ç‰¹å®šé¡ºåºè¸ç€å¦è±¡æ–¹ä½è¡Œè¿›ï¼Œä»ç¬¬ä¸€æ­¥åˆ°æœ€åä¸€æ­¥æ­£å¥½è¡Œèµ°ä¸€ä¸ªå¤§åœˆã€‚æ­¤æ­¥æ³•ç²¾å¦™å¼‚å¸¸ã€‚<br>å‡ºå¤„ï¼šé‡‘åº¸ã€Šå¤©é¾™å…«éƒ¨ã€‹ã€‚</p></blockquote><p>IDEA ä¸­çš„ â€œå‡Œæ³¢å¾®æ­¥â€ æ°å¥½å°±æ˜¯è¿™ä¹ˆä¸€åœˆå¸¸ç”¨çª—å£ï¼Œå‡åŒ€åˆ†å¸ƒåœ¨ç¼–è¾‘çª—å£å‘¨å›´ï¼Œä¸”é…ä»¥æ–¹ä¾¿çš„å¿«æ·é”®ï¼Œåˆ‡æ¢èµ·æ¥ååˆ†çš„è¿…é€Ÿã€‚</p><p><img src="/assets/idea-skill/1571756048466.png" alt="IDEA çª—å£"></p><p>åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œçª—å£åˆ‡æ¢çš„æ“ä½œæ˜¯å¾ˆé¢‘ç¹çš„ï¼Œä¸‹é¢çš„å‡ ä¸ªå¿«æ·é”®å¿…ä¸å¯å°‘ã€‚</p><p>å¿«æ·é”®ï¼š</p><ul><li><p><strong>ALT +ï¼‘</strong>æ˜¾ç¤º/éšè—æ–‡ä»¶çª—å£â­ã€‚</p></li><li><p><strong>ALT + 2</strong>æ˜¾ç¤º/éšè—æ”¶è—çª—å£  ã€‚</p></li><li><p><strong>ALT + 4</strong> æ˜¾ç¤º/éšè—è¿è¡Œçª—å£   ã€‚</p></li><li><p><strong>ALT + 6</strong>æ˜¾ç¤º/éšè—Todoçª—å£  ã€‚</p></li><li><p><strong>ALT + 7</strong>æ˜¾ç¤º/éšè—ç±»ç»“æ„çª—å£ã€‚</p></li></ul><h2 id="2-é¡¹ç›®åˆ‡æ¢-æ¥è€Œä¸å¾€"><a href="#2-é¡¹ç›®åˆ‡æ¢-æ¥è€Œä¸å¾€" class="headerlink" title="2. é¡¹ç›®åˆ‡æ¢ - æ¥è€Œä¸å¾€"></a>2. é¡¹ç›®åˆ‡æ¢ - æ¥è€Œä¸å¾€</h2><blockquote><p>å¾€è€Œä¸æ¥ï¼Œéç¤¼ä¹Ÿï¼›æ¥è€Œä¸å¾€ï¼Œäº¦éç¤¼ä¹Ÿã€‚<br>å‡ºå¤„: ã€Š<a href="https://baike.baidu.com/item/ç¤¼è®°" target="_blank" rel="noopener">ç¤¼è®°</a>Â·<a href="https://baike.baidu.com/item/æ›²ç¤¼" target="_blank" rel="noopener">æ›²ç¤¼</a>ä¸Šã€‹</p></blockquote><p><img src="/assets/idea-skill/1571756766101.png" alt="çª—å£åˆ‡æ¢"></p><p>å¼€å‘å½“ä¸­å¾ˆå¤šæ—¶å€™ä¼šåŒæ—¶æ‰“å¼€å¤šä¸ªé¡¹ç›®ï¼Œå¦‚æœè¿™æ—¶å€™ä½ è¿˜å‚»å‚»çš„ç‚¹å‡»çª—å£åˆ‡æ¢çª—å£ï¼Œæ— ç–‘æ•ˆç‡ä½ä¸‹ï¼Œç‚¹æ¥ç‚¹å»ä¹‹é—´å½±å“äº†æ•²å‡»é”®ç›˜çš„å¿«æ„Ÿã€‚æ—¢ç„¶åŒæ—¶æ‰“å¼€äº†å¤šä¸ªé¡¹ç›®çª—å£ï¼Œä½œä¸ºçª—å£é‚»å±…éƒ½ä¸èƒ½è‡ªç”±æ¥å¾€æœ‰ç‚¹ä¸å°½äººæ„ã€‚</p><p>å¿«æ·é”®ï¼š</p><ul><li>ä¸Šä¸€ä¸ªé¡¹ç›®çª—å£ <strong>CTRL + ALT + [ã€‚</strong></li><li>ä¸Šä¸€ä¸ªé¡¹ç›®çª—å£ <strong>CTRL + ALT + ]</strong>ã€‚</li></ul><h2 id="3-æ–‡ä»¶å®šä½-æ¥å»è‡ªå¦‚"><a href="#3-æ–‡ä»¶å®šä½-æ¥å»è‡ªå¦‚" class="headerlink" title="3. æ–‡ä»¶å®šä½ - æ¥å»è‡ªå¦‚"></a>3. æ–‡ä»¶å®šä½ - æ¥å»è‡ªå¦‚</h2><blockquote><p> èº«å¦‚ä¸ç³»ä¹‹èˆŸï¼Œä¸€ä»»æµä»»åæ­¢ï¼›å¿ƒä¼¼æ—¢ç°ä¹‹æœ¨ï¼Œä½•å¦¨åˆ€å‰²é¦™æ¶‚ï¼Ÿæ¥å»è‡ªå¦‚ä¹ã€‚<br>å‡ºå¤„ï¼šæˆ˜å›½Â·åº„å­ã€Šåº„å­Â·åˆ—å¾¡å¯‡ã€‹ </p></blockquote><p>æ–‡ä»¶å®šä½æ˜¯<strong>éå¸¸å¸¸ç”¨</strong>çš„æ“ä½œã€‚</p><ul><li><strong>CTRL + N</strong> æœç´¢ Java ç±»æ–‡ä»¶â­ã€‚</li><li><p><strong>CTRL + SHIFT + N</strong> æœç´¢æ‰€æœ‰æ–‡ä»¶ã€‚</p></li><li><p><strong>CTRL + E</strong> æ‰“å¼€æœ€è¿‘æµè§ˆæ–‡ä»¶  ï¼Œå†æ¬¡ <strong>CTRL + E</strong> å¯ä»¥åªæ˜¾ç¤ºæ›´æ”¹çš„æ–‡ä»¶ã€‚</p></li><li><strong>CTRL + SHIFT + E</strong> æ‰“å¼€æœ€è¿‘æµè§ˆæ–‡ä»¶ ï¼Œå†æ¬¡ <strong>CTRL + SHIFT + E</strong> å¯ä»¥åªæ˜¾ç¤ºæ›´æ”¹çš„æ–‡ä»¶ã€‚</li><li><strong>SHIFT + é¼ æ ‡å·¦é”®</strong>ï¼Œå…³é—­æ–‡ä»¶ã€‚</li></ul><h2 id="4-ä»£ç å®šä½-ç™¾æ­¥ç©¿æ¨"><a href="#4-ä»£ç å®šä½-ç™¾æ­¥ç©¿æ¨" class="headerlink" title="4. ä»£ç å®šä½ - ç™¾æ­¥ç©¿æ¨"></a>4. ä»£ç å®šä½ - ç™¾æ­¥ç©¿æ¨</h2><blockquote><p> æ¥šæœ‰å…»ç”±åŸºè€…ï¼Œå–„å°„ï¼›å»æŸ³å¶ç™¾æ­¥è€Œå°„ä¹‹ï¼Œç™¾å‘ç™¾ä¸­ã€‚<br> å‡ºå¤„ï¼š ã€Šæˆ˜å›½ç­– Â· è¥¿å‘¨ç­–ã€‹ </p></blockquote><p>ç”¨è¿‡ Eclipse çš„æƒ³å¿…éƒ½çŸ¥é“ Eclipse çš„æ–‡æœ¬æœç´¢é€Ÿåº¦æ˜¯å¤šä¹ˆç¼“æ…¢ï¼Œå¤šä¸ªé¡¹ç›®æœç´¢æ—¶å€™ï¼Œçœ‹ç€é‚£ç¼“æ…¢çš„è¿›åº¦æ¡ï¼Œä»¿ä½›åœ¨è™šåº¦ç”Ÿå‘½ã€‚è€Œ <strong>IDEA</strong> é€Ÿåº¦ä¿è¯è®©ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶å°±ä¸ºä¹‹æƒŠå¹ã€‚æ¯«ç§’çº§çš„å“åº”é€Ÿåº¦ï¼ˆè‡ªåŠ¨å¿½ç•¥CPU ç™¾åˆ†ç™¾ï¼Œæ‰‹åŠ¨æ»‘ç¨½ï¼‰ï¼Œæ™ºèƒ½çš„æœç´¢æ¨¡å¼ï¼Œä¸è¦å¤ªèˆ’æœã€‚</p><p>é‚£ä¹ˆåˆè¯´äº†é‚£ä¹ˆå¤šï¼Œåˆ°åº•è¯¥æ€ä¹ˆç”¨å‘¢ï¼Ÿ</p><p><strong>è¶…çº§å¸¸ç”¨</strong>å¿«æ·é”®ï¼š</p><ul><li><strong>CTRL + SHIFT + F</strong> é¡¹ç›®ä»£ç å…¨æ–‡æœç´¢â­ã€‚</li><li><strong>CTRL + SHIFT + ALT + N</strong> æœç´¢å‡½æ•°ï¼Œè‡ªåŠ¨æ¨¡ç³ŠåŒ¹é…ï¼Œååˆ†å¼ºå¤§ã€‚</li><li><strong>CTRL + W</strong> ä¸‡èƒ½é€‰ä¸­å¿«æ·é”®ï¼Œçˆ±ä¸é‡Šæ‰‹ï¼Œå¤šå±‚åµŒå¥—æ—¶éå¸¸å¥½ç”¨â­ã€‚</li></ul><h2 id="5-ä»£ç æ“ä½œ-å‡ºç¥å…¥åŒ–"><a href="#5-ä»£ç æ“ä½œ-å‡ºç¥å…¥åŒ–" class="headerlink" title="5. ä»£ç æ“ä½œ - å‡ºç¥å…¥åŒ–"></a>5. ä»£ç æ“ä½œ - å‡ºç¥å…¥åŒ–</h2><blockquote><p> æˆ‘ä¸æ›¾å‡ºå£°ï¼Œä»–è¿å¿™ç­”åº”ã€‚é‡‘åœ£å¹ï¼šâ€˜çœŸæ­£å‡ºç¥å…¥åŒ–ä¹‹ç¬”â€™<br>å‡ºå¤„ï¼š å…ƒÂ·ç‹å®ç”«ã€Šè¥¿å¢è®°ã€‹</p></blockquote><p>åŸºæœ¬çš„ä»£ç æ“ä½œåœ¨æ—¥å¸¸å¼€å‘ä¸­æ‰æ˜¯ç”¨çš„æœ€å¤šçš„ï¼Œå°å°çš„å¿«æ·é”®è®©æˆ‘ä»¬çš„å¼€å‘èˆ’é€‚æ„Ÿä¸æ–­çˆ¬å‡ã€‚ä½è°ƒä½è°ƒï¼Œéƒ½æ˜¯åŸºæœ¬æ“ä½œã€‚</p><ul><li><strong>ALT + ENTER</strong> ä¸‡èƒ½æ™ºèƒ½é”®ï¼Œå¼ºå¤§åˆ°æ— æ³•è‡ªæ‹”â­ã€‚</li><li><strong>CTRL + ALT + L</strong> ä»£ç æ ¼å¼åŒ–â­ã€‚</li><li><strong>CTRL + SHIFT + R</strong> é¡¹ç›®å…¨æ–‡ä»£ç æŸ¥æ‰¾ä¸æ›¿æ¢â­ã€‚</li><li><strong>SHIFT + F6</strong> é‡æ„ - é‡å‘½åâ­ã€‚</li><li><strong>iter + Tab</strong> ç”Ÿæˆ å¢å¼ºfor å¾ªç¯â­ã€‚</li><li><strong>itar + Tab</strong> ç”Ÿæˆ for å¾ªç¯ã€‚</li><li><strong>psvm + Tab</strong> ç”Ÿæˆ main æ–¹æ³•ã€‚</li><li><strong>sout + Tab</strong> ç”Ÿæˆ System.out.println()ã€‚</li><li><strong>CTRL + F</strong> æŸ¥æ‰¾æ–‡æœ¬ã€‚</li><li><strong>CTRL + R</strong> æ›¿æ¢æ–‡æœ¬ã€‚</li><li><strong>CTRL + D</strong> å¤åˆ¶è¡Œã€‚</li><li><strong>CTRL + X</strong> å‰ªåˆ‡è¡Œã€‚</li><li><strong>CTRL + Y</strong> åˆ é™¤è¡Œã€‚</li><li><strong>CTRL + /</strong>  è¡Œæ³¨é‡Šæˆ–å–æ¶ˆè¡Œæ³¨é‡Šã€‚</li><li><strong>CTRL + SHIFT + /</strong> å—æ³¨é‡Šæˆ–å–æ¶ˆå—æ³¨é‡Šã€‚</li><li><strong>CTRL + SHIFT + ENTER</strong>  è‡ªåŠ¨è¡¥ä¸Šç»“å°¾åˆ†å·ï¼Œæˆ–è€…è¡¥ä¸Šç»“å°¾èŠ±æ‹¬å·{}ã€‚</li><li><strong>CTRL + U</strong> å¤§å°å†™åˆ‡æ¢ã€‚</li></ul><h2 id="6-æƒŠä¸–éª‡ä¿—-æ·±è—ä¸éœ²"><a href="#6-æƒŠä¸–éª‡ä¿—-æ·±è—ä¸éœ²" class="headerlink" title="6. æƒŠä¸–éª‡ä¿— - æ·±è—ä¸éœ²"></a>6. æƒŠä¸–éª‡ä¿— - æ·±è—ä¸éœ²</h2><p>ä¸å¾—ä¸è¯´ï¼Œ <strong>IDEA</strong> ç”¨èµ·æ¥æ›´åŠ èˆ’æœçš„åœ°æ–¹å°±æ˜¯å®ƒæ€»èƒ½æƒ³ä½ æ‰€æƒ³ï¼Œåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸å‘ç°æ„æ–™ä¹‹å¤–çš„æƒŠå–œåŠŸèƒ½ã€‚</p><h3 id="6-1-é›†æˆæ’ä»¶"><a href="#6-1-é›†æˆæ’ä»¶" class="headerlink" title="6.1  é›†æˆæ’ä»¶"></a>6.1  é›†æˆæ’ä»¶</h3><p><img src="/assets/idea-skill/1571762835305.png" alt="IDEA æ’ä»¶"></p><p>ä¸€ä¸ªå¥½ç”¨çš„æ’ä»¶å¯ä»¥è®©å¼€å‘äº‹åŠåŠŸå€ï¼Œ IDEA æ”¯æŒä¸°å¯Œçš„æ’ä»¶æ‰©å±•ï¼Œä¸ç®¡æ˜¯æœ‰åŠ©äºä»£ç å¼€å‘ç±»æ’ä»¶ï¼Œè¿˜æ˜¯å¸®åŠ©åˆ†æç±»æ’ä»¶ï¼Œè¿˜æ˜¯å°å·¥å…·æ’ä»¶ï¼Œäº¦æˆ–æ˜¯ä¸»é¢˜æ’ä»¶ç­‰ï¼Œéƒ½ååˆ†ä¸°å¯Œï¼Œå¸¸å¸¸ä½ åœ¨å¼€å‘ä¸­å› ä¸ºæŸä¸ªé—®é¢˜ä¸¾æ­¥ç»´è‰°ï¼Œå¯èƒ½ä½ ç¼ºå°‘çš„åªæ˜¯ä¸€æ¬¾è¶æ‰‹çš„æ’ä»¶ã€‚</p><p>ä¸‹é¢ä»…ä»…åˆ—ä¸¾æˆ‘å¸¸ç”¨çš„å‡ æ¬¾æ’ä»¶ï¼Œæ›´å¤šæ’ä»¶å¯ä»¥è‡ªè¡Œæ¢ç´¢ã€‚</p><ol><li><strong>A8Translate</strong> ï¼Œä¸€æ¬¾ç¿»è¯‘å·¥å…·ï¼Œè‹±è¯­ä¸å¤Ÿï¼Œå·¥å…·æ¥å‡‘ã€‚</li><li><strong>Eclipse Code Formatter</strong> ï¼Œå¯ä»¥ç»“åˆé˜¿é‡Œä»£ç æ ¼å¼åŒ–æ–‡ä»¶è¿›è¡Œæ ¼å¼åŒ–ã€‚</li><li><strong>Lombok</strong> ï¼ŒLombok æ³¨è§£æ”¯æŒã€‚</li><li><strong>Maven Helper</strong> ï¼ŒMaven ä¾èµ–å¤„ç†ã€‚</li></ol><h3 id="6-2-Rest-Client"><a href="#6-2-Rest-Client" class="headerlink" title="6.2 Rest Client"></a>6.2 Rest Client</h3><p>å½“ä½ æƒ³ç®€å•çš„æµ‹è¯•æŸä¸ªæ¥å£è°ƒç”¨å“åº”æƒ…å†µæ—¶å€™ï¼Œä¸å¿…æ‰“å¼€ä½ çš„ postmanï¼Œ<strong>IDEA</strong> å·²ç»é»˜è®¤ä¸ºä½ é›†æˆäº† Rest Client æµ‹è¯•å·¥å…·ã€‚å¯ä»¥ <strong>CTRL+ SHIFT + A</strong> ç„¶åæœç´¢ <strong>restful</strong>ã€‚</p><h3 id="6-3-å‰ªåˆ‡æ¿å†å²"><a href="#6-3-å‰ªåˆ‡æ¿å†å²" class="headerlink" title="6.3 å‰ªåˆ‡æ¿å†å²"></a>6.3 å‰ªåˆ‡æ¿å†å²</h3><p>å¬è¯´ä½ æ‹·è´äº†ä¸€ä¸²ä»£ç ï¼Œåˆæ‹·è´äº†ä¸€ä¸²ä»£ç ï¼Œå°´å°¬ï¼Œä¹‹å‰çš„æ‹·è´ä¸¢å¤±äº†ã€‚è«æ…Œï¼Œ <strong>IDEA</strong> æƒ³ä½ æ‰€æƒ³ï¼Œå†…ç½®äº†ç²˜è´´æ¿å†å²ã€‚åªéœ€è¦ä½¿ç”¨å¿«æ·é”®  <strong>CTRL + SHIFT + V</strong> å³å¯ã€‚</p><p><img src="/assets/idea-skill/1571788672930.png" alt="å‰ªåˆ‡æ¿å†å²"></p><h3 id="6-4-JSON-æ ¼å¼åŒ–"><a href="#6-4-JSON-æ ¼å¼åŒ–" class="headerlink" title="6.4 JSON æ ¼å¼åŒ–"></a>6.4 JSON æ ¼å¼åŒ–</h3><p>å½“æ§åˆ¶å°æ‰“å°äº†JSON å­—ç¬¦ä¸²æ—¶ï¼Œå¯ä»¥å³é”®æ ¼å¼åŒ–æ˜¾ç¤ºï¼Œå¯¹äº JSON å“åº”çš„æ¥å£è°ƒç”¨æµ‹è¯•æ—¶å€™ååˆ†å¥½ç”¨ã€‚</p><p><img src="/assets/idea-skill/1571762204121.png" alt="JSON æ ¼å¼åŒ–"></p><h3 id="6-5-æ¼”ç¤ºæ¨¡å¼"><a href="#6-5-æ¼”ç¤ºæ¨¡å¼" class="headerlink" title="6.5 æ¼”ç¤ºæ¨¡å¼"></a>6.5 æ¼”ç¤ºæ¨¡å¼</h3><p>æŒ‰ ALT + V é€‰æ‹© Enter Presentation Mode è¿›å…¥æ¼”ç¤ºæ¨¡å¼ï¼Œå¯ä»¥æ”¾å¤§ç¼–è¾‘çª—å£ï¼Œååˆ†é€‚åˆä»£ç æ“ä½œæ¼”ç¤ºï¼Œå¦‚æœå¯¹äº IDEA å¿«æ·é”®æ¯”è¾ƒç†Ÿç»ƒï¼Œæ“ä½œèµ·æ¥ä¾æ—§è¡Œäº‘æµæ°´ã€‚</p><h3 id="6-6-è¡¥å…¨åˆ¤æ–­"><a href="#6-6-è¡¥å…¨åˆ¤æ–­" class="headerlink" title="6.6 è¡¥å…¨åˆ¤æ–­"></a>6.6 è¡¥å…¨åˆ¤æ–­</h3><p>å¯¹æŸä¸ªå¯¹è±¡åˆ¤æ–­æ˜¯å¦ä¸º nullï¼Œæˆ–è€…å¯¹æŸä¸ªå­—ç¬¦ä¸²åˆ¤ç©ºç­‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ <strong>IDEA æ™ºèƒ½è¯­æ³•</strong>ã€‚</p><p>æ¯”å¦‚ï¼š</p><p><img src="/assets/idea-skill/1571763565635.png" alt="ä»£ç "></p><p><strong>content.notnull</strong> å›è½¦å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸‹é¢çš„ä»£ç ï¼Œç±»ä¼¼çš„æ“ä½œåœ¨ IDEA ä¸­è¿˜æœ‰å¾ˆå¤šï¼Œä¸å†ä¸€ä¸€åˆ—ä¸¾ã€‚</p><p><img src="/assets/idea-skill/1571763587951.png" alt="ç”Ÿæˆä»£ç "></p><p>æ–‡ä¸­çš„ä¸€äº› <strong>IDEA</strong> ä½¿ç”¨æŠ€å·§éƒ½æ˜¯å·¥ä½œä¸­ç»å¸¸ä½¿ç”¨çš„ï¼Œå½“ç„¶ <strong>IDEA</strong> çš„åŠŸèƒ½è¿œä¸æ­¢è¿™äº›ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt; â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€&lt;br&gt;å‡ºå¤„ï¼šå­”å­ã€Šè®ºè¯­ã€‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸¤å¹´äº†ï¼Œè¿™æ˜¯æˆ‘çš„ IDEA &lt;strong&gt;å®ç”¨æŠ€å·§&lt;/strong&gt;æ€»ç»“ï¼Œä»å‰æˆ‘æ˜¯ä¸€ä¸ª Eclipse å¿ å®ç”¨æˆ·ï¼Œç›´åˆ°æŸå¤©æˆ‘ç”¨ä¸Šäº†  &lt;strong&gt;IntelliJ IDEA&lt;/strong&gt; ï¼ŒEclipse å¼€å§‹åœ¨ç¡¬ç›˜èººå°¸â€¦â€¦.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/idea-skill/1571750577728.png&quot; alt=&quot;IDEA å¯åŠ¨&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;IDEA&lt;/strong&gt; æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å·¥å…·ï¼Œå®ƒçš„è¯­æ³•ååˆ†æ™ºèƒ½ï¼Œå½“ä½ å†™äº†ä¸€æ®µä¸æ€ä¹ˆèªæ˜ï¼ˆå¾ˆå‚»ï¼‰çš„ä»£ç æ—¶å€™ï¼Œå®ƒä¼šå‘Šè¯‰ä½ æœ‰æ›´ä¼˜çš„å†™æ³•ï¼›å½“ä½ æŒæ¡äº†å¸¸ç”¨çš„å¿«æ·é”®åï¼Œå¼€å‘æ•ˆç‡æå‡ N å€ï¼›å½“ä½ ç†Ÿç»ƒä½¿ç”¨æ—¶å€™ï¼Œç¼–ç é€Ÿåº¦ä¸ç¼–ç è´¨é‡éƒ½æœ‰è´¨çš„é£è·ƒã€‚&lt;br&gt;
    
    </summary>
    
      <category term="ç”Ÿäº§å·¥å…·" scheme="https://www.codingme.net/categories/%E7%94%9F%E4%BA%A7%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="idea" scheme="https://www.codingme.net/tags/idea/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåå››ï¼‰è¿…é€Ÿå¯ç”¨ HTTPS åŠ å¯†ä½ çš„ç½‘ç«™</title>
    <link href="https://www.codingme.net/2019/08/springboot/springboot-14-https/"/>
    <id>https://www.codingme.net/2019/08/springboot/springboot-14-https/</id>
    <published>2019-08-06T16:10:22.000Z</published>
    <updated>2019-10-29T00:24:30.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/assets/springboot-14-https/1572308662878.png" alt="HTTPS"></p><h2 id="1-è·å–-HTTPS-è¯ä¹¦"><a href="#1-è·å–-HTTPS-è¯ä¹¦" class="headerlink" title="1. è·å– HTTPS è¯ä¹¦"></a>1. è·å– HTTPS è¯ä¹¦</h2><p>æ­£å¸¸æƒ…å†µä¸‹ HTTPS è¯ä¹¦éœ€è¦ä»è¯ä¹¦æˆæƒä¸­å¿ƒè·å¾—ï¼Œè¿™æ ·è·å¾—çš„è¯ä¹¦æ‰å…·æœ‰å…¬ä¿¡åŠ›ï¼Œä¹Ÿä¼šè¢«å„ç§æµè§ˆå™¨å®¢æˆ·ç«¯æ‰€è®¤å¯ã€‚å¸¸è§çš„è¯ä¹¦å“ç‰Œå¦‚ Symantecï¼ŒGeoTrustmï¼ŒTrustAsiaï¼ŒSymantec ç­‰ã€‚ä¸è¿‡åœ¨ Springboot çš„ HTTPS å®éªŒä¸­å°±æ²¡æœ‰å¿…è¦å»ç”³è¯·äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Java è‡ªå¸¦çš„ <strong>keytool</strong> ç”Ÿæˆ HTTPS è¯ä¹¦ã€‚</p><a id="more"></a><p>æŸ¥çœ‹ keytool å·¥å…·ä½¿ç”¨è¯´æ˜ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;keytool</span><br><span class="line">å¯†é’¥å’Œè¯ä¹¦ç®¡ç†å·¥å…·</span><br><span class="line">å‘½ä»¤:</span><br><span class="line"> -certreq            ç”Ÿæˆè¯ä¹¦è¯·æ±‚</span><br><span class="line"> -changealias        æ›´æ”¹æ¡ç›®çš„åˆ«å</span><br><span class="line"> -delete             åˆ é™¤æ¡ç›®</span><br><span class="line"> -exportcert         å¯¼å‡ºè¯ä¹¦</span><br><span class="line"> -genkeypair         ç”Ÿæˆå¯†é’¥å¯¹</span><br><span class="line"> -genseckey          ç”Ÿæˆå¯†é’¥</span><br><span class="line"> -gencert            æ ¹æ®è¯ä¹¦è¯·æ±‚ç”Ÿæˆè¯ä¹¦</span><br><span class="line"> -importcert         å¯¼å…¥è¯ä¹¦æˆ–è¯ä¹¦é“¾</span><br><span class="line"> -importpass         å¯¼å…¥å£ä»¤</span><br><span class="line"> -importkeystore     ä»å…¶ä»–å¯†é’¥åº“å¯¼å…¥ä¸€ä¸ªæˆ–æ‰€æœ‰æ¡ç›®</span><br><span class="line"> -keypasswd          æ›´æ”¹æ¡ç›®çš„å¯†é’¥å£ä»¤</span><br><span class="line"> -list               åˆ—å‡ºå¯†é’¥åº“ä¸­çš„æ¡ç›®</span><br><span class="line"> -printcert          æ‰“å°è¯ä¹¦å†…å®¹</span><br><span class="line"> -printcertreq       æ‰“å°è¯ä¹¦è¯·æ±‚çš„å†…å®¹</span><br><span class="line"> -printcrl           æ‰“å° CRL æ–‡ä»¶çš„å†…å®¹</span><br><span class="line"> -storepasswd        æ›´æ”¹å¯†é’¥åº“çš„å­˜å‚¨å£ä»¤</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ "keytool -command_name -help" è·å– command_name çš„ç”¨æ³•</span><br><span class="line"></span><br><span class="line">D:\&gt;keytool -genkeypair --help</span><br><span class="line">keytool -genkeypair [OPTION]...</span><br><span class="line">ç”Ÿæˆå¯†é’¥å¯¹</span><br><span class="line">é€‰é¡¹:</span><br><span class="line"> -alias &lt;alias&gt;                  è¦å¤„ç†çš„æ¡ç›®çš„åˆ«å</span><br><span class="line"> -keyalg &lt;keyalg&gt;                å¯†é’¥ç®—æ³•åç§°</span><br><span class="line"> -keysize &lt;keysize&gt;              å¯†é’¥ä½å¤§å°</span><br><span class="line"> -sigalg &lt;sigalg&gt;                ç­¾åç®—æ³•åç§°</span><br><span class="line"> -destalias &lt;destalias&gt;          ç›®æ ‡åˆ«å</span><br><span class="line"> -dname &lt;dname&gt;                  å”¯ä¸€åˆ¤åˆ«å</span><br><span class="line"> -startdate &lt;startdate&gt;          è¯ä¹¦æœ‰æ•ˆæœŸå¼€å§‹æ—¥æœŸ/æ—¶é—´</span><br><span class="line"> -ext &lt;value&gt;                    X.509 æ‰©å±•</span><br><span class="line"> -validity &lt;valDays&gt;             æœ‰æ•ˆå¤©æ•°</span><br><span class="line"> -keypass &lt;arg&gt;                  å¯†é’¥å£ä»¤</span><br><span class="line"> -keystore &lt;keystore&gt;            å¯†é’¥åº“åç§°</span><br><span class="line"> -storepass &lt;arg&gt;                å¯†é’¥åº“å£ä»¤</span><br><span class="line"> -storetype &lt;storetype&gt;          å¯†é’¥åº“ç±»å‹</span><br><span class="line"> -providername &lt;providername&gt;    æä¾›æ–¹åç§°</span><br><span class="line"> -providerclass &lt;providerclass&gt;  æä¾›æ–¹ç±»å</span><br><span class="line"> -providerarg &lt;arg&gt;              æä¾›æ–¹å‚æ•°</span><br><span class="line"> -providerpath &lt;pathlist&gt;        æä¾›æ–¹ç±»è·¯å¾„</span><br><span class="line"> -v                              è¯¦ç»†è¾“å‡º</span><br><span class="line"> -protected                      é€šè¿‡å—ä¿æŠ¤çš„æœºåˆ¶çš„å£ä»¤</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„ keytool ï¼Œæˆ‘ä»¬ç”Ÿæˆè‡ªå·±çš„è‡ªç­¾åè¯ä¹¦ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;keytool -genkeypair -alias tomcat_https -keypass 123456 -keyalg RSA -keysize 1024 -validity 365 -keystore d:/tomcat_https.keystore -storepass 123456</span><br><span class="line">æ‚¨çš„åå­—ä¸å§“æ°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  darcy</span><br><span class="line">æ‚¨çš„ç»„ç»‡å•ä½åç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  codingme</span><br><span class="line">æ‚¨çš„ç»„ç»‡åç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  codingme</span><br><span class="line">æ‚¨æ‰€åœ¨çš„åŸå¸‚æˆ–åŒºåŸŸåç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  ShangHai</span><br><span class="line">æ‚¨æ‰€åœ¨çš„çœ/å¸‚/è‡ªæ²»åŒºåç§°æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  ShangHai</span><br><span class="line">è¯¥å•ä½çš„åŒå­—æ¯å›½å®¶/åœ°åŒºä»£ç æ˜¯ä»€ä¹ˆ?</span><br><span class="line">  [Unknown]:  ZN</span><br><span class="line">CN=darcy, OU=codingme, O=codingme, L=ShangHai, ST=ShangHai, C=ZNæ˜¯å¦æ­£ç¡®?</span><br><span class="line">  [å¦]:  y</span><br><span class="line">D:\&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å·²ç»åœ¨æˆ‘ä»¬æŒ‡å®šçš„ä½ç½®ä¸‹ç”Ÿæˆäº†è¯ä¹¦æ–‡ä»¶ï¼Œå¦‚æœéœ€è¦æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ keytool çš„ list å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å¯†é’¥åº“ç±»å‹æ˜¯ JKSï¼Œåœ¨åé¢çš„é…ç½®é‡Œä¼šç”¨åˆ°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;keytool -list -keystore tomcat_https.keystore</span><br><span class="line">è¾“å…¥å¯†é’¥åº“å£ä»¤:</span><br><span class="line"></span><br><span class="line">å¯†é’¥åº“ç±»å‹: JKS</span><br><span class="line">å¯†é’¥åº“æä¾›æ–¹: SUN</span><br><span class="line"></span><br><span class="line">æ‚¨çš„å¯†é’¥åº“åŒ…å« 1 ä¸ªæ¡ç›®</span><br><span class="line"></span><br><span class="line">tomcat_https, 2019-4-21, PrivateKeyEntry,</span><br><span class="line">è¯ä¹¦æŒ‡çº¹ (SHA1): 1E:5F:15:9C:45:BD:D3:2A:7E:7F:1F:83:56:B8:74:E0:8B:CA:FD:F6</span><br><span class="line"></span><br><span class="line">D:\&gt;</span><br></pre></td></tr></table></figure><p>è‡ªå·±ç”Ÿæˆçš„ HTTPS è¯ä¹¦åªèƒ½ç”¨æ¥è‡ªå·±æµ‹è¯•ï¼ŒçœŸæ­£ç”¨äºç½‘ç»œä¸Šæ—¶ï¼Œæµè§ˆå™¨ä¼šæ˜¾ç¤ºè¯ä¹¦æ— æ³•ä¿¡æ¯ã€‚å› æ­¤å¦‚æœæƒ³è¦å¾—åˆ°ä¸€ä¸ªçœŸå®æœ‰æ•ˆçš„è¯ä¹¦ï¼Œè¯·çœ‹æ–‡ç« æœ«å°¾ã€‚</p><h2 id="2-é…ç½®-HTTPS-è¯ä¹¦"><a href="#2-é…ç½®-HTTPS-è¯ä¹¦" class="headerlink" title="2. é…ç½® HTTPS è¯ä¹¦"></a>2. é…ç½® HTTPS è¯ä¹¦</h2><p>åˆ›å»ºä¸€ä¸ª Springboot é¡¹ç›®è¿™é‡Œä¸æï¼Œæ‹·è´ä¸Šä¸€æ­¥éª¤ä¸­ç”Ÿæˆçš„ tomcat_https.keystore è¯ä¹¦æ–‡ä»¶åˆ°<strong>src/main/resource</strong> æ–‡ä»¶å¤¹ä¸‹ï¼Œå…ˆçœ‹ä¸‹æ€»ä½“çš„é¡¹ç›®ç»“æ„ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/3f4682d8b6eaa6ac7bf29eae9f9d5109.png" alt="é¡¹ç›®ç»“æ„å¦‚ä¸‹"></p><p>ç„¶ååœ¨ application.yml æ–‡ä»¶ä¸­é…ç½® HTTPS ç›¸å…³ä¿¡æ¯ã€‚ç›´æ¥é…ç½®äº†ç«¯å£å·ä¸º <strong>443</strong>ï¼Œ443æ˜¯ HTTPS çš„é»˜è®¤ç«¯å£ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ HTTPS å°±è¡Œè®¿é—®çš„æ—¶å€™å°±ä¸éœ€è¦å†™é¢å¤–çš„ç«¯å£å·äº†ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½® HTTPS ç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">443</span></span><br><span class="line"><span class="attr">  http-port:</span> <span class="number">80</span> <span class="comment"># ä¸ºäº†åé¢çš„é…ç½®ä½¿ç”¨ï¼Œæš‚æ—¶æ— ç”¨</span></span><br><span class="line"><span class="attr">  ssl:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    key-store:</span> <span class="attr">classpath:tomcat_https.keystore</span> <span class="comment"># è¯ä¹¦æ–‡ä»¶</span></span><br><span class="line"><span class="attr">    key-password:</span> <span class="number">123456</span>  <span class="comment"># å¯†ç </span></span><br><span class="line"><span class="attr">    key-store-type:</span> <span class="string">JKS</span> <span class="comment"># å¯†é’¥åº“ç±»å‹</span></span><br><span class="line"><span class="attr">    key-alias:</span> <span class="string">tomcat_https</span></span><br></pre></td></tr></table></figure><p>è¿™æ—¶ï¼Œå·²ç»å¯ä»¥é€šè¿‡ HTTPS è¿›è¡Œé¡µé¢è®¿é—®äº†ã€‚</p><h2 id="3-æµ‹è¯•-HTTPS-è¯ä¹¦"><a href="#3-æµ‹è¯•-HTTPS-è¯ä¹¦" class="headerlink" title="3. æµ‹è¯• HTTPS è¯ä¹¦"></a>3. æµ‹è¯• HTTPS è¯ä¹¦</h2><p>ç›´æ¥ç¼–å†™ä¸€ä¸ª æ¥å£ç”¨äºæµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Https æ¥å£æ§åˆ¶ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/4/20 22:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpsController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello HTTPS"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ä¹‹åå¯ä»¥é€šè¿‡ <a href="https://localhost/hello" target="_blank" rel="noopener">https://localhost/hello</a> è¿›è¡Œè®¿é—®äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/29a658a7761aa462cb80e1e34e5b0017.png" alt="HTTPS è®¿é—®æµ‹è¯•"></p><p>å½“ç„¶ï¼Œç”±äºæ˜¯è‡ªå·±ç”Ÿæˆçš„è¯ä¹¦ï¼Œä¼šæç¤ºä¸å®‰å…¨ï¼Œç»§ç»­è®¿é—®å³å¯ï¼Œå¦‚æœæ˜¯æ­£å¸¸ç”³è¯·æˆ–è€…è´­ä¹°çš„è¯ä¹¦å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜çš„ã€‚</p><h2 id="4-HTTP-è·³è½¬-HTTPS"><a href="#4-HTTP-è·³è½¬-HTTPS" class="headerlink" title="4. HTTP è·³è½¬ HTTPS"></a>4. HTTP è·³è½¬ HTTPS</h2><p>åœ¨ä¸Šé¢çš„æµ‹è¯•é‡Œï¼ŒHTTPS å·²ç»å¯ä»¥è®¿é—®äº†ï¼Œä½†æ˜¯ HTTP å´ä¸èƒ½è®¿é—®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹åœ¨å¯ç”¨äº† HTTPS ä¹‹åï¼Œéƒ½ä¼šå¸Œæœ› HTTP çš„è¯·æ±‚ä¼šè‡ªåŠ¨è·³è½¬åˆ° HTTPSï¼Œè¿™ä¸ªåœ¨ Springboot é‡Œè‡ªç„¶ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚æˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªé…ç½®ç±»æŠŠ HTTP è¯·æ±‚ç›´æ¥è½¬å‘åˆ° HTTPS å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * HTTP å¼ºåˆ¶è·³è½¬ HTTPS</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/4/21 17:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Http2Https</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;server.port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sslPort;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;server.http-port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> httpPort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TomcatServletWebServerFactory <span class="title">servletContainerFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TomcatServletWebServerFactory tomcat = <span class="keyword">new</span> TomcatServletWebServerFactory() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postProcessContext</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">                SecurityConstraint securityConstraint = <span class="keyword">new</span> SecurityConstraint();</span><br><span class="line">                securityConstraint.setUserConstraint(<span class="string">"CONFIDENTIAL"</span>);</span><br><span class="line">                SecurityCollection collection = <span class="keyword">new</span> SecurityCollection();</span><br><span class="line">                collection.addPattern(<span class="string">"/*"</span>);</span><br><span class="line">                securityConstraint.addCollection(collection);</span><br><span class="line">                context.addConstraint(securityConstraint);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        Connector connector = <span class="keyword">new</span> Connector(<span class="string">"org.apache.coyote.http11.Http11NioProtocol"</span>);</span><br><span class="line">        connector.setScheme(<span class="string">"http"</span>);</span><br><span class="line">        connector.setPort(httpPort);</span><br><span class="line">        connector.setRedirectPort(sslPort);</span><br><span class="line">        tomcat.addAdditionalTomcatConnectors(connector);</span><br><span class="line">        <span class="keyword">return</span> tomcat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨ä¹‹åï¼Œä½¿ç”¨ <a href="http://localhost/hello" target="_blank" rel="noopener">http://localhost/hello</a> è®¿é—®ä¼šè‡ªåŠ¨è·³è½¬åˆ° <a href="https://localhost/hello" target="_blank" rel="noopener">https://localhost/hello</a>.</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><p>å¦‚æœéœ€è¦ç”³è¯·å…è´¹è¯ä¹¦ï¼Œå¯ä»¥åœ¨è…¾è®¯äº‘ä¸Šå…è´¹ç”³è¯·ï¼Œè¯·å‚è€ƒï¼š</p><ul><li><a href="https://cloud.tencent.com/document/product/400/6813#.E8.8E.B7.E5.8F.96.E8.AF.81.E4.B9.A6" target="_blank" rel="noopener">å…è´¹ç‰ˆ DV SSL è¯ä¹¦ç”³è¯·</a>ã€‚</li></ul><p>å¦‚æœæƒ³è¦è‡ªå·±å®‰è£…è¯ä¹¦ï¼Œè¯·å‚è€ƒï¼š</p><ul><li><a href="https://cloud.tencent.com/document/product/400/35243" target="_blank" rel="noopener">Apache æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li><li><a href="https://cloud.tencent.com/document/product/400/35244" target="_blank" rel="noopener">Nginx æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li><li><a href="https://cloud.tencent.com/document/product/400/35224" target="_blank" rel="noopener">Tomcat æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li><li><a href="https://cloud.tencent.com/document/product/400/35225" target="_blank" rel="noopener">Windows IIS æœåŠ¡å™¨è¯ä¹¦å®‰è£…</a></li></ul><p>ğŸŸ æ–‡ç« ç›¸å…³ä»£ç å·²ç»ä¸Šä¼  Github <a href="https://github.com/niumoo/springboot/tree/master/springboot-web-https" target="_blank" rel="noopener">Spring Boot https</a>ï¼Œ æ¬¢è¿â­Starï¸ï¼Œæ¬¢è¿ Fork !</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/assets/springboot-14-https/1572308662878.png&quot; alt=&quot;HTTPS&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-è·å–-HTTPS-è¯ä¹¦&quot;&gt;&lt;a href=&quot;#1-è·å–-HTTPS-è¯ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;1. è·å– HTTPS è¯ä¹¦&quot;&gt;&lt;/a&gt;1. è·å– HTTPS è¯ä¹¦&lt;/h2&gt;&lt;p&gt;æ­£å¸¸æƒ…å†µä¸‹ HTTPS è¯ä¹¦éœ€è¦ä»è¯ä¹¦æˆæƒä¸­å¿ƒè·å¾—ï¼Œè¿™æ ·è·å¾—çš„è¯ä¹¦æ‰å…·æœ‰å…¬ä¿¡åŠ›ï¼Œä¹Ÿä¼šè¢«å„ç§æµè§ˆå™¨å®¢æˆ·ç«¯æ‰€è®¤å¯ã€‚å¸¸è§çš„è¯ä¹¦å“ç‰Œå¦‚ Symantecï¼ŒGeoTrustmï¼ŒTrustAsiaï¼ŒSymantec ç­‰ã€‚ä¸è¿‡åœ¨ Springboot çš„ HTTPS å®éªŒä¸­å°±æ²¡æœ‰å¿…è¦å»ç”³è¯·äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Java è‡ªå¸¦çš„ &lt;strong&gt;keytool&lt;/strong&gt; ç”Ÿæˆ HTTPS è¯ä¹¦ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Https" scheme="https://www.codingme.net/tags/Https/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåä¸‰ï¼‰ä½¿ç”¨é‚®ä»¶æœåŠ¡</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-13-email/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-13-email/</id>
    <published>2019-03-11T16:20:22.000Z</published>
    <updated>2019-05-20T16:29:37.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/00a2b4768bf601da67118c0acb347876.jpg" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰">æˆ‘ä»¬è¿™ä¸ªæ—¶ä»£ï¼Œé‚®ä»¶æœåŠ¡ä¸ç®¡æ˜¯å¯¹äºå·¥ä½œä¸Šçš„äº¤æµï¼Œè¿˜æ˜¯å¹³æ—¶çš„å„ç§é‚®ä»¶é€šçŸ¥ï¼Œéƒ½æ˜¯ä¸€ä¸ªååˆ†é‡è¦çš„å­˜åœ¨ã€‚Java ä»å¾ˆæ—©æ—¶å€™å°±å¯ä»¥é€šè¿‡ Java mail æ”¯æŒé‚®ä»¶æœåŠ¡ã€‚Spring æ›´æ˜¯å¯¹ Java mail è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼ŒæŠ½è±¡å‡ºäº† <code>JavaMailSender</code>. åæ¥éšç€ Springboot çš„å‡ºç°ï¼Œç†æ‰€å½“ç„¶çš„å‡ºç°äº† <code>spring-boot-starter-mail</code>. ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ¯æ¬¡çš„å°è£…éƒ½è®©ä½¿ç”¨å˜å¾—è¶Šæ¥è¶Šç®€å•ã€‚<br><a id="more"></a></p><h2 id="Springboot-mail-ä¾èµ–"><a href="#Springboot-mail-ä¾èµ–" class="headerlink" title="Springboot mail ä¾èµ–"></a>Springboot mail ä¾èµ–</h2><p>åˆ›å»º Springboot é¡¹ç›®ä¸æï¼Œå…ˆçœ‹ä¸€ä¸‹æ€»ä½“ç›®å½•ç»“æ„ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/87989c22d455e3d428811562649c840d.jpg" alt="é¡¹ç›®ç»“æ„"></p><p>ç›´æ¥å¼•å…¥ Springboot é‚®ä»¶æœåŠ¡æ‰€éœ€çš„ä¾èµ–ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- é‚®ä»¶æœåŠ¡ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- Thymeleaf æ¨¡ç‰ˆï¼Œç”¨äºå‘é€æ¨¡ç‰ˆé‚®ä»¶ --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="Springboot-mail-é…ç½®"><a href="#Springboot-mail-é…ç½®" class="headerlink" title="Springboot mail é…ç½®"></a>Springboot mail é…ç½®</h2><p>ä½¿ç”¨é‚®ä»¶æœåŠ¡éœ€è¦é…ç½®è‡ªå·±å¯ä»¥ä½¿ç”¨çš„é‚®ç®±ä¿¡æ¯ï¼Œä¸€èˆ¬éœ€è¦é…ç½®å‘é€åè®® SMTPã€é‚®ç®±å¸å·ï¼ˆæœ¬æ¬¡ä»¥126é‚®ç®±ä¸ºä¾‹ï¼‰ã€é‚®ç®±å¯†ç ä»¥åŠç¼–ç æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring.mail.host=smtp.126.com</span><br><span class="line">spring.mail.port=25</span><br><span class="line"># ä½ çš„é‚®ç®±åœ°å€</span><br><span class="line">spring.mail.username=niumoo@126.com </span><br><span class="line"># ä½ çš„æˆæƒç ï¼ˆ126 å’Œ 163 ä»¥åŠ qq é‚®ç®± éƒ½éœ€è¦æˆæƒç ç™»å½•ï¼Œæ²¡æœ‰æˆæƒç çš„ç›´æ¥ç™»å½•ç½‘é¡µç‰ˆé‚®ç®±è®¾ç½®é‡Œè®¾ç½®ï¼‰</span><br><span class="line">spring.mail.password=password</span><br><span class="line">spring.mail.default-encoding=UTF-8</span><br></pre></td></tr></table></figure></p><h2 id="Springboot-mail-æ–‡æœ¬é‚®ä»¶"><a href="#Springboot-mail-æ–‡æœ¬é‚®ä»¶" class="headerlink" title="Springboot mail æ–‡æœ¬é‚®ä»¶"></a>Springboot mail æ–‡æœ¬é‚®ä»¶</h2><p>æ–‡æœ¬é‚®ä»¶æ˜¯æœ€ç®€å•ä¹Ÿæ˜¯æœ€åŸºç¡€çš„ä¸€ç§é‚®ä»¶ï¼Œä½¿ç”¨ Spring å°è£…çš„ <code>JavaMailSender</code> ç›´æ¥å‘é€å°±å¯ä»¥äº†ã€‚</p><p>åˆ›å»º <code>MailService</code> ç±»ï¼Œæ³¨å…¥ <code>JavaMailSender</code> ç”¨äºå‘é€é‚®ä»¶ï¼Œä½¿ç”¨ <code>@Value(&quot;${spring.mail.username}&quot;)</code> ç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ç”¨äºè®¾ç½®é‚®ä»¶å‘é€çš„æ¥é‚®ç®±ã€‚ä½¿ç”¨ <code>@Service</code> æ³¨è§£æŠŠ <code>MailService</code> æ³¨å…¥åˆ° Spring å®¹å™¨ï¼Œä½¿ç”¨ <code>Lombok</code> çš„ <code>@Slf4j</code> å¼•å…¥æ—¥å¿—ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * é‚®ä»¶æœåŠ¡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/3/10 21:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.mail.username&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String from;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSender mailSender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€ç®€å•æ–‡æœ¬é‚®ä»¶</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendSimpleTextMail</span><span class="params">(String to, String subject, String content)</span> </span>&#123;</span><br><span class="line">        SimpleMailMessage message = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">        message.setTo(to);</span><br><span class="line">        message.setSubject(subject);</span><br><span class="line">        message.setText(content);</span><br><span class="line">        message.setFrom(from);</span><br><span class="line">        mailSender.send(message);</span><br><span class="line">        log.info(<span class="string">"ã€æ–‡æœ¬é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åˆ›å»º Springboot çš„å•å…ƒæµ‹è¯•ç±»æµ‹è¯•æ–‡æœ¬é‚®ä»¶ï¼Œå®éªŒä¸­çš„æ”¶ä¿¡äººä¸ºäº†æ–¹ä¾¿ï¼Œéƒ½è®¾ç½®æˆäº†è‡ªå·±çš„é‚®ç®±ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MailService mailService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendSimpleTextMailTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">        String subject = <span class="string">"Springboot å‘é€ç®€å•æ–‡æœ¬é‚®ä»¶"</span>;</span><br><span class="line">        String content = <span class="string">"&lt;p&gt;ç¬¬ä¸€å° Springboot ç®€å•æ–‡æœ¬é‚®ä»¶&lt;/p&gt;"</span>;</span><br><span class="line">        mailService.sendSimpleTextMail(to, subject, content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•æ–‡æœ¬é‚®ä»¶çš„å‘é€ã€‚</p><p>PSï¼šå¦‚æœè¿è¡ŒæŠ¥å‡ºå¼‚å¸¸ <code>AuthenticationFailedException: 535 Error</code>. ä¸€èˆ¬éƒ½æ˜¯ç”¨æˆ·åå’Œå¯†ç æœ‰è¯¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Caused by: javax.mail.AuthenticationFailedException: 535 Error: authentication failed</span><br><span class="line"></span><br><span class="line">at com.sun.mail.smtp.SMTPTransport$Authenticator.authenticate(SMTPTransport.java:965)</span><br><span class="line">at com.sun.mail.smtp.SMTPTransport.authenticate(SMTPTransport.java:876)</span><br><span class="line">at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:780)</span><br><span class="line">at javax.mail.Service.connect(Service.java:366)</span><br><span class="line">at org.springframework.mail.javamail.JavaMailSenderImpl.connectTransport(JavaMailSenderImpl.java:517)</span><br><span class="line">at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:436)</span><br><span class="line">... 34 more</span><br></pre></td></tr></table></figure></p><p>æ­£å¸¸è¿è¡Œè¾“å‡ºæˆåŠŸå‘é€çš„æ—¥å¿—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2019-03-11 23:35:14.743  INFO 13608 --- [           main] n.codingme.boot.service.MailServiceTest  : Started MailServiceTest in 3.964 seconds (JVM running for 5.749)</span><br><span class="line">2019-03-11 23:35:24.718  INFO 13608 --- [           main] net.codingme.boot.service.MailService    : ã€æ–‡æœ¬é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=niumoo@126.com</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹é‚®ç®±ä¸­çš„æ”¶ä¿¡ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/e391dbce4b614779ae9a024908ef0275.jpg" alt="æ–‡æœ¬é‚®ä»¶"></p><p>æ–‡æœ¬é‚®ä»¶æ­£å¸¸æ”¶åˆ°ï¼ŒåŒæ—¶å¯è§æ–‡æœ¬é‚®ä»¶ä¸­çš„ HTML æ ‡ç­¾ä¹Ÿä¸ä¼šè¢«è§£æã€‚</p><h2 id="Springboot-mail-HTML-é‚®ä»¶"><a href="#Springboot-mail-HTML-é‚®ä»¶" class="headerlink" title="Springboot mail HTML é‚®ä»¶"></a>Springboot mail HTML é‚®ä»¶</h2><p>åœ¨ä¸Šé¢çš„ <code>MailService</code> ç±»é‡Œæ–°åŠ ä¸€ä¸ªæ–¹æ³• <code>sendHtmlMail</code>ï¼Œç”¨äºæµ‹è¯• HTML é‚®ä»¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€ HTML é‚®ä»¶</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> MessagingException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendHtmlMail</span><span class="params">(String to, String subject, String content)</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    MimeMessage message = mailSender.createMimeMessage();</span><br><span class="line">    MimeMessageHelper messageHelper = <span class="keyword">new</span> MimeMessageHelper(message, <span class="keyword">true</span>);</span><br><span class="line">    messageHelper.setFrom(from);</span><br><span class="line">    messageHelper.setTo(to);</span><br><span class="line">    messageHelper.setSubject(subject);</span><br><span class="line">    <span class="comment">// true ä¸º HTML é‚®ä»¶</span></span><br><span class="line">    messageHelper.setText(content, <span class="keyword">true</span>);</span><br><span class="line">    mailSender.send(message);</span><br><span class="line">    log.info(<span class="string">"ã€HTML é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨æµ‹è¯•æ–¹æ³•ä¸­å¢åŠ  HTML é‚®ä»¶æµ‹è¯•æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendHtmlMailTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ HTML é‚®ä»¶"</span>;</span><br><span class="line">    String content = <span class="string">"&lt;h2&gt;Hi~&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€å° Springboot HTML é‚®ä»¶&lt;/p&gt;"</span>;</span><br><span class="line">    mailService.sendHtmlMail(to, subject, content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/147b7f68d12e0080b408a581414fb92a.jpg" alt="HTML é‚®ä»¶"></p><p>HTML é‚®ä»¶æ­£å¸¸æ”¶åˆ°ï¼ŒHTML æ ‡ç­¾ä¹Ÿè¢«è§£ææˆå¯¹åº”çš„æ ·å¼ã€‚</p><h2 id="Springboot-mail-é™„ä»¶é‚®ä»¶"><a href="#Springboot-mail-é™„ä»¶é‚®ä»¶" class="headerlink" title="Springboot mail é™„ä»¶é‚®ä»¶"></a>Springboot mail é™„ä»¶é‚®ä»¶</h2><p>åœ¨ä¸Šé¢çš„ <code>MailService</code> ç±»é‡Œæ–°åŠ ä¸€ä¸ªæ–¹æ³• <code>sendAttachmentMail</code>ï¼Œç”¨äºæµ‹è¯• é™„ä»¶é‚®ä»¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileArr</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendAttachmentMail</span><span class="params">(String to, String subject, String content, String... fileArr)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line">    MimeMessageHelper messageHelper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line">    messageHelper.setFrom(from);</span><br><span class="line">    messageHelper.setTo(to);</span><br><span class="line">    messageHelper.setSubject(subject);</span><br><span class="line">    messageHelper.setText(content, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ é™„ä»¶</span></span><br><span class="line">    <span class="keyword">for</span> (String filePath : fileArr) &#123;</span><br><span class="line">        FileSystemResource fileResource = <span class="keyword">new</span> FileSystemResource(<span class="keyword">new</span> File(filePath));</span><br><span class="line">        <span class="keyword">if</span> (fileResource.exists()) &#123;</span><br><span class="line">            String filename = fileResource.getFilename();</span><br><span class="line">            messageHelper.addAttachment(filename, fileResource);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mailSender.send(mimeMessage);</span><br><span class="line">    log.info(<span class="string">"ã€é™„ä»¶é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨æµ‹è¯•æ–¹æ³•ä¸­å¢åŠ é™„ä»¶é‚®ä»¶æµ‹è¯•æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendAttachmentTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ HTML é™„ä»¶é‚®ä»¶"</span>;</span><br><span class="line">    String content = <span class="string">"&lt;h2&gt;Hi~&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€å° Springboot HTML é™„ä»¶é‚®ä»¶&lt;/p&gt;"</span>;</span><br><span class="line">    String filePath = <span class="string">"pom.xml"</span>;</span><br><span class="line">    mailService.sendAttachmentMail(to, subject, content, filePath, filePath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/0ab42e65ae35c7970d7954bf5a985a79.jpg" alt="é™„ä»¶é‚®ä»¶"></p><p>å¸¦é™„ä»¶çš„é‚®ä»¶æ­£å¸¸æ”¶åˆ°ï¼Œå¤šä¸ªé™„ä»¶çš„å®ç°æ–¹å¼åŒç†ã€‚</p><h2 id="Springboot-mail-å›¾ç‰‡é‚®ä»¶"><a href="#Springboot-mail-å›¾ç‰‡é‚®ä»¶" class="headerlink" title="Springboot mail å›¾ç‰‡é‚®ä»¶"></a>Springboot mail å›¾ç‰‡é‚®ä»¶</h2><p>å›¾ç‰‡é‚®ä»¶å’Œå…¶ä»–çš„é‚®ä»¶æ–¹å¼ç•¥æœ‰ä¸åŒï¼Œå›¾ç‰‡é‚®ä»¶éœ€è¦å…ˆåœ¨å†…å®¹ä¸­å®šä¹‰å¥½å›¾ç‰‡çš„ä½ç½®å¹¶å‡ºç»™ä¸€ä¸ªè®°å½• ID ï¼Œç„¶ååœ¨æŠŠå›¾ç‰‡åŠ åˆ°é‚®ä»¶ä¸­çš„å¯¹äºçš„ ID ä½ç½®ã€‚</p><p>åœ¨ä¸Šé¢çš„ <code>MailService</code> ç±»é‡Œæ–°åŠ ä¸€ä¸ªæ–¹æ³• <code>sendImgMail</code>ï¼Œç”¨äºæµ‹è¯• é™„ä»¶é‚®ä»¶ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * å‘é€å¸¦å›¾ç‰‡çš„é‚®ä»¶</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> imgMap</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendImgMail</span><span class="params">(String to, String subject, String content, Map&lt;String, String&gt; imgMap)</span></span></span><br><span class="line"><span class="function">     <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">     MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line">     MimeMessageHelper messageHelper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line">     messageHelper.setFrom(from);</span><br><span class="line">     messageHelper.setTo(to);</span><br><span class="line">     messageHelper.setSubject(subject);</span><br><span class="line">     messageHelper.setText(content, <span class="keyword">true</span>);</span><br><span class="line">     <span class="comment">// æ·»åŠ å›¾ç‰‡</span></span><br><span class="line">     <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : imgMap.entrySet()) &#123;</span><br><span class="line">         FileSystemResource fileResource = <span class="keyword">new</span> FileSystemResource(<span class="keyword">new</span> File(entry.getValue()));</span><br><span class="line">         <span class="keyword">if</span> (fileResource.exists()) &#123;</span><br><span class="line">             String filename = fileResource.getFilename();</span><br><span class="line">             messageHelper.addInline(entry.getKey(), fileResource);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     mailSender.send(mimeMessage);</span><br><span class="line">     log.info(<span class="string">"ã€å›¾ç‰‡é‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼to=&#123;&#125;"</span>, to);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨æµ‹è¯•æ–¹æ³•ä¸­å¢åŠ å›¾ç‰‡é‚®ä»¶æµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•æ–¹æ³•ä¸­ä½¿ç”¨çš„ apple.png æ˜¯é¡¹ç›®é‡Œçš„ä¸€ä¸ªå›¾ç‰‡ã€‚å¯ä»¥çœ‹ä¸Šé¢çš„é¡¹ç›®ç»“æ„ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendImgTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ HTML å›¾ç‰‡é‚®ä»¶"</span>;</span><br><span class="line">    String content =</span><br><span class="line">        <span class="string">"&lt;h2&gt;Hi~&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€å° Springboot HTML å›¾ç‰‡é‚®ä»¶&lt;/p&gt;&lt;br/&gt;&lt;img src=\"cid:img01\" /&gt;&lt;img src=\"cid:img02\" /&gt;"</span>;</span><br><span class="line">    String imgPath = <span class="string">"apple.png"</span>;</span><br><span class="line">    Map&lt;String, String&gt; imgMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    imgMap.put(<span class="string">"img01"</span>, imgPath);</span><br><span class="line">    imgMap.put(<span class="string">"img02"</span>, imgPath);</span><br><span class="line">    mailService.sendImgMail(to, subject, content, imgMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå•å…ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/a676fadf6b40195c7de746adff0700bc.jpg" alt="å›¾ç‰‡é‚®ä»¶"></p><p>ä¸¤ä¸ªå›¾ç‰‡æ­£å¸¸æ˜¾ç¤ºåœ¨é‚®ä»¶é‡Œã€‚</p><h2 id="Springboot-mail-æ¨¡ç‰ˆé‚®ä»¶"><a href="#Springboot-mail-æ¨¡ç‰ˆé‚®ä»¶" class="headerlink" title="Springboot mail æ¨¡ç‰ˆé‚®ä»¶"></a>Springboot mail æ¨¡ç‰ˆé‚®ä»¶</h2><p>æ¨¡ç‰ˆé‚®ä»¶çš„ç”¨å¤„å¾ˆå¹¿æ³›ï¼Œåƒç»å¸¸æ”¶åˆ°çš„æ³¨å†ŒæˆåŠŸé‚®ä»¶æˆ–è€…æ˜¯æ“ä½œé€šçŸ¥é‚®ä»¶ç­‰éƒ½æ˜¯æ¨¡ç‰ˆé‚®ä»¶ï¼Œæ¨¡ç‰ˆé‚®ä»¶å¾€å¾€åªéœ€è¦æ›´æ”¹å…¶ä¸­çš„å‡ ä¸ªå˜é‡ã€‚Springboot ä¸­çš„æ¨¡ç‰ˆé‚®ä»¶é¦–é€‰éœ€è¦é€‰æ‹©ä¸€æ¬¾æ¨¡ç‰ˆå¼•æ“ï¼Œåœ¨å¼•å…¥ä¾èµ–çš„æ—¶å€™å·²ç»å¢åŠ äº†æ¨¡ç‰ˆå¼•æ“ <code>Thymeleaf</code>.</p><p>æ¨¡ç‰ˆé‚®ä»¶é¦–å…ˆéœ€è¦ä¸€ä¸ªé‚®ä»¶æ¨¡ç‰ˆï¼Œæˆ‘ä»¬åœ¨ <code>Templates</code> ä¸‹æ–°å»ºä¸€ä¸ª <code>HTML</code> æ–‡ä»¶ <code>RegisterSuccess.html</code>. å…¶ä¸­çš„ username æ˜¯ç»™æˆ‘ä»¬è‡ªå®šä¹‰çš„ã€‚<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ³¨å†ŒæˆåŠŸé€šçŸ¥<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>[[$&#123;username&#125;]]ï¼Œæ‚¨å¥½!</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    æ–°çš„å…¬é’¥å·²æ·»åŠ åˆ°ä½ çš„è´¦æˆ·:<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    æ ‡é¢˜: HP-WIN10 <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    å¦‚æœå…¬é’¥æ— æ³•ä½¿ç”¨ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œé‡æ–°æ·»åŠ ï¼š SSH Keys</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>åœ¨é‚®ä»¶æœåŠ¡ <code>MailService</code> ä¸­æ³¨å…¥æ¨¡ç‰ˆå¼•æ“,ç„¶åç¼–å†™é‚®ä»¶æ¨¡ç‰ˆå‘é€ä»£ç ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€æ¨¡ç‰ˆé‚®ä»¶</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> paramMap</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> template</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> MessagingException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendTemplateMail</span><span class="params">(String to, String subject, Map&lt;String, Object&gt; paramMap, String template)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    Context context = <span class="keyword">new</span> Context();</span><br><span class="line">    <span class="comment">// è®¾ç½®å˜é‡çš„å€¼</span></span><br><span class="line">    context.setVariables(paramMap);</span><br><span class="line">    String emailContent = templateEngine.process(template, context);</span><br><span class="line">    sendHtmlMail(to, subject, emailContent);</span><br><span class="line">    log.info(<span class="string">"ã€æ¨¡ç‰ˆé‚®ä»¶ã€‘æˆåŠŸå‘é€ï¼paramsMap=&#123;&#125;ï¼Œtemplate=&#123;&#125;"</span>, paramMap, template);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨å•å…ƒå•å…ƒæµ‹è¯•ä¸­å¢åŠ æ¨¡ç‰ˆé‚®ä»¶æµ‹è¯•æ–¹æ³•ï¼Œç„¶åå‘é€é‚®ä»¶æµ‹è¯•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendTemplateMailTest</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">    String to = <span class="string">"niumoo@126.com"</span>;</span><br><span class="line">    String subject = <span class="string">"Springboot å‘é€ æ¨¡ç‰ˆé‚®ä»¶"</span>;</span><br><span class="line">    Map&lt;String, Object&gt; paramMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">    paramMap.put(<span class="string">"username"</span>, <span class="string">"Darcy"</span>);</span><br><span class="line">    mailService.sendTemplateMail(to, subject, paramMap, <span class="string">"RegisterSuccess"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹æ”¶ä¿¡æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/8244d50efe797cfa3ceb14aab7b7b461.jpg" alt="æ¨¡ç‰ˆé‚®ä»¶"></p><p>å¯ä»¥å‘ç°æ¨¡ç‰ˆé‚®ä»¶å·²ç»æ­£å¸¸å‘é€äº†ã€‚</p><h2 id="Springboot-mail-è¡¥å……"><a href="#Springboot-mail-è¡¥å……" class="headerlink" title="Springboot mail è¡¥å……"></a>Springboot mail è¡¥å……</h2><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ˜¯ Springboot é‚®ä»¶æœåŠ¡çš„åŸºæœ¬ç”¨æ³•ï¼Œä»£ç ä¹Ÿæœ‰å¾ˆå¤šé‡å¤ï¼Œå’Œå®é™…çš„ä½¿ç”¨æƒ…å†µç›¸æ¯”è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œæ¯”å¦‚ç¼ºå°‘<code>å¼‚å¸¸å¤„ç†æœºåˆ¶</code>ï¼Œåœ¨å‘é€å¤±è´¥æ—¶çš„<code>é‡è¯•æœºåˆ¶</code>ä¹Ÿæ²¡æœ‰ï¼Œå®é™…æƒ…å†µä¸­é‚®ä»¶æœåŠ¡å¾€å¾€å¯¹å®æ—¶æ€§ä¸é«˜ï¼Œå¤šè¯´æƒ…å†µä¸‹ä¼šç”¨äº<code>å¼‚æ­¥è¯·æ±‚</code>ã€‚</p><p>æ–‡ç« ç›¸å…³ä»£ç å·²ç»ä¸Šä¼  Github <a href="https://github.com/niumoo/springboot/tree/master/springboot-mail" target="_blank" rel="noopener">Spring Boot ç›¸å…³æ•´åˆ - é‚®ä»¶æœåŠ¡</a>ã€‚</p><p>&lt;å®Œ&gt;<br>æœ¬æ–‡åŸå‘äºä¸ªäººåšå®¢ï¼š<a href="https://www.codingme.net">https://www.codingme.net</a> è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/00a2b4768bf601da67118c0acb347876.jpg&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;æˆ‘ä»¬è¿™ä¸ªæ—¶ä»£ï¼Œé‚®ä»¶æœåŠ¡ä¸ç®¡æ˜¯å¯¹äºå·¥ä½œä¸Šçš„äº¤æµï¼Œè¿˜æ˜¯å¹³æ—¶çš„å„ç§é‚®ä»¶é€šçŸ¥ï¼Œéƒ½æ˜¯ä¸€ä¸ªååˆ†é‡è¦çš„å­˜åœ¨ã€‚Java ä»å¾ˆæ—©æ—¶å€™å°±å¯ä»¥é€šè¿‡ Java mail æ”¯æŒé‚®ä»¶æœåŠ¡ã€‚Spring æ›´æ˜¯å¯¹ Java mail è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼ŒæŠ½è±¡å‡ºäº† &lt;code&gt;JavaMailSender&lt;/code&gt;. åæ¥éšç€ Springboot çš„å‡ºç°ï¼Œç†æ‰€å½“ç„¶çš„å‡ºç°äº† &lt;code&gt;spring-boot-starter-mail&lt;/code&gt;. ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ¯æ¬¡çš„å°è£…éƒ½è®©ä½¿ç”¨å˜å¾—è¶Šæ¥è¶Šç®€å•ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="é‚®ä»¶" scheme="https://www.codingme.net/tags/%E9%82%AE%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåäºŒï¼‰ä½¿ç”¨ Mybatis é›†æˆ pagehelper åˆ†é¡µæ’ä»¶å’Œ mapper æ’ä»¶</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-12-data-mybatis-page/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-12-data-mybatis-page/</id>
    <published>2019-03-07T16:40:22.000Z</published>
    <updated>2019-05-14T16:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/64cccddf32b7e3f4069ca2459057496e.png" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ Springboot ç³»åˆ—æ–‡ç« ç¬¬åä¸€ç¯‡é‡Œï¼ˆ<a href="https://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;mid=2247483756&amp;idx=1&amp;sn=902dba8ed665131453bc26de246ccaa1&amp;chksm=e984e808def3611edf0949a9db71ea6dc29432b25fb27015d78bc8117a50a3bedd79194de5ea&amp;token=93558379&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ä½¿ç”¨ Mybatisï¼ˆè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼‰ è®¿é—®æ•°æ®åº“</a>ï¼‰ï¼Œå®éªŒäº† Springboot ç»“åˆ Mybatis ä»¥åŠ Mybatis-generator ç”Ÿæˆæ’ä»¶çš„å¼€å‘è¿‡ç¨‹ï¼Œå…¶å®å¯¹äº Mybatis æ¥è®²è¿˜æœ‰å¾ˆå¤šä¼˜ç§€æ–¹ä¾¿å¥½ç”¨çš„æ’ä»¶ï¼Œæ¯”å¦‚è¿™æ¬¡è¦æ¼”ç¤ºçš„ é€šç”¨ Mapper ç”Ÿæˆæ’ä»¶å’Œåˆ†é¡µæ’ä»¶ã€‚<br><a id="more"></a></p><h2 id="æ•°æ®åº“å‡†å¤‡"><a href="#æ•°æ®åº“å‡†å¤‡" class="headerlink" title="æ•°æ®åº“å‡†å¤‡"></a>æ•°æ®åº“å‡†å¤‡</h2><p> æ—¢ç„¶æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œå…ˆå‡†å¤‡ä¸€ä¸ªç”¨äºå®éªŒæ“ä½œçš„æ•°æ®è¡¨ï¼Œè¿™æ¬¡è¿˜æ˜¯ä½¿ç”¨ä¸Šä¸€ä¸ªå®éªŒä½¿ç”¨çš„ mysql æ•°æ®åº“ä¸­çš„ springboot.book æ•°æ®è¡¨ã€‚</p><p>æœªåˆ›å»ºçš„å¯ä»¥åœ¨ mysql æ•°æ®åº“çš„ springboot åº“ä¸­åˆ›å»ºè¡¨ book ç”¨äºæ¼”ç¤ºã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`author`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä½œè€…'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±åç§°'</span>,</span><br><span class="line">  <span class="string">`price`</span> <span class="built_in">float</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä»·æ ¼'</span>,</span><br><span class="line">  <span class="string">`create_time`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">  <span class="string">`description`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±æè¿°'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">15</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></p><p>å¢åŠ æµ‹è¯•æ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (2, &apos;é‡‘åº¸&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–&apos;, 12, &apos;2018-09-01 10:10:12&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (3, &apos;ç½—è´¯ä¸­&apos;, &apos;ä¸‰å›½æ¼”ä¹‰&apos;, 22, &apos;2018-09-01 10:10:16&apos;, &apos;æ˜¯ä½œå®¶ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å†å²å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (4, &apos;å´æ‰¿æ©&apos;, &apos;è¥¿æ¸¸è®°&apos;, 17, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶å´æ‰¿æ©åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (5, &apos;é‡‘åº¸1535767819284&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819284&apos;, 43, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819284&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (6, &apos;é‡‘åº¸1535767819679&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819679&apos;, 24, &apos;2018-09-01 10:10:20&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819679&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (7, &apos;ç½—è´¯ä¸­1535769035138&apos;, &apos;ä¸‰å›½æ¼”ä¹‰1535769035138&apos;, 20, &apos;2018-09-01 10:30:35&apos;, &apos;æ˜¯ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨å°è¯´1535769035138&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (9, &apos;é‡‘åº¸1535783613226&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783613226&apos;, 30, &apos;2018-09-01 14:33:33&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783613226&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (10, &apos;é‡‘åº¸1535783618455&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783618455&apos;, 30, &apos;2018-09-01 14:33:38&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783618455&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (11, &apos;é‡‘åº¸1535783620634&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783620634&apos;, 30, &apos;2018-09-01 14:33:41&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783620634&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (12, &apos;é‡‘åº¸1535783672457&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783672457&apos;, 30, &apos;2018-09-01 14:34:32&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783672457&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (13, &apos;é‡‘åº¸1535783673664&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783673664&apos;, 30, &apos;2018-09-01 14:34:34&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783673664&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (14, &apos;é‡‘åº¸1535783939262&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783939262&apos;, 30, &apos;2018-09-01 14:38:59&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783939262&apos;);</span><br></pre></td></tr></table></figure></p><h2 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h2><p>åˆ›å»º Springboot é¡¹ç›®ä¸æï¼Œå¼•å…¥ maven ä¾èµ–ï¼Œä¸»è¦æ˜¯ mybastis æ ¸å¿ƒä¾èµ–ä»¥åŠ mybatis mapper è‡ªåŠ¨ç”Ÿæˆæ’ä»¶ã€åˆ†é¡µæ’ä»¶ã€é€šç”¨ Mapper æ’ä»¶ã€‚ä¾èµ–ä¸­çš„ druid æ•°æ®æºéƒ¨åˆ†ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!--æ·»åŠ æ•°æ®åº“é“¾æ¥ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Druid æ•°æ®æº --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis mapperè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis é€šç”¨ Mapper --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç®€å•è¯´æ˜ä¸€ä¸‹å‡ ä¸ªä¸å¸¸è§ä¾èµ–çš„ä½œç”¨ã€‚</p><ol><li>mybatis-generator-core ç”¨äºè‡ªåŠ¨ç”Ÿæˆ modelã€mapper æ¥å£ã€mapper xmlã€‚</li><li>pagehelper-spring-boot-starter ç”¨äºåˆ†é¡µ</li><li>mapper ç”¨äºå¢å¼ºå¢åˆ æ”¹æŸ¥åŠŸèƒ½ï¼Œé›†æˆäº†å¾ˆå¤šå¸¸ç”¨æ“ä½œã€‚</li></ol><h2 id="å¢åŠ é…ç½®"><a href="#å¢åŠ é…ç½®" class="headerlink" title="å¢åŠ é…ç½®"></a>å¢åŠ é…ç½®</h2><p>å…³äº Druid æ•°æ®æºçš„é…ç½®ä¸å†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚é…ç½®ä¸­ä¸»è¦é…ç½®äº†é¡¹ç›®ç¼–ç ã€æ•°æ®æºä¿¡æ¯ã€durid æ•°æ®æºå’Œ mybatis çš„ mapper ä½ç½®ä»¥åŠ mybatis æ˜ å°„åˆ«åçš„åŒ…è·¯å¾„ã€‚è¿˜æœ‰ pagehelper åˆ†é¡µæ’ä»¶éƒ¨åˆ†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">############################################################</span><br><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line"># ç¼–ç </span><br><span class="line">server.tomcat.uri-encoding=utf-8</span><br><span class="line">spring.http.encoding.force=true</span><br><span class="line">spring.http.encoding.charset=UTF-8</span><br><span class="line">spring.http.encoding.enabled=true</span><br><span class="line">############################################################</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line"># ä½¿ç”¨ druid æ•°æ®æº</span><br><span class="line">spring.datasource.type:com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.initialSize:5</span><br><span class="line">spring.datasource.minIdle:5</span><br><span class="line">spring.datasource.maxActive:20</span><br><span class="line">spring.datasource.maxWait:60000</span><br><span class="line">spring.datasource.timeBetweenEvictionRunsMillis:60000</span><br><span class="line">spring.datasource.minEvictableIdleTimeMillis:300000</span><br><span class="line">spring.datasource.validationQuery:SELECT 1 FROM DUAL</span><br><span class="line">spring.datasource.testWhileIdle:true</span><br><span class="line">spring.datasource.testOnBorrow:false</span><br><span class="line">spring.datasource.testOnReturn:false</span><br><span class="line">spring.datasource.poolPreparedStatements:true</span><br><span class="line">spring.datasource.filters:stat</span><br><span class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize:20</span><br><span class="line">spring.datasource.useGlobalDataSourceStat:true</span><br><span class="line">spring.datasource.connectionProperties:druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br><span class="line">############################################################</span><br><span class="line"># mybatis</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*.xml</span><br><span class="line">mybatis.type-aliases-package=net.codingme.boot.domain</span><br><span class="line">############## mybatis pageé…ç½®#######################</span><br><span class="line"># restart ç±»åŠ è½½åŠ è½½ include è¿›å»çš„ jar åŒ…ã€‚</span><br><span class="line">restart.include.mapper=/mapper-[\\w-\\.]+jar</span><br><span class="line">restart.include.pagehelper=/pagehelper-[\\w-\\.]+jar</span><br><span class="line"># mappers å¤šä¸ªæ¥å£æ—¶é€—å·éš”å¼€</span><br><span class="line">mapper.mappers=net.codingme.boot.util.MybatisMapper</span><br><span class="line">mapper.not-empty=false</span><br><span class="line">mapper.identity=MYSQL</span><br><span class="line"># pagehelper</span><br><span class="line">pagehelper.helperDialect=mysql</span><br><span class="line">pagehelper.reasonable=true</span><br><span class="line">pagehelper.supportMethodsArguments=true</span><br><span class="line">pagehelper.params=count=countSql</span><br><span class="line"># è¾“å‡º mybatis SQL æ—¥å¿—</span><br><span class="line">logging.level.net.codingme.boot.domain.mapper=debug</span><br></pre></td></tr></table></figure><p>ä¸€äº›è¯´æ˜ã€‚</p><ol><li><code>mapper.mappers=net.codingme.boot.util.MybatisMapper</code> ç”¨äºåŒ…å«ä¸€ä¸ªè‡ªå·±ç¼–å†™çš„ mapperã€‚</li><li><code>restart.include</code> çƒ­éƒ¨ç½²</li><li><code>logging.level.net.codingme.boot.domain.mapper=debug</code> è¾“å‡º Mybatis SQL è¿™é‡Œè¦æŒ‡å®šè‡ªå·± mapper æ‰€åœ¨çš„åŒ…è·¯å¾„</li></ol><h2 id="é€šç”¨-Mapper"><a href="#é€šç”¨-Mapper" class="headerlink" title="é€šç”¨ Mapper"></a>é€šç”¨ Mapper</h2><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä¹Ÿæ¼”ç¤ºäº†è‡ªåŠ¨ç”Ÿæˆï¼Œé‚£æ˜¯é€šç”¨çš„ä¸€ç§ç”Ÿæˆæ–¹å¼ï¼Œè¿™æ¬¡æˆ‘ä»¬å¼•å…¥é€šç”¨ Mapper å†è¿›è¡Œç”Ÿæˆï¼Œè¿™æ ·ç”Ÿæˆçš„ä»£ç æ›´åŠ ç®€æ´ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå…ˆçœ‹ä¸€ä¸‹é¡¹ç›®æœ€ç»ˆç»“æ„ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/58fef28ddbcf12f769f2424db21d7fa3.png" alt="é¡¹ç›®æ¥å£"></p><h3 id="è‡ªåŠ¨ç”Ÿæˆé…ç½®"><a href="#è‡ªåŠ¨ç”Ÿæˆé…ç½®" class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆé…ç½®"></a>è‡ªåŠ¨ç”Ÿæˆé…ç½®</h3><p>è‡ªåŠ¨ç”Ÿæˆé€šç”¨æ¥å£åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¼–å†™ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œæ³¨é‡Šå·²ç»æ·»åŠ äº†ï¼Œç›´æ¥çœ‹ä»£ç ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"MysqlContext"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"javaFileEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ˜¯å¦ä½¿ç”¨é€šç”¨ Mapper æä¾›çš„æ³¨é‡Šå·¥å…·ï¼Œé»˜è®¤ true ä½¿ç”¨ï¼Œè¿™æ ·åœ¨ç”Ÿæˆä»£ç æ—¶ä¼šåŒ…å«å­—æ®µçš„æ³¨é‡Šï¼ˆç›®å‰åªæœ‰ mysql å’Œ oracle æ”¯æŒï¼‰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useMapperCommentGenerator"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">"tk.mybatis.mapper.generator.MapperPlugin"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®åç”Ÿæˆçš„ Mapper æ¥å£éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªæ¥å£--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappers"</span> <span class="attr">value</span>=<span class="string">"tk.mybatis.mapper.common.MySqlMapper"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">"tk.mybatis.mapper.generator.MapperPlugin"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®åç”Ÿæˆçš„ Mapper æ¥å£éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªæ¥å£ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappers"</span> <span class="attr">value</span>=<span class="string">"tk.mybatis.mapper.common.Mapper"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œé»˜è®¤ false --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"caseSensitive"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;amp;serverTimezone=GMT%2B8&amp;amp;nullCatalogMeansCurrent=true"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"123"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„pojoæ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„mapperæ‰€åœ¨ç›®å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®mapperå¯¹åº”çš„javaæ˜ å°„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- è¦ç”Ÿæˆé‚£äº›è¡¨(æ›´æ”¹tableNameå’ŒdomainObjectNameå°±å¯ä»¥) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"book"</span> <span class="attr">domainObjectName</span>=<span class="string">"Book"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä¸ä¸Šæ¬¡ä¸åŒçš„æ˜¯è¿™æ¬¡å¢åŠ äº†ä¸¤ä¸ª <code>plugin</code>ï¼Œåé¢ç”Ÿæˆçš„ Mapper æ¥å£éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™äº›ç±»ã€‚</p><h3 id="è‡ªåŠ¨ç”Ÿæˆä»£ç "><a href="#è‡ªåŠ¨ç”Ÿæˆä»£ç " class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆä»£ç "></a>è‡ªåŠ¨ç”Ÿæˆä»£ç </h3><p>å†™å¥½é…ç½®æ–‡ä»¶ä¹‹åï¼Œè¿˜éœ€è¦å†™ä¸€ä¸ªç”Ÿæˆç¨‹åºï¼Œç”¨äºåŠ è½½é…ç½®æ–‡ä»¶ï¼Œè¿è¡Œå°±å¯ä»¥ç”Ÿæˆç›¸å…³çš„å®ä½“ç±»ã€Mapper æ¥å£ã€Mapper xml .<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Mybatis generatorçš„é€†å‘ç”Ÿæˆå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">// æŒ‡å®šä½ æƒ³å·¥ç¨‹é…ç½®æ–‡ä»¶</span></span><br><span class="line">        File configFile = <span class="keyword">new</span> File(<span class="string">"generatorConfig.xml"</span>);</span><br><span class="line">        System.out.println(configFile.getAbsolutePath());</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (String warning : warnings) &#123;</span><br><span class="line">            System.out.println(warning);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        MybatisGenerator mybatisGenerator = <span class="keyword">new</span> MybatisGenerator();</span><br><span class="line">        mybatisGenerator.generator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="è‡ªåŠ¨ç”Ÿæˆç»“æœ"><a href="#è‡ªåŠ¨ç”Ÿæˆç»“æœ" class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆç»“æœ"></a>è‡ªåŠ¨ç”Ÿæˆç»“æœ</h3><p>è¿è¡Œå®Œæ¯•ä¸Šé¢ç¨‹åºä¹‹åï¼Œè‡ªåŠ¨ç”Ÿæˆäº† Book.java.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Table</span>(name = <span class="string">"book"</span>)</span><br><span class="line"><span class="meta">@ToString</span> <span class="comment">// æ‰‹åŠ¨æ·»åŠ çš„ tostring æ³¨è§£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹¦ç±ä½œè€…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹¦ç±åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹¦ç±ä»·æ ¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Float price;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥ä¸‹é¢çš„è‡ªåŠ¨ç”Ÿæˆä»£ç </span></span><br></pre></td></tr></table></figure></p><h3 id="é€šç”¨-Mapper-1"><a href="#é€šç”¨-Mapper-1" class="headerlink" title="é€šç”¨ Mapper"></a>é€šç”¨ Mapper</h3><p>ä¸Šé¢çš„ç¨‹åºä¹Ÿè‡ªåŠ¨ç”Ÿæˆäº† BookMapper æ¥å£ï¼Œä¸”ç»§æ‰¿äº†é…ç½®çš„ MySqlMapper å’Œ Mapper æ¥å£ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Book;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.Mapper;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.MySqlMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookMapper</span> <span class="keyword">extends</span> <span class="title">MySqlMapper</span>&lt;<span class="title">Book</span>&gt;, <span class="title">Mapper</span>&lt;<span class="title">Book</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸¤ä¸ªæ¥å£é‡Œå®ç°äº†å¾ˆå¤šå¸¸ç”¨æ“ä½œã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/51f20a7f33ad27d9495046c236dec145.png" alt="é€šç”¨ Mapper é‡Œçš„æ–¹æ³•"></p><p>ç”Ÿæˆå®Œæˆä¹‹åè¦åœ¨ Springboot å¯åŠ¨å™¨ä¸Šæ·»åŠ  MapperScan æ³¨è§£æŒ‡å®šè¦æ‰«æçš„ mapper ä½ç½®ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@tk</span>.mybatis.spring.annotation.MapperScan(basePackages = <span class="string">"net.codingme.boot.domain.mapper"</span>)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•"></a>å•å…ƒæµ‹è¯•å’Œåˆ†é¡µæµ‹è¯•</h2><p>ç¼–å†™ BookMapperTest å•å…ƒæµ‹è¯•ç”¨äºæµ‹è¯• BookMapper çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.domain.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.Book;</span><br><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookMapper bookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = <span class="keyword">new</span> Book();</span><br><span class="line">        book.setId(<span class="number">2</span>);</span><br><span class="line">        Book selectOne = bookMapper.selectOne(book);</span><br><span class="line">        Assert.assertNotNull(selectOne);</span><br><span class="line">        System.out.println(selectOne);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = bookMapper.selectByPrimaryKey(<span class="number">2</span>);</span><br><span class="line">        Assert.assertNotNull(book);</span><br><span class="line">        System.out.println(book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæµ‹è¯•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPageInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper.startPage(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥è¯¢å‡ºæ•°é‡ï¼š"</span> + bookList.size());</span><br><span class="line">        PageInfo&lt;Book&gt; pageInfo = PageInfo.of(bookList);</span><br><span class="line">        System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + pageInfo.getTotal());</span><br><span class="line">        System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + pageInfo.getPages());</span><br><span class="line">        System.out.println(<span class="string">"é¡µå¤§å°ï¼š"</span> + pageInfo.getPageSize());</span><br><span class="line">        System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + pageInfo.getPageNum());</span><br><span class="line">        System.out.println(<span class="string">"å½“å‰é‡ï¼š"</span> + pageInfo.getSize());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæµ‹è¯•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper.startPage(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥è¯¢å‡ºæ•°é‡ï¼š"</span> + bookList.size());</span><br><span class="line">        System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + ((Page)bookList).getTotal());</span><br><span class="line">        System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + ((Page)bookList).getPages());</span><br><span class="line">        System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + ((Page)bookList).getPageNum());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°åˆ†é¡µçš„å®ç°ä¸»è¦æ˜¯ PageHelper çš„è®¾ç½®ï¼Œåœ¨è®¾ç½® PageHelper ä¹‹åçš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¼šè¿›è¡Œåˆ†é¡µã€‚åƒä¸Šé¢çš„ä¾‹å­ä¼šæŸ¥è¯¢ç¬¬äºŒé¡µï¼Œæ¯é¡µä¸‰æ¡è¿™æ ·ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.startPage(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br></pre></td></tr></table></figure></p><p>å…¶å®ä½¿ç”¨äº†åˆ†é¡µæ’ä»¶ä¹‹åè¿”å›çš„æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ª Page ç±»ï¼Œæ€»æ•°ç­‰åˆ†é¡µä¿¡æ¯éƒ½å·²ç»è¿”å›ï¼Œå¦‚æœè¦å–å‡ºæ¥ä½¿ç”¨å°±éœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹ç„¶åå–å‡ºï¼Œä¸Šé¢ä¹Ÿæ˜¯æ¼”ç¤ºäº†ä¸¤ç§æ–¹å¼ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼ 1</span></span><br><span class="line">PageInfo&lt;Book&gt; pageInfo = PageInfo.of(bookList);</span><br><span class="line">System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + pageInfo.getTotal());</span><br><span class="line">System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + pageInfo.getPages());</span><br><span class="line">System.out.println(<span class="string">"é¡µå¤§å°ï¼š"</span> + pageInfo.getPageSize());</span><br><span class="line">System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + pageInfo.getPageNum());</span><br><span class="line">System.out.println(<span class="string">"å½“å‰é‡ï¼š"</span> + pageInfo.getSize());</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼ 2</span></span><br><span class="line">System.out.println(<span class="string">"æŸ¥è¯¢å‡ºæ•°é‡ï¼š"</span> + bookList.size());</span><br><span class="line">System.out.println(<span class="string">"æ€»æ•°é‡ï¼š"</span> + ((Page)bookList).getTotal());</span><br><span class="line">System.out.println(<span class="string">"æ€»é¡µæ•°ï¼š"</span> + ((Page)bookList).getPages());</span><br><span class="line">System.out.println(<span class="string">"ç¬¬å‡ é¡µï¼š"</span> + ((Page)bookList).getPageNum());</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œ BookMapperTest ç±»æµ‹è¯•æ‰€æœ‰çš„å•å…ƒæµ‹è¯•ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/0dd65eb033d1b3e872cd2ed41f201dca.png" alt="å•å…ƒæµ‹è¯•ç»“æœ"></p><p>å‘ç°å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ŒæŸ¥çœ‹ä¸€ä¸ªåˆ†é¡µæŸ¥è¯¢ï¼ˆtestSelectPageInfoï¼‰è¾“å‡ºæƒ…å†µã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2019-03-08 16:07:52.226 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectAll_COUNT     : ==&gt;  Preparing: SELECT count(0) FROM book </span><br><span class="line">2019-03-08 16:07:52.227 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectAll_COUNT     : ==&gt; Parameters: </span><br><span class="line">2019-03-08 16:07:52.229 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectAll_COUNT     : &lt;==      Total: 1</span><br><span class="line">2019-03-08 16:07:52.231 DEBUG 26764 --- [           main] n.c.b.d.mapper.BookMapper.selectAll      : ==&gt;  Preparing: SELECT id,author,name,price,create_time,description FROM book LIMIT ?, ? </span><br><span class="line">2019-03-08 16:07:52.233 DEBUG 26764 --- [           main] n.c.b.d.mapper.BookMapper.selectAll      : ==&gt; Parameters: 3(Integer), 3(Integer)</span><br><span class="line">2019-03-08 16:07:52.236 DEBUG 26764 --- [           main] n.c.b.d.mapper.BookMapper.selectAll      : &lt;==      Total: 3</span><br><span class="line">æŸ¥è¯¢å‡ºæ•°é‡ï¼š3</span><br><span class="line">æ€»æ•°é‡ï¼š12</span><br><span class="line">æ€»é¡µæ•°ï¼š4</span><br><span class="line">é¡µå¤§å°ï¼š3</span><br><span class="line">ç¬¬å‡ é¡µï¼š2</span><br><span class="line">å½“å‰é‡ï¼š3</span><br></pre></td></tr></table></figure></p><p>å†æŸ¥çœ‹ä¸€ä¸ªæ™®é€šæŸ¥è¯¢ï¼ˆtestSelectByPrimaryKeyï¼‰è¾“å‡ºæƒ…å†µã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2019-03-08 16:07:52.241 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectByPrimaryKey  : ==&gt;  Preparing: SELECT id,author,name,price,create_time,description FROM book WHERE id = ? </span><br><span class="line">2019-03-08 16:07:52.242 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectByPrimaryKey  : ==&gt; Parameters: 2(Integer)</span><br><span class="line">2019-03-08 16:07:52.244 DEBUG 26764 --- [           main] n.c.b.d.m.BookMapper.selectByPrimaryKey  : &lt;==      Total: 1</span><br><span class="line">Book(id=2, author=é‡‘åº¸, name=ç¬‘å‚²æ±Ÿæ¹–, price=12.0, createTime=Sat Sep 01 10:10:12 GMT+08:00 2018, description=æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´)</span><br></pre></td></tr></table></figure></p><p>æ–‡ä¸­ä»£ç å·²ç»ä¸Šä¼ åˆ° Github <a href="https://github.com/niumoo/springboot" target="_blank" rel="noopener">Spring Boot è¿æ¥æ•°æ®åº“ - Mybatis æ’ä»¶</a></p><p>æƒ³è¦äº†è§£è¿™å‡ ä¸ªæ’ä»¶çš„å…¶ä»–ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><ol><li><a href="https://pagehelper.github.io/docs/howtouse/" target="_blank" rel="noopener">å¦‚ä½•ä½¿ç”¨åˆ†é¡µæ’ä»¶</a></li><li><a href="https://github.com/abel533/Mapper/wiki/1.3-spring-boot" target="_blank" rel="noopener">Mapperæ’ä»¶</a></li><li><a href="http://www.mybatis.org/generator/" target="_blank" rel="noopener"> MyBatis Generator</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/64cccddf32b7e3f4069ca2459057496e.png&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨ Springboot ç³»åˆ—æ–‡ç« ç¬¬åä¸€ç¯‡é‡Œï¼ˆ&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI1MDIxNjQ1OQ==&amp;amp;mid=2247483756&amp;amp;idx=1&amp;amp;sn=902dba8ed665131453bc26de246ccaa1&amp;amp;chksm=e984e808def3611edf0949a9db71ea6dc29432b25fb27015d78bc8117a50a3bedd79194de5ea&amp;amp;token=93558379&amp;amp;lang=zh_CN#rd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä½¿ç”¨ Mybatisï¼ˆè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼‰ è®¿é—®æ•°æ®åº“&lt;/a&gt;ï¼‰ï¼Œå®éªŒäº† Springboot ç»“åˆ Mybatis ä»¥åŠ Mybatis-generator ç”Ÿæˆæ’ä»¶çš„å¼€å‘è¿‡ç¨‹ï¼Œå…¶å®å¯¹äº Mybatis æ¥è®²è¿˜æœ‰å¾ˆå¤šä¼˜ç§€æ–¹ä¾¿å¥½ç”¨çš„æ’ä»¶ï¼Œæ¯”å¦‚è¿™æ¬¡è¦æ¼”ç¤ºçš„ é€šç”¨ Mapper ç”Ÿæˆæ’ä»¶å’Œåˆ†é¡µæ’ä»¶ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="æ’ä»¶" scheme="https://www.codingme.net/tags/%E6%8F%92%E4%BB%B6/"/>
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Mybatis" scheme="https://www.codingme.net/tags/Mybatis/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåä¸€ï¼‰ä½¿ç”¨ Mybatisï¼ˆè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼‰ è®¿é—®æ•°æ®åº“</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-11-data-mybatis/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-11-data-mybatis/</id>
    <published>2019-03-06T17:40:01.000Z</published>
    <updated>2019-05-14T16:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/60327e81c9b1f06ed84cb177feded21b.jpg" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰"></p><h2 id="1-Springboot-mybatis-ä»‹ç»"><a href="#1-Springboot-mybatis-ä»‹ç»" class="headerlink" title="1. Springboot mybatis ä»‹ç»"></a>1. Springboot mybatis ä»‹ç»</h2><p>MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°è·å–ç»“æœé›†çš„è¿‡ç¨‹ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ <code>XML</code> æˆ–<code>æ³¨è§£</code>æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚<br><a id="more"></a><br>å…³äº Mybatis çš„åŸºç¡€çŸ¥è¯†å¯ä»¥æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ï¼Œååˆ†çš„è¯¦ç»†ã€‚<a href="http://www.mybatis.org/mybatis-3/zh/getting-started.html" target="_blank" rel="noopener">mybatis å®˜æ–¹æ–‡æ¡£</a>.</p><h2 id="2-Springboot-mybatis-ä¾èµ–"><a href="#2-Springboot-mybatis-ä¾èµ–" class="headerlink" title="2. Springboot mybatis ä¾èµ–"></a>2. Springboot mybatis ä¾èµ–</h2><p>æœ¬ç³»åˆ— Springboot æ–‡ç« ä¸»è¦æ˜¯ Springboot çš„å­¦ä¹ ä¸åˆ†æï¼Œä¹Ÿå› æ­¤åªä¼šè¯•éªŒ Mybatis åœ¨ Springboot ä¸­çš„ä¸€äº›ç”¨æ³•ï¼Œå…³äº Mybatis çš„åŸºç¡€çŸ¥è¯†ï¼Œè¿˜æ˜¯éœ€è¦è‡ªè¡Œå­¦ä¹ çš„ã€‚<br>åˆ›å»º Springboot é¡¹ç›®ä¸æï¼Œå¼•å…¥ maven ä¾èµ–ï¼Œä¸»è¦æ˜¯ mybastis æ ¸å¿ƒä¾èµ–ä»¥åŠä¸€ä¸ª mybatis mapper è‡ªåŠ¨ç”Ÿæˆæ’ä»¶ã€‚ä¾èµ–ä¸­çš„ druid æ•°æ®æºéƒ¨åˆ†ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- Druid æ•°æ®æº --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- mybatis mapperè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!--æ·»åŠ æ•°æ®åº“é“¾æ¥ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="3-Springboot-mybatis-é…ç½®"><a href="#3-Springboot-mybatis-é…ç½®" class="headerlink" title="3. Springboot mybatis é…ç½®"></a>3. Springboot mybatis é…ç½®</h2><p>å…³äº Druid æ•°æ®æºçš„é…ç½®ä¸å†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚é…ç½®ä¸­ä¸»è¦é…ç½®äº†é¡¹ç›®ç¼–ç ã€æ•°æ®æºä¿¡æ¯ã€durid æ•°æ®æºå’Œ mybatis çš„ mapper ä½ç½®ä»¥åŠ mybatis æ˜ å°„åˆ«åçš„åŒ…è·¯å¾„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">############################################################</span><br><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line"></span><br><span class="line"># ç¼–ç </span><br><span class="line">server.tomcat.uri-encoding=utf-8</span><br><span class="line">spring.http.encoding.force=true</span><br><span class="line">spring.http.encoding.charset=UTF-8</span><br><span class="line">spring.http.encoding.enabled=true</span><br><span class="line">############################################################</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span><br><span class="line">spring.datasource.driver-class-name= com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ druid æ•°æ®æº</span><br><span class="line">spring.datasource.type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.initialSize: 5</span><br><span class="line">spring.datasource.minIdle: 5</span><br><span class="line">spring.datasource.maxActive: 20</span><br><span class="line">spring.datasource.maxWait: 60000</span><br><span class="line">spring.datasource.timeBetweenEvictionRunsMillis: 60000</span><br><span class="line">spring.datasource.minEvictableIdleTimeMillis: 300000</span><br><span class="line">spring.datasource.validationQuery: SELECT 1 FROM DUAL</span><br><span class="line">spring.datasource.testWhileIdle: true</span><br><span class="line">spring.datasource.testOnBorrow: false</span><br><span class="line">spring.datasource.testOnReturn: false</span><br><span class="line">spring.datasource.poolPreparedStatements: true</span><br><span class="line">spring.datasource.filters: stat</span><br><span class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize: 20</span><br><span class="line">spring.datasource.useGlobalDataSourceStat: true</span><br><span class="line">spring.datasource.connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br><span class="line"></span><br><span class="line"># mybatis</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*.xml</span><br><span class="line">mybatis.type-aliases-package=net.codingme.boot.domain</span><br></pre></td></tr></table></figure></p><h2 id="4-Springboot-mybatis-ç¼–ç "><a href="#4-Springboot-mybatis-ç¼–ç " class="headerlink" title="4. Springboot mybatis ç¼–ç "></a>4. Springboot mybatis ç¼–ç </h2><p>mybatis æ˜¯åŠ ORM æ¡†æ¶ï¼Œå®ƒé€šè¿‡ XML æè¿°ç¬¦æˆ–è€…æ³¨è§£æŠŠ POJO å¯¹è±¡ä¸ SQL ä¿¡æ¯å…³è”èµ·æ¥ï¼Œä¹Ÿå› ä¸ºæ˜¯å’Œ SQL å…³è”èµ·æ¥ï¼Œä½¿ç”¨ mybatis å¯ä»¥å……åˆ†çš„åˆ©ç”¨æ•°æ®çš„å„ç§åŠŸèƒ½ä»¥åŠå¼ºå¤§çš„ SQL è¯­å¥ã€‚ä¹Ÿå¯ä»¥å‘å‘ç°ä½¿ç”¨ mybatis è‡³å°‘åº”è¯¥å»ºç«‹ POJO å¯¹è±¡å’Œ SQL å…³è”ä¿¡æ¯ä»¥åŠç¼–å†™ç›¸å…³æ“ä½œä»£ç ã€‚</p><h3 id="4-1-æ•°æ®åº“å‡†å¤‡"><a href="#4-1-æ•°æ®åº“å‡†å¤‡" class="headerlink" title="4.1. æ•°æ®åº“å‡†å¤‡"></a>4.1. æ•°æ®åº“å‡†å¤‡</h3><p>æ—¢ç„¶æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œå…ˆå‡†å¤‡ä¸€ä¸ªç”¨äºå®éªŒæ“ä½œçš„æ•°æ®è¡¨ã€‚ä¸Šä¸€ä¸ªæ­¥éª¤ä¸­æœ‰é…ç½®æ•°æ®åº“ä¿¡æ¯ä¸º springbootã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot</span><br></pre></td></tr></table></figure></p><p>å› æ­¤åœ¨ mysql æ•°æ®åº“çš„ springboot åº“ä¸­åˆ›å»ºè¡¨ book ç”¨äºæ¼”ç¤ºã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`author`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä½œè€…'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±åç§°'</span>,</span><br><span class="line">  <span class="string">`price`</span> <span class="built_in">float</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±ä»·æ ¼'</span>,</span><br><span class="line">  <span class="string">`create_time`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">  <span class="string">`description`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ä¹¦ç±æè¿°'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">15</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></p><p>å¢åŠ æµ‹è¯•æ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (2, &apos;é‡‘åº¸&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–&apos;, 12, &apos;2018-09-01 10:10:12&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (3, &apos;ç½—è´¯ä¸­&apos;, &apos;ä¸‰å›½æ¼”ä¹‰&apos;, 22, &apos;2018-09-01 10:10:16&apos;, &apos;æ˜¯ä½œå®¶ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å†å²å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (4, &apos;å´æ‰¿æ©&apos;, &apos;è¥¿æ¸¸è®°&apos;, 17, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶å´æ‰¿æ©åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡å°è¯´&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (5, &apos;é‡‘åº¸1535767819284&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819284&apos;, 43, &apos;2018-09-01 10:10:19&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819284&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (6, &apos;é‡‘åº¸1535767819679&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535767819679&apos;, 24, &apos;2018-09-01 10:10:20&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535767819679&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (7, &apos;ç½—è´¯ä¸­1535769035138&apos;, &apos;ä¸‰å›½æ¼”ä¹‰1535769035138&apos;, 20, &apos;2018-09-01 10:30:35&apos;, &apos;æ˜¯ç½—è´¯ä¸­åˆ›ä½œçš„ä¸€éƒ¨å°è¯´1535769035138&apos;);</span><br><span class="line">INSERT INTO `springboot`.`book`(`id`, `author`, `name`, `price`, `create_time`, `description`) VALUES (8, &apos;é‡‘åº¸1535783611785&apos;, &apos;ç¬‘å‚²æ±Ÿæ¹–1535783611785&apos;, 30, &apos;2018-09-01 14:33:32&apos;, &apos;æ˜¯ä½œå®¶é‡‘åº¸åˆ›ä½œçš„ä¸€éƒ¨é•¿ç¯‡æ­¦ä¾ å°è¯´1535783611785&apos;);</span><br></pre></td></tr></table></figure></p><h3 id="4-2-è‡ªåŠ¨ç”Ÿæˆæ’ä»¶"><a href="#4-2-è‡ªåŠ¨ç”Ÿæˆæ’ä»¶" class="headerlink" title="4.2. è‡ªåŠ¨ç”Ÿæˆæ’ä»¶"></a>4.2. è‡ªåŠ¨ç”Ÿæˆæ’ä»¶</h3><p>ä¼ ç»Ÿçš„ mybatisã€€å¼€å‘è¿‡ç¨‹éœ€è¦ä¾ç…§æ•°æ®è¡¨æ–°å»ºå¤§é‡çš„ã€€POJO ç±»ï¼Œç„¶ååœ¨ç¼–å†™å“åº”çš„å¢åˆ æ”¹æŸ¥æ¥å£ï¼Œç»§è€Œç¼–å†™å¢åˆ æ”¹æŸ¥å¯¹åº”çš„ XML æ–‡ä»¶ã€‚è¿‡ç¨‹æ— è¶£ä¸”æœ‰é‡å¤åŠ³åŠ¨ï¼Œå› æ­¤äº§ç”Ÿäº†ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆå·¥å…·ï¼Œå¯ä»¥é€šè¿‡ JDBC è¿æ¥åˆ°æ•°æ®åº“ï¼Œè‡ªåŠ¨çš„åˆ›å»º POJOã€æ“ä½œæ¥å£ã€XML æ–‡ä»¶ã€‚</p><p>åœ¨å¼•å…¥ä¾èµ–çš„æ—¶å€™å·²ç»å¼•å…¥äº†è‡ªåŠ¨ç”Ÿæˆæ’ä»¶ï¼Œä¹Ÿå°±æ˜¯ <code>mybatis-generator-core</code>ã€‚</p><p>æ¥ç€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºè‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œä¸»è¦é…ç½®æ•°æ®åº“ä¿¡æ¯å’Œè¦ç”Ÿæˆçš„è¡¨å·²ç»ç”Ÿæˆçš„ä»£ç å­˜æ”¾ä½ç½®ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/9de1c6553d3afc7f006f791fdf088b04.png" alt="é¡¹ç›®ç»“æ„"></p><p>åœ¨ä¹‹å‰ä½œè€…ä¹Ÿä»‹ç»è¿‡ï¼Œå¯ä»¥å‚è€ƒåšå®¢æ–‡ç« <a href="https://www.codingme.net/2017/11/develop/tool-mybatis-generator/">ä½¿ç”¨MyBatis Generatorè‡ªåŠ¨ç”ŸæˆModelã€Daoã€Mapperç›¸å…³ä»£ç </a>ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"MysqlContext"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;amp;serverTimezone=GMT%2B8&amp;amp;nullCatalogMeansCurrent=true"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"123"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„pojoæ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹äºç”Ÿæˆçš„mapperæ‰€åœ¨ç›®å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®mapperå¯¹åº”çš„javaæ˜ å°„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"net.codingme.boot.domain.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- è¦ç”Ÿæˆé‚£äº›è¡¨(æ›´æ”¹tableNameå’ŒdomainObjectNameå°±å¯ä»¥) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"book"</span> <span class="attr">domainObjectName</span>=<span class="string">"Book"</span> <span class="attr">enableCountByExample</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">enableUpdateByExample</span>=<span class="string">"true"</span> <span class="attr">enableUpdateByPrimaryKey</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">selectByExampleQueryId</span>=<span class="string">"true"</span> <span class="attr">enableDeleteByPrimaryKey</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">enableSelectByPrimaryKey</span>=<span class="string">"true"</span> <span class="attr">enableSelectByExample</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        &gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å†™å¥½é…ç½®æ–‡ä»¶ä¹‹åï¼Œè¿˜éœ€è¦å†™ä¸€ä¸ªå¯åŠ¨ç¨‹åºï¼Œç”¨äºåŠ è½½é…ç½®æ–‡ä»¶ï¼Œè¿è¡Œå°±å¯ä»¥ç”Ÿæˆç›¸å…³é…ç½®ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Mybatis generatorçš„é€†å‘ç”Ÿæˆå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">// æŒ‡å®šä½ æƒ³å·¥ç¨‹é…ç½®æ–‡ä»¶</span></span><br><span class="line">        File configFile = <span class="keyword">new</span> File(<span class="string">"generatorConfig.xml"</span>);</span><br><span class="line">        System.out.println(configFile.getAbsolutePath());</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        MybatisGenerator mybatisGenerator = <span class="keyword">new</span> MybatisGenerator();</span><br><span class="line">        mybatisGenerator.generator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç”Ÿæˆçš„æ–‡ä»¶å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/de3a01eaf435ed5ab223603a04c9eb71.png" alt="é¡¹ç›®ç»“æ„"></p><p>æŸ¥çœ‹ç”Ÿæˆçš„æ¥å£ä»¥åŠ XML æ˜ å°„æ–‡ä»¶å¯ä»¥å‘ç°å·²ç»è‡ªåŠ¨ç”Ÿæˆäº†å¸¸ç”¨çš„å‡ ä¸ªæ–¹æ³•ã€‚</p><ol><li>deleteByPrimaryKey</li><li>insert</li><li>updateByPrimaryKey</li><li>selectByPrimaryKey</li><li>selectAll</li></ol><p>ç”Ÿæˆå®Œæˆä¹‹åè¦åœ¨ Springboot å¯åŠ¨å™¨ä¸Šæ·»åŠ  MapperScan æ³¨è§£æŒ‡å®šè¦æ‰«æçš„ mapper ä½ç½®ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"net.codingme.boot.domain.mapper"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="4-3-æ³¨è§£é…ç½®æ–¹å¼"><a href="#4-3-æ³¨è§£é…ç½®æ–¹å¼" class="headerlink" title="4.3. æ³¨è§£é…ç½®æ–¹å¼"></a>4.3. æ³¨è§£é…ç½®æ–¹å¼</h3><p>Mybatis åŒæ ·æ”¯æŒæ³¨è§£çš„æ–¹å¼é…ç½®æ˜ å°„å…³ç³»ï¼Œä½¿ç”¨æ³¨è§£å¯ä»¥æ›¿ä»£ XML çš„é…ç½®ï¼Œå†™ä¸€ä¸ªç®€å•çš„æ³¨è§£ä¾‹å­ã€‚åœ¨åˆšæ‰ç”Ÿæˆçš„ BookMapper.java ä¸­å¢åŠ ä¸€ä¸ªæ ¹æ®ä½œè€…åç§°æŸ¥è¯¢çš„æ–¹æ³•ï¼Œå¹¶æ˜ å°„å­—æ®µå¯¹åº”çš„å±æ€§ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ  @Repository æ³¨è§£ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ @Autowired å¼•å…¥çš„æ—¶å€™ä¸ä¼šæŠ¥æ¨ªçº¿</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookMapper</span> </span>&#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨è§£æ–¹å¼é…ç½®æ˜ å°„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> author</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Results</span> å­—æ®µå’Œå±æ€§æ˜ å°„å…³ç³»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Select</span> æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Results</span>(&#123;</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"id"</span>, column = <span class="string">"ids"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"name"</span>, column = <span class="string">"name"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"author"</span>, column = <span class="string">"authors"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"createTime"</span>, column = <span class="string">"create_time"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select id as ids, author as authors, name, price, create_time, description from book where author = #&#123;author&#125;"</span>)</span><br><span class="line">    <span class="function">List&lt;Book&gt; <span class="title">selectByAuthor</span><span class="params">(@Param(<span class="string">"author"</span>)</span> String author)</span>;</span><br><span class="line">    <span class="comment">// çœç•¥ä¸‹é¢è‡ªåŠ¨ç”Ÿæˆä»£ç </span></span><br></pre></td></tr></table></figure></p><h2 id="5-Springboot-mybatis-æµ‹è¯•"><a href="#5-Springboot-mybatis-æµ‹è¯•" class="headerlink" title="5. Springboot mybatis æµ‹è¯•"></a>5. Springboot mybatis æµ‹è¯•</h2><p>æ­£å¸¸æƒ…å†µä¸‹ä¼šåœ¨é¡¹ç›®ä¸­çš„ä¸šåŠ¡å±‚ service åŒ…ä¸‹åˆ›å»ºæ¥å£å’Œç±»ç„¶åé€šè¿‡æ³¨è§£å¼•å…¥ä½¿ç”¨ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> BookMapper bookMapper;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬åªæ˜¯å®éªŒï¼Œæ²¡æœ‰è¿™æ ·å†™ä¸€å¥—çš„å¿…è¦ï¼Œåªè¦èƒ½ç¡®ä¿ BookMapper å¯ä»¥æ­£å¸¸æ³¨å…¥ä½¿ç”¨å°±å¥½äº†ã€‚å› æ­¤åˆ›å»ºæµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/730d20139c46c077d4064261ec9290a5.png" alt="åˆ›å»ºæµ‹è¯•ç±»"></p><p>åœ¨ç”Ÿæˆçš„ï¼ˆä¹Ÿå¯ä»¥å®Œå…¨æ‰‹å†™æµ‹è¯•æ–¹æ³•ï¼‰æµ‹è¯•ç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•è¿›è¡Œæµ‹è¯•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookMapper bookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectAll();</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        bookList.forEach((book) -&gt; System.out.println(book));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByAuthro</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = bookMapper.selectByAuthor(<span class="string">"é‡‘åº¸"</span>);</span><br><span class="line">        Assert.assertNotNull(bookList);</span><br><span class="line">        bookList.forEach((book) -&gt; System.out.println(book));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = bookMapper.selectByPrimaryKey(<span class="number">2</span>);</span><br><span class="line">        Assert.assertNotNull(book);</span><br><span class="line">        System.out.println(book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> primaryKey = bookMapper.deleteByPrimaryKey(<span class="number">8</span>);</span><br><span class="line">        Assert.assertNotEquals(<span class="number">0</span>, primaryKey);</span><br><span class="line">        System.out.println(primaryKey);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸ºäº†è§‚å¯ŸæŸ¥è¯¢æ¥å£ book çš„ä¿¡æ¯è¾“å‡ºï¼Œé‡å†™ Book ç±»çš„ toString æ–¹æ³•ï¼Œç„¶åè¿è¡Œå•å…ƒæµ‹è¯•ã€‚</p><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/0a059a1c7f49265a61cda7bbd07f1d2d.png" alt="å•å…ƒæµ‹è¯•ç»“æœ"></p><p>å¯ä»¥å‘ç°æµ‹è¯•å…¨éƒ¨é€šè¿‡ã€‚ç»“æœæ­£å¸¸ã€‚<br>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° Github <a href="https://github.com/niumoo/springboot/tree/master/springboot-data-mybatis" target="_blank" rel="noopener">Spring Boot è¿æ¥æ•°æ®åº“ - Mybatis</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/60327e81c9b1f06ed84cb177feded21b.jpg&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-Springboot-mybatis-ä»‹ç»&quot;&gt;&lt;a href=&quot;#1-Springboot-mybatis-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1. Springboot mybatis ä»‹ç»&quot;&gt;&lt;/a&gt;1. Springboot mybatis ä»‹ç»&lt;/h2&gt;&lt;p&gt;MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°è·å–ç»“æœé›†çš„è¿‡ç¨‹ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ &lt;code&gt;XML&lt;/code&gt; æˆ–&lt;code&gt;æ³¨è§£&lt;/code&gt;æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="æ’ä»¶" scheme="https://www.codingme.net/tags/%E6%8F%92%E4%BB%B6/"/>
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Mybatis" scheme="https://www.codingme.net/tags/Mybatis/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆåï¼‰ä½¿ç”¨ Spring data jpa è®¿é—®æ•°æ®åº“</title>
    <link href="https://www.codingme.net/2019/03/springboot/springboot-10-data-jpa/"/>
    <id>https://www.codingme.net/2019/03/springboot/springboot-10-data-jpa/</id>
    <published>2019-02-28T17:40:01.000Z</published>
    <updated>2019-05-14T16:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/7bea43f15edb0db3ac708c346acd35c4.jpg" alt="æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Springboot data jpa å’Œ Spring jdbc åŒå±äº Springå¼€æºç»„ç»‡ï¼Œåœ¨ Spring jdbc ä¹‹ååˆå¼€å‘äº†æŒä¹…å±‚æ¡†æ¶ï¼Œå¾ˆæ˜æ˜¾ Spring data jpa ç›¸å¯¹äº Spring jdbc æ›´åŠ çš„ä¾¿æ·å¼ºå¤§ï¼Œä¸ç„¶ä¹Ÿå°±æ²¡æœ‰å¼€å‘çš„å¿…è¦äº†ã€‚æ ¹æ®ä¸‹é¢çš„æ–‡ç« å¼€å§‹ä½“éªŒä¸‹ Spring data jpa é­…åŠ›ã€‚<br><a id="more"></a></p><h2 id="1-Spring-data-jpa-ä»‹ç»"><a href="#1-Spring-data-jpa-ä»‹ç»" class="headerlink" title="1. Spring data jpa ä»‹ç»"></a>1. Spring data jpa ä»‹ç»</h2><p>Spring data jpa æ˜¯ Spring data ç³»åˆ—çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨å®ƒå¯ä»¥è½»æ¾çš„å®ç°å¯¹æ•°æ®è®¿é—®å±‚çš„å¢å¼ºæ”¯æŒï¼Œåœ¨ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼Œå®ç°åº”ç”¨ç¨‹åºçš„æ•°æ®è®¿é—®å±‚ä¸€ç›´å¾ˆéº»çƒ¦ï¼Œéœ€è¦ç¼–å†™å¤§é‡çš„æ ·æ¿å¼çš„ä»£ç æ¥æ‰§è¡Œç®€å•æŸ¥è¯¢æˆ–è€…åˆ†é¡µæ“ä½œã€‚Spring data jpa çš„ç›®æ ‡æ˜¯å°½é‡çš„å‡å°‘å®é™…ç¼–ç æ¥æ”¹å–„æ•°æ®è®¿é—®å±‚çš„æ“ä½œã€‚</p><h2 id="2-Spring-data-jpa-ä¾èµ–"><a href="#2-Spring-data-jpa-ä¾èµ–" class="headerlink" title="2. Spring data jpa ä¾èµ–"></a>2. Spring data jpa ä¾èµ–</h2><p>è¿™æ¬¡çš„å®éªŒåŸºäºç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡å®éªŒä»£ç ï¼Œä»£ç ä¸­çš„æ•°æ®æºç›¸å…³çš„é…ç½®ä¹Ÿå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ï¼Œè¿™é‡Œåªæ¼”ç¤º Spring data jpa éƒ¨åˆ†ã€‚</p><p>åˆ›å»ºSpring boot é¡¹ç›®ï¼Œå¼•å…¥éœ€è¦çš„ä¾èµ–ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot web å¼€å‘æ•´åˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é˜¿é‡Œ fastjson --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Lombok å·¥å…· --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œåœ¨é…ç½®springbootç›¸å…³æ–‡ä»¶æ—¶å€™ä¼šæœ‰æç¤º --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ•°æ®åº“è®¿é—® JPA--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ·»åŠ æ•°æ®åº“é“¾æ¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é˜¿é‡Œ druid æ•°æ®æºï¼ŒSpring boot ä¸­ä½¿ç”¨Druidè¦ç”¨è¿™ä¸ª  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="3-Spring-data-jpa-é…ç½®"><a href="#3-Spring-data-jpa-é…ç½®" class="headerlink" title="3. Spring data jpa é…ç½®"></a>3. Spring data jpa é…ç½®</h2><p>å…³äº Druid æ•°æ®æºçš„é…ç½®ä¸å†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒç³»åˆ—æ–‡ç« ç¬¬ä¹ç¯‡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">############################################################</span><br><span class="line"># æœåŠ¡å¯åŠ¨ç«¯å£å·</span><br><span class="line">server.port=8080</span><br><span class="line">spring.profiles.active=dev</span><br><span class="line">############################################################</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span><br><span class="line">spring.datasource.driver-class-name= com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line"># ä½¿ç”¨ druid æ•°æ®æº</span><br><span class="line">spring.datasource.type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">spring.datasource.initialSize: 5</span><br><span class="line">spring.datasource.minIdle: 5</span><br><span class="line">spring.datasource.maxActive: 20</span><br><span class="line">spring.datasource.maxWait: 60000</span><br><span class="line">spring.datasource.timeBetweenEvictionRunsMillis: 60000</span><br><span class="line">spring.datasource.minEvictableIdleTimeMillis: 300000</span><br><span class="line">spring.datasource.validationQuery: SELECT 1 FROM DUAL</span><br><span class="line">spring.datasource.testWhileIdle: true</span><br><span class="line">spring.datasource.testOnBorrow: false</span><br><span class="line">spring.datasource.testOnReturn: false</span><br><span class="line">spring.datasource.poolPreparedStatements: true</span><br><span class="line">spring.datasource.filters: stat</span><br><span class="line">spring.datasource.maxPoolPreparedStatementPerConnectionSize: 20</span><br><span class="line">spring.datasource.useGlobalDataSourceStat: true</span><br><span class="line">spring.datasource.connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br><span class="line"># SpringBoot JPA</span><br><span class="line">spring.jpa.show-sql=true</span><br><span class="line"># create æ¯æ¬¡éƒ½é‡æ–°åˆ›å»ºè¡¨ï¼Œupdateï¼Œè¡¨è‹¥å­˜åœ¨åˆ™ä¸é‡å»º</span><br><span class="line">spring.jpa.hibernate.ddl-auto=update</span><br><span class="line">spring.jpa.database-platform=org.hibernate.dialect.MySQL55Dialect</span><br></pre></td></tr></table></figure></p><p><code>spring.jpa.show-sql=true</code> æ‰“å° SQL è¯­å¥ã€‚<br><code>spring.jpa.hibernate.ddl-auto=update</code> æ ¹æ® Enity è‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨ï¼ŒUpdate è¡¨ç¤ºå¦‚æœè¡¨å­˜åœ¨åˆ™ä¸é‡æ–°åˆ›å»ºã€‚</p><h2 id="4-Spring-data-jpa-ç¼–ç "><a href="#4-Spring-data-jpa-ç¼–ç " class="headerlink" title="4. Spring data jpa ç¼–ç "></a>4. Spring data jpa ç¼–ç </h2><p>Springboot Data JPA æ˜¯ ORM çš„å®Œæ•´å®ç°ï¼Œå®ä½“ç±»å’Œæ•°æ®è¡¨å…³ç³»ä¸€ä¸€å¯¹åº”ï¼Œå› æ­¤å®ä½“ç±»ä¹Ÿå°±æ˜¯æ•°æ®è¡¨ç»“æ„ã€‚<code>spring.jpa.hibernate.ddl-auto=update</code> ä¼šåœ¨ JPA è¿è¡Œæ—¶è‡ªåŠ¨åœ¨æ•°æ®è¡¨ä¸­åˆ›å»ºè¢« <code>@Entity</code> æ³¨è§£çš„å®ä½“æ•°æ®è¡¨ã€‚å¦‚æœè¡¨å·²ç»å­˜åœ¨ï¼Œåˆ™ä¸ä¼šåˆ›å»ºã€‚</p><h3 id="4-1-æ•°æ®å®ä½“ç±»"><a href="#4-1-æ•°æ®å®ä½“ç±»" class="headerlink" title="4.1. æ•°æ®å®ä½“ç±»"></a>4.1. æ•°æ®å®ä½“ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Entity</span> JPAå®ä½“</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Data</span> GET SET TOSTRING</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@NoArgsConstructor</span> æ— å‚æ„é€ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@AllArgsConstructor</span> å…¨å‚æ„é€ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2018/12/19 17:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ID</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Id</span> ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@GeneratedValue</span> è‡ªå¢ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"username"</span>, length = <span class="number">32</span>, nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"password"</span>, length = <span class="number">32</span>, nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"å¯†ç ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"age"</span>, length = <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæ—¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(pattern = <span class="string">"yyyy-MM-dd hh:mm:ss"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠ€èƒ½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String skills;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-JPA-æ“ä½œæ¥å£"><a href="#4-2-JPA-æ“ä½œæ¥å£" class="headerlink" title="4.2. JPA æ“ä½œæ¥å£"></a>4.2. JPA æ“ä½œæ¥å£</h3><p>JPA æ“ä½œæ¥å£åªéœ€è¦ç»§æ‰¿ JpaRepository å°±å¯ä»¥äº†ï¼ŒJpaRepository é‡Œå°è£…äº†å¸¸ç”¨çš„å¢åˆ æ”¹æŸ¥åˆ†é¡µç­‰æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰æŸ¥è¯¢æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•åçš„æ–¹å¼å¢åŠ ã€‚ä¸‹é¢å¢åŠ äº†ä¸€ä¸ªæ ¹æ® username å’Œ password æŸ¥è¯¢ User ä¿¡æ¯çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.domain.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/1114:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸€ä¸ªè‡ªå®šä¹‰æ–¹æ³•ï¼Œæ ¹æ® username å’Œ password æŸ¥è¯¢ User ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">findByUsernameAndPassword</span><span class="params">(String username, String password)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼ŒJpa çš„åŠŸèƒ½å·²ç»å¯ä»¥æµ‹è¯•ä½¿ç”¨äº†ï¼Œå…³äº Service å±‚å’Œ Controller å°±ä¸åœ¨è¿™é‡Œè´´äº†ï¼Œç›´æ¥ç¼–å†™ Springboot å•å…ƒæµ‹è¯•è¿›è¡Œ Jpa æµ‹è¯•ã€‚</p><h2 id="5-Spring-data-jpa-æµ‹è¯•"><a href="#5-Spring-data-jpa-æµ‹è¯•" class="headerlink" title="5. Spring data jpa æµ‹è¯•"></a>5. Spring data jpa æµ‹è¯•</h2><p>ä½¿ç”¨ Springboot çš„å•å…ƒæµ‹è¯•æ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„æµ‹è¯• Springboot é¡¹ç›®ï¼Œå¯¹ Springboot å•å…ƒæµ‹è¯•ä¸äº†è§£çš„å¯ä»¥ç›´æ¥å‚ç…§<a href="https://docs.spring.io/spring-boot/docs/2.1.x/reference/htmlsingle/#boot-features-testing-spring-applications" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>çš„è¯´æ˜ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ã€‚<br>ä¸‹é¢ç¼–å†™å››ä¸ªæµ‹è¯•æ–¹æ³•åˆ†åˆ«æµ‹è¯•æ ¹æ® Id æŸ¥è¯¢ã€åˆ†é¡µæŸ¥è¯¢ã€æ›´æ–°æ•°æ®ã€æ ¹æ® username å’Œ password æŸ¥è¯¢å››ä¸ªåŠŸèƒ½ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> net.codingme.boot.domain.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.codingme.boot.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•å…ƒæµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRepositoryTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * idæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByIdUserTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Optional&lt;User&gt; userOptional = userRepository.findById(<span class="number">1</span>);</span><br><span class="line">        User user = userOptional.orElseGet(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        Assert.assertNotNull(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByPageTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageRequest pageRequest = PageRequest.of(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">        Page&lt;User&gt; userPage = userRepository.findAll(pageRequest);</span><br><span class="line">        List&lt;User&gt; userList = userPage.getContent();</span><br><span class="line">        userList.forEach((user) -&gt; System.out.println(user));</span><br><span class="line">        Assert.assertNotNull(userList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUserTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Optional&lt;User&gt; userOptional = userRepository.findById(<span class="number">1</span>);</span><br><span class="line">        User user = userOptional.orElseThrow(() -&gt; <span class="keyword">new</span> RuntimeException(<span class="string">"ç”¨æˆ·ä¿¡æ¯æ²¡æœ‰å–åˆ°"</span>));</span><br><span class="line">        System.out.println(user.getAge());</span><br><span class="line">        ;</span><br><span class="line">        user.setAge(user.getAge() + <span class="number">1</span>);</span><br><span class="line">        User updateResult = userRepository.save(user);</span><br><span class="line">        Assert.assertNotNull(updateResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® Username å’Œ Password æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByUsernameAndPasswordTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = userRepository.findByUsernameAndPassword(<span class="string">"Darcy"</span>, <span class="string">"123"</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        Assert.assertNotNull(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é¦–å…ˆçœ‹åˆ°å››ä¸ªæ–¹æ³•å…¨éƒ¨è¿è¡Œé€šè¿‡ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/77d538a467dd500356c519b67f41b7a6.png" alt="å•å…ƒæµ‹è¯•ç»“æœ"><br>åˆ†é¡µæŸ¥è¯¢æŸ¥å‡ºæ•°æ®åº“ä¸­çš„ä¸¤æ¡æ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_, user0_.age as age2_0_, user0_.birthday as birthday3_0_, user0_.password as password4_0_, user0_.skills as skills5_0_, user0_.username as username6_0_ from user user0_ limit ?</span><br><span class="line">Hibernate: select count(user0_.id) as col_0_0_ from user user0_</span><br><span class="line">User(id=1, username=Darcy, password=123, age=18, birthday=2019-01-12 21:02:30.0, skills=Go)</span><br><span class="line">User(id=3, username=Chris, password=456, age=23, birthday=2019-01-01 00:11:22.0, skills=Java)</span><br></pre></td></tr></table></figure></p><p>æ ¹æ® Id æŸ¥è¯¢ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_0_, user0_.age as age2_0_0_, user0_.birthday as birthday3_0_0_, user0_.password as password4_0_0_, user0_.skills as skills5_0_0_, user0_.username as username6_0_0_ from user user0_ where user0_.id=?</span><br><span class="line">User(id=1, username=Darcy, password=123, age=18, birthday=2019-01-12 21:02:30.0, skills=Go)</span><br></pre></td></tr></table></figure></p><p>æ›´æ–°æ“ä½œä¹Ÿæ˜¯æ­£å¸¸è¾“å‡º SQL ï¼Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_0_, user0_.age as age2_0_0_, user0_.birthday as birthday3_0_0_, user0_.password as password4_0_0_, user0_.skills as skills5_0_0_, user0_.username as username6_0_0_ from user user0_ where user0_.id=?</span><br><span class="line">18</span><br><span class="line">Hibernate: select user0_.id as id1_0_0_, user0_.age as age2_0_0_, user0_.birthday as birthday3_0_0_, user0_.password as password4_0_0_, user0_.skills as skills5_0_0_, user0_.username as username6_0_0_ from user user0_ where user0_.id=?</span><br><span class="line">Hibernate: update user set age=?, birthday=?, password=?, skills=?, username=? where id=?</span><br></pre></td></tr></table></figure></p><p>æœ€åä¸€ä¸ªæ˜¯è‡ªå®šä¹‰æŸ¥è¯¢æ“ä½œï¼Œä¸Šé¢ä¸‰ä¸ªæ–¹æ³•çš„è¾“å‡ºä¸­ï¼ŒDarcy ç”¨æˆ·å¯¹åº”çš„å¹´é¾„æ˜¯ 18ï¼Œåœ¨ç»è¿‡æ›´æ–°åŠ 1 ä¹‹ååº”è¯¥å˜ä¸º19ï¼Œä¸‹é¢æ˜¯è‡ªå®šä¹‰æŸ¥è¯¢çš„ç»“æœã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: select user0_.id as id1_0_, user0_.age as age2_0_, user0_.birthday as birthday3_0_, user0_.password as password4_0_, user0_.skills as skills5_0_, user0_.username as username6_0_ from user user0_ where user0_.username=? and user0_.password=?</span><br><span class="line">User(id=1, username=Darcy, password=123, age=19, birthday=2019-01-12 21:02:30.0, skills=Go)</span><br></pre></td></tr></table></figure></p><p>å¯è§æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚<br>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/niumoo/springboot/tree/master/springboot-data-jpa" target="_blank" rel="noopener">GitHub</a>ã€‚<br>æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨äº†ä¸€äº› JDK8 çš„ç‰¹æ€§ï¼Œå¦‚ <code>Optional</code> ç±»çš„ä½¿ç”¨ï¼Œä»¥åä¼šå•ç‹¬å†™ä¸€éƒ¨åˆ†å…³äº JDK æ–°ç‰¹æ€§çš„æ–‡ç« ï¼Œæ¬¢è¿æ‰«ç å…³æ³¨å…¬ä¼—å·ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/7bea43f15edb0db3ac708c346acd35c4.jpg&quot; alt=&quot;æ¡Œé¢ç”Ÿæ´»ï¼ˆæ¥è‡ªç½‘ç»œï¼‰&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;Springboot data jpa å’Œ Spring jdbc åŒå±äº Springå¼€æºç»„ç»‡ï¼Œåœ¨ Spring jdbc ä¹‹ååˆå¼€å‘äº†æŒä¹…å±‚æ¡†æ¶ï¼Œå¾ˆæ˜æ˜¾ Spring data jpa ç›¸å¯¹äº Spring jdbc æ›´åŠ çš„ä¾¿æ·å¼ºå¤§ï¼Œä¸ç„¶ä¹Ÿå°±æ²¡æœ‰å¼€å‘çš„å¿…è¦äº†ã€‚æ ¹æ®ä¸‹é¢çš„æ–‡ç« å¼€å§‹ä½“éªŒä¸‹ Spring data jpa é­…åŠ›ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
      <category term="Jpa" scheme="https://www.codingme.net/tags/Jpa/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆä¹ï¼‰ä½¿ç”¨ Spring JDBC å’Œ Druid æ•°æ®æºç›‘æ§</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-09-data-jdbc/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-09-data-jdbc/</id>
    <published>2019-02-27T15:40:01.000Z</published>
    <updated>2019-10-30T07:47:20.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/assets/springboot-09-data-jdbc/129bdbc0a9f53e0fd3b748978ccd5fe6.png" alt="ç›‘æ§"></p><p>ä½œä¸ºä¸€å Java å¼€å‘è€…ï¼Œç›¸ä¿¡å¯¹ JDBCï¼ˆJava Data Base Connectivityï¼‰æ˜¯ä¸ä¼šé™Œç”Ÿçš„ï¼ŒJDBCä½œä¸º Java åŸºç¡€å†…å®¹ï¼Œå®ƒæä¾›äº†ä¸€ç§åŸºå‡†ï¼Œæ®æ­¤å¯ä»¥æ„å»ºæ›´é«˜çº§çš„å·¥å…·å’Œæ¥å£ï¼Œä½¿æ•°æ®åº“å¼€å‘äººå‘˜èƒ½å¤Ÿç¼–å†™æ•°æ®åº“åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ¼”ç¤ºä¸‹ Springboot ä¸­å¦‚ä½•ä½¿ç”¨ JDBC æ“ä½œï¼Œå¹¶é…ç½®ä½¿ç”¨ Druid è¿æ¥æ± ï¼Œä½“éªŒ Druid å¯¹æ•°æ®åº“æ“ä½œå¼ºå¤§çš„ç›‘æ§å’Œæ‰©å±•åŠŸèƒ½ã€‚Alibaba-Durid å®˜æ–¹æ‰‹å†Œ<a href="https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" target="_blank" rel="noopener">ç‚¹è¿™é‡Œ</a>ã€‚<br><a id="more"></a></p><h2 id="1-æ•°æ®åº“å‡†å¤‡"><a href="#1-æ•°æ®åº“å‡†å¤‡" class="headerlink" title="1. æ•°æ®åº“å‡†å¤‡"></a>1. æ•°æ®åº“å‡†å¤‡</h2><p>ä½¿ç”¨mysqlæ•°æ®åº“åˆ›å»ºæ•°æ®åº“ springbootï¼Œå¹¶åœ¨åº“ä¸­æ–°å»ºæ•°æ®è¡¨ user å¹¶æ–°å¢ä¸¤æ¡ä¿¡æ¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`birthday`</span> datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`skills`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`username`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">4</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"># æ–°å¢æ•°æ®</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`springboot`</span>.<span class="string">`user`</span>(<span class="string">`id`</span>, <span class="string">`age`</span>, <span class="string">`birthday`</span>, <span class="string">`password`</span>, <span class="string">`skills`</span>, <span class="string">`username`</span>) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">17</span>, <span class="string">'2019-01-12 21:02:30'</span>, <span class="string">'123'</span>, <span class="string">'Go'</span>, <span class="string">'Darcy'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`springboot`</span>.<span class="string">`user`</span>(<span class="string">`id`</span>, <span class="string">`age`</span>, <span class="string">`birthday`</span>, <span class="string">`password`</span>, <span class="string">`skills`</span>, <span class="string">`username`</span>) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">23</span>, <span class="string">'2019-01-01 00:11:22'</span>, <span class="string">'456'</span>, <span class="string">'Java'</span>, <span class="string">'Chris'</span>);</span><br></pre></td></tr></table></figure></p><h2 id="2-æ·»åŠ ä¾èµ–"><a href="#2-æ·»åŠ ä¾èµ–" class="headerlink" title="2. æ·»åŠ ä¾èµ–"></a>2. æ·»åŠ ä¾èµ–</h2><p>æ–°å»ºä¸€ä¸ª Springbooté¡¹ç›®ï¼Œè¿™é‡Œä¸è¯´ã€‚æ·»åŠ ä¾èµ–å¦‚ä¸‹ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- spring jdbc æ“ä½œæ¨¡ç‰ˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- springboot webå¼€å‘ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mysql æ•°æ®åº“è¿æ¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥druidæ•°æ®æº --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="3-é…ç½®æ•°æ®æºä¿¡æ¯"><a href="#3-é…ç½®æ•°æ®æºä¿¡æ¯" class="headerlink" title="3. é…ç½®æ•°æ®æºä¿¡æ¯"></a>3. é…ç½®æ•°æ®æºä¿¡æ¯</h2><p>å¸¸è§„çš„ JDBC é…ç½®ä¸éœ€è¦é…ç½®è¿™ä¹ˆå¤šå†…å®¹ï¼Œè¿™é‡Œå› ä¸ºä½¿ç”¨äº† Druid è¿æ¥æ± ï¼Œæ‰€ä»¥é…ç½®äº† Druid éƒ¨åˆ†ã€‚å¯¹è‡ªåŠ¨é…ç½®ä¸ç†è§£çš„å¯ä»¥æŸ¥çœ‹ç³»åˆ—æ–‡ç« <a href="https://www.codingme.net/2019/01/springboot/springboot02-config/#4-%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BD%BF%E7%94%A8">Springboot ç³»åˆ—ï¼ˆäºŒï¼‰Spring Boot é…ç½®æ–‡ä»¶</a>ã€‚<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/springboot?characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    initialSize:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">    minIdle:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">    maxActive:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">    maxWait:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">    timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">    minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line"><span class="attr">    validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line"><span class="attr">    testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    testOnReturn:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment">#   é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œå»æ‰åç›‘æ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡ï¼Œ'wall'ç”¨äºé˜²ç«å¢™</span></span><br><span class="line"><span class="attr">    filters:</span> <span class="string">stat</span></span><br><span class="line"><span class="attr">    maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">    useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br></pre></td></tr></table></figure></p><p>é…ç½®å®Œæ¯•ä¹‹åï¼Œé…ç½®ä¿¡æ¯è¿˜ä¸èƒ½ç»‘å®šåˆ° Druidæ•°æ®æºä¸­ï¼Œè¿˜éœ€è¦æ–°å»ºä¸€ä¸ªé…ç½®ç±»ç»‘å®šæ•°æ®æºå’Œé…ç½®ä¿¡æ¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Druid æ•°æ®æºé…ç½®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2019/1/14 22:20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®ç»‘å®š</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">druid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åˆ°è¿™é‡Œï¼Œæ•°æ®æºå·²ç»é…ç½®å®Œæ¯•ï¼Œç¼–å†™æµ‹è¯•æ–¹æ³•æµ‹è¯• druid è¿æ¥æ± æ˜¯å¦ç”Ÿæ•ˆã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootDataJdbcApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•JDBCæ•°æ®æº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        Connection connection = dataSource.getConnection();</span><br><span class="line">        System.out.println(connection);</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œçœ‹åˆ° contextLoads è¾“å‡ºä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">Loading class `com.mysql.jdbc.Driver&apos;. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver&apos;. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span><br><span class="line">2019-02-27 14:14:56.144  INFO 12860 --- [           main] com.alibaba.druid.pool.DruidDataSource   : &#123;dataSource-1&#125; inited</span><br><span class="line">com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@3e104d4b</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºæ—¥å¿—ä¸­çš„ com.alibaba.druid è¯´æ˜ Druid å·²ç»ç”Ÿæ•ˆã€‚</p><h2 id="4-ä½¿ç”¨-Spring-JDBC"><a href="#4-ä½¿ç”¨-Spring-JDBC" class="headerlink" title="4. ä½¿ç”¨ Spring-JDBC"></a>4. ä½¿ç”¨ Spring-JDBC</h2><p>ä¼ ç»Ÿçš„ JDBC ä½¿ç”¨ä¸­ï¼Œéœ€è¦ç¼–å†™å¤§é‡ä»£ç ï¼Œä»æ„é€  PreparedStatement åˆ°æŸ¥è¯¢ä¸èƒœå…¶çƒ¦ã€‚é¢å¯¹è¿™æ ·çš„å¼€å‘ç—›ç‚¹ï¼ŒSpring å°è£…äº† Spring-jdbc. è®©æˆ‘ä»¬ä½¿ç”¨ JdbcTemplate å³å¯è½»æ¾çš„æ“ä½œæ•°æ®åº“ã€‚Spring-jdbc çš„è¯¦ç»†ä½¿ç”¨ä¸æ˜¯è¿™ç¯‡æ–‡ç« é‡ç‚¹ï¼Œåªç®€å•æ¼”ç¤ºä¸‹æ˜¯å¦ç”Ÿæ•ˆã€‚<br>ç¼–å†™æ§åˆ¶å™¨ï¼ŒæŸ¥è¯¢ä¸€ä¸ª user ä¿¡æ¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">map</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; list = jdbcTemplate.queryForList(<span class="string">"select * FROM user"</span>);</span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯åŠ¨spring é¡¹ç›®ï¼Œè¯·æ±‚ /query æ¥å£å¾—åˆ°æ­£å¸¸å“åº”ã€‚<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"age"</span>: <span class="number">17</span>,</span><br><span class="line"><span class="attr">"birthday"</span>: <span class="string">"2019-01-12T13:02:30.000+0000"</span>,</span><br><span class="line"><span class="attr">"password"</span>: <span class="string">"123"</span>,</span><br><span class="line"><span class="attr">"skills"</span>: <span class="string">"Go"</span>,</span><br><span class="line"><span class="attr">"username"</span>: <span class="string">"Darcy"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯è§ Spring-JDBC å·²ç»ä»æ•°æ®åº“ä¸­å–å‡ºäº†æ•°æ®ä¿¡æ¯ã€‚</p><h2 id="5-ä½¿ç”¨-Druid-ç›‘æ§"><a href="#5-ä½¿ç”¨-Druid-ç›‘æ§" class="headerlink" title="5. ä½¿ç”¨ Druid ç›‘æ§"></a>5. ä½¿ç”¨ Druid ç›‘æ§</h2><p>å¦‚æœä½¿ç”¨ Druid è¿æ¥æ± å´ä¸ä½¿ç”¨ç›‘æ§åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±æœ‰ç‚¹æš´æ®„å¤©ç‰©äº†ã€‚ä¸‹é¢å¼€å§‹é…ç½® Druid çš„ SQL ç›‘æ§åŠŸèƒ½ã€‚åœ¨ä¸Šé¢å†™çš„ DruidConfig é…ç½®ç±»ä¸­å¢åŠ é…ç½® Druid çš„ Servlet å’Œ Filter.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Druidçš„servlet</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">statViewServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      ServletRegistrationBean bean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet());</span><br><span class="line">      Map&lt;String, String&gt; initParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">      initParams.put(<span class="string">"loginUsername"</span>, <span class="string">"admin"</span>);</span><br><span class="line">      initParams.put(<span class="string">"loginPassword"</span>, <span class="string">"123"</span>);</span><br><span class="line">      initParams.put(<span class="string">"allow"</span>,<span class="string">"127.0.0.1"</span>);</span><br><span class="line">      bean.setInitParameters(initParams);</span><br><span class="line">      bean.setUrlMappings(Arrays.asList(<span class="string">"/druid/*"</span>));</span><br><span class="line">      <span class="keyword">return</span> bean;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">webStatFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      FilterRegistrationBean&lt;WebStatFilter&gt; bean = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;(<span class="keyword">new</span> WebStatFilter());</span><br><span class="line">      HashMap&lt;String, String&gt; initParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">      initParams.put(<span class="string">"exclusions"</span>, <span class="string">"/css,/druid/*"</span>);</span><br><span class="line">      bean.setInitParameters(initParams);</span><br><span class="line">      bean.setUrlPatterns(Arrays.asList(<span class="string">"/*"</span>));</span><br><span class="line">      <span class="keyword">return</span> bean;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢é…ç½®äº† Druid ç›‘æ§è®¿é—®è·¯å¾„ä¸º <code>/druid</code>ã€ç™»å½•ç”¨æˆ·æ˜¯ <code>admin</code>ã€ç™»å½•å¯†ç æ˜¯<code>123</code>ã€å…è®¸è®¿é—®çš„IPæ˜¯<code>127.0.0.1</code> æœ¬æœºã€ä¸éœ€è¦ç›‘æ§çš„è¯·æ±‚æ˜¯ <code>/css</code> å’Œ <code>/druid</code> å¼€å¤´çš„è¯·æ±‚ã€‚</p><p>é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®æµ‹è¯• <code>/query</code>ï¼Œç„¶åè®¿é—® <code>/durid</code> ç™»å½•é¡µã€‚<br><img src="/assets/springboot-09-data-jdbc/d6f42164708fcd4c8e5009386bb9837e.png" alt="Druid ç™»å½•é¡µ"></p><p>ç™»å½•åå¯ä»¥çœ‹åˆ° SQL ç›‘æ§ä¿¡æ¯å’Œ URL ç›‘æ§ç­‰ä¿¡æ¯ã€‚<br><img src="/assets/springboot-09-data-jdbc/64a71b68b6afb74e22a2eb274e8956c3.png" alt="SQL ç›‘æ§"><br>URL ç›‘æ§ã€‚<br><img src="/assets/springboot-09-data-jdbc/7b96df5bbd8698295696a3805ad82e26.png" alt="URL ç›‘æ§"></p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/springboot-data-jdbc" target="_blank" rel="noopener">Spring Boot jdbc</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/assets/springboot-09-data-jdbc/129bdbc0a9f53e0fd3b748978ccd5fe6.png&quot; alt=&quot;ç›‘æ§&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€å Java å¼€å‘è€…ï¼Œç›¸ä¿¡å¯¹ JDBCï¼ˆJava Data Base Connectivityï¼‰æ˜¯ä¸ä¼šé™Œç”Ÿçš„ï¼ŒJDBCä½œä¸º Java åŸºç¡€å†…å®¹ï¼Œå®ƒæä¾›äº†ä¸€ç§åŸºå‡†ï¼Œæ®æ­¤å¯ä»¥æ„å»ºæ›´é«˜çº§çš„å·¥å…·å’Œæ¥å£ï¼Œä½¿æ•°æ®åº“å¼€å‘äººå‘˜èƒ½å¤Ÿç¼–å†™æ•°æ®åº“åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ¼”ç¤ºä¸‹ Springboot ä¸­å¦‚ä½•ä½¿ç”¨ JDBC æ“ä½œï¼Œå¹¶é…ç½®ä½¿ç”¨ Druid è¿æ¥æ± ï¼Œä½“éªŒ Druid å¯¹æ•°æ®åº“æ“ä½œå¼ºå¤§çš„ç›‘æ§å’Œæ‰©å±•åŠŸèƒ½ã€‚Alibaba-Durid å®˜æ–¹æ‰‹å†Œ&lt;a href=&quot;https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç‚¹è¿™é‡Œ&lt;/a&gt;ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>Springboot ç³»åˆ—ï¼ˆå…«ï¼‰åŠ¨æ€Bannerä¸å›¾ç‰‡è½¬å­—ç¬¦å›¾æ¡ˆçš„æ‰‹åŠ¨å®ç°</title>
    <link href="https://www.codingme.net/2019/02/springboot/springboot-08-banner/"/>
    <id>https://www.codingme.net/2019/02/springboot/springboot-08-banner/</id>
    <published>2019-02-25T15:40:01.000Z</published>
    <updated>2019-05-14T16:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ <strong>v2.1.1.RELEASE</strong> è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/33e6877404fed0daf8c894cec6a4d37c.png" alt="Springboot å¯åŠ¨ banner"></p><p>ä½¿ç”¨è¿‡ Springboot çš„å¯¹ä¸Šé¢è¿™ä¸ªå›¾æ¡ˆè‚¯å®šä¸ä¼šé™Œç”Ÿï¼ŒSpringboot å¯åŠ¨çš„åŒæ—¶ä¼šæ‰“å°ä¸Šé¢çš„å›¾æ¡ˆï¼Œå¹¶å¸¦æœ‰ç‰ˆæœ¬å·ã€‚æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥æ‰¾åˆ°å…³äº banner çš„æè¿°</p><blockquote><p>The banner that is printed on start up can be changed by adding a banner.txt file to your classpath or by setting the spring.banner.location property to the location of such a file. If the file has an encoding other than UTF-8, you can set spring.banner.charset. In addition to a text file, you can also add a banner.gif, banner.jpg, or banner.png image file to your classpath or set the spring.banner.image.location property. Images are converted into an ASCII art representation and printed above any text banner.</p></blockquote><a id="more"></a><p>å°±ä¸ç¿»è¯‘äº†ï¼Œç›´æ¥æœ‰é“ç¿»è¯‘è´´è¿‡æ¥çœ‹ä¸ªå¤§æ¦‚æ„æ€ã€‚</p><blockquote><p>å¯ä»¥é€šè¿‡å‘ç±»è·¯å¾„ä¸­æ·»åŠ ä¸€ä¸ªbanner.txtæ–‡ä»¶æˆ–è®¾ç½®spring.banneræ¥æ›´æ”¹åœ¨start upä¸Šæ‰“å°çš„bannerã€‚å±æ€§æŒ‡å‘æ­¤ç±»æ–‡ä»¶çš„ä½ç½®ã€‚å¦‚æœæ–‡ä»¶çš„ç¼–ç ä¸æ˜¯UTF-8ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®spring.banner.charsetã€‚é™¤äº†æ–‡æœ¬æ–‡ä»¶ï¼Œè¿˜å¯ä»¥æ·»åŠ æ¨ªå¹…ã€‚å°†gifã€banner.jpgæˆ–banner.pngå›¾åƒæ–‡ä»¶ä¿å­˜åˆ°ç±»è·¯å¾„æˆ–è®¾ç½®spring.banner.imageã€‚ä½ç½®å±æ€§ã€‚å›¾åƒè¢«è½¬æ¢æˆASCIIè‰ºæœ¯å½¢å¼ï¼Œå¹¶æ‰“å°åœ¨ä»»ä½•æ–‡æœ¬æ¨ªå¹…ä¸Šé¢ã€‚</p></blockquote><h1 id="1-è‡ªå®šä¹‰-banner"><a href="#1-è‡ªå®šä¹‰-banner" class="headerlink" title="1. è‡ªå®šä¹‰ banner"></a>1. è‡ªå®šä¹‰ banner</h1><p>æ ¹æ®å®˜æ–¹çš„æè¿°ï¼Œå¯ä»¥åœ¨ç±»è·¯å¾„ä¸­è‡ªå®šä¹‰ banner å›¾æ¡ˆï¼Œæˆ‘ä»¬è¿›è¡Œå°è¯•åœ¨æ”¾ resouce ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ banner.txt å¹¶å†™å…¥å†…å®¹ï¼ˆ<a href="http://patorjk.com/software/taag/#p=testall&amp;f=Graffiti&amp;t=niumoo" target="_blank" rel="noopener">åœ¨çº¿å­—ç¬¦ç”Ÿæˆ</a>ï¼‰ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    (_)</span><br><span class="line"> _ __  _ _   _ _ __ ___   ___   ___</span><br><span class="line">| &apos;_ \| | | | | &apos;_ ` _ \ / _ \ / _ \</span><br><span class="line">| | | | | |_| | | | | | | (_) | (_) |</span><br><span class="line">|_| |_|_|\__,_|_| |_| |_|\___/ \___/ ç‰ˆæœ¬ï¼š$&#123;spring-boot.formatted-version&#125;</span><br></pre></td></tr></table></figure></p><p>å¯åŠ¨ Springboot åœ¨æ§åˆ¶å°çœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">     (_)</span><br><span class="line">  _ __  _ _   _ _ __ ___   ___   ___</span><br><span class="line"> | &apos;_ \| | | | | &apos;_ ` _ \ / _ \ / _ \</span><br><span class="line"> | | | | | |_| | | | | | | (_) | (_) |</span><br><span class="line"> |_| |_|_|\__,_|_| |_| |_|\___/ \___/ ç‰ˆæœ¬ï¼š(v2.1.3.RELEASE)</span><br><span class="line">2019-02-25 14:00:31.289  INFO 12312 --- [           main] net.codingme.banner.BannerApplication    : Starting BannerApplication on LAPTOP-L1S5MKTA with PID 12312 (D:\IdeaProjectMy\springboot-git\springboot-banner\target\classes started by Niu in D:\IdeaProjectMy\springboot-git\springboot-banner)</span><br><span class="line">2019-02-25 14:00:31.291  INFO 12312 --- [           main] net.codingme.banner.BannerApplication    : No active profile set, falling back to default profiles: default</span><br><span class="line">2019-02-25 14:00:32.087  INFO 12312 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)</span><br></pre></td></tr></table></figure></p><p>å‘ç°è‡ªå®šä¹‰ banner å·²ç»ç”Ÿæ•ˆäº†ï¼Œå®˜æ–¹æ–‡æ¡£çš„ä»‹ç»é‡Œè¯´è¿˜å¯ä»¥æ”¾ç½®å›¾ç‰‡ï¼Œä¸‹é¢æ”¾ç½®å›¾ç‰‡ banner.jpg æµ‹è¯•ã€‚<br>ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªå›¾ç‰‡ã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/d9879377e30b5f37f9116e7927e35604.jpg" alt="Google Log">å†æ¬¡å¯åŠ¨è§‚å¯Ÿè¾“å‡ºã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/935928a0c76faa399a6f49252c713afa.png" alt="è‡ªå®šä¹‰ Banner">Springboot æŠŠå›¾æ¡ˆè½¬æˆäº† ASCII å›¾æ¡ˆã€‚</p><h1 id="2-ASCII-å›¾æ¡ˆç”ŸæˆåŸç†"><a href="#2-ASCII-å›¾æ¡ˆç”ŸæˆåŸç†" class="headerlink" title="2. ASCII å›¾æ¡ˆç”ŸæˆåŸç†"></a>2. ASCII å›¾æ¡ˆç”ŸæˆåŸç†</h1><p>çœ‹äº†ä¸Šé¢çš„ä¾‹å­ï¼Œå‘ç° Springboot å¯ä»¥æŠŠå›¾ç‰‡è½¬æ¢æˆ ASCII å›¾æ¡ˆï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿæˆ‘ä»¬æˆ–è®¸å¯ä»¥æƒ³è±¡å‡ºä¸€ä¸ªå¤§æ¦‚æµç¨‹ã€‚</p><ol><li>è·å–å›¾ç‰‡ã€‚</li><li>éå†å›¾ç‰‡åƒç´ ç‚¹ã€‚</li><li>åˆ†æåƒç´ ç‚¹ï¼Œæ¯ä¸ªåƒç´ ç‚¹æ ¹æ®é¢œè‰²æ·±åº¦å¾—å‡ºä¸€ä¸ªå€¼ï¼Œæ ¹æ®æ˜æš—åº¦åŒ¹é…ä¸åŒçš„å­—ç¬¦ã€‚</li><li>è¾“å‡ºå›¾æ¡ˆã€‚</li></ol><p>Springboot å¯¹å›¾ç‰‡ banner çš„å¤„ç†åˆ°åº•æ˜¯ä¸æ˜¯æˆ‘ä»¬ä¸Šé¢æƒ³æƒ³çš„é‚£æ ·å‘¢ï¼Ÿç›´æ¥å»æºç ä¸­å¯»æ‰¾ç­”æ¡ˆã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ä½ç½®ï¼šorg.springframework.boot.SpringApplicationBannerPrinter */</span></span><br><span class="line"><span class="comment">//æ–¹æ³•1ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Banner <span class="title">print</span><span class="params">(Environment environment, Class&lt;?&gt; sourceClass, Log logger)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å– banner  è°ƒç”¨æ–¹æ³•è®°ä¸º2</span></span><br><span class="line">Banner banner = getBanner(environment);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">logger.info(createStringFromBanner(banner, environment, sourceClass));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (UnsupportedEncodingException ex) &#123;</span><br><span class="line">logger.warn(<span class="string">"Failed to create String for banner"</span>, ex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰“å° banner</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> PrintedBanner(banner, sourceClass);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•2</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Banner <span class="title">getBanner</span><span class="params">(Environment environment)</span> </span>&#123;</span><br><span class="line">Banners banners = <span class="keyword">new</span> Banners();</span><br><span class="line"><span class="comment">// è·å–å›¾ç‰‡bannerï¼Œæˆ‘ä»¬åªå…³æ³¨è¿™ä¸ªï¼Œè°ƒç”¨æ–¹æ³•è®°ä¸º3</span></span><br><span class="line">banners.addIfNotNull(getImageBanner(environment));</span><br><span class="line">banners.addIfNotNull(getTextBanner(environment));</span><br><span class="line"><span class="keyword">if</span> (banners.hasAtLeastOneBanner()) &#123;</span><br><span class="line"><span class="keyword">return</span> banners;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.fallbackBanner != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.fallbackBanner;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> DEFAULT_BANNER;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•3</span></span><br><span class="line"><span class="comment">/** è·å–è‡ªå®šä¹‰banneræ–‡ä»¶ä¿¡æ¯ */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Banner <span class="title">getImageBanner</span><span class="params">(Environment environment)</span> </span>&#123;</span><br><span class="line"><span class="comment">// BANNER_IMAGE_LOCATION_PROPERTY = "spring.banner.image.location";</span></span><br><span class="line">String location = environment.getProperty(BANNER_IMAGE_LOCATION_PROPERTY);</span><br><span class="line"><span class="keyword">if</span> (StringUtils.hasLength(location)) &#123;</span><br><span class="line">Resource resource = <span class="keyword">this</span>.resourceLoader.getResource(location);</span><br><span class="line"><span class="keyword">return</span> resource.exists() ? <span class="keyword">new</span> ImageBanner(resource) : <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// IMAGE_EXTENSION = &#123; "gif", "jpg", "png" &#125;;</span></span><br><span class="line"><span class="keyword">for</span> (String ext : IMAGE_EXTENSION) &#123;</span><br><span class="line">Resource resource = <span class="keyword">this</span>.resourceLoader.getResource(<span class="string">"banner."</span> + ext);</span><br><span class="line"><span class="keyword">if</span> (resource.exists()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ImageBanner(resource);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢æ˜¯å¯»æ‰¾è‡ªå®šä¹‰å›¾ç‰‡ banner æ–‡ä»¶æºç ï¼Œå¦‚æœæŠŠå›¾ç‰‡è½¬æ¢æˆ ASCII å›¾æ¡ˆç»§ç»­è·Ÿè¿›ï¼Œè¿½è¸ªæ–¹æ³•1ä¸­çš„<code>PrintedBanner(banner, sourceClass)</code>æ–¹æ³•ã€‚æœ€ç»ˆæŸ¥æ‰¾è¾“å‡ºå›¾æ¡ˆçš„ä¸»è¦æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½ç½®ï¼šorg.springframework.boot.ImageBanner#printBanner</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printBanner</span><span class="params">(BufferedImage image, <span class="keyword">int</span> margin, <span class="keyword">boolean</span> invert,</span></span></span><br><span class="line"><span class="function"><span class="params">PrintStream out)</span> </span>&#123;</span><br><span class="line">AnsiElement background = invert ? AnsiBackground.BLACK : AnsiBackground.DEFAULT;</span><br><span class="line">out.print(AnsiOutput.encode(AnsiColor.DEFAULT));</span><br><span class="line">out.print(AnsiOutput.encode(background));</span><br><span class="line">out.println();</span><br><span class="line">out.println();</span><br><span class="line">AnsiColor lastColor = AnsiColor.DEFAULT;</span><br><span class="line"><span class="comment">// å›¾ç‰‡é«˜åº¦éå†</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; image.getHeight(); y++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; margin; i++) &#123;</span><br><span class="line">out.print(<span class="string">" "</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å›¾ç‰‡å®½åº¦éå†</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; image.getWidth(); x++) &#123;</span><br><span class="line"><span class="comment">// è·å–æ¯ä¸€ä¸ªåƒç´ ç‚¹</span></span><br><span class="line">Color color = <span class="keyword">new</span> Color(image.getRGB(x, y), <span class="keyword">false</span>);</span><br><span class="line">AnsiColor ansiColor = AnsiColors.getClosest(color);</span><br><span class="line"><span class="keyword">if</span> (ansiColor != lastColor) &#123;</span><br><span class="line">out.print(AnsiOutput.encode(ansiColor));</span><br><span class="line">lastColor = ansiColor;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åƒç´ ç‚¹è½¬æ¢æˆå­—ç¬¦è¾“å‡ºï¼Œè°ƒç”¨æ–¹æ³•è®°ä¸º2</span></span><br><span class="line">out.print(getAsciiPixel(color, invert));</span><br><span class="line">&#125;</span><br><span class="line">out.println();</span><br><span class="line">&#125;</span><br><span class="line">out.print(AnsiOutput.encode(AnsiColor.DEFAULT));</span><br><span class="line">out.print(AnsiOutput.encode(AnsiBackground.DEFAULT));</span><br><span class="line">out.println();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•2ï¼Œåƒç´ ç‚¹è½¬æ¢æˆå­—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">char</span> <span class="title">getAsciiPixel</span><span class="params">(Color color, <span class="keyword">boolean</span> dark)</span> </span>&#123;</span><br><span class="line"><span class="comment">// æ ¹æ® color ç®—å‡ºä¸€ä¸ªäº®åº¦å€¼</span></span><br><span class="line"><span class="keyword">double</span> luminance = getLuminance(color, dark);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; PIXEL.length; i++) &#123;</span><br><span class="line"><span class="comment">// å¯»æ‰¾äº®åº¦å€¼åŒ¹é…çš„å­—ç¬¦</span></span><br><span class="line"><span class="keyword">if</span> (luminance &gt;= (LUMINANCE_START - (i * LUMINANCE_INCREMENT))) &#123;</span><br><span class="line"><span class="comment">// PIXEL = &#123; ' ', '.', '*', ':', 'o', '&amp;', '8', '#', '@' &#125;;</span></span><br><span class="line"><span class="keyword">return</span> PIXEL[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> PIXEL[PIXEL.length - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡æŸ¥çœ‹æºç ï¼Œå‘ç° Springboot çš„å›¾ç‰‡ banner çš„è½¬æ¢å’Œæˆ‘ä»¬é¢„æƒ³çš„å¤§è‡´ä¸€è‡´ï¼Œè¿™ä¹ˆæœ‰è¶£çš„åŠŸèƒ½æˆ‘ä»¬èƒ½ä¸èƒ½è‡ªå·±å†™ä¸€ä¸ªå‘¢ï¼Ÿ</p><h1 id="3-è‡ªå·±å®ç°å›¾ç‰‡è½¬-ASCIIå­—ç¬¦"><a href="#3-è‡ªå·±å®ç°å›¾ç‰‡è½¬-ASCIIå­—ç¬¦" class="headerlink" title="3.è‡ªå·±å®ç°å›¾ç‰‡è½¬ ASCIIå­—ç¬¦"></a>3.è‡ªå·±å®ç°å›¾ç‰‡è½¬ ASCIIå­—ç¬¦</h1><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæ€»ç»“ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å†™ä¸€ä¸ªå›¾ç‰‡è½¬ ASCII å­—ç¬¦å›¾æ¡ˆã€‚<br>æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li>å›¾ç‰‡å¤§å°ç¼©æ”¾ï¼Œè°ƒæ•´åˆ°åˆé€‚å¤§å°ã€‚</li><li>éå†å›¾ç‰‡åƒç´ ã€‚</li><li>è·å–å›¾ç‰‡åƒç´ ç‚¹äº®åº¦ï¼ˆRGBé¢œè‰²é€šè¿‡å…¬å¼å¯ä»¥å¾—åˆ°äº®åº¦æ•°å€¼ï¼‰ã€‚</li><li>åŒ¹é…å­—ç¬¦ã€‚</li><li>è¾“å‡ºå›¾æ¡ˆã€‚</li></ol><p>ä¸Šé¢çš„5ä¸ªæ­¥éª¤ç›´æ¥ä½¿ç”¨ Java ä»£ç å°±å¯ä»¥å®Œæ•´å®ç°ï¼Œä¸‹é¢æ˜¯ç¼–å†™çš„æºç ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ ¹æ®å›¾ç‰‡ç”Ÿæˆå­—ç¬¦å›¾æ¡ˆ</span></span><br><span class="line"><span class="comment"> * 1.å›¾ç‰‡å¤§å°ç¼©æ”¾</span></span><br><span class="line"><span class="comment"> * 2.éå†å›¾ç‰‡åƒç´ ç‚¹</span></span><br><span class="line"><span class="comment"> * 3.è·å–å›¾ç‰‡åƒç´ ç‚¹äº®åº¦</span></span><br><span class="line"><span class="comment"> * 4.åŒ¹é…å­—ç¬¦</span></span><br><span class="line"><span class="comment"> * 5.è¾“å‡ºå›¾æ¡ˆ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>  niujinpeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@website</span> www.codingme.net</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019-02-25 23:03:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratorTextImage</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span>[] PIXEL = &#123;<span class="string">'@'</span>, <span class="string">'#'</span>, <span class="string">'8'</span>, <span class="string">'&amp;'</span>, <span class="string">'o'</span>, <span class="string">':'</span>, <span class="string">'*'</span>, <span class="string">'.'</span>, <span class="string">' '</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// å›¾ç‰‡ç¼©æ”¾</span></span><br><span class="line">        BufferedImage bufferedImage = makeSmallImage(<span class="string">"src/main/resources/banner.jpg"</span>);</span><br><span class="line">        <span class="comment">// è¾“å‡º</span></span><br><span class="line">        printImage(bufferedImage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printImage</span><span class="params">(BufferedImage image)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> width = image.getWidth();</span><br><span class="line">        <span class="keyword">int</span> height = image.getHeight();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; height; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; width; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> rgb = image.getRGB(j, i);</span><br><span class="line">                Color color = <span class="keyword">new</span> Color(rgb);</span><br><span class="line">                <span class="keyword">int</span> red = color.getRed();</span><br><span class="line">                <span class="keyword">int</span> green = color.getGreen();</span><br><span class="line">                <span class="keyword">int</span> blue = color.getBlue();</span><br><span class="line">                <span class="comment">// ä¸€ä¸ªç”¨äºè®¡ç®—RGBåƒç´ ç‚¹äº®åº¦çš„å…¬å¼</span></span><br><span class="line">                Double luminace = <span class="number">0.2126</span> * red + <span class="number">0.7152</span> * green + <span class="number">0.0722</span> * blue;</span><br><span class="line">                <span class="keyword">double</span> index = luminace / (Math.ceil(<span class="number">255</span> / PIXEL.length) + <span class="number">0.5</span>);</span><br><span class="line">                System.out.print(PIXEL[(<span class="keyword">int</span>)(Math.floor(index))]);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title">makeSmallImage</span><span class="params">(String srcImageName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        File srcImageFile = <span class="keyword">new</span> File(srcImageName);</span><br><span class="line">        <span class="keyword">if</span> (srcImageFile == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ–‡ä»¶ä¸å­˜åœ¨"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">        BufferedImage tagImage = <span class="keyword">null</span>;</span><br><span class="line">        Image srcImage = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            srcImage = ImageIO.read(srcImageFile);</span><br><span class="line">            <span class="keyword">int</span> srcWidth = srcImage.getWidth(<span class="keyword">null</span>);<span class="comment">// åŸå›¾ç‰‡å®½åº¦</span></span><br><span class="line">            <span class="keyword">int</span> srcHeight = srcImage.getHeight(<span class="keyword">null</span>);<span class="comment">// åŸå›¾ç‰‡é«˜åº¦</span></span><br><span class="line">            <span class="keyword">int</span> dstMaxSize = <span class="number">90</span>;<span class="comment">// ç›®æ ‡ç¼©ç•¥å›¾çš„æœ€å¤§å®½åº¦/é«˜åº¦ï¼Œå®½åº¦ä¸é«˜åº¦å°†æŒ‰æ¯”ä¾‹ç¼©å†™</span></span><br><span class="line">            <span class="keyword">int</span> dstWidth = srcWidth;<span class="comment">// ç¼©ç•¥å›¾å®½åº¦</span></span><br><span class="line">            <span class="keyword">int</span> dstHeight = srcHeight;<span class="comment">// ç¼©ç•¥å›¾é«˜åº¦</span></span><br><span class="line">            <span class="keyword">float</span> scale = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// è®¡ç®—ç¼©ç•¥å›¾çš„å®½å’Œé«˜</span></span><br><span class="line">            <span class="keyword">if</span> (srcWidth &gt; dstMaxSize) &#123;</span><br><span class="line">                dstWidth = dstMaxSize;</span><br><span class="line">                scale = (<span class="keyword">float</span>)srcWidth / (<span class="keyword">float</span>)dstMaxSize;</span><br><span class="line">                dstHeight = Math.round((<span class="keyword">float</span>)srcHeight / scale);</span><br><span class="line">            &#125;</span><br><span class="line">            srcHeight = dstHeight;</span><br><span class="line">            <span class="keyword">if</span> (srcHeight &gt; dstMaxSize) &#123;</span><br><span class="line">                dstHeight = dstMaxSize;</span><br><span class="line">                scale = (<span class="keyword">float</span>)srcHeight / (<span class="keyword">float</span>)dstMaxSize;</span><br><span class="line">                dstWidth = Math.round((<span class="keyword">float</span>)dstWidth / scale);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ç”Ÿæˆç¼©ç•¥å›¾</span></span><br><span class="line">            tagImage = <span class="keyword">new</span> BufferedImage(dstWidth, dstHeight, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">            tagImage.getGraphics().drawImage(srcImage, <span class="number">0</span>, <span class="number">0</span>, dstWidth, dstHeight, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> tagImage;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (fileOutputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileOutputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            tagImage = <span class="keyword">null</span>;</span><br><span class="line">            srcImage = <span class="keyword">null</span>;</span><br><span class="line">            System.gc();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿˜æ˜¯æ‹¿ä¸Šé¢çš„ Google log å›¾ç‰‡ä½œä¸ºå®éªŒå¯¹è±¡ï¼Œè¿è¡Œå¾—åˆ°å­—ç¬¦å›¾æ¡ˆè¾“å‡ºã€‚<br><img src="https://raw.githubusercontent.com/niumoo/files/master/images/blog/ddc9487dd2050f9188825195427ed0a1.png" alt="å›¾ç‰‡è½¬ ASCII å­—ç¬¦"></p><p>æ–‡ç« ä»£ç å·²ç»ä¸Šä¼ åˆ° GitHub <a href="https://github.com/niumoo/springboot/tree/master/" target="_blank" rel="noopener">Spring Boot</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ¬ Spring Boot ç³»åˆ—æ–‡ç« åŸºäº Spring Boot ç‰ˆæœ¬ &lt;strong&gt;v2.1.1.RELEASE&lt;/strong&gt; è¿›è¡Œå­¦ä¹ åˆ†æï¼Œç‰ˆæœ¬ä¸åŒå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/niumoo/files/master/images/blog/33e6877404fed0daf8c894cec6a4d37c.png&quot; alt=&quot;Springboot å¯åŠ¨ banner&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨è¿‡ Springboot çš„å¯¹ä¸Šé¢è¿™ä¸ªå›¾æ¡ˆè‚¯å®šä¸ä¼šé™Œç”Ÿï¼ŒSpringboot å¯åŠ¨çš„åŒæ—¶ä¼šæ‰“å°ä¸Šé¢çš„å›¾æ¡ˆï¼Œå¹¶å¸¦æœ‰ç‰ˆæœ¬å·ã€‚æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥æ‰¾åˆ°å…³äº banner çš„æè¿°&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The banner that is printed on start up can be changed by adding a banner.txt file to your classpath or by setting the spring.banner.location property to the location of such a file. If the file has an encoding other than UTF-8, you can set spring.banner.charset. In addition to a text file, you can also add a banner.gif, banner.jpg, or banner.png image file to your classpath or set the spring.banner.image.location property. Images are converted into an ASCII art representation and printed above any text banner.&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Springboot" scheme="https://www.codingme.net/categories/Springboot/"/>
    
    
      <category term="Springboot" scheme="https://www.codingme.net/tags/Springboot/"/>
    
  </entry>
  
</feed>
